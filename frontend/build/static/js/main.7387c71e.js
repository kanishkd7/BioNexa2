/*! For license information please see main.7387c71e.js.LICENSE.txt */
(()=>{var e={43:(e,t,n)=>{"use strict";e.exports=n(202)},52:(e,t,n)=>{"use strict";n.d(t,{KO:()=>X,MF:()=>Q,Sx:()=>Y,Wp:()=>J,j6:()=>G,om:()=>z,xZ:()=>q});var i=n(812),r=n(443),s=n(700),o=n(799);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const l="@firebase/app",c="0.10.13",u=new r.Vy("@firebase/app"),d="@firebase/app-compat",h="@firebase/analytics-compat",p="@firebase/analytics",f="@firebase/app-check-compat",m="@firebase/app-check",g="@firebase/auth",v="@firebase/auth-compat",y="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",k="@firebase/functions",T="@firebase/functions-compat",S="@firebase/installations",E="@firebase/installations-compat",I="@firebase/messaging",C="@firebase/messaging-compat",P="@firebase/performance",A="@firebase/performance-compat",_="@firebase/remote-config",x="@firebase/remote-config-compat",R="@firebase/storage",N="@firebase/storage-compat",D="@firebase/firestore",L="@firebase/vertexai-preview",O="@firebase/firestore-compat",M="firebase",j="[DEFAULT]",F={[l]:"fire-core",[d]:"fire-core-compat",[p]:"fire-analytics",[h]:"fire-analytics-compat",[m]:"fire-app-check",[f]:"fire-app-check-compat",[g]:"fire-auth",[v]:"fire-auth-compat",[y]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[k]:"fire-fn",[T]:"fire-fn-compat",[S]:"fire-iid",[E]:"fire-iid-compat",[I]:"fire-fcm",[C]:"fire-fcm-compat",[P]:"fire-perf",[A]:"fire-perf-compat",[_]:"fire-rc",[x]:"fire-rc-compat",[R]:"fire-gcs",[N]:"fire-gcs-compat",[D]:"fire-fst",[O]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[M]:"fire-js-all"},U=new Map,V=new Map,B=new Map;function $(e,t){try{e.container.addComponent(t)}catch(n){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function z(e){const t=e.name;if(B.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;B.set(t,e);for(const n of U.values())$(n,e);for(const n of V.values())$(n,e);return!0}function G(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function q(e){return void 0!==e.settings}const H={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},W=new s.FA("app","Firebase",H);class K{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw W.create("app-deleted",{appName:this._name})}}const Q="10.14.1";function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:j,automaticDataCollectionEnabled:!1},t),o=r.name;if("string"!==typeof o||!o)throw W.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.T9)()),!n)throw W.create("no-options");const a=U.get(o);if(a){if((0,s.bD)(n,a.options)&&(0,s.bD)(r,a.config))return a;throw W.create("duplicate-app",{appName:o})}const l=new i.h1(o);for(const i of B.values())l.addComponent(i);const c=new K(n,r,l);return U.set(o,c),c}function Y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;const t=U.get(e);if(!t&&e===j&&(0,s.T9)())return J();if(!t)throw W.create("no-app",{appName:e});return t}function X(e,t,n){var r;let s=null!==(r=F[e])&&void 0!==r?r:e;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=[`Unable to register library "${s}" with version "${t}":`];return o&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}z(new i.uA(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}const Z="firebase-heartbeat-store";let ee=null;function te(){return ee||(ee=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Z)}catch(n){console.warn(n)}}}).catch((e=>{throw W.create("idb-open",{originalErrorMessage:e.message})}))),ee}async function ne(e,t){try{const n=(await te()).transaction(Z,"readwrite"),i=n.objectStore(Z);await i.put(t,ie(e)),await n.done}catch(n){if(n instanceof s.g)u.warn(n.message);else{const e=W.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});u.warn(e.message)}}}function ie(e){return`${e.name}!${e.options.appId}`}class re{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=se();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){u.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=se(),{heartbeatsToSend:n,unsentEntries:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),ae(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),ae(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return u.warn(t),""}}}function se(){return(new Date).toISOString().substring(0,10)}class oe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await te()).transaction(Z),n=await t.objectStore(Z).get(ie(e));return await t.done,n}catch(t){if(t instanceof s.g)u.warn(t.message);else{const e=W.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ae(e){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var le;le="",z(new i.uA("platform-logger",(e=>new a(e)),"PRIVATE")),z(new i.uA("heartbeat",(e=>new re(e)),"PRIVATE")),X(l,c,le),X(l,c,"esm2017"),X("fire-js","")},67:(e,t,n)=>{e=n.nmd(e);var i="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",l="[object Date]",c="[object Error]",u="[object Function]",d="[object Map]",h="[object Number]",p="[object Object]",f="[object Promise]",m="[object RegExp]",g="[object Set]",v="[object String]",y="[object Symbol]",b="[object WeakMap]",w="[object ArrayBuffer]",k="[object DataView]",T=/^\[object .+?Constructor\]$/,S=/^(?:0|[1-9]\d*)$/,E={};E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E[s]=E[o]=E[w]=E[a]=E[k]=E[l]=E[c]=E[u]=E[d]=E[h]=E[p]=E[m]=E[g]=E[v]=E[b]=!1;var I="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,C="object"==typeof self&&self&&self.Object===Object&&self,P=I||C||Function("return this")(),A=t&&!t.nodeType&&t,_=A&&e&&!e.nodeType&&e,x=_&&_.exports===A,R=x&&I.process,N=function(){try{return R&&R.binding&&R.binding("util")}catch(e){}}(),D=N&&N.isTypedArray;function L(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function O(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function M(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var j,F,U=Array.prototype,V=Function.prototype,B=Object.prototype,$=P["__core-js_shared__"],z=V.toString,G=B.hasOwnProperty,q=function(){var e=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),H=B.toString,W=RegExp("^"+z.call(G).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),K=x?P.Buffer:void 0,Q=P.Symbol,J=P.Uint8Array,Y=B.propertyIsEnumerable,X=U.splice,Z=Q?Q.toStringTag:void 0,ee=Object.getOwnPropertySymbols,te=K?K.isBuffer:void 0,ne=(j=Object.keys,F=Object,function(e){return j(F(e))}),ie=Re(P,"DataView"),re=Re(P,"Map"),se=Re(P,"Promise"),oe=Re(P,"Set"),ae=Re(P,"WeakMap"),le=Re(Object,"create"),ce=Oe(ie),ue=Oe(re),de=Oe(se),he=Oe(oe),pe=Oe(ae),fe=Q?Q.prototype:void 0,me=fe?fe.valueOf:void 0;function ge(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ve(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function be(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ye;++t<n;)this.add(e[t])}function we(e){var t=this.__data__=new ve(e);this.size=t.size}function ke(e,t){var n=Fe(e),i=!n&&je(e),r=!n&&!i&&Ue(e),s=!n&&!i&&!r&&Ge(e),o=n||i||r||s,a=o?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],l=a.length;for(var c in e)!t&&!G.call(e,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Le(c,l))||a.push(c);return a}function Te(e,t){for(var n=e.length;n--;)if(Me(e[n][0],t))return n;return-1}function Se(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Z&&Z in Object(e)?function(e){var t=G.call(e,Z),n=e[Z];try{e[Z]=void 0;var i=!0}catch(s){}var r=H.call(e);i&&(t?e[Z]=n:delete e[Z]);return r}(e):function(e){return H.call(e)}(e)}function Ee(e){return ze(e)&&Se(e)==s}function Ie(e,t,n,i,r){return e===t||(null==e||null==t||!ze(e)&&!ze(t)?e!==e&&t!==t:function(e,t,n,i,r,u){var f=Fe(e),b=Fe(t),T=f?o:De(e),S=b?o:De(t),E=(T=T==s?p:T)==p,I=(S=S==s?p:S)==p,C=T==S;if(C&&Ue(e)){if(!Ue(t))return!1;f=!0,E=!1}if(C&&!E)return u||(u=new we),f||Ge(e)?Ae(e,t,n,i,r,u):function(e,t,n,i,r,s,o){switch(n){case k:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case w:return!(e.byteLength!=t.byteLength||!s(new J(e),new J(t)));case a:case l:case h:return Me(+e,+t);case c:return e.name==t.name&&e.message==t.message;case m:case v:return e==t+"";case d:var u=O;case g:var p=1&i;if(u||(u=M),e.size!=t.size&&!p)return!1;var f=o.get(e);if(f)return f==t;i|=2,o.set(e,t);var b=Ae(u(e),u(t),i,r,s,o);return o.delete(e),b;case y:if(me)return me.call(e)==me.call(t)}return!1}(e,t,T,n,i,r,u);if(!(1&n)){var P=E&&G.call(e,"__wrapped__"),A=I&&G.call(t,"__wrapped__");if(P||A){var _=P?e.value():e,x=A?t.value():t;return u||(u=new we),r(_,x,n,i,u)}}if(!C)return!1;return u||(u=new we),function(e,t,n,i,r,s){var o=1&n,a=_e(e),l=a.length,c=_e(t),u=c.length;if(l!=u&&!o)return!1;var d=l;for(;d--;){var h=a[d];if(!(o?h in t:G.call(t,h)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var f=!0;s.set(e,t),s.set(t,e);var m=o;for(;++d<l;){var g=e[h=a[d]],v=t[h];if(i)var y=o?i(v,g,h,t,e,s):i(g,v,h,e,t,s);if(!(void 0===y?g===v||r(g,v,n,i,s):y)){f=!1;break}m||(m="constructor"==h)}if(f&&!m){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,n,i,r,u)}(e,t,n,i,Ie,r))}function Ce(e){return!(!$e(e)||function(e){return!!q&&q in e}(e))&&(Ve(e)?W:T).test(Oe(e))}function Pe(e){if(!function(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||B;return e===n}(e))return ne(e);var t=[];for(var n in Object(e))G.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ae(e,t,n,i,r,s){var o=1&n,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(e);if(c&&s.get(t))return c==t;var u=-1,d=!0,h=2&n?new be:void 0;for(s.set(e,t),s.set(t,e);++u<a;){var p=e[u],f=t[u];if(i)var m=o?i(f,p,u,t,e,s):i(p,f,u,e,t,s);if(void 0!==m){if(m)continue;d=!1;break}if(h){if(!L(t,(function(e,t){if(o=t,!h.has(o)&&(p===e||r(p,e,n,i,s)))return h.push(t);var o}))){d=!1;break}}else if(p!==f&&!r(p,f,n,i,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function _e(e){return function(e,t,n){var i=t(e);return Fe(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,qe,Ne)}function xe(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Re(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ce(n)?n:void 0}ge.prototype.clear=function(){this.__data__=le?le(null):{},this.size=0},ge.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ge.prototype.get=function(e){var t=this.__data__;if(le){var n=t[e];return n===i?void 0:n}return G.call(t,e)?t[e]:void 0},ge.prototype.has=function(e){var t=this.__data__;return le?void 0!==t[e]:G.call(t,e)},ge.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=le&&void 0===t?i:t,this},ve.prototype.clear=function(){this.__data__=[],this.size=0},ve.prototype.delete=function(e){var t=this.__data__,n=Te(t,e);return!(n<0)&&(n==t.length-1?t.pop():X.call(t,n,1),--this.size,!0)},ve.prototype.get=function(e){var t=this.__data__,n=Te(t,e);return n<0?void 0:t[n][1]},ve.prototype.has=function(e){return Te(this.__data__,e)>-1},ve.prototype.set=function(e,t){var n=this.__data__,i=Te(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},ye.prototype.clear=function(){this.size=0,this.__data__={hash:new ge,map:new(re||ve),string:new ge}},ye.prototype.delete=function(e){var t=xe(this,e).delete(e);return this.size-=t?1:0,t},ye.prototype.get=function(e){return xe(this,e).get(e)},ye.prototype.has=function(e){return xe(this,e).has(e)},ye.prototype.set=function(e,t){var n=xe(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},be.prototype.add=be.prototype.push=function(e){return this.__data__.set(e,i),this},be.prototype.has=function(e){return this.__data__.has(e)},we.prototype.clear=function(){this.__data__=new ve,this.size=0},we.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},we.prototype.get=function(e){return this.__data__.get(e)},we.prototype.has=function(e){return this.__data__.has(e)},we.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ve){var i=n.__data__;if(!re||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new ye(i)}return n.set(e,t),this.size=n.size,this};var Ne=ee?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,s=[];++n<i;){var o=e[n];t(o,n,e)&&(s[r++]=o)}return s}(ee(e),(function(t){return Y.call(e,t)})))}:function(){return[]},De=Se;function Le(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||S.test(e))&&e>-1&&e%1==0&&e<t}function Oe(e){if(null!=e){try{return z.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Me(e,t){return e===t||e!==e&&t!==t}(ie&&De(new ie(new ArrayBuffer(1)))!=k||re&&De(new re)!=d||se&&De(se.resolve())!=f||oe&&De(new oe)!=g||ae&&De(new ae)!=b)&&(De=function(e){var t=Se(e),n=t==p?e.constructor:void 0,i=n?Oe(n):"";if(i)switch(i){case ce:return k;case ue:return d;case de:return f;case he:return g;case pe:return b}return t});var je=Ee(function(){return arguments}())?Ee:function(e){return ze(e)&&G.call(e,"callee")&&!Y.call(e,"callee")},Fe=Array.isArray;var Ue=te||function(){return!1};function Ve(e){if(!$e(e))return!1;var t=Se(e);return t==u||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Be(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function $e(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ze(e){return null!=e&&"object"==typeof e}var Ge=D?function(e){return function(t){return e(t)}}(D):function(e){return ze(e)&&Be(e.length)&&!!E[Se(e)]};function qe(e){return null!=(t=e)&&Be(t.length)&&!Ve(t)?ke(e):Pe(e);var t}e.exports=function(e,t){return Ie(e,t)}},121:function(e,t,n){var i;!function(r,s){"use strict";var o="function",a="undefined",l="object",c="string",u="major",d="model",h="name",p="type",f="vendor",m="version",g="architecture",v="console",y="mobile",b="tablet",w="smarttv",k="wearable",T="embedded",S="Amazon",E="Apple",I="ASUS",C="BlackBerry",P="Browser",A="Chrome",_="Firefox",x="Google",R="Huawei",N="LG",D="Microsoft",L="Motorola",O="Opera",M="Samsung",j="Sharp",F="Sony",U="Xiaomi",V="Zebra",B="Facebook",$="Chromium OS",z="Mac OS",G=" Browser",q=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},H=function(e,t){return typeof e===c&&-1!==W(t).indexOf(W(e))},W=function(e){return e.toLowerCase()},K=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},Q=function(e,t){for(var n,i,r,a,c,u,d=0;d<t.length&&!c;){var h=t[d],p=t[d+1];for(n=i=0;n<h.length&&!c&&h[n];)if(c=h[n++].exec(e))for(r=0;r<p.length;r++)u=c[++i],typeof(a=p[r])===l&&a.length>0?2===a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,u):this[a[0]]=a[1]:3===a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=u?u.replace(a[1],a[2]):s:this[a[0]]=u?a[1].call(this,u,a[2]):s:4===a.length&&(this[a[0]]=u?a[3].call(this,u.replace(a[1],a[2])):s):this[a]=u||s;d+=2}},J=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(H(t[n][i],e))return"?"===n?s:n}else if(H(t[n],e))return"?"===n?s:n;return t.hasOwnProperty("*")?t["*"]:e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,m],[/opios[\/ ]+([\w\.]+)/i],[m,[h,O+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[m,[h,O+" GX"]],[/\bopr\/([\w\.]+)/i],[m,[h,O]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[h,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[m,[h,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,m],[/quark(?:pc)?\/([-\w\.]+)/i],[m,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[m,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[h,"UC"+P]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[h,"Smart Lenovo "+P]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+P],m],[/\bfocus\/([\w\.]+)/i],[m,[h,_+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[h,O+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[h,O+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[h,"MIUI"+G]],[/fxios\/([\w\.-]+)/i],[m,[h,_]],[/\bqihoobrowser\/?([\w\.]*)/i],[m,[h,"360"]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],m],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+G],m],[/samsungbrowser\/([\w\.]+)/i],[m,[h,M+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[m,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[h,m],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[h],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[m,h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,B],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[h,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,A+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[h,"Android "+P]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[m,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],m],[/(wolvic|librewolf)\/([\w\.]+)/i],[h,m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[h,_+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,[m,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,W]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",W]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,W]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,M],[p,b]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,M],[p,y]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,E],[p,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,E],[p,b]],[/(macintosh);/i],[d,[f,E]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,j],[p,y]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[f,"Honor"],[p,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,R],[p,b]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,R],[p,y]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[f,U],[p,y]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,U],[p,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[p,y]],[/\b(opd2\d{3}a?) bui/i],[d,[f,"OPPO"],[p,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[p,y]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[p,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,L],[p,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,L],[p,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,N],[p,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,N],[p,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[p,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[p,y]],[/(pixel c)\b/i],[d,[f,x],[p,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,x],[p,y]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,F],[p,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,F],[p,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[p,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,S],[p,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,S],[p,y]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[p,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,C],[p,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,I],[p,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,I],[p,y]],[/(nexus 9)/i],[d,[f,"HTC"],[p,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[p,y]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[f,"TCL"],[p,b]],[/(itel) ((\w+))/i],[[f,W],d,[p,J,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[p,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[p,y]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[p,y]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[f,"Energizer"],[p,y]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[f,"Cat"],[p,y]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[f,"Smartfren"],[p,y]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[f,"Nothing"],[p,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[p,y]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[p,b]],[/(surface duo)/i],[d,[f,D],[p,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[p,y]],[/(u304aa)/i],[d,[f,"AT&T"],[p,y]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[p,y]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[p,b]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[p,b]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[p,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[p,b]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[p,b]],[/\b(k88) b/i],[d,[f,"ZTE"],[p,b]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[p,y]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[p,y]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[p,b]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[p,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[p,b]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[p,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[p,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[p,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[p,y]],[/\b(ph-1) /i],[d,[f,"Essential"],[p,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[p,b]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[p,b]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[p,b]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[p,b]],[/(sprint) (\w+)/i],[f,d,[p,y]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,D],[p,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,V],[p,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,V],[p,y]],[/smart-tv.+(samsung)/i],[f,[p,w]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,M],[p,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,N],[p,w]],[/(apple) ?tv/i],[f,[d,E+" TV"],[p,w]],[/crkey/i],[[d,A+"cast"],[f,x],[p,w]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,S],[p,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,j],[p,w]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,F],[p,w]],[/(mitv-\w{5}) bui/i],[d,[f,U],[p,w]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[p,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,K],[d,K],[p,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[p,v]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[p,v]],[/(playstation [345portablevi]+)/i],[d,[f,F],[p,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,D],[p,v]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[f,M],[p,k]],[/((pebble))app/i],[f,d,[p,k]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,E],[p,k]],[/droid.+; (glass) \d/i],[d,[f,x],[p,k]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,V],[p,k]],[/droid.+; (glass) \d/i],[d,[f,x],[p,k]],[/(pico) (4|neo3(?: link|pro)?)/i],[f,d,[p,k]],[/; (quest( \d| pro)?)/i],[d,[f,B],[p,k]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[p,T]],[/(aeobc)\b/i],[d,[f,S],[p,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[p,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[p,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[p,y]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[h,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[h,m],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[m,J,Y]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,J,Y],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,z],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,m],[/\(bb(10);/i],[m,[h,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[h,_+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[h,A+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,$],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,m],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,m]]},Z=function(e,t){if(typeof e===l&&(t=e,e=s),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof r!==a&&r.navigator?r.navigator:s,i=e||(n&&n.userAgent?n.userAgent:""),v=n&&n.userAgentData?n.userAgentData:s,w=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2===0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}(X,t):X,k=n&&n.userAgent==i;return this.getBrowser=function(){var e,t={};return t[h]=s,t[m]=s,Q.call(t,i,w.browser),t[u]=typeof(e=t[m])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:s,k&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[g]=s,Q.call(e,i,w.cpu),e},this.getDevice=function(){var e={};return e[f]=s,e[d]=s,e[p]=s,Q.call(e,i,w.device),k&&!e[p]&&v&&v.mobile&&(e[p]=y),k&&"Macintosh"==e[d]&&n&&typeof n.standalone!==a&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[p]=b),e},this.getEngine=function(){var e={};return e[h]=s,e[m]=s,Q.call(e,i,w.engine),e},this.getOS=function(){var e={};return e[h]=s,e[m]=s,Q.call(e,i,w.os),k&&!e[h]&&v&&v.platform&&"Unknown"!=v.platform&&(e[h]=v.platform.replace(/chrome os/i,$).replace(/macos/i,z)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===c&&e.length>500?K(e,500):e,this},this.setUA(i),this};Z.VERSION="1.0.40",Z.BROWSER=q([h,m,u]),Z.CPU=q([g]),Z.DEVICE=q([d,f,p,v,y,w,b,k,T]),Z.ENGINE=Z.OS=q([h,m]),typeof t!==a?(e.exports&&(t=e.exports=Z),t.UAParser=Z):n.amdO?(i=function(){return Z}.call(t,n,t,e))===s||(e.exports=i):typeof r!==a&&(r.UAParser=Z);var ee=typeof r!==a&&(r.jQuery||r.Zepto);if(ee&&!ee.ua){var te=new Z;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var n in t)ee.ua[n]=t[n]}}}("object"===typeof window?window:this)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},173:(e,t,n)=>{e.exports=n(497)()},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var k=Array.isArray,T=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)T.call(t,r)&&!E.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:S.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+A(l,0):s,k(o)?(r="",null!=e&&(r=e.replace(P,"$&/")+"/"),_(o,t,r,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(P,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",k(e))for(var c=0;c<e.length;c++){var u=s+A(a=e[c],c);l+=_(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=_(a=a.value,t,r,u=s+A(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function x(e,t,n){if(null==e)return e;var i=[],r=0;return _(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},D={transition:null},L={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:x,forEach:function(e,t,n){x(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return x(e,(function(){t++})),t},toArray:function(e){return x(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=O,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!E.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.3.1"},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function k(e){if(g=!1,w(e),!m)if(null!==i(c))m=!0,D(T);else{var t=i(u);null!==t&&L(k,t.startTime-e)}}function T(e,n){m=!1,g&&(g=!1,y(C),C=-1),f=!0;var s=p;try{for(w(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!_());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===i(c)&&r(c),w(n)}else r(c);h=i(c)}if(null!==h)var l=!0;else{var d=i(u);null!==d&&L(k,d.startTime-n),l=!1}return l}finally{h=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,I=null,C=-1,P=5,A=-1;function _(){return!(t.unstable_now()-A<P)}function x(){if(null!==I){var e=t.unstable_now();A=e;var n=!0;try{n=I(!0,e)}finally{n?S():(E=!1,I=null)}}else E=!1}if("function"===typeof b)S=function(){b(x)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,N=R.port2;R.port1.onmessage=x,S=function(){N.postMessage(null)}}else S=function(){v(x,0)};function D(e){I=e,E||(E=!0,S())}function L(e,n){C=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,D(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(y(C),C=-1):g=!0,L(k,s-o))):(e.sortIndex=a,n(c,e),m||f||(m=!0,D(T))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},321:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},391:(e,t,n)=>{"use strict";var i=n(950);t.H=i.createRoot,i.hydrateRoot},443:(e,t,n)=>{"use strict";n.d(t,{$b:()=>r,Vy:()=>c});const i=[];var r;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(r={}));const s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=a[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];console[i](`[${n}]  ${e.name}:`,...s)};class c{constructor(e){this.name=e,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},476:(e,t,n)=>{var i;!function(r){var s=Object.hasOwnProperty,o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a="object"==typeof process&&"function"==typeof process.nextTick,l="function"===typeof Symbol,c="object"===typeof Reflect,u="function"===typeof setImmediate?setImmediate:setTimeout,d=l?c&&"function"===typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function h(){this._events={},this._conf&&p.call(this,this._conf)}function p(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==r&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function f(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!==typeof process&&process.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=e,process.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var m=function(e,t,n){var i=arguments.length;switch(i){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var r=new Array(i);i--;)r[i]=arguments[i];return r}};function g(e,t){for(var n={},i=e.length,s=t?t.length:0,o=0;o<i;o++)n[e[o]]=o<s?t[o]:r;return n}function v(e,t,n){var i,r;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(i=n.on,r=n.off),t.addEventListener?(i=t.addEventListener,r=t.removeEventListener):t.addListener?(i=t.addListener,r=t.removeListener):t.on&&(i=t.on,r=t.off),!i&&!r)throw Error("target does not implement any known event API");if("function"!==typeof i)throw TypeError("on method must be a function");if("function"!==typeof r)throw TypeError("off method must be a function");this._on=i,this._off=r;var s=e._observers;s?s.push(this):e._observers=[this]}function y(e,t,n,i){var o=Object.assign({},t);if(!e)return o;if("object"!==typeof e)throw TypeError("options must be an object");var a,l,c,u=Object.keys(e),d=u.length;function h(e){throw Error('Invalid "'+a+'" option value'+(e?". Reason: "+e:""))}for(var p=0;p<d;p++){if(a=u[p],!i&&!s.call(t,a))throw Error('Unknown "'+a+'" option');(l=e[a])!==r&&(c=n[a],o[a]=c?c(l,h):l)}return o}function b(e,t){return"function"===typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function w(e){var t="value must be type of "+e.join("|"),n=e.length,i=e[0],r=e[1];return 1===n?function(e,n){if(typeof e===i)return e;n(t)}:2===n?function(e,n){var s=typeof e;if(s===i||s===r)return e;n(t)}:function(i,r){for(var s=typeof i,o=n;o-- >0;)if(s===e[o])return i;r(t)}}Object.assign(v.prototype,{subscribe:function(e,t,n){var i=this,r=this._target,s=this._emitter,o=this._listeners,a=function(){var i=m.apply(null,arguments),o={data:i,name:t,original:e};n?!1!==n.call(r,o)&&s.emit.apply(s,[o.name].concat(i)):s.emit.apply(s,[t].concat(i))};if(o[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,s._newListener&&s._removeListener&&!i._onNewListener?(this._onNewListener=function(n){n===t&&null===o[e]&&(o[e]=a,i._on.call(r,e,a))},s.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!s.hasListeners(n)&&o[e]&&(o[e]=null,i._off.call(r,e,a))},o[e]=null,s.on("removeListener",this._onRemoveListener)):(o[e]=a,i._on.call(r,e,a))},unsubscribe:function(e){var t,n,i,r=this,s=this._listeners,o=this._emitter,a=this._off,l=this._target;if(e&&"string"!==typeof e)throw TypeError("event must be a string");function c(){r._onNewListener&&(o.off("newListener",r._onNewListener),o.off("removeListener",r._onRemoveListener),r._onNewListener=null,r._onRemoveListener=null);var e=E.call(o,r);o._observers.splice(e,1)}if(e){if(!(t=s[e]))return;a.call(l,e,t),delete s[e],--this._listenersCount||c()}else{for(i=(n=d(s)).length;i-- >0;)e=n[i],a.call(l,e,s[e]);this._listeners={},this._listenersCount=0,c()}}});var k=w(["function"]),T=w(["object","function"]);function S(e,t,n){var i,r,s,o=0,a=new e((function(l,c,u){function d(){r&&(r=null),o&&(clearTimeout(o),o=0)}n=y(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!==typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),i=!n.overload&&"function"===typeof e.prototype.cancel&&"function"===typeof u;var h=function(e){d(),l(e)},p=function(e){d(),c(e)};i?t(h,p,u):(r=[function(e){p(e||Error("canceled"))}],t(h,p,(function(e){if(s)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!==typeof e)throw TypeError("onCancel callback must be a function");r.push(e)})),s=!0),n.timeout>0&&(o=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",o=0,a.cancel(e),c(e)}),n.timeout))}));return i||(a.cancel=function(e){if(r){for(var t=r.length,n=1;n<t;n++)r[n](e);r[0](e),r=null}}),a}function E(e){var t=this._observers;if(!t)return-1;for(var n=t.length,i=0;i<n;i++)if(t[i]._target===e)return i;return-1}function I(e,t,n,i,r){if(!n)return null;if(0===i){var s=typeof t;if("string"===s){var o,a,l=0,c=0,u=this.delimiter,h=u.length;if(-1!==(a=t.indexOf(u))){o=new Array(5);do{o[l++]=t.slice(c,a),c=a+h}while(-1!==(a=t.indexOf(u,c)));o[l++]=t.slice(c),t=o,r=l}else t=[t],r=1}else"object"===s?r=t.length:(t=[t],r=1)}var p,f,m,g,v,y,b,w=null,k=t[i],T=t[i+1];if(i===r)n._listeners&&("function"===typeof n._listeners?(e&&e.push(n._listeners),w=[n]):(e&&e.push.apply(e,n._listeners),w=[n]));else{if("*"===k){for(a=(y=d(n)).length;a-- >0;)"_listeners"!==(p=y[a])&&(b=I(e,t,n[p],i+1,r))&&(w?w.push.apply(w,b):w=b);return w}if("**"===k){for((v=i+1===r||i+2===r&&"*"===T)&&n._listeners&&(w=I(e,t,n,r,r)),a=(y=d(n)).length;a-- >0;)"_listeners"!==(p=y[a])&&("*"===p||"**"===p?(n[p]._listeners&&!v&&(b=I(e,t,n[p],r,r))&&(w?w.push.apply(w,b):w=b),b=I(e,t,n[p],i,r)):b=I(e,t,n[p],p===T?i+2:i,r),b&&(w?w.push.apply(w,b):w=b));return w}n[k]&&(w=I(e,t,n[k],i+1,r))}if((f=n["*"])&&I(e,t,f,i+1,r),m=n["**"])if(i<r)for(m._listeners&&I(e,t,m,r,r),a=(y=d(m)).length;a-- >0;)"_listeners"!==(p=y[a])&&(p===T?I(e,t,m[p],i+2,r):p===k?I(e,t,m[p],i+1,r):((g={})[p]=m[p],I(e,t,{"**":g},i+1,r)));else m._listeners?I(e,t,m,r,r):m["*"]&&m["*"]._listeners&&I(e,t,m["*"],r,r);return w}function C(e,t,n){var i,r,s=0,o=0,a=this.delimiter,l=a.length;if("string"===typeof e)if(-1!==(i=e.indexOf(a))){r=new Array(5);do{r[s++]=e.slice(o,i),o=i+l}while(-1!==(i=e.indexOf(a,o)));r[s++]=e.slice(o)}else r=[e],s=1;else r=e,s=e.length;if(s>1)for(i=0;i+1<s;i++)if("**"===r[i]&&"**"===r[i+1])return;var c,u=this.listenerTree;for(i=0;i<s;i++)if(u=u[c=r[i]]||(u[c]={}),i===s-1)return u._listeners?("function"===typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,f.call(this,u._listeners.length,c))):u._listeners=t,!0;return!0}function P(e,t,n,i){for(var r,s,o,a,l=d(e),c=l.length,u=e._listeners;c-- >0;)r=e[s=l[c]],o="_listeners"===s?n:n?n.concat(s):[s],a=i||"symbol"===typeof s,u&&t.push(a?o:o.join(this.delimiter)),"object"===typeof r&&P.call(this,r,t,o,a);return t}function A(e){for(var t,n,i,r=d(e),s=r.length;s-- >0;)(t=e[n=r[s]])&&(i=!0,"_listeners"===n||A(t)||delete e[n]);return i}function _(e,t,n){this.emitter=e,this.event=t,this.listener=n}function x(e,t,n){if(!0===n)s=!0;else if(!1===n)i=!0;else{if(!n||"object"!==typeof n)throw TypeError("options should be an object or true");var i=n.async,s=n.promisify,o=n.nextTick,l=n.objectify}if(i||o||s){var c=t,d=t._origin||t;if(o&&!a)throw Error("process.nextTick is not supported");s===r&&(s="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return s?o?Promise.resolve():new Promise((function(e){u(e)})).then((function(){return t.event=n,c.apply(t,e)})):(o?process.nextTick:u)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=d}return[t,l?new _(this,e,t):this]}function R(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,p.call(this,e)}_.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},R.EventEmitter2=R,R.prototype.listenTo=function(e,t,n){if("object"!==typeof e)throw TypeError("target musts be an object");var i=this;function s(t){if("object"!==typeof t)throw TypeError("events must be an object");var r,s=n.reducers,o=E.call(i,e);r=-1===o?new v(i,e,n):i._observers[o];for(var a,l=d(t),c=l.length,u="function"===typeof s,h=0;h<c;h++)a=l[h],r.subscribe(a,t[a]||a,u?s:s&&s[a])}return n=y(n,{on:r,off:r,reducers:r},{on:k,off:k,reducers:T}),o(t)?s(g(t)):s("string"===typeof t?g(t.split(/\s+/)):t),this},R.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var i,r=n.length,s=!1;if(e&&"object"!==typeof e)throw TypeError("target should be an object");for(;r-- >0;)i=n[r],e&&i._target!==e||(i.unsubscribe(t),s=!0);return s},R.prototype.delimiter=".",R.prototype.setMaxListeners=function(e){e!==r&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},R.prototype.getMaxListeners=function(){return this._maxListeners},R.prototype.event="",R.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},R.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},R.prototype._once=function(e,t,n,i){return this._many(e,1,t,n,i)},R.prototype.many=function(e,t,n,i){return this._many(e,t,n,!1,i)},R.prototype.prependMany=function(e,t,n,i){return this._many(e,t,n,!0,i)},R.prototype._many=function(e,t,n,i,r){var s=this;if("function"!==typeof n)throw new Error("many only accepts instances of Function");function o(){return 0===--t&&s.off(e,o),n.apply(this,arguments)}return o._origin=n,this._on(e,o,i,r)},R.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,n,i,r,s,o=arguments[0],a=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return!1;if(a&&(e=o,"newListener"!==o&&"removeListener"!==o&&"object"===typeof o)){if(n=o.length,l)for(i=0;i<n;i++)if("symbol"===typeof o[i]){s=!0;break}s||(o=o.join(this.delimiter))}var c,u=arguments.length;if(this._all&&this._all.length)for(i=0,n=(c=this._all.slice()).length;i<n;i++)switch(this.event=o,u){case 1:c[i].call(this,o);break;case 2:c[i].call(this,o,arguments[1]);break;case 3:c[i].call(this,o,arguments[1],arguments[2]);break;default:c[i].apply(this,arguments)}if(a)c=[],I.call(this,c,e,this.listenerTree,0,n);else{if("function"===typeof(c=this._events[o])){switch(this.event=o,u){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),r=1;r<u;r++)t[r-1]=arguments[r];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(u>3)for(t=new Array(u-1),r=1;r<u;r++)t[r-1]=arguments[r];for(i=0,n=c.length;i<n;i++)switch(this.event=o,u){case 1:c[i].call(this);break;case 2:c[i].call(this,arguments[1]);break;case 3:c[i].call(this,arguments[1],arguments[2]);break;default:c[i].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===o)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},R.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,n,i,r,s,o=arguments[0],a=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(a&&(e=o,"newListener"!==o&&"removeListener"!==o&&"object"===typeof o)){if(i=o.length,l)for(r=0;r<i;r++)if("symbol"===typeof o[r]){t=!0;break}t||(o=o.join(this.delimiter))}var c,u=[],d=arguments.length;if(this._all)for(r=0,i=this._all.length;r<i;r++)switch(this.event=o,d){case 1:u.push(this._all[r].call(this,o));break;case 2:u.push(this._all[r].call(this,o,arguments[1]));break;case 3:u.push(this._all[r].call(this,o,arguments[1],arguments[2]));break;default:u.push(this._all[r].apply(this,arguments))}if(a?(c=[],I.call(this,c,e,this.listenerTree,0)):c=this._events[o],"function"===typeof c)switch(this.event=o,d){case 1:u.push(c.call(this));break;case 2:u.push(c.call(this,arguments[1]));break;case 3:u.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(d-1),s=1;s<d;s++)n[s-1]=arguments[s];u.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),d>3)for(n=new Array(d-1),s=1;s<d;s++)n[s-1]=arguments[s];for(r=0,i=c.length;r<i;r++)switch(this.event=o,d){case 1:u.push(c[r].call(this));break;case 2:u.push(c[r].call(this,arguments[1]));break;case 3:u.push(c[r].call(this,arguments[1],arguments[2]));break;default:u.push(c[r].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===o)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},R.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},R.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},R.prototype.onAny=function(e){return this._onAny(e,!1)},R.prototype.prependAny=function(e){return this._onAny(e,!0)},R.prototype.addListener=R.prototype.on,R.prototype._onAny=function(e,t){if("function"!==typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},R.prototype._on=function(e,t,n,i){if("function"===typeof e)return this._onAny(e,t),this;if("function"!==typeof t)throw new Error("on only accepts instances of Function");this._events||h.call(this);var s,o=this;return i!==r&&(t=(s=x.call(this,e,t,i))[0],o=s[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(C.call(this,e,t,n),o):(this._events[e]?("function"===typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,f.call(this,this._events[e].length,e))):this._events[e]=t,o)},R.prototype.off=function(e,t){if("function"!==typeof t)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var r="string"===typeof e?e.split(this.delimiter):e.slice();if(!(i=I.call(this,null,r,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var a=i[s];if(n=a._listeners,o(n)){for(var l=-1,c=0,u=n.length;c<u;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){l=c;break}if(l<0)continue;return this.wildcard?a._listeners.splice(l,1):this._events[e].splice(l,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&A(this.listenerTree),this},R.prototype.offAny=function(e){var t,n=0,i=0;if(e&&this._all&&this._all.length>0){for(n=0,i=(t=this._all).length;n<i;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,i=t.length;n<i;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},R.prototype.removeListener=R.prototype.off,R.prototype.removeAllListeners=function(e){if(e===r)return!this._events||h.call(this),this;if(this.wildcard){var t,n=I.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&A(this.listenerTree)}else this._events&&(this._events[e]=null);return this},R.prototype.listeners=function(e){var t,n,i,s,o,a=this._events;if(e===r){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(s=(t=d(a)).length,i=[];s-- >0;)"function"===typeof(n=a[t[s]])?i.push(n):i.push.apply(i,n);return i}if(this.wildcard){if(!(o=this.listenerTree))return[];var l=[],c="string"===typeof e?e.split(this.delimiter):e.slice();return I.call(this,l,c,o,0),l}return a&&(n=a[e])?"function"===typeof n?[n]:n:[]},R.prototype.eventNames=function(e){var t=this._events;return this.wildcard?P.call(this,this.listenerTree,[],null,e):t?d(t):[]},R.prototype.listenerCount=function(e){return this.listeners(e).length},R.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"===typeof e?e.split(this.delimiter):e.slice();return I.call(this,t,n,this.listenerTree,0),t.length>0}var i=this._events,s=this._all;return!!(s&&s.length||i&&(e===r?d(i).length:i[e]))},R.prototype.listenersAny=function(){return this._all?this._all:[]},R.prototype.waitFor=function(e,t){var n=this,i=typeof t;return"number"===i?t={timeout:t}:"function"===i&&(t={filter:t}),S((t=y(t,{timeout:0,filter:r,handleError:!1,Promise:Promise,overload:!1},{filter:k,Promise:b})).Promise,(function(i,r,s){function o(){var s=t.filter;if(!s||s.apply(n,arguments))if(n.off(e,o),t.handleError){var a=arguments[0];a?r(a):i(m.apply(null,arguments).slice(1))}else i(m.apply(null,arguments))}s((function(){n.off(e,o)})),n._on(e,o,!1)}),{timeout:t.timeout,overload:t.overload})};var N=R.prototype;Object.defineProperties(R,{defaultMaxListeners:{get:function(){return N._maxListeners},set:function(e){if("number"!==typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");N._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return S((n=y(n,{Promise:Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,i,r){var s;if("function"===typeof e.addEventListener)return s=function(){n(m.apply(null,arguments))},r((function(){e.removeEventListener(t,s)})),void e.addEventListener(t,s,{once:!0});var o,a=function(){o&&e.removeListener("error",o),n(m.apply(null,arguments))};"error"!==t&&(o=function(n){e.removeListener(t,a),i(n)},e.once("error",o)),r((function(){o&&e.removeListener("error",o),e.removeListener(t,a)})),e.once(t,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(N,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(i=function(){return R}.call(t,n,t,e))===r||(e.exports=i)}()},497:(e,t,n)=>{"use strict";var i=n(218);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,o){if(o!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},579:(e,t,n)=>{"use strict";e.exports=n(153)},605:(e,t,n)=>{var i=n(321),r=/%[sdv%]/g,s=function(e){var t=1,n=arguments,i=n.length;return e.replace(r,(function(e){if(t>=i)return e;var r=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}}))},o=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var r=0;r<t.names.length;r+=1){var o=t.names[r];t.name?i.push(n[t.name][o]):i.push(n[t.names[r]])}else i.push(n[t.name]);return s.apply(null,i)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||a,r=t.innerOrder||l,s=[];return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?s.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){s.push(o(t,n,e))}))}))})),e.media.forEach((function(e){s.push(o("m",i.m[0],e)),r.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?s.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){s.push(o(t,n,e))}))}))}))})),s.join("\r\n")+"\r\n"}},640:(e,t,n)=>{var i=n(877),r=n(605);n(321),t.M9=r,t.qg=i.parse,i.parseParams,i.parseFmtpConfig,i.parsePayloads,i.parseRemoteCandidates,i.parseImageAttributes,i.parseSimulcastStreamList},700:(e,t,n)=>{"use strict";n.d(t,{Am:()=>N,FA:()=>P,Fy:()=>m,I9:()=>D,Im:()=>_,Ku:()=>z,T9:()=>h,Tj:()=>u,Uj:()=>o,XA:()=>p,ZQ:()=>g,bD:()=>x,c1:()=>y,cY:()=>f,dM:()=>I,eX:()=>E,g:()=>C,hp:()=>L,jZ:()=>v,lT:()=>k,lV:()=>w,nr:()=>T,p9:()=>$,sr:()=>b,tD:()=>O,u:()=>a,yU:()=>d,zW:()=>S});const i=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],s=r+1<e.length,o=s?e[r+1]:0,a=r+2<e.length,l=a?e[r+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let d=(15&o)<<2|l>>6,h=63&l;a||(h=64,s||(d=64)),i.push(n[c],n[u],n[d],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],o=r<e.length?n[e.charAt(r)]:0;++r;const a=r<e.length?n[e.charAt(r)]:64;++r;const l=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==o||null==a||null==l)throw new s;const c=t<<2|o>>4;if(i.push(c),64!==a){const e=o<<4&240|a>>2;if(i.push(e),64!==l){const e=a<<6&192|l;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(e){return function(e){const t=i(e);return r.encodeByteArray(t,!0)}(e).replace(/\./g,"")},a=function(e){try{return r.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const l=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,c=()=>{try{return l()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"http://localhost:5000",REACT_APP_OPENAI_API_KEY:"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"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&a(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},u=e=>{var t,n;return null===(n=null===(t=c())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},h=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},p=e=>{var t;return null===(t=c())||void 0===t?void 0:t[`_${e}`]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function y(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function k(){const e=g();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function T(){return!function(){var e;const t=null===(e=c())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(i){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S(){try{return"object"===typeof indexedDB}catch(e){return!1}}function E(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}function I(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class C extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,C.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,P.prototype.create)}}class P{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,i=this.errors[e],r=i?function(e,t){return e.replace(A,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(i,t):"Error",s=`${this.serviceName}: ${r} (${n}).`;return new C(n,s,t)}}const A=/\{\$([^}]+)}/g;function _(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function x(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(R(n)&&R(s)){if(!x(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function R(e){return null!==e&&"object"===typeof e}function N(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function D(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function L(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function O(e,t){const n=new M(e,t);return n.subscribe.bind(n)}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=j),void 0===i.error&&(i.error=j),void 0===i.complete&&(i.complete=j);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function j(){}const F=1e3,U=2,V=144e5,B=.5;function $(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:F)*Math.pow(t,e),i=Math.round(B*n*(Math.random()-.5)*2);return Math.min(V,n+i)}function z(e){return e&&e._delegate?e._delegate:e}},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),T=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),P=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var M,j=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case T:return"Portal";case I:return"Profiler";case E:return"StrictMode";case _:return"Suspense";case x:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return $(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=q(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return j({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=G(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return j({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function se(e,t){var n=G(t.value),i=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Se=null,Ee=null;function Ie(e){if(e=br(e)){if("function"!==typeof Te)throw Error(s(280));var t=e.stateNode;t&&(t=kr(t),Te(e.stateNode,e.type,t))}}function Ce(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Pe(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ae(e,t){return e(t)}function _e(){}var xe=!1;function Re(e,t,n){if(xe)return e(t,n);xe=!0;try{return Ae(e,t,n)}finally{xe=!1,(null!==Se||null!==Ee)&&(_e(),Pe())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var i=kr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){De=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){De=!1}function Oe(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,je=null,Fe=!1,Ue=null,Ve={onError:function(e){Me=!0,je=e}};function Be(e,t,n,i,r,s,o,a,l){Me=!1,je=null,Oe.apply(Ve,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if($e(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Ge(r),e;if(o===i)return Ge(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var We=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Je=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=dt(a):0!==(s&=o)&&(i=dt(s))}else 0!==(o=n&~r)?i=dt(o):0!==s&&(i=dt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,Tt,St,Et,It,Ct=!1,Pt=[],At=null,_t=null,xt=null,Rt=new Map,Nt=new Map,Dt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":xt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Mt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&Tt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function jt(e){var t=yr(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void It(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&Tt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);we=i,n.target.dispatchEvent(i),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){Ct=!1,null!==At&&Ft(At)&&(At=null),null!==_t&&Ft(_t)&&(_t=null),null!==xt&&Ft(xt)&&(xt=null),Rt.forEach(Ut),Nt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vt)))}function $t(e){function t(t){return Bt(t,e)}if(0<Pt.length){Bt(Pt[0],e);for(var n=1;n<Pt.length;n++){var i=Pt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==At&&Bt(At,e),null!==_t&&Bt(_t,e),null!==xt&&Bt(xt,e),Rt.forEach(t),Nt.forEach(t),n=0;n<Dt.length;n++)(i=Dt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)jt(n),null===n.blockedOn&&Dt.shift()}var zt=w.ReactCurrentBatchConfig,Gt=!0;function qt(e,t,n,i){var r=bt,s=zt.transition;zt.transition=null;try{bt=1,Wt(e,t,n,i)}finally{bt=r,zt.transition=s}}function Ht(e,t,n,i){var r=bt,s=zt.transition;zt.transition=null;try{bt=4,Wt(e,t,n,i)}finally{bt=r,zt.transition=s}}function Wt(e,t,n,i){if(Gt){var r=Qt(e,t,n,i);if(null===r)Gi(e,t,i,Kt,n),Ot(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return At=Mt(At,e,t,n,i,r),!0;case"dragenter":return _t=Mt(_t,e,t,n,i,r),!0;case"mouseover":return xt=Mt(xt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Rt.set(s,Mt(Rt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Nt.set(s,Mt(Nt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Ot(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&kt(s),null===(s=Qt(e,t,n,i))&&Gi(e,t,i,Kt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Gi(e,t,i,null,n)}}var Kt=null;function Qt(e,t,n,i){if(Kt=null,null!==(e=yr(e=ke(i))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=j({},cn,{view:0,detail:0}),hn=sn(dn),pn=j({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=sn(pn),mn=sn(j({},pn,{dataTransfer:0})),gn=sn(j({},dn,{relatedTarget:0})),vn=sn(j({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=j({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),wn=sn(j({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function In(){return En}var Cn=j({},dn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Tn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Pn=sn(Cn),An=sn(j({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=sn(j({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),xn=sn(j({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=j({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=sn(Rn),Dn=[9,13,27,32],Ln=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Mn=u&&"TextEvent"in window&&!On,jn=u&&(!Ln||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function qn(e,t,n,i){Ce(i),0<(t=Hi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,Wn=null;function Kn(e){Fi(e,0)}function Qn(e){if(W(wr(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ti(){Hn&&(Hn.detachEvent("onpropertychange",ni),Wn=Hn=null)}function ni(e){if("value"===e.propertyName&&Qn(Wn)){var t=[];qn(t,Wn,e,ke(e)),Re(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Wn=n,(Hn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Wn)}function si(e,t){if("click"===e)return Qn(t)}function oi(e,t){if("input"===e||"change"===e)return Qn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,bi=!1;function wi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==K(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=Hi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function ki(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ti={animationend:ki("Animation","AnimationEnd"),animationiteration:ki("Animation","AnimationIteration"),animationstart:ki("Animation","AnimationStart"),transitionend:ki("Transition","TransitionEnd")},Si={},Ei={};function Ii(e){if(Si[e])return Si[e];if(!Ti[e])return e;var t,n=Ti[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ei)return Si[e]=n[t];return e}u&&(Ei=document.createElement("div").style,"AnimationEvent"in window||(delete Ti.animationend.animation,delete Ti.animationiteration.animation,delete Ti.animationstart.animation),"TransitionEvent"in window||delete Ti.transitionend.transition);var Ci=Ii("animationend"),Pi=Ii("animationiteration"),Ai=Ii("animationstart"),_i=Ii("transitionend"),xi=new Map,Ri="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(e,t){xi.set(e,t),l(t,[e])}for(var Di=0;Di<Ri.length;Di++){var Li=Ri[Di];Ni(Li.toLowerCase(),"on"+(Li[0].toUpperCase()+Li.slice(1)))}Ni(Ci,"onAnimationEnd"),Ni(Pi,"onAnimationIteration"),Ni(Ai,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(_i,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function ji(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(Be.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=je;Me=!1,je=null,Fe||(Fe=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;ji(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;ji(r,a,c),s=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ui(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(zi(t,e,2,!1),n.add(i))}function Vi(e,t,n){var i=0;t&&(i|=4),zi(n,e,i,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[Bi]){e[Bi]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mi.has(t)||Vi(t,!1,e),Vi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bi]||(t[Bi]=!0,Vi("selectionchange",!1,t))}}function zi(e,t,n,i){switch(Jt(t)){case 1:var r=qt;break;case 4:r=Ht;break;default:r=Wt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Gi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=yr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Re((function(){var i=s,r=ke(n),o=[];e:{var a=xi.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Pn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_n;break;case Ci:case Pi:case Ai:l=vn;break;case _i:l=xn;break;case"scroll":l=hn;break;case"wheel":l=Nn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ne(f,h))&&u.push(qi(f,m,p)))),d)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[fr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(d=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?a:wr(l),p=null==c?a:wr(c),(a=new u(m,f+"leave",l,n,r)).target=d,a.relatedTarget=p,m=null,yr(r)===i&&((u=new u(h,f+"enter",c,n,r)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Wi(p))f++;for(p=0,m=h;m;m=Wi(m))p++;for(;0<f-p;)u=Wi(u),f--;for(;0<p-f;)h=Wi(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wi(u),h=Wi(h)}u=null}else u=null;null!==l&&Ki(o,a,l,u,!1),null!==c&&null!==d&&Ki(o,d,c,u,!0)}if("select"===(l=(a=i?wr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Jn;else if(Gn(a))if(Yn)g=oi;else{g=ri;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=si);switch(g&&(g=g(e,i))?qn(o,g,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?wr(i):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,wi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":wi(o,n,r)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else $n?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(jn&&"ko"!==n.locale&&($n||"onCompositionStart"!==b?"onCompositionEnd"===b&&$n&&(y=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,$n=!0)),0<(v=Hi(i,b)).length&&(b=new wn(b,e,null,n,r),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Ln&&Vn(e,t)?(e=en(),Zt=Xt=Yt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=y))}Fi(o,t)}))}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ne(e,n))&&i.unshift(qi(e,s,r)),null!=(s=Ne(e,t))&&i.push(qi(e,s,r))),e=e.return}return i}function Wi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Ne(n,s))&&o.unshift(qi(n,l,a)):r||null!=(l=Ne(n,s))&&o.push(qi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qi=/\r\n?/g,Ji=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Ji,"")}function Xi(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(s(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void $t(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);$t(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,pr="__reactProps$"+dr,fr="__reactContainer$"+dr,mr="__reactEvents$"+dr,gr="__reactListeners$"+dr,vr="__reactHandles$"+dr;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[hr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function kr(e){return e[pr]||null}var Tr=[],Sr=-1;function Er(e){return{current:e}}function Ir(e){0>Sr||(e.current=Tr[Sr],Tr[Sr]=null,Sr--)}function Cr(e,t){Sr++,Tr[Sr]=e.current,e.current=t}var Pr={},Ar=Er(Pr),_r=Er(!1),xr=Pr;function Rr(e,t){var n=e.type.contextTypes;if(!n)return Pr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Nr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Dr(){Ir(_r),Ir(Ar)}function Lr(e,t,n){if(Ar.current!==Pr)throw Error(s(168));Cr(Ar,t),Cr(_r,n)}function Or(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,z(e)||"Unknown",r));return j({},n,i)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pr,xr=Ar.current,Cr(Ar,e),Cr(_r,_r.current),!0}function jr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Or(e,t,xr),i.__reactInternalMemoizedMergedChildContext=e,Ir(_r),Ir(Ar),Cr(Ar,e)):Ir(_r),Cr(_r,n)}var Fr=null,Ur=!1,Vr=!1;function Br(e){null===Fr?Fr=[e]:Fr.push(e)}function $r(){if(!Vr&&null!==Fr){Vr=!0;var e=0,t=bt;try{var n=Fr;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fr=null,Ur=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),We(Ze,$r),r}finally{bt=t,Vr=!1}}return null}var zr=[],Gr=0,qr=null,Hr=0,Wr=[],Kr=0,Qr=null,Jr=1,Yr="";function Xr(e,t){zr[Gr++]=Hr,zr[Gr++]=qr,qr=e,Hr=t}function Zr(e,t,n){Wr[Kr++]=Jr,Wr[Kr++]=Yr,Wr[Kr++]=Qr,Qr=e;var i=Jr;e=Yr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Jr=1<<32-ot(t)+r|n<<r|i,Yr=s+e}else Jr=1<<s|n<<r|i,Yr=e}function es(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function ts(e){for(;e===qr;)qr=zr[--Gr],zr[Gr]=null,Hr=zr[--Gr],zr[Gr]=null;for(;e===Qr;)Qr=Wr[--Kr],Wr[Kr]=null,Yr=Wr[--Kr],Wr[Kr]=null,Jr=Wr[--Kr],Wr[Kr]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:Jr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw hs(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=is;e;)e=cr(e.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=jc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===S?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===N&&ys(s)===t.type)?((i=r(t,n.props)).ref=gs(e,t,n),i.return=e,i):((i=Lc(n.type,n.key,n.props,null,e.mode,i)).ref=gs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,s){return null===t||7!==t.tag?((t=Oc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case T:return(t=Fc(t,e.mode,n)).return=e,t;case N:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?c(e,t,n,i):null;case T:return n.key===r?u(e,t,n,i):null;case N:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||O(n))return null!==r?null:d(e,t,n,i,null);vs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case k:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case T:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case N:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||O(i))return d(t,e=e.get(n)||null,i,r,null);vs(t,i)}return null}function m(r,s,a,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(r,d,a[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),s=o(v,s,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(r,d),rs&&Xr(r,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(r,a[m],l))&&(s=o(d,s,m),null===u?c=d:u.sibling=d,u=d);return rs&&Xr(r,m),c}for(d=i(r,d);m<a.length;m++)null!==(g=f(d,r,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(r,e)})),rs&&Xr(r,m),c}function g(r,a,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(r,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),a=o(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),rs&&Xr(r,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(r,y.value,c))&&(a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return rs&&Xr(r,g),u}for(m=i(r,m);!y.done;g++,y=l.next())null!==(y=f(m,r,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach((function(e){return t(r,e)})),rs&&Xr(r,g),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===N&&ys(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=gs(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===S?((s=Oc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Lc(o.type,o.key,o.props,null,i.mode,l)).ref=gs(i,s,o),l.return=i,i=l)}return a(i);case T:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Fc(o,i.mode,l)).return=i,i=s}return a(i);case N:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return m(i,s,o,l);if(O(o))return g(i,s,o,l);vs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=jc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var ws=bs(!0),ks=bs(!1),Ts=Er(null),Ss=null,Es=null,Is=null;function Cs(){Is=Es=Ss=null}function Ps(e){var t=Ts.current;Ir(Ts),e._currentValue=t}function As(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function _s(e,t){Ss=e,Is=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function xs(e){var t=e._currentValue;if(Is!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===Ss)throw Error(s(308));Es=e,Ss.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var Rs=null;function Ns(e){null===Rs?Rs=[e]:Rs.push(e)}function Ds(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Ns(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ls(e,i)}function Ls(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function js(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Al)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ls(e,n)}return null===(r=i.interleaved)?(t.next=t,Ns(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ls(e,n)}function Vs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Bs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $s(e,t,n,i){var r=e.updateQueue;Os=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=r.baseState;for(o=0,u=c=l=null,a=s;;){var h=a.lane,p=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=j({},d,h);break e;case 2:Os=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,o|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=d}}function zs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Gs={},qs=Er(Gs),Hs=Er(Gs),Ws=Er(Gs);function Ks(e){if(e===Gs)throw Error(s(174));return e}function Qs(e,t){switch(Cr(Ws,t),Cr(Hs,e),Cr(qs,Gs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ir(qs),Cr(qs,t)}function Js(){Ir(qs),Ir(Hs),Ir(Ws)}function Ys(e){Ks(Ws.current);var t=Ks(qs.current),n=le(t,e.type);t!==n&&(Cr(Hs,e),Cr(qs,n))}function Xs(e){Hs.current===e&&(Ir(qs),Ir(Hs))}var Zs=Er(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=w.ReactCurrentDispatcher,ro=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function go(e,t,n,i,r,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?Zo:ea,e=n(i,r),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,io.current=ta,e=n(i,r)}while(uo)}if(io.current=Xo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,co=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function ko(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ao,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((so&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=i):c=c.next=h,oo.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(ba=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,Ml|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function To(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function So(){}function Eo(e,t){var n=oo,i=bo(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ba=!0),i=i.queue,Mo(Po.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ro(9,Co.bind(null,n,i,r,t),void 0,null),null===_l)throw Error(s(349));0!==(30&so)||Io(n,t,r)}return r}function Io(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,i){t.value=n,t.getSnapshot=i,Ao(t)&&_o(e)}function Po(e,t,n){return n((function(){Ao(t)&&_o(e)}))}function Ao(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function _o(e){var t=Ls(e,1);null!==t&&nc(t,e,1,-1)}function xo(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[t.memoizedState,e]}function Ro(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function No(){return bo().memoizedState}function Do(e,t,n,i){var r=yo();oo.flags|=e,r.memoizedState=Ro(1|t,n,void 0,void 0===i?null:i)}function Lo(e,t,n,i){var r=bo();i=void 0===i?null:i;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==i&&mo(i,o.deps))return void(r.memoizedState=Ro(t,n,s,i))}oo.flags|=e,r.memoizedState=Ro(1|t,n,s,i)}function Oo(e,t){return Do(8390656,8,e,t)}function Mo(e,t){return Lo(2048,8,e,t)}function jo(e,t){return Lo(4,2,e,t)}function Fo(e,t){return Lo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4,4,Uo.bind(null,t,e),n)}function Bo(){}function $o(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function zo(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Go(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ai(n,t)||(n=mt(),oo.lanes|=n,Ml|=n,e.baseState=!0),t)}function qo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{bt=n,ro.transition=i}}function Ho(){return bo().memoizedState}function Wo(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Jo(t,n);else if(null!==(n=Ds(e,t,n,i))){nc(n,e,i,ec()),Yo(n,t,i)}}function Ko(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Jo(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Ns(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ds(e,t,r,i))&&(nc(n,e,i,r=ec()),Yo(n,t,i))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Jo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xo={readContext:xs,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Zo={readContext:xs,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:xs,useEffect:Oo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){return Do(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=yo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Wo.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:xo,useDebugValue:Bo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=xo(!1),t=e[0];return e=qo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,r=yo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===_l)throw Error(s(349));0!==(30&so)||Io(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Oo(Po.bind(null,i,o,e),[e]),i.flags|=2048,Ro(9,Co.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=_l.identifierPrefix;if(rs){var n=Yr;t=":"+t+"R"+(n=(Jr&~(1<<32-ot(Jr)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:xs,useCallback:$o,useContext:xs,useEffect:Mo,useImperativeHandle:Vo,useInsertionEffect:jo,useLayoutEffect:Fo,useMemo:zo,useReducer:ko,useRef:No,useState:function(){return ko(wo)},useDebugValue:Bo,useDeferredValue:function(e){return Go(bo(),ao.memoizedState,e)},useTransition:function(){return[ko(wo)[0],bo().memoizedState]},useMutableSource:So,useSyncExternalStore:Eo,useId:Ho,unstable_isNewReconciler:!1},ta={readContext:xs,useCallback:$o,useContext:xs,useEffect:Mo,useImperativeHandle:Vo,useInsertionEffect:jo,useLayoutEffect:Fo,useMemo:zo,useReducer:To,useRef:No,useState:function(){return To(wo)},useDebugValue:Bo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:Go(t,ao.memoizedState,e)},useTransition:function(){return[To(wo)[0],bo().memoizedState]},useMutableSource:So,useSyncExternalStore:Eo,useId:Ho,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=j({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:j({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Fs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),Vs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),s=Fs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nc(t,e,r,i),Vs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Fs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Us(e,r,i))&&(nc(t,e,i,n),Vs(t,e,i))}};function sa(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function oa(e,t,n){var i=!1,r=Pr,s=t.contextType;return"object"===typeof s&&null!==s?s=xs(s):(r=Nr(t)?xr:Ar.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Rr(e,r):Pr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function la(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=xs(s):(s=Nr(t)?xr:Ar.current,r.context=Rr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ia(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),$s(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function ca(e,t){try{var n="",i=t;do{n+=B(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ha="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Gl||(Gl=!0,ql=i),da(0,t)},n}function fa(e,t,n){(n=Fs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof i&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ha;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Ic.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ya=w.ReactCurrentOwner,ba=!1;function wa(e,t,n,i){t.child=null===e?ks(t,null,n,i):ws(t,e.child,n,i)}function ka(e,t,n,i,r){n=n.render;var s=t.ref;return _s(t,r),i=go(e,t,n,i,s,r),n=vo(),null===e||ba?(rs&&n&&es(t),t.flags|=1,wa(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ga(e,t,r))}function Ta(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Nc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Sa(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Ga(e,t,r)}return t.flags|=1,(e=Dc(s,i)).ref=t.ref,e.return=t,t.child=e}function Sa(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(ba=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Ga(e,t,r);0!==(131072&e.flags)&&(ba=!0)}}return Ca(e,t,n,i,r)}function Ea(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Dl,Nl),Nl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(Dl,Nl),Nl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Cr(Dl,Nl),Nl|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Cr(Dl,Nl),Nl|=i;return wa(e,t,r,n),t.child}function Ia(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,i,r){var s=Nr(n)?xr:Ar.current;return s=Rr(t,s),_s(t,r),n=go(e,t,n,i,s,r),i=vo(),null===e||ba?(rs&&i&&es(t),t.flags|=1,wa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ga(e,t,r))}function Pa(e,t,n,i,r){if(Nr(n)){var s=!0;Mr(t)}else s=!1;if(_s(t,r),null===t.stateNode)za(e,t),oa(t,n,i),la(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=xs(c):c=Rr(t,c=Nr(n)?xr:Ar.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&aa(t,o,i,c),Os=!1;var h=t.memoizedState;o.state=h,$s(t,i,o,r),l=t.memoizedState,a!==i||h!==l||_r.current||Os?("function"===typeof u&&(ia(t,n,u,i),l=t.memoizedState),(a=Os||sa(t,n,a,i,h,l,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,js(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:na(t.type,a),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=xs(l):l=Rr(t,l=Nr(n)?xr:Ar.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&aa(t,o,i,l),Os=!1,h=t.memoizedState,o.state=h,$s(t,i,o,r);var f=t.memoizedState;a!==d||h!==f||_r.current||Os?("function"===typeof p&&(ia(t,n,p,i),f=t.memoizedState),(c=Os||sa(t,n,c,i,h,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Aa(e,t,n,i,s,r)}function Aa(e,t,n,i,r,s){Ia(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&jr(t,n,!1),Ga(e,t,s);i=t.stateNode,ya.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=i.state,r&&jr(t,n,!0),t.child}function _a(e){var t=e.stateNode;t.pendingContext?Lr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Lr(0,t.context,!1),Qs(e,t.containerInfo)}function xa(e,t,n,i,r){return ps(),fs(r),t.flags|=256,wa(e,t,n,i),t.child}var Ra,Na,Da,La,Oa={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function ja(e,t,n){var i,r=t.pendingProps,o=Zs.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Cr(Zs,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Mc(l,r,0,null),e=Oc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Oa,e):Fa(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,i=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Mc({mode:"visible",children:i.children},r,0,null),(o=Oc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Oa,o);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ua(e,t,a,i=ua(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(i=_l)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ls(e,r),nc(i,e,r,-1))}return mc(),Ua(e,t,a,i=ua(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Pc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Wr[Kr++]=Jr,Wr[Kr++]=Yr,Wr[Kr++]=Qr,Jr=e.id,Yr=e.overflow,Qr=t),t=Fa(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Dc(i,a):(a=Oc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Oa,r}return e=(a=e.child).sibling,r=Dc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fa(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,i){return null!==i&&fs(i),ws(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Va(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),As(e.return,t,n)}function Ba(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function $a(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(wa(e,t,i.children,n),0!==(2&(i=Zs.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Va(e,n,t);else if(19===e.tag)Va(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Cr(Zs,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ba(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ba(t,!0,n,null,s);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function za(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ga(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ha(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Wa(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ha(t),null;case 1:case 17:return Nr(t.type)&&Dr(),Ha(t),null;case 3:return i=t.stateNode,Js(),Ir(_r),Ir(Ar),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Na(e,t),Ha(t),null;case 5:Xs(t);var r=Ks(Ws.current);if(n=t.type,null!==e&&null!=t.stateNode)Da(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Ha(t),null}if(e=Ks(qs.current),ds(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[hr]=t,i[pr]=o,e=0!==(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<Oi.length;r++)Ui(Oi[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":J(i,o),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ui("invalid",i);break;case"textarea":re(i,o),Ui("invalid",i)}for(var l in ye(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":H(i),Z(i,o,!0);break;case"textarea":H(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hr]=t,e[pr]=i,Ra(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),r=i;break;case"iframe":case"object":case"embed":Ui("load",e),r=i;break;case"video":case"audio":for(r=0;r<Oi.length;r++)Ui(Oi[r],e);r=i;break;case"source":Ui("error",e),r=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),r=i;break;case"details":Ui("toggle",e),r=i;break;case"input":J(e,i),r=Q(e,i),Ui("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=j({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ui("invalid",e)}for(o in ye(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ui("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":H(e),Z(e,i,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+G(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ha(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Ks(Ws.current),Ks(qs.current),ds(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Ha(t),null;case 13:if(Ir(Zs),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,o=!1;else if(o=ds(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[hr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ha(t),o=!1}else null!==ss&&(oc(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ha(t),null);case 4:return Js(),Na(e,t),null===e&&$i(t.stateNode.containerInfo),Ha(t),null;case 10:return Ps(t.type._context),Ha(t),null;case 19:if(Ir(Zs),null===(o=t.memoizedState))return Ha(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)qa(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,qa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cr(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>$l&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Ha(t),null}else 2*Ye()-o.renderingStartTime>$l&&1073741824!==n&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Zs.current,Cr(Zs,i?1&n|2:1&n),t):(Ha(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Nl)&&(Ha(t),6&t.subtreeFlags&&(t.flags|=8192)):Ha(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ka(e,t){switch(ts(t),t.tag){case 1:return Nr(t.type)&&Dr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),Ir(_r),Ir(Ar),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(Ir(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ir(Zs),null;case 4:return Js(),null;case 10:return Ps(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ra=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Na=function(){},Da=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Ks(qs.current);var s,o=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),o=[];break;case"select":r=j({},r,{value:void 0}),i=j({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ui("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,i){n!==i&&(t.flags|=4)};var Qa=!1,Ja=!1,Ya="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Ec(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Ec(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,n,s)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[pr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ja||Za(n,t);case 6:var i=ul,r=dl;ul=null,hl(e,t,n),dl=r,null!==(ul=i)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),$t(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=i,dl=r;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),r=r.next}while(r!==i)}hl(e,t,n);break;case 1:if(!Ja&&(Za(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ec(n,t,a)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Ja=(i=Ja)||null!==n.memoizedState,hl(e,t,n),Ja=i):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ya),t.forEach((function(t){var i=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));pl(o,a,r),ul=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Ec(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){Ec(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&i&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),vl(e),512&i&&null!==n&&Za(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){Ec(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(r,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?ge(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(l){case"input":X(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(r,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(g){Ec(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Ec(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Bl=Ye())),4&i&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||d,ml(t,e),Ja=u):ml(t,e),vl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Za(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(i,n,g)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){kl(h);continue}}null!==f?(f.return=p,Xa=f):kl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,a=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Ec(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&i&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),cl(e,al(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(a){Ec(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Xa=e,bl(e,t,n)}function bl(e,t,n){for(var i=0!==(1&e.mode);null!==Xa;){var r=Xa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Qa;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=Qa;var c=Ja;if(Qa=o,(Ja=l)&&!c)for(Xa=r;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?Tl(r):null!==l?(l.return=o,Xa=l):Tl(r);for(;null!==s;)Xa=s,bl(s,t,n),s=s.sibling;Xa=r,Qa=a,Ja=c}wl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Xa=s):wl(e)}}function wl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ja)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&zs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&$t(h)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&rl(t)}catch(p){Ec(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function kl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Tl(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Ec(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Ec(t,r,l)}}var s=t.return;try{rl(t)}catch(l){Ec(t,s,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Ec(t,o,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Sl,El=Math.ceil,Il=w.ReactCurrentDispatcher,Cl=w.ReactCurrentOwner,Pl=w.ReactCurrentBatchConfig,Al=0,_l=null,xl=null,Rl=0,Nl=0,Dl=Er(0),Ll=0,Ol=null,Ml=0,jl=0,Fl=0,Ul=null,Vl=null,Bl=0,$l=1/0,zl=null,Gl=!1,ql=null,Hl=null,Wl=!1,Kl=null,Ql=0,Jl=0,Yl=null,Xl=-1,Zl=0;function ec(){return 0!==(6&Al)?Ye():-1!==Xl?Xl:Xl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Rl?Rl&-Rl:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,i){if(50<Jl)throw Jl=0,Yl=null,Error(s(185));vt(e,n,i),0!==(2&Al)&&e===_l||(e===_l&&(0===(2&Al)&&(jl|=n),4===Ll&&ac(e,Rl)),ic(e,i),1===n&&0===Al&&0===(1&t.mode)&&($l=Ye()+500,Ur&&$r()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=ht(e,e===_l?Rl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ur=!0,Br(e)}(lc.bind(null,e)):Br(lc.bind(null,e)),or((function(){0===(6&Al)&&$r()})),n=null;else{switch(wt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=_c(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Xl=-1,Zl=0,0!==(6&Al))throw Error(s(327));var n=e.callbackNode;if(Tc()&&e.callbackNode!==n)return null;var i=ht(e,e===_l?Rl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var r=Al;Al|=2;var o=fc();for(_l===e&&Rl===t||(zl=null,$l=Ye()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}Cs(),Il.current=o,Al=r,null!==xl?t=0:(_l=null,Rl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=sc(e,r))),1===t)throw n=Ol,hc(e,0),ac(e,i),ic(e,Ye()),n;if(6===t)ac(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,i))&&(0!==(o=ft(e))&&(i=o,t=sc(e,o))),1===t))throw n=Ol,hc(e,0),ac(e,i),ic(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:kc(e,Vl,zl);break;case 3:if(ac(e,i),(130023424&i)===i&&10<(t=Bl+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(kc.bind(null,e,Vl,zl),t);break}kc(e,Vl,zl);break;case 4:if(ac(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*El(i/1960))-i)){e.timeoutHandle=ir(kc.bind(null,e,Vl,zl),i);break}kc(e,Vl,zl);break;default:throw Error(s(329))}}}return ic(e,Ye()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function ac(e,t){for(t&=~Fl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&Al))throw Error(s(327));Tc();var t=ht(e,0);if(0===(1&t))return ic(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Ol,hc(e,0),ac(e,t),ic(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Vl,zl),ic(e,Ye()),null}function cc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&($l=Ye()+500,Ur&&$r())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Al)&&Tc();var t=Al;Al|=1;var n=Pl.transition,i=bt;try{if(Pl.transition=null,bt=1,e)return e()}finally{bt=i,Pl.transition=n,0===(6&(Al=t))&&$r()}}function dc(){Nl=Dl.current,Ir(Dl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==xl)for(n=xl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Dr();break;case 3:Js(),Ir(_r),Ir(Ar),no();break;case 5:Xs(i);break;case 4:Js();break;case 13:case 19:Ir(Zs);break;case 10:Ps(i.type._context);break;case 22:case 23:dc()}n=n.return}if(_l=e,xl=e=Dc(e.current,null),Rl=Nl=t,Ll=0,Ol=null,Fl=jl=Ml=0,Vl=Ul=null,null!==Rs){for(t=0;t<Rs.length;t++)if(null!==(i=(n=Rs[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Rs=null}return e}function pc(e,t){for(;;){var n=xl;try{if(Cs(),io.current=Xo,co){for(var i=oo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}co=!1}if(so=0,lo=ao=oo=null,uo=!1,ho=0,Cl.current=null,null===n||null===n.return){Ll=1,Ol=t,xl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,va(f,a,l,0,t),1&f.mode&&ma(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,l,0,t),fs(ca(c,l));break e}}o=c=ca(c,l),4!==Ll&&(Ll=2),null===Ul?Ul=[o]:Ul.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,pa(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hl||!Hl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Bs(o,fa(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(w){t=w,xl===n&&null!==n&&(xl=n=n.return);continue}break}}function fc(){var e=Il.current;return Il.current=Xo,null===e?Xo:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===_l||0===(268435455&Ml)&&0===(268435455&jl)||ac(_l,Rl)}function gc(e,t){var n=Al;Al|=2;var i=fc();for(_l===e&&Rl===t||(zl=null,hc(e,t));;)try{vc();break}catch(r){pc(e,r)}if(Cs(),Al=n,Il.current=i,null!==xl)throw Error(s(261));return _l=null,Rl=0,Ll}function vc(){for(;null!==xl;)bc(xl)}function yc(){for(;null!==xl&&!Qe();)bc(xl)}function bc(e){var t=Sl(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,null===t?wc(e):xl=t,Cl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wa(n,t,Nl)))return void(xl=n)}else{if(null!==(n=Ka(n,t)))return n.flags&=32767,void(xl=n);if(null===e)return Ll=6,void(xl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(xl=t);xl=t=e}while(null!==t);0===Ll&&(Ll=5)}function kc(e,t,n){var i=bt,r=Pl.transition;try{Pl.transition=null,bt=1,function(e,t,n,i){do{Tc()}while(null!==Kl);if(0!==(6&Al))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===_l&&(xl=_l=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,_c(tt,(function(){return Tc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Pl.transition,Pl.transition=null;var a=bt;bt=1;var l=Al;Al|=4,Cl.current=null,function(e,t){if(er=Gt,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(l=a+r),h!==o||0!==i&&3!==h.nodeType||(c=a+i),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(l=a),p===o&&++d===i&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Gt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(k){Ec(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tl,tl=!1}(e,n),gl(n,e),fi(tr),Gt=!!er,tr=er=null,e.current=n,yl(n,e,r),Je(),Al=l,bt=a,Pl.transition=o}else e.current=n;if(Wl&&(Wl=!1,Kl=e,Ql=r),o=e.pendingLanes,0===o&&(Hl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Gl)throw Gl=!1,e=ql,ql=null,e;0!==(1&Ql)&&0!==e.tag&&Tc(),o=e.pendingLanes,0!==(1&o)?e===Yl?Jl++:(Jl=0,Yl=e):Jl=0,$r()}(e,t,n,i)}finally{Pl.transition=r,bt=i}return null}function Tc(){if(null!==Kl){var e=wt(Ql),t=Pl.transition,n=bt;try{if(Pl.transition=null,bt=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,Ql=0,0!==(6&Al))throw Error(s(331));var r=Al;for(Al|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var p=(d=Xa).sibling,f=d.return;if(sl(d),d===u){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xa=y;break e}Xa=o.return}}var b=e.current;for(Xa=b;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=b;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(T){Ec(l,l.return,T)}if(l===a){Xa=null;break e}var k=l.sibling;if(null!==k){k.return=l.return,Xa=k;break e}Xa=l.return}}if(Al=r,$r(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(T){}i=!0}return i}finally{bt=n,Pl.transition=t}}return!1}function Sc(e,t,n){e=Us(e,t=pa(0,t=ca(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Hl||!Hl.has(i))){t=Us(t,e=fa(t,e=ca(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Ic(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,_l===e&&(Rl&n)===n&&(4===Ll||3===Ll&&(130023424&Rl)===Rl&&500>Ye()-Bl?hc(e,0):Fl|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ls(e,t))&&(vt(e,t,n),ic(e,n))}function Pc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Cc(e,n)}function _c(e,t){return We(e,t)}function xc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,i){return new xc(e,t,n,i)}function Nc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Nc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Oc(n.children,r,o,t);case E:a=8,r|=8;break;case I:return(e=Rc(12,n,t,2|r)).elementType=I,e.lanes=o,e;case _:return(e=Rc(13,n,t,r)).elementType=_,e.lanes=o,e;case x:return(e=Rc(19,n,t,r)).elementType=x,e.lanes=o,e;case D:return Mc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case P:a=9;break e;case A:a=11;break e;case R:a=14;break e;case N:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Oc(e,t,n,i){return(e=Rc(7,e,i,t)).lanes=n,e}function Mc(e,t,n,i){return(e=Rc(22,e,i,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,i,r,s,o,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Bc(e){if(!e)return Pr;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Nr(n))return Or(e,n,t)}return t}function $c(e,t,n,i,r,s,o,a,l){return(e=Vc(n,i,!0,e,0,s,0,a,l)).context=Bc(null),n=e.current,(s=Fs(i=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,r),e.current.lanes=r,vt(e,r,i),ic(e,i),e}function zc(e,t,n,i){var r=t.current,s=ec(),o=tc(r);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Us(r,t,o))&&(nc(e,r,o,s),Vs(e,r,o)),o}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_r.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:_a(t),ps();break;case 5:Ys(t);break;case 1:Nr(t.type)&&Mr(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Cr(Ts,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Cr(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ja(e,t,n):(Cr(Zs,1&Zs.current),null!==(e=Ga(e,t,n))?e.sibling:null);Cr(Zs,1&Zs.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return $a(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(Zs,Zs.current),i)break;return null;case 22:case 23:return t.lanes=0,Ea(e,t,n)}return Ga(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,rs&&0!==(1048576&t.flags)&&Zr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;za(e,t),e=t.pendingProps;var r=Rr(t,Ar.current);_s(t,n),r=go(null,t,i,e,r,n);var o=vo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nr(i)?(o=!0,Mr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ms(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,la(t,i,e,n),t=Aa(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),wa(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(za(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Nc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===R)return 14}return 2}(i),e=na(i,e),r){case 0:t=Ca(null,t,i,e,n);break e;case 1:t=Pa(null,t,i,e,n);break e;case 11:t=ka(null,t,i,e,n);break e;case 14:t=Ta(null,t,i,na(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ca(e,t,i,r=t.elementType===i?r:na(i,r),n);case 1:return i=t.type,r=t.pendingProps,Pa(e,t,i,r=t.elementType===i?r:na(i,r),n);case 3:e:{if(_a(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,js(e,t),$s(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=xa(e,t,i,n,r=ca(Error(s(423)),t));break e}if(i!==r){t=xa(e,t,i,n,r=ca(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=ks(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=Ga(e,t,n);break e}wa(e,t,i,n)}t=t.child}return t;case 5:return Ys(t),null===e&&cs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),Ia(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return ja(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ws(t,null,i,n):wa(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,ka(e,t,i,r=t.elementType===i?r:na(i,r),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Cr(Ts,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!_r.current){t=Ga(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Fs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),As(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),As(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,_s(t,n),i=i(r=xs(r)),t.flags|=1,wa(e,t,i,n),t.child;case 14:return r=na(i=t.type,t.pendingProps),Ta(e,t,i,r=na(i.type,r),n);case 15:return Sa(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:na(i,r),za(e,t),t.tag=1,Nr(i)?(e=!0,Mr(t)):e=!1,_s(t,n),oa(t,i,r),la(t,i,r,n),Aa(null,t,i,!0,e,n);case 19:return $a(e,t,n);case 22:return Ea(e,t,n)}throw Error(s(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Gc(o);a.call(e)}}zc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Gc(o);s.call(e)}}var o=$c(t,i,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[fr]=o.current,$i(8===e.nodeType?e.parentNode:e),uc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Gc(l);a.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[fr]=l.current,$i(8===e.nodeType?e.parentNode:e),uc((function(){zc(t,l,n,i)})),l}(n,t,e,r,i);return Gc(o)}Qc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));zc(e,t,null,null)},Qc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){zc(null,e,null,null)})),t[fr]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&jt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Ye()),0===(6&Al)&&($l=Ye()+500,$r()))}break;case 13:uc((function(){var t=Ls(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},Tt=function(e){if(13===e.tag){var t=Ls(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Ls(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},Et=function(){return bt},It=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Te=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=kr(i);if(!r)throw Error(s(90));W(i),X(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,_e=uc;var eu={usingClientEntryPoint:!1,Events:[br,wr,kr,Ce,Pe,cc]},tu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,i="",r=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,$i(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=$c(t,null,e,1,null!=n?n:null,r,0,o,a),e[fr]=t.current,$i(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Qc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Yc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},786:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionCodeOperation:()=>h,ActionCodeURL:()=>tt,AuthCredential:()=>ze,AuthErrorCodes:()=>v,EmailAuthCredential:()=>Je,EmailAuthProvider:()=>it,FacebookAuthProvider:()=>at,FactorId:()=>l,GithubAuthProvider:()=>ct,GoogleAuthProvider:()=>lt,OAuthCredential:()=>Xe,OAuthProvider:()=>ot,OperationType:()=>d,PhoneAuthCredential:()=>et,PhoneAuthProvider:()=>si,PhoneMultiFactorGenerator:()=>ir,ProviderId:()=>c,RecaptchaVerifier:()=>Xn,SAMLAuthProvider:()=>dt,SignInMethod:()=>u,TotpMultiFactorGenerator:()=>rr,TotpSecret:()=>or,TwitterAuthProvider:()=>ht,applyActionCode:()=>Mt,beforeAuthStateChanged:()=>cn,browserLocalPersistence:()=>In,browserPopupRedirectResolver:()=>er,browserSessionPersistence:()=>Pn,checkActionCode:()=>jt,confirmPasswordReset:()=>Ot,connectAuthEmulator:()=>Ve,createUserWithEmailAndPassword:()=>Ut,debugErrorMap:()=>f,deleteUser:()=>mn,fetchSignInMethodsForEmail:()=>Gt,getAdditionalUserInfo:()=>rn,getAuth:()=>fr,getIdToken:()=>Y,getIdTokenResult:()=>X,getMultiFactorResolver:()=>yn,getRedirectResult:()=>Pi,inMemoryPersistence:()=>fe,indexedDBLocalPersistence:()=>$n,initializeAuth:()=>Ue,initializeRecaptchaConfig:()=>on,isSignInWithEmailLink:()=>$t,linkWithCredential:()=>Ct,linkWithPhoneNumber:()=>ti,linkWithPopup:()=>mi,linkWithRedirect:()=>Ci,multiFactor:()=>kn,onAuthStateChanged:()=>un,onIdTokenChanged:()=>ln,parseActionCodeURL:()=>nt,prodErrorMap:()=>m,reauthenticateWithCredential:()=>Pt,reauthenticateWithPhoneNumber:()=>ni,reauthenticateWithPopup:()=>fi,reauthenticateWithRedirect:()=>Ii,reload:()=>oe,revokeAccessToken:()=>fn,sendEmailVerification:()=>qt,sendPasswordResetEmail:()=>Lt,sendSignInLinkToEmail:()=>Bt,setPersistence:()=>sn,signInAnonymously:()=>gt,signInWithCredential:()=>It,signInWithCustomToken:()=>At,signInWithEmailAndPassword:()=>Vt,signInWithEmailLink:()=>zt,signInWithPhoneNumber:()=>ei,signInWithPopup:()=>pi,signInWithRedirect:()=>Ei,signOut:()=>pn,unlink:()=>wt,updateCurrentUser:()=>hn,updateEmail:()=>Kt,updatePassword:()=>Qt,updatePhoneNumber:()=>ri,updateProfile:()=>Wt,useDeviceLanguage:()=>dn,validatePassword:()=>an,verifyBeforeUpdateEmail:()=>Ht,verifyPasswordResetCode:()=>Ft});var i=n(52),r=n(700),s=n(443);function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var a=n(812);const l={PHONE:"phone",TOTP:"totp"},c={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},u={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},d={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},h={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function p(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const f=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},m=p,g=new r.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),v={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"},y=new s.Vy("@firebase/auth");function b(e){if(y.logLevel<=s.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];y.error(`Auth (${i.MF}): ${e}`,...n)}}function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw I(e,...n)}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return I(e,...n)}function T(e,t,n){const i=Object.assign(Object.assign({},m()),{[t]:n});return new r.FA("auth","Firebase",i).create(t,{appName:e.name})}function S(e){return T(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function E(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&w(e,"argument-error"),T(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function I(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return g.create(e,...n)}function C(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];throw I(t,...i)}}function P(e){const t="INTERNAL ASSERTION FAILED: "+e;throw b(t),new Error(t)}function A(e,t){e||P(t)}function _(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function x(){return"http:"===R()||"https:"===R()}function R(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class N{constructor(e,t){this.shortDelay=e,this.longDelay=t,A(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,r.jZ)()||(0,r.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(x()||(0,r.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function D(e,t){A(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class L{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void P("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void P("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void P("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const O={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},M=new N(3e4,6e4);function j(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function F(e,t,n,i){return U(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=(0,r.Am)(Object.assign({key:e.config.apiKey},o)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},s);return(0,r.c1)()||(c.referrerPolicy="no-referrer"),L.fetch()(B(e,e.config.apiHost,n,a),c)}))}async function U(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},O),t);try{const t=new z(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw G(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw G(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw G(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw G(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw T(e,a,o);w(e,a)}}catch(s){if(s instanceof r.g)throw s;w(e,"network-request-failed",{message:String(s)})}}async function V(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await F(e,t,n,i,r);return"mfaPendingCredential"in s&&w(e,"multi-factor-auth-required",{_serverResponse:s}),s}function B(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?D(e.config,r):`${e.config.apiScheme}://${r}`}function $(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class z{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(k(this.auth,"network-request-failed"))),M.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function G(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=k(e,t,i);return r.customData._tokenResponse=n,r}function q(e){return void 0!==e&&void 0!==e.getResponse}function H(e){return void 0!==e&&void 0!==e.enterprise}class W{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return $(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function K(e,t){return F(e,"GET","/v2/recaptchaConfig",j(e,t))}async function Q(e,t){return F(e,"POST","/v1/accounts:lookup",t)}function J(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r.Ku)(e).getIdToken(t)}async function X(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,r.Ku)(e),i=await n.getIdToken(t),s=ee(i);C(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"===typeof s.firebase?s.firebase:void 0,a=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:J(Z(s.auth_time)),issuedAtTime:J(Z(s.iat)),expirationTime:J(Z(s.exp)),signInProvider:a||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}function Z(e){return 1e3*Number(e)}function ee(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return b("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,r.u)(n);return e?JSON.parse(e):(b("Failed to decode base64 JWT payload"),null)}catch(s){return b("Caught error parsing JWT payload as JSON",null===s||void 0===s?void 0:s.toString()),null}}function te(e){const t=ee(e);return C(t,"internal-error"),C("undefined"!==typeof t.exp,"internal-error"),C("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ne(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof r.g&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class ie{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class re{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=J(this.lastLoginAt),this.creationTime=J(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function se(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ne(e,Q(n,{idToken:i}));C(null===r||void 0===r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ae(s.providerUserInfo):[],a=(l=e.providerData,c=o,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),h=!!u&&d,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new re(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,p)}async function oe(e){const t=(0,r.Ku)(e);await se(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function ae(e){return e.map((e=>{var{providerId:t}=e,n=o(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class le{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){C(e.idToken,"internal-error"),C("undefined"!==typeof e.idToken,"internal-error"),C("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):te(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){C(0!==e.length,"internal-error");const t=te(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(C(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await U(e,{},(async()=>{const n=(0,r.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=B(e,i,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",L.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new le;return n&&(C("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(C("string"===typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(C("number"===typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new le,this.toJSON())}_performRefresh(){return P("not implemented")}}function ce(e,t){C("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ue{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=o(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ie(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new re(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ne(this,this.stsTokenManager.getToken(this.auth,e));return C(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return X(this,e)}reload(){return oe(this)}_assign(e){this!==e&&(C(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ue(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){C(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await se(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,i.xZ)(this.auth.app))return Promise.reject(S(this.auth));const e=await this.getIdToken();return await ne(this,async function(e,t){return F(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:k,stsTokenManager:T}=t;C(y&&T,e,"internal-error");const S=le.fromJSON(this.name,T);C("string"===typeof y,e,"internal-error"),ce(u,e.name),ce(d,e.name),C("boolean"===typeof b,e,"internal-error"),C("boolean"===typeof w,e,"internal-error"),ce(h,e.name),ce(p,e.name),ce(f,e.name),ce(m,e.name),ce(g,e.name),ce(v,e.name);const E=new ue({uid:y,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:S,createdAt:g,lastLoginAt:v});return k&&Array.isArray(k)&&(E.providerData=k.map((e=>Object.assign({},e)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new le;i.updateFromServerResponse(t);const r=new ue({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await se(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];C(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?ae(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length),o=new le;o.updateFromIdToken(n);const a=new ue({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new re(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length)};return Object.assign(a,l),a}}const de=new Map;function he(e){A(e instanceof Function,"Expected a class definition");let t=de.get(e);return t?(A(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,de.set(e,t),t)}class pe{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}pe.type="NONE";const fe=pe;function me(e,t,n){return`firebase:${e}:${t}:${n}`}class ge{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=me(this.userKey,i.apiKey,r),this.fullPersistenceKey=me("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ue._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ge(he(fe),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||he(fe);const s=me(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=ue._fromJSON(e,t);c!==r&&(o=n),r=c;break}}catch(l){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(l){}}))),new ge(r,e,n)):new ge(r,e,n)}}function ve(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ke(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ye(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Se(t))return"Blackberry";if(Ee(t))return"Webos";if(be(t))return"Safari";if((t.includes("chrome/")||we(t))&&!t.includes("edge/"))return"Chrome";if(Te(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/firefox\//i.test(e)}function be(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function we(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/crios\//i.test(e)}function ke(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iemobile/i.test(e)}function Te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/android/i.test(e)}function Se(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/blackberry/i.test(e)}function Ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/webos/i.test(e)}function Ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)();return Ie(e)||Te(e)||Ee(e)||Se(e)||/windows phone/i.test(e)||ke(e)}function Pe(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ve((0,r.ZQ)());break;case"Worker":t=`${ve((0,r.ZQ)())}-${e}`;break;default:t=e}const s=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${i.MF}/${s}`}class Ae{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(r){i(r)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class _e{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class xe{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ne(this),this.idTokenSubscription=new Ne(this),this.beforeStateQueue=new Ae(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=he(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ge.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Q(this,{idToken:e}),n=await ue._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,i.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==i||!(null===o||void 0===o?void 0:o.user)||(r=o.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(o)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return C(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await se(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,i.xZ)(this.app))return Promise.reject(S(this));const t=e?(0,r.Ku)(e):null;return t&&C(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&C(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,i.xZ)(this.app)?Promise.reject(S(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,i.xZ)(this.app)?Promise.reject(S(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(he(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return F(e,"GET","/v2/passwordPolicy",j(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new _e(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new r.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return F(e,"POST","/v2/accounts:revokeToken",j(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&he(e)||this._popupRedirectResolver;C(t,this,"argument-error"),this.redirectPersistenceManager=await ge.create(this,[he(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(C(o,this,"internal-error"),o.then((()=>{s||r(this.currentUser)})),"function"===typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return C(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Pe(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(y.logLevel<=s.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];y.warn(`Auth (${i.MF}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Re(e){return(0,r.Ku)(e)}class Ne{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.tD)((e=>this.observer=e))}get next(){return C(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let De={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Le(e){return De.loadJS(e)}function Oe(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Me{constructor(e){this.type="recaptcha-enterprise",this.auth=Re(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const r=window.grecaptcha;H(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{K(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new W(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&H(window.grecaptcha))n(r,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=De.recaptchaEnterpriseScript;0!==t.length&&(t+=r),Le(t).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function je(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new Me(e);let s;try{s=await r.verify(n)}catch(a){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Fe(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await je(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await je(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)}))}function Ue(e,t){const n=(0,i.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),i=n.getOptions();if((0,r.bD)(i,null!==t&&void 0!==t?t:{}))return e;w(e,"already-initialized")}return n.initialize({options:t})}function Ve(e,t,n){const i=Re(e);C(i._canInitEmulator,i,"emulator-config-failed"),C(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Be(t),{host:o,port:a}=function(e){const t=Be(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:$e(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:$e(t)}}}(t),l=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Be(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function $e(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ze{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return P("not implemented")}_getIdTokenResponse(e){return P("not implemented")}_linkToIdToken(e,t){return P("not implemented")}_getReauthenticationResolver(e){return P("not implemented")}}async function Ge(e,t){return F(e,"POST","/v1/accounts:resetPassword",j(e,t))}async function qe(e,t){return F(e,"POST","/v1/accounts:signUp",t)}async function He(e,t){return V(e,"POST","/v1/accounts:signInWithPassword",j(e,t))}async function We(e,t){return F(e,"POST","/v1/accounts:sendOobCode",j(e,t))}async function Ke(e,t){return We(e,t)}async function Qe(e,t){return We(e,t)}class Je extends ze{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Je(e,t,"password")}static _fromEmailAndCode(e,t){return new Je(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Fe(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",He);case"emailLink":return async function(e,t){return V(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{email:this._email,oobCode:this._password});default:w(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Fe(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qe);case"emailLink":return async function(e,t){return V(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:w(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ye(e,t){return V(e,"POST","/v1/accounts:signInWithIdp",j(e,t))}class Xe extends ze{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xe(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):w("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=o(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Xe(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return Ye(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ye(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ye(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.Am)(t)}return e}}const Ze={USER_NOT_FOUND:"user-not-found"};class et extends ze{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new et({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new et({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return V(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await V(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t));if(n.temporaryProof)throw G(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return V(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ze)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new et({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class tt{constructor(e){var t,n,i,s,o,a;const l=(0,r.I9)((0,r.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=l.mode)&&void 0!==i?i:null);C(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=l.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=l.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=(0,r.I9)((0,r.hp)(e)).link,n=t?(0,r.I9)((0,r.hp)(t)).deep_link_id:null,i=(0,r.I9)((0,r.hp)(e)).deep_link_id;return(i?(0,r.I9)((0,r.hp)(i)).link:null)||i||n||t||e}(e);try{return new tt(t)}catch(n){return null}}}function nt(e){return tt.parseLink(e)}class it{constructor(){this.providerId=it.PROVIDER_ID}static credential(e,t){return Je._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=tt.parseLink(t);return C(n,"argument-error"),Je._fromEmailAndCode(e,n.code,n.tenantId)}}it.PROVIDER_ID="password",it.EMAIL_PASSWORD_SIGN_IN_METHOD="password",it.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class rt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class st extends rt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ot extends st{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return C("providerId"in t&&"signInMethod"in t,"argument-error"),Xe._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return C(e.idToken||e.accessToken,"argument-error"),Xe._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ot.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ot.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i,oauthTokenSecret:r,pendingToken:s,nonce:o,providerId:a}=t;if(!i&&!r&&!n&&!s)return null;if(!a)return null;try{return new ot(a)._credential({idToken:n,accessToken:i,nonce:o,pendingToken:s})}catch(l){return null}}}class at extends st{constructor(){super("facebook.com")}static credential(e){return Xe._fromParams({providerId:at.PROVIDER_ID,signInMethod:at.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return at.credentialFromTaggedObject(e)}static credentialFromError(e){return at.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return at.credential(t.oauthAccessToken)}catch(n){return null}}}at.FACEBOOK_SIGN_IN_METHOD="facebook.com",at.PROVIDER_ID="facebook.com";class lt extends st{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xe._fromParams({providerId:lt.PROVIDER_ID,signInMethod:lt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return lt.credentialFromTaggedObject(e)}static credentialFromError(e){return lt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return lt.credential(n,i)}catch(r){return null}}}lt.GOOGLE_SIGN_IN_METHOD="google.com",lt.PROVIDER_ID="google.com";class ct extends st{constructor(){super("github.com")}static credential(e){return Xe._fromParams({providerId:ct.PROVIDER_ID,signInMethod:ct.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ct.credentialFromTaggedObject(e)}static credentialFromError(e){return ct.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ct.credential(t.oauthAccessToken)}catch(n){return null}}}ct.GITHUB_SIGN_IN_METHOD="github.com",ct.PROVIDER_ID="github.com";class ut extends ze{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Ye(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ye(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ye(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new ut(n,r):null}static _create(e,t){return new ut(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class dt extends rt{constructor(e){C(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return dt.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return dt.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=ut.fromJSON(e);return C(t,"argument-error"),t}static samlCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{pendingToken:n,providerId:i}=t;if(!n||!i)return null;try{return ut._create(i,n)}catch(r){return null}}}class ht extends st{constructor(){super("twitter.com")}static credential(e,t){return Xe._fromParams({providerId:ht.PROVIDER_ID,signInMethod:ht.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ht.credentialFromTaggedObject(e)}static credentialFromError(e){return ht.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return ht.credential(n,i)}catch(r){return null}}}async function pt(e,t){return V(e,"POST","/v1/accounts:signUp",j(e,t))}ht.TWITTER_SIGN_IN_METHOD="twitter.com",ht.PROVIDER_ID="twitter.com";class ft{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=await ue._fromIdTokenResponse(e,n,i),s=mt(n);return new ft({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=mt(n);return new ft({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function mt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function gt(e){var t;if((0,i.xZ)(e.app))return Promise.reject(S(e));const n=Re(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new ft({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await pt(n,{returnSecureToken:!0}),s=await ft._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}class vt extends r.g{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,vt.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new vt(e,t,n,i)}}function yt(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw vt._fromErrorAndOperation(e,n,t,i);throw n}))}function bt(e){return new Set(e.map((e=>{let{providerId:t}=e;return t})).filter((e=>!!e)))}async function wt(e,t){const n=(0,r.Ku)(e);await Tt(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return F(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=bt(i||[]);return n.providerData=n.providerData.filter((e=>s.has(e.providerId))),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function kt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await ne(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ft._forOperation(e,"link",i)}async function Tt(e,t,n){await se(t);const i=!1===e?"provider-already-linked":"no-such-provider";C(bt(t.providerData).has(n)===e,t.auth,i)}async function St(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,i.xZ)(r.app))return Promise.reject(S(r));const s="reauthenticate";try{const i=await ne(e,yt(r,s,t,e),n);C(i.idToken,r,"internal-error");const o=ee(i.idToken);C(o,r,"internal-error");const{sub:a}=o;return C(e.uid===a,r,"user-mismatch"),ft._forOperation(e,s,i)}catch(o){throw"auth/user-not-found"===(null===o||void 0===o?void 0:o.code)&&w(r,"user-mismatch"),o}}async function Et(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(S(e));const r="signIn",s=await yt(e,r,t),o=await ft._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(o.user),o}async function It(e,t){return Et(Re(e),t)}async function Ct(e,t){const n=(0,r.Ku)(e);return await Tt(!1,n,t.providerId),kt(n,t)}async function Pt(e,t){return St((0,r.Ku)(e),t)}async function At(e,t){if((0,i.xZ)(e.app))return Promise.reject(S(e));const n=Re(e),r=await async function(e,t){return V(e,"POST","/v1/accounts:signInWithCustomToken",j(e,t))}(n,{token:t,returnSecureToken:!0}),s=await ft._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}class _t{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?xt._fromServerResponse(e,t):"totpInfo"in t?Rt._fromServerResponse(e,t):w(e,"internal-error")}}class xt extends _t{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new xt(t)}}class Rt extends _t{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Rt(t)}}function Nt(e,t,n){var i;C((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),C("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(C(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(C(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Dt(e){const t=Re(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Lt(e,t,n){const i=Re(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Nt(i,r,n),await Fe(i,r,"getOobCode",Ke)}async function Ot(e,t,n){await Ge((0,r.Ku)(e),{oobCode:t,newPassword:n}).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Dt(e),t}))}async function Mt(e,t){await async function(e,t){return F(e,"POST","/v1/accounts:update",j(e,t))}((0,r.Ku)(e),{oobCode:t})}async function jt(e,t){const n=(0,r.Ku)(e),i=await Ge(n,{oobCode:t}),s=i.requestType;switch(C(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":C(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":C(i.mfaInfo,n,"internal-error");default:C(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=_t._fromServerResponse(Re(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function Ft(e,t){const{data:n}=await jt((0,r.Ku)(e),t);return n.email}async function Ut(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(S(e));const r=Re(e),s=Fe(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",pt),o=await s.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Dt(e),t})),a=await ft._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function Vt(e,t,n){return(0,i.xZ)(e.app)?Promise.reject(S(e)):It((0,r.Ku)(e),it.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Dt(e),t}))}async function Bt(e,t,n){const i=Re(e),r={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){C(t.handleCodeInApp,i,"argument-error"),t&&Nt(i,e,t)}(r,n),await Fe(i,r,"getOobCode",Qe)}function $t(e,t){const n=tt.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}async function zt(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(S(e));const s=(0,r.Ku)(e),o=it.credentialWithLink(t,n||_());return C(o._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),It(s,o)}async function Gt(e,t){const n={identifier:t,continueUri:x()?_():"http://localhost"},{signinMethods:i}=await async function(e,t){return F(e,"POST","/v1/accounts:createAuthUri",j(e,t))}((0,r.Ku)(e),n);return i||[]}async function qt(e,t){const n=(0,r.Ku)(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Nt(n.auth,i,t);const{email:s}=await async function(e,t){return We(e,t)}(n.auth,i);s!==e.email&&await e.reload()}async function Ht(e,t,n){const i=(0,r.Ku)(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Nt(i.auth,s,n);const{email:o}=await async function(e,t){return We(e,t)}(i.auth,s);o!==e.email&&await e.reload()}async function Wt(e,t){let{displayName:n,photoURL:i}=t;if(void 0===n&&void 0===i)return;const s=(0,r.Ku)(e),o={idToken:await s.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},a=await ne(s,async function(e,t){return F(e,"POST","/v1/accounts:update",t)}(s.auth,o));s.displayName=a.displayName||null,s.photoURL=a.photoUrl||null;const l=s.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),await s._updateTokensIfNecessary(a)}function Kt(e,t){const n=(0,r.Ku)(e);return(0,i.xZ)(n.auth.app)?Promise.reject(S(n.auth)):Jt(n,t,null)}function Qt(e,t){return Jt((0,r.Ku)(e),null,t)}async function Jt(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await ne(e,async function(e,t){return F(e,"POST","/v1/accounts:update",t)}(i,r));await e._updateTokensIfNecessary(s,!0)}class Yt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isNewUser=e,this.providerId=t,this.profile=n}}class Xt extends Yt{constructor(e,t,n,i){super(e,t,n),this.username=i}}class Zt extends Yt{constructor(e,t){super(e,"facebook.com",t)}}class en extends Xt{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class tn extends Yt{constructor(e,t){super(e,"google.com",t)}}class nn extends Xt{constructor(e,t,n){super(e,"twitter.com",t,n)}}function rn(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null===e||void 0===e?void 0:e.idToken)){const i=null===(n=null===(t=ee(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i)return new Yt(s,"anonymous"!==i&&"custom"!==i?i:null)}if(!i)return null;switch(i){case"facebook.com":return new Zt(s,r);case"github.com":return new en(s,r);case"google.com":return new tn(s,r);case"twitter.com":return new nn(s,r,e.screenName||null);case"custom":case"anonymous":return new Yt(s,null);default:return new Yt(s,i,r)}}(n)}function sn(e,t){return(0,r.Ku)(e).setPersistence(t)}function on(e){return async function(e){const t=Re(e),n=await K(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new W(n);null==t.tenantId?t._agentRecaptchaConfig=i:t._tenantRecaptchaConfigs[t.tenantId]=i,i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")&&new Me(t).verify()}(e)}async function an(e,t){return Re(e).validatePassword(t)}function ln(e,t,n,i){return(0,r.Ku)(e).onIdTokenChanged(t,n,i)}function cn(e,t,n){return(0,r.Ku)(e).beforeAuthStateChanged(t,n)}function un(e,t,n,i){return(0,r.Ku)(e).onAuthStateChanged(t,n,i)}function dn(e){(0,r.Ku)(e).useDeviceLanguage()}function hn(e,t){return(0,r.Ku)(e).updateCurrentUser(t)}function pn(e){return(0,r.Ku)(e).signOut()}function fn(e,t){return Re(e).revokeAccessToken(t)}async function mn(e){return(0,r.Ku)(e).delete()}class gn{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new gn("enroll",e,t)}static _fromMfaPendingCredential(e){return new gn("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return gn._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return gn._fromIdtoken(e.multiFactorSession.idToken)}return null}}class vn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Re(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map((e=>_t._fromServerResponse(n,e)));C(i.mfaPendingCredential,n,"internal-error");const s=gn._fromMfaPendingCredential(i.mfaPendingCredential);return new vn(s,r,(async e=>{const r=await e._process(n,s);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await ft._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return C(t.user,n,"internal-error"),ft._forOperation(t.user,t.operationType,o);default:w(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function yn(e,t){var n;const i=(0,r.Ku)(e),s=t;return C(t.customData.operationType,i,"argument-error"),C(null===(n=s.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),vn._fromError(i,s)}class bn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>_t._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new bn(e)}async getSession(){return gn._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,i=await this.getSession(),r=await ne(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await ne(this.user,(i=this.user.auth,r={idToken:n,mfaEnrollmentId:t},F(i,"POST","/v2/accounts/mfaEnrollment:withdraw",j(i,r))));this.enrolledFactors=this.enrolledFactors.filter((e=>{let{uid:n}=e;return n!==t})),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(s){throw s}var i,r}}const wn=new WeakMap;function kn(e){const t=(0,r.Ku)(e);return wn.has(t)||wn.set(t,bn._fromUser(t)),wn.get(t)}const Tn="__sak";class Sn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Tn,"1"),this.storage.removeItem(Tn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class En extends Sn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ce(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,r.lT)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}En.type="LOCAL";const In=En;class Cn extends Sn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Cn.type="SESSION";const Pn=Cn;class An{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new An(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function _n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}An.receivers=[];class xn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const l=_n("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Rn(){return window}function Nn(){return"undefined"!==typeof Rn().WorkerGlobalScope&&"function"===typeof Rn().importScripts}const Dn="firebaseLocalStorageDb",Ln="firebaseLocalStorage",On="fbase_key";class Mn{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function jn(e,t){return e.transaction([Ln],t?"readwrite":"readonly").objectStore(Ln)}function Fn(){const e=indexedDB.open(Dn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ln,{keyPath:On})}catch(i){n(i)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ln)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Dn);return new Mn(e).toPromise()}(),t(await Fn()))}))}))}async function Un(e,t,n){const i=jn(e,!0).put({[On]:t,value:n});return new Mn(i).toPromise()}function Vn(e,t){const n=jn(e,!0).delete(t);return new Mn(n).toPromise()}class Bn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Fn()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Nn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=An._getInstance(Nn()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new xn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fn();return await Un(e,Tn,"1"),await Vn(e,Tn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Un(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=jn(e,!1).get(t),i=await new Mn(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Vn(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=jn(e,!1).getAll();return new Mn(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Bn.type="LOCAL";const $n=Bn;const zn=1e12;class Gn{constructor(e){this.auth=e,this.counter=zn,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new qn(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||zn;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||zn;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||zn;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class qn{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i="string"===typeof e?document.getElementById(e):e;C(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Hn=Oe("rcb"),Wn=new N(3e4,6e4);class Kn{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Rn().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return C(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&q(Rn().grecaptcha)?Promise.resolve(Rn().grecaptcha):new Promise(((n,i)=>{const s=Rn().setTimeout((()=>{i(k(e,"network-request-failed"))}),Wn.get());Rn()[Hn]=()=>{Rn().clearTimeout(s),delete Rn()[Hn];const r=Rn().grecaptcha;if(!r||!q(r))return void i(k(e,"internal-error"));const o=r.render;r.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(r)};Le(`${De.recaptchaV2Script}?${(0,r.Am)({onload:Hn,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(s),i(k(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Rn().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Qn{async load(e){return new Gn(e)}clearedOneInstance(){}}const Jn="recaptcha",Yn={theme:"light",type:"image"};class Xn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},Yn);this.parameters=n,this.type=Jn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Re(e),this.isInvisible="invisible"===this.parameters.size,C("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"===typeof t?document.getElementById(t):t;C(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Qn:new Kn,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){C(!this.parameters.sitekey,this.auth,"argument-error"),C(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),C("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"===typeof e)e(t);else if("string"===typeof e){const n=Rn()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){C(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){C(x()&&!Nn(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await F(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);C(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return C(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Zn{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=et._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function ei(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(S(e));const s=Re(e),o=await ii(s,t,(0,r.Ku)(n));return new Zn(o,(e=>It(s,e)))}async function ti(e,t,n){const i=(0,r.Ku)(e);await Tt(!1,i,"phone");const s=await ii(i.auth,t,(0,r.Ku)(n));return new Zn(s,(e=>Ct(i,e)))}async function ni(e,t,n){const s=(0,r.Ku)(e);if((0,i.xZ)(s.auth.app))return Promise.reject(S(s.auth));const o=await ii(s.auth,t,(0,r.Ku)(n));return new Zn(o,(e=>Pt(s,e)))}async function ii(e,t,n){var i;const r=await n.verify();try{let s;if(C("string"===typeof r,e,"argument-error"),C(n.type===Jn,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){C("enroll"===t.type,e,"internal-error");const n=await function(e,t){return F(e,"POST","/v2/accounts/mfaEnrollment:start",j(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{C("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;C(n,e,"missing-multi-factor-info");const o=await function(e,t){return F(e,"POST","/v2/accounts/mfaSignIn:start",j(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return F(e,"POST","/v1/accounts:sendVerificationCode",j(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function ri(e,t){const n=(0,r.Ku)(e);if((0,i.xZ)(n.auth.app))return Promise.reject(S(n.auth));await kt(n,t)}class si{constructor(e){this.providerId=si.PROVIDER_ID,this.auth=Re(e)}verifyPhoneNumber(e,t){return ii(this.auth,e,(0,r.Ku)(t))}static credential(e,t){return et._fromVerification(e,t)}static credentialFromResult(e){const t=e;return si.credentialFromTaggedObject(t)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?et._fromTokenResponse(n,i):null}}function oi(e,t){return t?he(t):(C(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}si.PROVIDER_ID="phone",si.PHONE_SIGN_IN_METHOD="phone";class ai extends ze{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ye(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ye(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ye(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function li(e){return Et(e.auth,new ai(e),e.bypassAuthState)}function ci(e){const{auth:t,user:n}=e;return C(n,t,"internal-error"),St(n,new ai(e),e.bypassAuthState)}async function ui(e){const{auth:t,user:n}=e;return C(n,t,"internal-error"),kt(n,new ai(e),e.bypassAuthState)}class di{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return li;case"linkViaPopup":case"linkViaRedirect":return ui;case"reauthViaPopup":case"reauthViaRedirect":return ci;default:w(this.auth,"internal-error")}}resolve(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const hi=new N(2e3,1e4);async function pi(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(k(e,"operation-not-supported-in-this-environment"));const r=Re(e);E(e,t,rt);const s=oi(r,n);return new gi(r,"signInViaPopup",t,s).executeNotNull()}async function fi(e,t,n){const s=(0,r.Ku)(e);if((0,i.xZ)(s.auth.app))return Promise.reject(k(s.auth,"operation-not-supported-in-this-environment"));E(s.auth,t,rt);const o=oi(s.auth,n);return new gi(s.auth,"reauthViaPopup",t,o,s).executeNotNull()}async function mi(e,t,n){const i=(0,r.Ku)(e);E(i.auth,t,rt);const s=oi(i.auth,n);return new gi(i.auth,"linkViaPopup",t,s,i).executeNotNull()}class gi extends di{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,gi.currentPopupAction&&gi.currentPopupAction.cancel(),gi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return C(e,this.auth,"internal-error"),e}async onExecution(){A(1===this.filter.length,"Popup operations only handle one event");const e=_n();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(k(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(k(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(k(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,hi.get())};e()}}gi.currentPopupAction=null;const vi="pendingRedirect",yi=new Map;class bi extends di{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=yi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Si(t),i=Ti(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}yi.set(this.auth._key(),e)}return this.bypassAuthState||yi.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function wi(e,t){return Ti(e)._set(Si(t),"true")}function ki(e,t){yi.set(e._key(),t)}function Ti(e){return he(e._redirectPersistence)}function Si(e){return me(vi,e.config.apiKey,e.name)}function Ei(e,t,n){return async function(e,t,n){if((0,i.xZ)(e.app))return Promise.reject(S(e));const r=Re(e);E(e,t,rt),await r._initializationPromise;const s=oi(r,n);return await wi(s,r),s._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function Ii(e,t,n){return async function(e,t,n){const s=(0,r.Ku)(e);if(E(s.auth,t,rt),(0,i.xZ)(s.auth.app))return Promise.reject(S(s.auth));await s.auth._initializationPromise;const o=oi(s.auth,n);await wi(o,s.auth);const a=await _i(s);return o._openRedirect(s.auth,t,"reauthViaRedirect",a)}(e,t,n)}function Ci(e,t,n){return async function(e,t,n){const i=(0,r.Ku)(e);E(i.auth,t,rt),await i.auth._initializationPromise;const s=oi(i.auth,n);await Tt(!1,i,t.providerId),await wi(s,i.auth);const o=await _i(i);return s._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)}async function Pi(e,t){return await Re(e)._initializationPromise,Ai(e,t,!1)}async function Ai(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,i.xZ)(e.app))return Promise.reject(S(e));const r=Re(e),s=oi(r,t),o=new bi(r,s,n),a=await o.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}async function _i(e){const t=_n(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class xi{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ni(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ni(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(k(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ri(e))}saveEventToCache(e){this.cachedEventUids.add(Ri(e)),this.lastProcessedEventTime=Date.now()}}function Ri(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ni(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Di=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Li=/^https?/;async function Oi(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return F(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(Mi(i))return}catch(n){}w(e,"unauthorized-domain")}function Mi(e){const t=_(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Li.test(n))return!1;if(Di.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const ji=new N(3e4,6e4);function Fi(){const e=Rn().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Ui(e){return new Promise(((t,n)=>{var i,r,s;function o(){Fi(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Fi(),n(k(e,"network-request-failed"))},timeout:ji.get()})}if(null===(r=null===(i=Rn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Rn().gapi)||void 0===s?void 0:s.load)){const t=Oe("iframefcb");return Rn()[t]=()=>{gapi.load?o():n(k(e,"network-request-failed"))},Le(`${De.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Vi=null,e}))}let Vi=null;const Bi=new N(5e3,15e3),$i={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gi(e){const t=e.config;C(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?D(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:i.MF},o=zi.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,r.Am)(s).slice(1)}`}async function qi(e){const t=await function(e){return Vi=Vi||Ui(e),Vi}(e),n=Rn().gapi;return C(n,e,"internal-error"),t.open({where:document.body,url:Gi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$i,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=k(e,"network-request-failed"),s=Rn().setTimeout((()=>{i(r)}),Bi.get());function o(){Rn().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}const Hi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Wi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ki(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Hi),{width:i.toString(),height:s.toString(),top:o,left:a}),u=(0,r.ZQ)().toLowerCase();n&&(l=we(u)?"_blank":n),ye(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce(((e,t)=>{let[n,i]=t;return`${e}${n}=${i},`}),"");if(function(){var e;return Ie(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",l),new Wi(null);const h=window.open(t||"",l,d);C(h,e,"popup-blocked");try{h.focus()}catch(p){}return new Wi(h)}const Qi="__/auth/handler",Ji="emulator/auth/handler",Yi=encodeURIComponent("fac");async function Xi(e,t,n,s,o,a){C(e.config.authDomain,e,"auth-domain-config-required"),C(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:i.MF,eventId:o};if(t instanceof rt){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,r.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))l[e]=t}if(t instanceof st){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const i of Object.keys(c))void 0===c[i]&&delete c[i];const u=await e._getAppCheckToken(),d=u?`#${Yi}=${encodeURIComponent(u)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Qi}`;return D(t,Ji)}(e)}?${(0,r.Am)(c).slice(1)}${d}`}const Zi="webStorageSupport";const er=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Pn,this._completeRedirectFn=Ai,this._overrideRedirectResult=ki}async _openPopup(e,t,n,i){var r;A(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return Ki(e,await Xi(e,t,n,_(),i),_n())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){Rn().location.href=e}(await Xi(e,t,n,_(),i)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(A(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await qi(e),n=new xi(e);return t.register("authEvent",(t=>{C(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zi,{type:Zi},(n=>{var i;const r=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[Zi];void 0!==r&&t(!!r),w(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Oi(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ce()||be()||Ie()}};class tr{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return P("unexpected MultiFactorSessionType")}}}class nr extends tr{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new nr(e)}_finalizeEnroll(e,t,n){return function(e,t){return F(e,"POST","/v2/accounts/mfaEnrollment:finalize",j(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return F(e,"POST","/v2/accounts/mfaSignIn:finalize",j(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ir{constructor(){}static assertion(e){return nr._fromCredential(e)}}ir.FACTOR_ID="phone";class rr{static assertionForEnrollment(e,t){return sr._fromSecret(e,t)}static assertionForSignIn(e,t){return sr._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const n=e;C("undefined"!==typeof(null===(t=n.user)||void 0===t?void 0:t.auth),"internal-error");const i=await(r=n.user.auth,s={idToken:n.credential,totpEnrollmentInfo:{}},F(r,"POST","/v2/accounts/mfaEnrollment:start",j(r,s)));var r,s;return or._fromStartTotpMfaEnrollmentResponse(i,n.user.auth)}}rr.FACTOR_ID="totp";class sr extends tr{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new sr(t,void 0,e)}static _fromEnrollmentId(e,t){return new sr(t,e)}async _finalizeEnroll(e,t,n){return C("undefined"!==typeof this.secret,e,"argument-error"),function(e,t){return F(e,"POST","/v2/accounts/mfaEnrollment:finalize",j(e,t))}(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){C(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");const n={verificationCode:this.otp};return function(e,t){return F(e,"POST","/v2/accounts/mfaSignIn:finalize",j(e,t))}(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class or{constructor(e,t,n,i,r,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new or(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let i=!1;return(ar(e)||ar(t))&&(i=!0),i&&(ar(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),ar(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function ar(e){return"undefined"===typeof e||0===(null===e||void 0===e?void 0:e.length)}var lr="@firebase/auth",cr="1.7.9";class ur{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){C(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const dr=(0,r.XA)("authIdTokenMaxAge")||300;let hr=null;const pr=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>dr)return;const r=null===n||void 0===n?void 0:n.token;hr!==r&&(hr=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.Sx)();const t=(0,i.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=Ue(e,{popupRedirectResolver:er,persistence:[$n,In,Pn]}),s=(0,r.XA)("authTokenSyncURL");if(s&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(s,location.origin);if(location.origin===e.origin){const t=pr(e.toString());cn(n,t,(()=>t(n.currentUser))),ln(n,(e=>t(e)))}}const o=(0,r.Tj)("auth");return o&&Ve(n,`http://${o}`),n}var mr;De={loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=k("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},mr="Browser",(0,i.om)(new a.uA("auth",((e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;C(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:mr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pe(mr)},c=new xe(i,r,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(he);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,i.om)(new a.uA("auth-internal",(e=>(e=>new ur(e))(Re(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.KO)(lr,cr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(mr)),(0,i.KO)(lr,cr,"esm2017")},799:(e,t,n)=>{"use strict";n.d(t,{P2:()=>g});const i=(e,t)=>t.some((t=>e instanceof t));let r,s;const o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(m(this),n),f(o.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return f(e.apply(m(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.call(m(this),t,...i);return l.set(s,t.sort?t.sort():[t]),f(s)}}function p(e){return"function"===typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),i(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(f(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=p(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const m=e=>u.get(e);function g(e,t){let{blocked:n,upgrade:i,blocking:r,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=f(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(f(o.result),e.oldVersion,e.newVersion,f(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function w(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!v.includes(n))return;const s=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return i&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),r&&t.done]))[0]};return b.set(t,s),s}d=(e=>({...e,get:(t,n,i)=>w(t,n)||e.get(t,n,i),has:(t,n)=>!!w(t,n)||e.has(t,n)}))(d)},812:(e,t,n)=>{"use strict";n.d(t,{h1:()=>a,uA:()=>r});var i=n(700);class r{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new i.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&s.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===s?void 0:r),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(o){}var r;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},824:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let s=3;s<i.length;s++){const r=i[s],o=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(o){const i=t.parseRtpMap(o),s=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=s.length?t.parseFmtp(s[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{r.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let r=0;return n.codecs.forEach((e=>{e.maxptime>r&&(r=e.maxptime)})),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=o.length>0&&o[0].ssrc;let l;const c=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));c.length>0&&c[0].length>1&&c[0][0]===a&&(l=c[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&l&&(t.rtx={ssrc:l}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:s?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&a&&n.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const s=t.matchPrefix(e,"a=rtcp-mux");return n.mux=s.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const s=t.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){const e=o[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const s=void 0!==n?n:2;r=e||t.generateSessionId();return"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t},853:(e,t,n)=>{"use strict";e.exports=n(234)},877:(e,t,n)=>{var i=function(e){return String(Number(e))===e?Number(e):e},r=function(e,t,n){var r=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={});var s=e.push?{}:r?t[e.name]:t;!function(e,t,n,r){if(r&&!n)t[r]=i(e[1]);else for(var s=0;s<n.length;s+=1)null!=e[s+1]&&(t[n[s]]=i(e[s+1]))}(n.match(e.reg),s,e.names,e.name),e.push&&t[e.push].push(s)},s=n(321),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var a=0;a<(s[t]||[]).length;a+=1){var l=s[t][a];if(l.reg.test(o))return r(l,i,o)}})),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=i(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),r=0;r<n.length;r+=3)t.push({component:n[r],ip:n[r+1],port:n[r+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&i;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>i[e]));return o.default=()=>i,n.d(s,o),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{"use strict";var e={};n.r(e),n.d(e,{fixNegotiationNeeded:()=>ME,shimAddTrackRemoveTrack:()=>LE,shimAddTrackRemoveTrackWithNative:()=>DE,shimGetDisplayMedia:()=>PE,shimGetSendersWithDtmf:()=>xE,shimGetStats:()=>RE,shimGetUserMedia:()=>CE,shimMediaStream:()=>AE,shimOnTrack:()=>_E,shimPeerConnection:()=>OE,shimSenderReceiverGetStats:()=>NE});var t={};n.r(t),n.d(t,{shimAddTransceiver:()=>qE,shimCreateAnswer:()=>KE,shimCreateOffer:()=>WE,shimGetDisplayMedia:()=>FE,shimGetParameters:()=>HE,shimGetUserMedia:()=>jE,shimOnTrack:()=>UE,shimPeerConnection:()=>VE,shimRTCDataChannel:()=>GE,shimReceiverGetStats:()=>$E,shimRemoveStream:()=>zE,shimSenderGetStats:()=>BE});var i={};n.r(i),n.d(i,{shimAudioContext:()=>iI,shimCallbacksAPI:()=>YE,shimConstraints:()=>ZE,shimCreateOfferLegacy:()=>nI,shimGetUserMedia:()=>XE,shimLocalStreamsAPI:()=>QE,shimRTCIceServerUrls:()=>eI,shimRemoteStreamsAPI:()=>JE,shimTrackEventTransceiver:()=>tI});var r={};n.r(r),n.d(r,{removeExtmapAllowMixed:()=>dI,shimAddIceCandidateNullOrEmpty:()=>hI,shimConnectionState:()=>uI,shimMaxMessageSize:()=>lI,shimParameterlessSetLocalDescription:()=>pI,shimRTCIceCandidate:()=>oI,shimRTCIceCandidateRelayProtocol:()=>aI,shimSendThrowTypeError:()=>cI});var s,o,a=n(43),l=n.t(a,2),c=n(391),u=n(950),d=n.t(u,2);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},h.apply(this,arguments)}(o=s||(s={})).Pop="POP",o.Push="PUSH",o.Replace="REPLACE";const p="popstate";function f(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function m(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(vC){}}}function g(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t,n,i){return void 0===n&&(n=null),h({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?b(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function y(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function b(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function w(e,t,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:o=!1}=i,a=r.history,l=s.Pop,c=null,u=d();function d(){return(a.state||{idx:null}).idx}function m(){l=s.Pop;let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:w.location,delta:t})}function b(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:y(e);return n=n.replace(/ $/,"%20"),f(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==u&&(u=0,a.replaceState(h({},a.state,{idx:u}),""));let w={get action(){return l},get location(){return e(r,a)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(p,m),c=e,()=>{r.removeEventListener(p,m),c=null}},createHref:e=>t(r,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=s.Push;let i=v(w.location,e,t);n&&n(i,e),u=d()+1;let h=g(i,u),p=w.createHref(i);try{a.pushState(h,"",p)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;r.location.assign(p)}o&&c&&c({action:l,location:w.location,delta:1})},replace:function(e,t){l=s.Replace;let i=v(w.location,e,t);n&&n(i,e),u=d();let r=g(i,u),h=w.createHref(i);a.replaceState(r,"",h),o&&c&&c({action:l,location:w.location,delta:0})},go:e=>a.go(e)};return w}var k,T;(T=k||(k={})).data="data",T.deferred="deferred",T.redirect="redirect",T.error="error";new Set(["lazy","caseSensitive","path","id","index","children"]);function S(e,t,n){return void 0===n&&(n="/"),E(e,t,n,!1)}function E(e,t,n,i){let r=F(("string"===typeof t?b(t):t).pathname||"/",n);if(null==r)return null;let s=I(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=j(r);o=O(s[a],e,i)}return o}function I(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(e,r,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};o.relativePath.startsWith("/")&&(f(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(i.length));let a=z([i,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(f(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),I(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:L(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of C(e.path))r(e,t,i);else r(e,t)})),t}function C(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let o=C(i.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),r&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const P=/^:[\w-]+$/,A=3,_=2,x=1,R=10,N=-2,D=e=>"*"===e;function L(e,t){let n=e.split("/"),i=n.length;return n.some(D)&&(i+=N),t&&(i+=_),n.filter((e=>!D(e))).reduce(((e,t)=>e+(P.test(t)?A:""===t?x:R)),i)}function O(e,t,n){void 0===n&&(n=!1);let{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let e=i[a],l=a===i.length-1,c="/"===s?t:t.slice(s.length)||"/",u=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:z([s,u.pathname]),pathnameBase:G(z([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=z([s,u.pathnameBase]))}return o}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);m("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce(((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function j(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return m(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function F(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function U(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function V(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function B(e,t){let n=V(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function $(e,t,n,i){let r;void 0===i&&(i=!1),"string"===typeof e?r=b(e):(r=h({},e),f(!r.pathname||!r.pathname.includes("?"),U("?","pathname","search",r)),f(!r.pathname||!r.pathname.includes("#"),U("#","pathname","hash",r)),f(!r.search||!r.search.includes("#"),U("#","search","hash",r)));let s,o=""===e||""===r.pathname,a=o?"/":r.pathname;if(null==a)s=n;else{let e=t.length-1;if(!i&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:i="",hash:r=""}="string"===typeof e?b(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:q(i),hash:H(r)}}(r,s),c=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const z=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",H=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const K=["post","put","patch","delete"],Q=(new Set(K),["get",...K]);new Set(Q),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},J.apply(this,arguments)}const Y=a.createContext(null);const X=a.createContext(null);const Z=a.createContext(null);const ee=a.createContext(null);const te=a.createContext({outlet:null,matches:[],isDataRoute:!1});const ne=a.createContext(null);function ie(){return null!=a.useContext(ee)}function re(){return ie()||f(!1),a.useContext(ee).location}function se(e){a.useContext(Z).static||a.useLayoutEffect(e)}function oe(){let{isDataRoute:e}=a.useContext(te);return e?function(){let{router:e}=me(pe.UseNavigateStable),t=ve(fe.UseNavigateStable),n=a.useRef(!1);return se((()=>{n.current=!0})),a.useCallback((function(i,r){void 0===r&&(r={}),n.current&&("number"===typeof i?e.navigate(i):e.navigate(i,J({fromRouteId:t},r)))}),[e,t])}():function(){ie()||f(!1);let e=a.useContext(Y),{basename:t,future:n,navigator:i}=a.useContext(Z),{matches:r}=a.useContext(te),{pathname:s}=re(),o=JSON.stringify(B(r,n.v7_relativeSplatPath)),l=a.useRef(!1);return se((()=>{l.current=!0})),a.useCallback((function(n,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof n)return void i.go(n);let a=$(n,JSON.parse(o),s,"path"===r.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:z([t,a.pathname])),(r.replace?i.replace:i.push)(a,r.state,r)}),[t,i,o,s,e])}()}function ae(e,t,n,i){ie()||f(!1);let{navigator:r,static:o}=a.useContext(Z),{matches:l}=a.useContext(te),c=l[l.length-1],u=c?c.params:{},d=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let h,p=re();if(t){var m;let e="string"===typeof t?b(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||f(!1),h=e}else h=p;let g=h.pathname||"/",v=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=!o&&n&&n.matches&&n.matches.length>0?n.matches:S(e,{pathname:v});let w=he(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:z([d,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:z([d,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,i);return t&&w?a.createElement(ee.Provider,{value:{location:J({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:s.Pop}},w):w}function le(){let e=function(){var e;let t=a.useContext(ne),n=ge(fe.UseRouteError),i=ve(fe.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:r},n):null,null)}const ce=a.createElement(le,null);class ue extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(te.Provider,{value:this.props.routeContext},a.createElement(ne.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function de(e){let{routeContext:t,match:n,children:i}=e,r=a.useContext(Y);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(te.Provider,{value:t},i)}function he(e,t,n,i){var r;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===i&&(i=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=i)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(r=n)?void 0:r.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||f(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(n&&i&&i.v7_partialHydration)for(let a=0;a<o.length;a++){let e=o[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=a),e.route.id){let{loaderData:t,errors:i}=n,r=e.route.loader&&void 0===t[e.route.id]&&(!i||void 0===i[e.route.id]);if(e.route.lazy||r){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight(((e,i,r)=>{let s,d=!1,h=null,p=null;var f;n&&(s=l&&i.route.id?l[i.route.id]:void 0,h=i.route.errorElement||ce,c&&(u<0&&0===r?(f="route-fallback",!1||ye[f]||(ye[f]=!0),d=!0,p=null):u===r&&(d=!0,p=i.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,r+1)),g=()=>{let t;return t=s?h:d?p:i.route.Component?a.createElement(i.route.Component,null):i.route.element?i.route.element:e,a.createElement(de,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===r)?a.createElement(ue,{location:n.location,revalidation:n.revalidation,component:h,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var pe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(pe||{}),fe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(fe||{});function me(e){let t=a.useContext(Y);return t||f(!1),t}function ge(e){let t=a.useContext(X);return t||f(!1),t}function ve(e){let t=function(){let e=a.useContext(te);return e||f(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||f(!1),n.route.id}const ye={};function be(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}l.startTransition;function we(e){let{to:t,replace:n,state:i,relative:r}=e;ie()||f(!1);let{future:s,static:o}=a.useContext(Z),{matches:l}=a.useContext(te),{pathname:c}=re(),u=oe(),d=$(t,B(l,s.v7_relativeSplatPath),c,"path"===r),h=JSON.stringify(d);return a.useEffect((()=>u(JSON.parse(h),{replace:n,state:i,relative:r})),[u,h,r,n,i]),null}function ke(e){f(!1)}function Te(e){let{basename:t="/",children:n=null,location:i,navigationType:r=s.Pop,navigator:o,static:l=!1,future:c}=e;ie()&&f(!1);let u=t.replace(/^\/*/,"/"),d=a.useMemo((()=>({basename:u,navigator:o,static:l,future:J({v7_relativeSplatPath:!1},c)})),[u,c,o,l]);"string"===typeof i&&(i=b(i));let{pathname:h="/",search:p="",hash:m="",state:g=null,key:v="default"}=i,y=a.useMemo((()=>{let e=F(h,u);return null==e?null:{location:{pathname:e,search:p,hash:m,state:g,key:v},navigationType:r}}),[u,h,p,m,g,v,r]);return null==y?null:a.createElement(Z.Provider,{value:d},a.createElement(ee.Provider,{children:n,value:y}))}function Se(e){let{children:t,location:n}=e;return ae(Ee(t),n)}new Promise((()=>{}));a.Component;function Ee(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,((e,i)=>{if(!a.isValidElement(e))return;let r=[...t,i];if(e.type===a.Fragment)return void n.push.apply(n,Ee(e.props.children,r));e.type!==ke&&f(!1),e.props.index&&e.props.children&&f(!1);let s={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=Ee(e.props.children,r)),n.push(s)})),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(vC){}new Map;const Ie=l.startTransition;d.flushSync,l.useId;function Ce(e){let{basename:t,children:n,future:i,window:r}=e,s=a.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:r,v5Compat:!0})&&(o={}),w((function(e,t){let{pathname:n,search:i,hash:r}=e.location;return v("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:y(t)}),null,o)));let l=s.current,[c,u]=a.useState({action:l.action,location:l.location}),{v7_startTransition:d}=i||{},h=a.useCallback((e=>{d&&Ie?Ie((()=>u(e))):u(e)}),[u,d]);return a.useLayoutEffect((()=>l.listen(h)),[l,h]),a.useEffect((()=>be(i)),[i]),a.createElement(Te,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:i})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Pe,Ae,_e,xe;(Ae=Pe||(Pe={})).UseScrollRestoration="useScrollRestoration",Ae.UseSubmit="useSubmit",Ae.UseSubmitFetcher="useSubmitFetcher",Ae.UseFetcher="useFetcher",Ae.useViewTransitionState="useViewTransitionState",(xe=_e||(_e={})).UseFetcher="useFetcher",xe.UseFetchers="useFetchers",xe.UseScrollRestoration="useScrollRestoration";function Re(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Re(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const Ne=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Re(e))&&(i&&(i+=" "),i+=t);return i},De=e=>"number"==typeof e&&!isNaN(e),Le=e=>"string"==typeof e,Oe=e=>"function"==typeof e,Me=e=>Le(e)||Oe(e)?e:null,je=e=>(0,a.isValidElement)(e)||Le(e)||Oe(e)||De(e);function Fe(e){let{enter:t,exit:n,appendPosition:i=!1,collapse:r=!0,collapseDuration:s=300}=e;return function(e){let{children:o,position:l,preventExitTransition:c,done:u,nodeRef:d,isIn:h,playToast:p}=e;const f=i?`${t}--${l}`:t,m=i?`${n}--${l}`:n,g=(0,a.useRef)(0);return(0,a.useLayoutEffect)((()=>{const e=d.current,t=f.split(" "),n=i=>{i.target===d.current&&(p(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==i.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)}),[]),(0,a.useEffect)((()=>{const e=d.current,t=()=>{e.removeEventListener("animationend",t),r?function(e,t,n){void 0===n&&(n=300);const{scrollHeight:i,style:r}=e;requestAnimationFrame((()=>{r.minHeight="initial",r.height=i+"px",r.transition=`all ${n}ms`,requestAnimationFrame((()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)}))}))}(e,u,s):u()};h||(c?t():(g.current=1,e.className+=` ${m}`,e.addEventListener("animationend",t)))}),[h]),a.createElement(a.Fragment,null,o)}}function Ue(e,t){return null!=e?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const Ve=new Map;let Be=[];const $e=new Set,ze=e=>$e.forEach((t=>t(e))),Ge=()=>Ve.size>0;function qe(e,t){var n;if(t)return!(null==(n=Ve.get(t))||!n.isToastActive(e));let i=!1;return Ve.forEach((t=>{t.isToastActive(e)&&(i=!0)})),i}function He(e,t){je(e)&&(Ge()||Be.push({content:e,options:t}),Ve.forEach((n=>{n.buildToast(e,t)})))}function We(e,t){Ve.forEach((n=>{null!=t&&null!=t&&t.containerId?(null==t?void 0:t.containerId)===n.id&&n.toggle(e,null==t?void 0:t.id):n.toggle(e,null==t?void 0:t.id)}))}function Ke(e){let{delay:t,isRunning:n,closeToast:i,type:r="default",hide:s,className:o,style:l,controlledProgress:c,progress:u,rtl:d,isIn:h,theme:p}=e;const f=s||c&&0===u,m={...l,animationDuration:`${t}ms`,animationPlayState:n?"running":"paused"};c&&(m.transform=`scaleX(${u})`);const g=Ne("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":d}),v=Oe(o)?o({rtl:d,type:r,defaultClassName:g}):Ne(g,o),y={[c&&u>=1?"onTransitionEnd":"onAnimationEnd"]:c&&u<1?null:()=>{h&&i()}};return a.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},a.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${p} Toastify__progress-bar--${r}`}),a.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:v,style:m,...y}))}let Qe=1;const Je=()=>""+Qe++;function Ye(e){return e&&(Le(e.toastId)||De(e.toastId))?e.toastId:Je()}function Xe(e,t){return He(e,t),t.toastId}function Ze(e,t){return{...t,type:t&&t.type||e,toastId:Ye(t)}}function et(e){return(t,n)=>Xe(t,Ze(e,n))}function tt(e,t){return Xe(e,Ze("default",t))}tt.loading=(e,t)=>Xe(e,Ze("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),tt.promise=function(e,t,n){let i,{pending:r,error:s,success:o}=t;r&&(i=Le(r)?tt.loading(r,n):tt.loading(r.render,{...n,...r}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,r)=>{if(null==t)return void tt.dismiss(i);const s={type:e,...a,...n,data:r},o=Le(t)?{render:t}:t;return i?tt.update(i,{...s,...o}):tt(o.render,{...s,...o}),r},c=Oe(e)?e():e;return c.then((e=>l("success",o,e))).catch((e=>l("error",s,e))),c},tt.success=et("success"),tt.info=et("info"),tt.error=et("error"),tt.warning=et("warning"),tt.warn=tt.warning,tt.dark=(e,t)=>Xe(e,Ze("default",{theme:"dark",...t})),tt.dismiss=function(e){!function(e){var t;if(Ge()){if(null==e||Le(t=e)||De(t))Ve.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){const t=Ve.get(e.containerId);t?t.removeToast(e.id):Ve.forEach((t=>{t.removeToast(e.id)}))}}else Be=Be.filter((t=>null!=e&&t.options.toastId!==e))}(e)},tt.clearWaitingQueue=function(e){void 0===e&&(e={}),Ve.forEach((t=>{!t.props.limit||e.containerId&&t.id!==e.containerId||t.clearQueue()}))},tt.isActive=qe,tt.update=function(e,t){void 0===t&&(t={});const n=((e,t)=>{var n;let{containerId:i}=t;return null==(n=Ve.get(i||1))?void 0:n.toasts.get(e)})(e,t);if(n){const{props:i,content:r}=n,s={delay:100,...i,...t,toastId:t.toastId||e,updateId:Je()};s.toastId!==e&&(s.staleId=e);const o=s.render||r;delete s.render,Xe(o,s)}},tt.done=e=>{tt.update(e,{progress:1})},tt.onChange=function(e){return $e.add(e),()=>{$e.delete(e)}},tt.play=e=>We(!0,e),tt.pause=e=>We(!1,e);const nt="undefined"!=typeof window?a.useLayoutEffect:a.useEffect,it=e=>{let{theme:t,type:n,isLoading:i,...r}=e;return a.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":`var(--toastify-icon-color-${n})`,...r})},rt={info:function(e){return a.createElement(it,{...e},a.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return a.createElement(it,{...e},a.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return a.createElement(it,{...e},a.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return a.createElement(it,{...e},a.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return a.createElement("div",{className:"Toastify__spinner"})}},st=e=>{const{isRunning:t,preventExitTransition:n,toastRef:i,eventHandlers:r,playToast:s}=function(e){const[t,n]=(0,a.useState)(!1),[i,r]=(0,a.useState)(!1),s=(0,a.useRef)(null),o=(0,a.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:d,closeOnClick:h}=e;var p,f;function m(){n(!0)}function g(){n(!1)}function v(n){const i=s.current;o.canDrag&&i&&(o.didMove=!0,t&&g(),o.delta="x"===e.draggableDirection?n.clientX-o.start:n.clientY-o.start,o.start!==n.clientX&&(o.canCloseOnClick=!1),i.style.transform=`translate3d(${"x"===e.draggableDirection?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,i.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function y(){document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",y);const t=s.current;if(o.canDrag&&o.didMove&&t){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return r(!0),e.closeToast(),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}null==(f=Ve.get((p={id:e.toastId,containerId:e.containerId,fn:n}).containerId||1))||f.setToggle(p.id,p.fn),(0,a.useEffect)((()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||g(),window.addEventListener("focus",m),window.addEventListener("blur",g),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",g)}}),[e.pauseOnFocusLoss]);const b={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){o.didMove=!1,document.addEventListener("pointermove",v),document.addEventListener("pointerup",y);const n=s.current;o.canCloseOnClick=!0,o.canDrag=!0,n.style.transition="none","x"===e.draggableDirection?(o.start=t.clientX,o.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(o.start=t.clientY,o.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){const{top:n,bottom:i,left:r,right:o}=s.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=r&&t.clientX<=o&&t.clientY>=n&&t.clientY<=i?g():m()}};return l&&c&&(b.onMouseEnter=g,e.stacked||(b.onMouseLeave=m)),h&&(b.onClick=e=>{d&&d(e),o.canCloseOnClick&&u()}),{playToast:m,pauseToast:g,isRunning:t,preventExitTransition:i,toastRef:s,eventHandlers:b}}(e),{closeButton:o,children:l,autoClose:c,onClick:u,type:d,hideProgressBar:h,closeToast:p,transition:f,position:m,className:g,style:v,bodyClassName:y,bodyStyle:b,progressClassName:w,progressStyle:k,updateId:T,role:S,progress:E,rtl:I,toastId:C,deleteToast:P,isIn:A,isLoading:_,closeOnClick:x,theme:R}=e,N=Ne("Toastify__toast",`Toastify__toast-theme--${R}`,`Toastify__toast--${d}`,{"Toastify__toast--rtl":I},{"Toastify__toast--close-on-click":x}),D=Oe(g)?g({rtl:I,position:m,type:d,defaultClassName:N}):Ne(N,g),L=function(e){let{theme:t,type:n,isLoading:i,icon:r}=e,s=null;const o={theme:t,type:n};return!1===r||(Oe(r)?s=r({...o,isLoading:i}):(0,a.isValidElement)(r)?s=(0,a.cloneElement)(r,o):i?s=rt.spinner():(e=>e in rt)(n)&&(s=rt[n](o))),s}(e),O=!!E||!c,M={closeToast:p,type:d,theme:R};let j=null;return!1===o||(j=Oe(o)?o(M):(0,a.isValidElement)(o)?(0,a.cloneElement)(o,M):function(e){let{closeToast:t,theme:n,ariaLabel:i="close"}=e;return a.createElement("button",{className:`Toastify__close-button Toastify__close-button--${n}`,type:"button",onClick:e=>{e.stopPropagation(),t(e)},"aria-label":i},a.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(M)),a.createElement(f,{isIn:A,done:P,position:m,preventExitTransition:n,nodeRef:i,playToast:s},a.createElement("div",{id:C,onClick:u,"data-in":A,className:D,...r,style:v,ref:i},a.createElement("div",{...A&&{role:S},className:Oe(y)?y({type:d}):Ne("Toastify__toast-body",y),style:b},null!=L&&a.createElement("div",{className:Ne("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!_})},L),a.createElement("div",null,l)),j,a.createElement(Ke,{...T&&!O?{key:`pb-${T}`}:{},rtl:I,theme:R,delay:c,isRunning:t,isIn:A,closeToast:p,hide:h,type:d,style:k,className:w,controlledProgress:O,progress:E||0})))},ot=function(e,t){return void 0===t&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},at=Fe(ot("bounce",!0)),lt=(Fe(ot("slide",!0)),Fe(ot("zoom")),Fe(ot("flip")),{position:"top-right",transition:at,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"});function ct(e){let t={...lt,...e};const n=e.stacked,[i,r]=(0,a.useState)(!0),s=(0,a.useRef)(null),{getToastToRender:o,isToastActive:l,count:c}=function(e){const{subscribe:t,getSnapshot:n,setProps:i}=(0,a.useRef)(function(e){const t=e.containerId||1;return{subscribe(n){const i=function(e,t,n){let i=1,r=0,s=[],o=[],l=[],c=t;const u=new Map,d=new Set,h=()=>{l=Array.from(u.values()),d.forEach((e=>e()))},p=e=>{o=null==e?[]:o.filter((t=>t!==e)),h()},f=e=>{const{toastId:t,onOpen:i,updateId:r,children:s}=e.props,l=null==r;e.staleId&&u.delete(e.staleId),u.set(t,e),o=[...o,e.props.toastId].filter((t=>t!==e.staleId)),h(),n(Ue(e,l?"added":"updated")),l&&Oe(i)&&i((0,a.isValidElement)(s)&&s.props)};return{id:e,props:c,observe:e=>(d.add(e),()=>d.delete(e)),toggle:(e,t)=>{u.forEach((n=>{null!=t&&t!==n.props.toastId||Oe(n.toggle)&&n.toggle(e)}))},removeToast:p,toasts:u,clearQueue:()=>{r-=s.length,s=[]},buildToast:(t,o)=>{if((t=>{let{containerId:n,toastId:i,updateId:r}=t;const s=n?n!==e:1!==e,o=u.has(i)&&null==r;return s||o})(o))return;const{toastId:l,updateId:d,data:m,staleId:g,delay:v}=o,y=()=>{p(l)},b=null==d;b&&r++;const w={...c,style:c.toastStyle,key:i++,...Object.fromEntries(Object.entries(o).filter((e=>{let[t,n]=e;return null!=n}))),toastId:l,updateId:d,data:m,closeToast:y,isIn:!1,className:Me(o.className||c.toastClassName),bodyClassName:Me(o.bodyClassName||c.bodyClassName),progressClassName:Me(o.progressClassName||c.progressClassName),autoClose:!o.isLoading&&(k=o.autoClose,T=c.autoClose,!1===k||De(k)&&k>0?k:T),deleteToast(){const e=u.get(l),{onClose:t,children:i}=e.props;Oe(t)&&t((0,a.isValidElement)(i)&&i.props),n(Ue(e,"removed")),u.delete(l),r--,r<0&&(r=0),s.length>0?f(s.shift()):h()}};var k,T;w.closeButton=c.closeButton,!1===o.closeButton||je(o.closeButton)?w.closeButton=o.closeButton:!0===o.closeButton&&(w.closeButton=!je(c.closeButton)||c.closeButton);let S=t;(0,a.isValidElement)(t)&&!Le(t.type)?S=(0,a.cloneElement)(t,{closeToast:y,toastProps:w,data:m}):Oe(t)&&(S=t({closeToast:y,toastProps:w,data:m}));const E={content:S,props:w,staleId:g};c.limit&&c.limit>0&&r>c.limit&&b?s.push(E):De(v)?setTimeout((()=>{f(E)}),v):f(E)},setProps(e){c=e},setToggle:(e,t)=>{u.get(e).toggle=t},isToastActive:e=>o.some((t=>t===e)),getSnapshot:()=>l}}(t,e,ze);Ve.set(t,i);const r=i.observe(n);return Be.forEach((e=>He(e.content,e.options))),Be=[],()=>{r(),Ve.delete(t)}},setProps(e){var n;null==(n=Ve.get(t))||n.setProps(e)},getSnapshot(){var e;return null==(e=Ve.get(t))?void 0:e.getSnapshot()}}}(e)).current;i(e);const r=(0,a.useSyncExternalStore)(t,n,n);return{getToastToRender:function(t){if(!r)return[];const n=new Map;return e.newestOnTop&&r.reverse(),r.forEach((e=>{const{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)})),Array.from(n,(e=>t(e[0],e[1])))},isToastActive:qe,count:null==r?void 0:r.length}}(t),{className:u,style:d,rtl:h,containerId:p}=t;function f(e){const t=Ne("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":h});return Oe(u)?u({position:e,rtl:h,defaultClassName:t}):Ne(t,Me(u))}function m(){n&&(r(!0),tt.play())}return nt((()=>{if(n){var e;const n=s.current.querySelectorAll('[data-in="true"]'),r=12,o=null==(e=t.position)?void 0:e.includes("top");let a=0,l=0;Array.from(n).reverse().forEach(((e,t)=>{const n=e;n.classList.add("Toastify__toast--stacked"),t>0&&(n.dataset.collapsed=`${i}`),n.dataset.pos||(n.dataset.pos=o?"top":"bot");const s=a*(i?.2:1)+(i?0:r*t);n.style.setProperty("--y",`${o?s:-1*s}px`),n.style.setProperty("--g",`${r}`),n.style.setProperty("--s",""+(1-(i?l:0))),a+=n.offsetHeight,l+=.025}))}}),[i,c,n]),a.createElement("div",{ref:s,className:"Toastify",id:p,onMouseEnter:()=>{n&&(r(!1),tt.pause())},onMouseLeave:m},o(((e,t)=>{const i=t.length?{...d}:{...d,pointerEvents:"none"};return a.createElement("div",{className:f(e),style:i,key:`container-${e}`},t.map((e=>{let{content:t,props:i}=e;return a.createElement(st,{...i,stacked:n,collapseAll:m,isIn:l(i.toastId,i.containerId),style:i.style,key:`toast-${i.key}`},t)})))})))}const ut=n.p+"static/media/logo2.b1c52a06c6d07d81ae1c.jpg";var dt=n(52);(0,dt.KO)("firebase","10.14.1","app");var ht=n(786),pt=n(443),ft=n(700),mt=n(812),gt=n(799);const vt="@firebase/installations",yt="0.6.9",bt=1e4,wt=`w:${yt}`,kt="FIS_v2",Tt=36e5,St={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Et=new ft.FA("installations","Installations",St);function It(e){return e instanceof ft.g&&e.code.includes("request-failed")}function Ct(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Pt(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function At(e,t){const n=(await t.json()).error;return Et.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function _t(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function xt(e,t){let{refreshToken:n}=t;const i=_t(e);return i.append("Authorization",function(e){return`${kt} ${e}`}(n)),i}async function Rt(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Nt(e){return new Promise((t=>{setTimeout(t,e)}))}const Dt=/^[cdef][\w-]{21}$/;function Lt(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Dt.test(t)?t:""}catch(e){return""}}function Ot(e){return`${e.appName}!${e.appId}`}const Mt=new Map;function jt(e,t){const n=Ot(e);Ft(n,t),function(e,t){const n=Vt();n&&n.postMessage({key:e,fid:t});Bt()}(n,t)}function Ft(e,t){const n=Mt.get(e);if(n)for(const i of n)i(t)}let Ut=null;function Vt(){return!Ut&&"BroadcastChannel"in self&&(Ut=new BroadcastChannel("[Firebase] FID Change"),Ut.onmessage=e=>{Ft(e.data.key,e.data.fid)}),Ut}function Bt(){0===Mt.size&&Ut&&(Ut.close(),Ut=null)}const $t="firebase-installations-store";let zt=null;function Gt(){return zt||(zt=(0,gt.P2)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore($t)}})),zt}async function qt(e,t){const n=Ot(e),i=(await Gt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||jt(e,t.fid),t}async function Ht(e){const t=Ot(e),n=(await Gt()).transaction($t,"readwrite");await n.objectStore($t).delete(t),await n.done}async function Wt(e,t){const n=Ot(e),i=(await Gt()).transaction($t,"readwrite"),r=i.objectStore($t),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||jt(e,o.fid),o}async function Kt(e){let t;const n=await Wt(e.appConfig,(n=>{const i=function(e){const t=e||{fid:Lt(),registrationStatus:0};return Yt(t)}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Et.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e,{fid:r}=t;const s=Ct(n),o=_t(n),a=i.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const l={fid:r,authVersion:kt,appId:n.appId,sdkVersion:wt},c={method:"POST",headers:o,body:JSON.stringify(l)},u=await Rt((()=>fetch(s,c)));if(u.ok){const e=await u.json();return{fid:e.fid||r,registrationStatus:2,refreshToken:e.refreshToken,authToken:Pt(e.authToken)}}throw await At("Create Installation",u)}(e,t);return qt(e.appConfig,n)}catch(vC){throw It(vC)&&409===vC.customData.serverCode?await Ht(e.appConfig):await qt(e.appConfig,{fid:t.fid,registrationStatus:0}),vC}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Qt(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Qt(e){let t=await Jt(e.appConfig);for(;1===t.registrationStatus;)await Nt(100),t=await Jt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Kt(e);return n||t}return t}function Jt(e){return Wt(e,(e=>{if(!e)throw Et.create("installation-not-found");return Yt(e)}))}function Yt(e){return 1===(t=e).registrationStatus&&t.registrationTime+bt<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Xt(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e;const r=function(e,t){let{fid:n}=t;return`${Ct(e)}/${n}/authTokens:generate`}(n,t),s=xt(n,t),o=i.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const a={installation:{sdkVersion:wt,appId:n.appId}},l={method:"POST",headers:s,body:JSON.stringify(a)},c=await Rt((()=>fetch(r,l)));if(c.ok){return Pt(await c.json())}throw await At("Generate Auth Token",c)}async function Zt(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await Wt(e.appConfig,(i=>{if(!tn(i))throw Et.create("not-registered");const r=i.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Tt}(e)}(r))return i;if(1===r.requestStatus)return t=async function(e,t){let n=await en(e.appConfig);for(;1===n.authToken.requestStatus;)await Nt(100),n=await en(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Zt(e,t):i}(e,n),i;{if(!navigator.onLine)throw Et.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return t=async function(e,t){try{const n=await Xt(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await qt(e.appConfig,i),n}catch(vC){if(!It(vC)||401!==vC.customData.serverCode&&404!==vC.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await qt(e.appConfig,n)}else await Ht(e.appConfig);throw vC}}(e,n),n}}));return t?await t:i.authToken}function en(e){return Wt(e,(e=>{if(!tn(e))throw Et.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+bt<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function tn(e){return void 0!==e&&2===e.registrationStatus}async function nn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await Kt(e);t&&await t}(n);return(await Zt(n,t)).token}function rn(e){return Et.create("missing-app-config-values",{valueName:e})}const sn="installations",on=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw rn("App Configuration");if(!e.name)throw rn("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw rn(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:(0,dt.j6)(t,"heartbeat"),_delete:()=>Promise.resolve()}},an=e=>{const t=e.getProvider("app").getImmediate(),n=(0,dt.j6)(t,sn).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await Kt(t);return i?i.catch(console.error):Zt(t).catch(console.error),n.fid}(n),getToken:e=>nn(n,e)}};(0,dt.om)(new mt.uA(sn,on,"PUBLIC")),(0,dt.om)(new mt.uA("installations-internal",an,"PRIVATE")),(0,dt.KO)(vt,yt),(0,dt.KO)(vt,yt,"esm2017");const ln="analytics",cn="https://www.googletagmanager.com/gtag/js",un=new pt.Vy("@firebase/analytics"),dn={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},hn=new ft.FA("analytics","Analytics",dn);function pn(e){if(!e.startsWith(cn)){const t=hn.create("invalid-gtag-resource",{gtagURL:e});return un.warn(t.message),""}return e}function fn(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function mn(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:pn}),i=document.createElement("script"),r=`${cn}?l=${e}&id=${t}`;i.src=n?null===n||void 0===n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function gn(e,t,n,i){return async function(r){try{for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];if("event"===r){const[i,r]=o;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await fn(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(vC){un.error(vC)}}(e,t,n,i,r)}else if("config"===r){const[r,s]=o;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await fn(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(vC){un.error(vC)}e("config",r,s)}(e,t,n,i,r,s)}else if("consent"===r){const[t,n]=o;e("consent",t,n)}else if("get"===r){const[t,n,i]=o;e("get",t,n,i)}else if("set"===r){const[t]=o;e("set",t)}else e(r,...o)}catch(vC){un.error(vC)}}}const vn=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function yn(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function bn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn,n=arguments.length>2?arguments[2]:void 0;const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw hn.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw hn.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new kn;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),wn({appId:i,apiKey:r,measurementId:s},o,a,t)}async function wn(e,t,n){let{throttleEndTimeMillis:i,backoffCount:r}=t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vn;var o;const{appId:a,measurementId:l}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(hn.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,i)}catch(vC){if(l)return un.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===vC||void 0===vC?void 0:vC.message}]`),{appId:a,measurementId:l};throw vC}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:yn(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(a){}throw hn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return s.deleteThrottleMetadata(a),t}catch(vC){const i=vC;if(!function(e){if(!(e instanceof ft.g)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i)){if(s.deleteThrottleMetadata(a),l)return un.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===i||void 0===i?void 0:i.message}]`),{appId:a,measurementId:l};throw vC}const c=503===Number(null===(o=null===i||void 0===i?void 0:i.customData)||void 0===o?void 0:o.httpStatus)?(0,ft.p9)(r,s.intervalMillis,30):(0,ft.p9)(r,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:r+1};return s.setThrottleMetadata(a,u),un.debug(`Calling attemptFetch again in ${c} millis`),wn(e,u,n,s)}}class kn{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Tn,Sn;function En(e){Sn=e}function In(e){Tn=e}async function Cn(e,t,n,i,r,s,o){var a;const l=bn(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&un.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>un.error(e))),t.push(l);const c=async function(){if(!(0,ft.zW)())return un.warn(hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,ft.eX)()}catch(vC){return un.warn(hn.create("indexeddb-unavailable",{errorInfo:null===vC||void 0===vC?void 0:vC.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[u,d]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(cn)&&n.src.includes(e))return n;return null})(s)||mn(s,u.measurementId),Sn&&(r("consent","default",Sn),En(void 0)),r("js",new Date);const h=null!==(a=null===o||void 0===o?void 0:o.config)&&void 0!==a?a:{};return h.origin="firebase",h.update=!0,null!=d&&(h.firebase_id=d),r("config",u.measurementId,h),Tn&&(r("set",Tn),In(void 0)),u.measurementId}class Pn{constructor(e){this.app=e}_delete(){return delete An[this.app.options.appId],Promise.resolve()}}let An={},_n=[];const xn={};let Rn,Nn,Dn="dataLayer",Ln="gtag",On=!1;function Mn(e,t,n){!function(){const e=[];if((0,ft.sr)()&&e.push("This is a browser extension environment."),(0,ft.dM)()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=hn.create("invalid-analytics-context",{errorInfo:t});un.warn(n.message)}}();const i=e.options.appId;if(!i)throw hn.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw hn.create("no-api-key");un.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=An[i])throw hn.create("already-exists",{id:i});if(!On){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Dn);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[r]&&"function"===typeof window[r]&&(s=window[r]),window[r]=gn(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(An,_n,xn,Dn,Ln);Nn=e,Rn=t,On=!0}An[i]=Cn(e,_n,xn,t,Rn,Dn,n);return new Pn(e)}function jn(e,t,n,i){e=(0,ft.Ku)(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Nn,An[e.app.options.appId],t,n,i).catch((e=>un.error(e)))}const Fn="@firebase/analytics",Un="0.10.8";(0,dt.om)(new mt.uA(ln,((e,t)=>{let{options:n}=t;return Mn(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),(0,dt.om)(new mt.uA("analytics-internal",(function(e){try{const t=e.getProvider(ln).getImmediate();return{logEvent:(e,n,i)=>jn(t,e,n,i)}}catch(vC){throw hn.create("interop-component-reg-failed",{reason:vC})}}),"PRIVATE")),(0,dt.KO)(Fn,Un),(0,dt.KO)(Fn,Un,"esm2017");var Vn,Bn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},$n={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"===typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=i;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(r[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,r),s=0;break}}else for(;o<t;)if(r[s++]=e[o++],s==this.blockSize){n(this,r),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function s(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new i([0|e],0>e?-1:0)})):new i([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function f(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=v(n),i=v(i);var r=y(n,1),s=y(i,1);for(i=y(i,2),n=y(n,2);!u(i);){var c=s.add(i);0>=c.l(e)&&(r=r.add(n),s=c),i=y(i,1),n=y(n,1)}return t=p(e,r.j(t)),new m(r,t)}for(r=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(s=o(n)).j(t);d(c)||0<c.l(e);)c=(s=o(n-=i)).j(t);u(s)&&(s=l),r=r.add(s),e=p(e,c)}return new m(r,e)}function v(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],o=0;o<r;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new i(s,e.h)}(e=i.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,i="";;){var r=g(n,t).g,s=((0<(n=p(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=p(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var o=r+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var l=this.i(r)>>>16,p=65535&this.i(r),m=e.i(s)>>>16,g=65535&e.i(s);n[2*r+2*s]+=p*g,f(n,2*r+2*s),n[2*r+2*s+1]+=l*g,f(n,2*r+2*s+1),n[2*r+2*s+1]+=p*m,f(n,2*r+2*s+1),n[2*r+2*s+2]+=l*m,f(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,$n.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=o,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=o(Math.pow(n,8)),r=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),r=r.j(l).add(o(c))):r=(r=r.j(i)).add(o(c))}return r},Vn=$n.Integer=i}).apply("undefined"!==typeof Bn?Bn:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var zn,Gn,qn,Hn,Wn,Kn,Qn,Jn,Yn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Xn={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Yn&&Yn];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in r))break e;r=r[o]}(i=i(s=r[e=e[e.length-1]]))!=s&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e,t){return t}))}}));var i=i||{},r=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function f(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function T(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){r.setTimeout((()=>{throw e}),0)}function E(){var e=_;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var I=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new C),(e=>e.reset()));class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let P,A=!1,_=new class{constructor(){this.h=this.g=null}add(e,t){const n=I.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},x=()=>{const e=r.Promise.resolve(void 0);P=()=>{e.then(R)}};var R=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){S(n)}var t=I;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}A=!1};function N(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}N.prototype.s=!1,N.prototype.ma=function(){this.s||(this.s=!0,this.N())},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var L=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var r=!0;break e}catch(eN){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}d(O,D);var M={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var j="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Array.prototype.indexOf.call(r,t,void 0);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function z(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==i)return r}return-1}B.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=z(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new U(t,this.src,s,!!i,r)).fa=n,e.push(t)),t};var G="closure_lm_"+(1e6*Math.random()|0),q={};function H(e,t,n,i,r){if(i&&i.once)return K(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)H(e,t[s],n,i,r);return null}return n=te(n),e&&e[j]?e.K(t,n,o(i)?!!i.capture:!!i,r):W(e,t,n,!1,i,r)}function W(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var a=o(r)?!!r.capture:!!r,l=Z(e);if(l||(e[G]=l=new B(e)),(n=l.add(t,n,i,a,s)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)L||(r=a),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Y(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function K(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)K(e,t[s],n,i,r);return null}return n=te(n),e&&e[j]?e.L(t,n,o(i)?!!i.capture:!!i,r):W(e,t,n,!0,i,r)}function Q(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,i,r);else i=o(i)?!!i.capture:!!i,n=te(n),e&&e[j]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=z(s=e.g[t],n,i,r))&&(V(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=z(t,n,i,r)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[j])$(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Y(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Z(t))?($(n,e),0==n.h&&(n.src=null,t[G]=null)):V(e)}}}function Y(e){return e in q?q[e]:q[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&J(e),e=n.call(i,t)}return e}function Z(e){return(e=e[G])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){N.call(this),this.i=new B(this),this.M=this,this.F=null}function ie(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var r=t;k(t=new D(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=re(o,i,!0,t)&&r}if(r=re(o=t.g=e,i,!0,t)&&r,r=re(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=re(o=t.g=n[s],i,!1,t)&&r}function re(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&$(e.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function oe(e){e.g=se((()=>{e.g=null,e.i&&(e.i=!1,oe(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,N),ne.prototype[j]=!0,ne.prototype.removeEventListener=function(e,t,n,i){Q(this,e,t,n,i)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)V(n[i]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ne.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class ae extends N{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){N.call(this),this.h=e,this.g={}}d(le,N);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&J(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=r.JSON.stringify,he=r.JSON.parse,pe=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function fe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}fe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}d(ye,D),d(be,D);var we={},ke=null;function Te(){return ke=ke||new ne}function Se(e){D.call(this,we.La,e)}function Ee(e){const t=Te();ie(t,new Se(t))}function Ie(e,t){D.call(this,we.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Te();ie(t,new Ie(t,e))}function Pe(e,t){D.call(this,we.Ma,e),this.size=t}function Ae(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout((function(){e()}),t)}function _e(){this.g=!0}function xe(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return de(n)}catch(a){return t}}(e,n)+(i?" "+i:"")}))}we.La="serverreachability",d(Se,D),we.STAT_EVENT="statevent",d(Ie,D),we.Ma="timingevent",d(Pe,D),_e.prototype.xa=function(){this.g=!1},_e.prototype.info=function(){};var Re,Ne={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Le(){}function Oe(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}d(Le,fe),Le.prototype.g=function(){return new XMLHttpRequest},Le.prototype.i=function(){return{}},Re=new Le;var je={},Fe={};function Ue(e,t,n){e.L=1,e.v=dt(ot(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),ze(e),e.A=ot(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),It(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Me,e.g=pn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(ce[0]=r.toString()),r=ce);for(var s=0;s<r.length;s++){var o=H(n,r[s],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&"type"==d[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Fe:(n=Number(t.substring(n,i)),isNaN(n)?je:(i+=1)+n>t.length?Fe:(t=t.slice(i,i+n),e.C=i+n,t))}function ze(e){e.S=Date.now()+e.I,Ge(e,e.I)}function Ge(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ae(c(e.ba,e),t)}function qe(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function He(e){0==e.j.G||e.J||ln(e.j,e)}function We(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ke(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Jt(n)}rn(n),Ce(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ae(c(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&an(n),!f(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(i=1.5*u,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(i.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,ut(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((i=n).qa=hn(i,i.J?i.ia:null,i.W),o.K){tt(i.h,o);var a=o,l=i.L;l&&(a.I=l),a.B&&(qe(a),ze(a)),i.g=o}else nn(i);0<n.i.length&&Xt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ee()}catch(u){}}Oe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},Oe.prototype.Y=function(e){try{if(e==this.g)e:{const h=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ht(this.g)))){this.J||4!=h||7==t||Ee(),qe(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var i=Ht(this.g);e="";var s=i.length,o=4==qt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){We(this),He(this);var a="";break t}this.h.i=new r.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(o&&t==s-1)});i.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!f(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ce(12),We(this),He(this);break e}xe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ke(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=$e(this,a),e==Fe){4==h&&(this.s=4,Ce(14),n=!1),xe(this.i,this.l,null,"[Incomplete Response]");break}if(e==je){this.s=4,Ce(15),xe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}xe(this.i,this.l,e,null),Ke(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(d),d.M=!0,Ce(11))}}else xe(this.i,this.l,a,"[Invalid Chunked Response]"),We(this),He(this)}else xe(this.i,this.l,a,null),Ke(this,a);4==h&&We(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,ze(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(f(e[i]))continue;var n=T(e[i]);const r=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),We(this),He(this)}}}catch(bC){}},Oe.prototype.cancel=function(){this.J=!0,We(this)},Oe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ee(),Ce(17)),We(this),this.s=2,He(this)):Ge(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,r.PerformanceNavigationTiming?e=0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function it(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],n&&n[o],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new kt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(rt))?(this.h=!1,at(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new kt(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof kt?(e.i=t,function(e,t){t&&!e.j&&(Tt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(St(this,t),It(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,bt)),e.i=new kt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ft),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ft(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function kt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Tt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function St(e,t){Tt(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return Tt(e),t=Ct(e,t),e.g.has(t)}function It(e,t,n){St(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),h(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Pt(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(eN){}}function At(){this.g=new pe}function _t(e,t,n){const i=n||"";try{it(e,(function(e,n){let r=e;o(e)&&(r=de(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(vC){throw t.push(i+"type="+encodeURIComponent("_badmap")),vC}}function xt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Rt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Nt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Lt(e)}function Lt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ot(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Mt(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Ot(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function jt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=kt.prototype).add=function(e,t){Tt(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Tt(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},e.na=function(){Tt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){Tt(this);let t=[];if("string"===typeof e)Et(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Tt(this),this.i=null,Et(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.V(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")},d(xt,fe),xt.prototype.g=function(){return new Rt(this.l,this.j)},xt.prototype.i=(mt={},function(){return mt}),d(Rt,ne),(e=Rt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Lt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Lt(this)),this.g&&(this.readyState=3,Lt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):Lt(this),3==this.readyState&&Nt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(jt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Bt(e),zt(e)}function Bt(e){e.A||(e.A=!0,ie(e,"complete"),ie(e,"error"))}function $t(e){if(e.h&&"undefined"!=typeof i&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))se(e.Ea,0,e);else if(ie(e,"readystatechange"),4==qt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===i){var o=String(e.D).match(rt)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),s=!Ft.test(o?o.toLowerCase():"")}n=s}if(n)ie(e,"complete"),ie(e,"success");else{e.m=6;try{var a=2<qt(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Bt(e)}}finally{zt(e)}}}function zt(e,t){if(e.g){Gt(e);const n=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ie(e,"ready");try{n.onreadystatechange=i}catch(vC){}}}function Gt(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function Ht(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Wt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kt(e){this.Aa=0,this.i=[],this.j=new _e,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wt("baseRetryDelayMs",5e3,e),this.cb=Wt("retryDelaySeedMs",1e4,e),this.Wa=Wt("forwardChannelMaxRetries",2,e),this.wa=Wt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new At,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Oe(e,e.j,t)).L=2,t.v=dt(ot(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(ZC){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=pn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),ze(t)}dn(e)}function Jt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Yt(e){Jt(e),e.u&&(r.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"===typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;P||x(),A||(P(),A=!0),_.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const i=ot(e.I);ut(i,"SID",e.K),ut(i,"RID",n),ut(i,"AID",e.T),en(e,i),e.m&&e.o&&Mt(i,e.m,e.o),n=new Oe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,i,t)}function en(e,t){e.H&&y(e.H,(function(e,n){ut(t,n,e)})),e.l&&it({},(function(e,n){ut(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{_t(a,e,"req"+n+"_")}catch(bC){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;P||x(),A||(P(),A=!0),_.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ae(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function on(e){e.g=new Oe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(ot(t)),n.m=null,n.P=!0,Ve(n,e)}function an(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var i=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;ie(i=Te(),new Pe(i,n)),Xt(e)}else nn(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ae(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==i&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new st(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||at(i,"https"),dt(i),t?function(e,t){const n=new _e;if(r.Image){const i=new Image;i.onload=u(Pt,n,"TestLoadImage: loaded",!0,t,i),i.onerror=u(Pt,n,"TestLoadImage: error",!1,t,i),i.onabort=u(Pt,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=u(Pt,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new _e;const n=new AbortController,i=setTimeout((()=>{n.abort(),Pt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(i),e.ok?Pt(0,0,!0,t):Pt(0,0,!1,t)})).catch((()=>{clearTimeout(i),Pt(0,0,!1,t)}))}(i.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),dn(e),Yt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var i=n instanceof st?ot(n):new st(n);if(""!=i.g)t&&(i.g=t+"."+i.g),lt(i,i.s);else{var s=r.location;i=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);i&&at(o,i),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),i=o}return n=e.D,t=e.ya,n&&t&&ut(i,n,t),ut(i,"VER",e.la),en(e,i),i}function pn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new jt(new xt({eb:n})):new jt(e.pa)).Ha(e.J),t}function fn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Kt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!f(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!f(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=jt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?me(this.o):me(Re),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(eN){return void Vt(this,eN)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,o]of n)this.g.setRequestHeader(r,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gt(this),this.u=!0,this.g.send(e),this.u=!1}catch(eN){Vt(this,eN)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ie(this,"complete"),ie(this,"abort"),zt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zt(this,!0)),jt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?$t(this):this.bb())},e.bb=function(){$t(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Kt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){Ce(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=hn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new Oe(this,this.j,e);let s=this.o;if(this.S&&(s?(s=b(s),k(s,this.S)):s=this.S),null!==this.m||this.O||(r.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,r,t),ut(n=ot(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Ot(s)))+"&"+t:this.m&&Mt(n,this.m,s)),et(this.h,r),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),r.T=!0,Ue(r,n,null)):Ue(r,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Ye(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ae(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Jt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Jt(this),rn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=fn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},d(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},d(vn,ye),d(yn,be),d(bn,fn),bn.prototype.ua=function(){ie(this.g,"a")},bn.prototype.ta=function(e){ie(this.g,new vn(e))},bn.prototype.sa=function(e){ie(this.g,new yn)},bn.prototype.ra=function(){ie(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Jn=Xn.createWebChannelTransport=function(){return new mn},Qn=Xn.getStatEventTarget=function(){return Te()},Kn=Xn.Event=we,Wn=Xn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Hn=Xn.ErrorCode=Ne,De.COMPLETE="complete",qn=Xn.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Gn=Xn.WebChannel=ge,Xn.FetchXmlHttpFactory=xt,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,zn=Xn.XhrIo=jt}).apply("undefined"!==typeof Yn?Yn:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Zn="@firebase/firestore";class ei{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ei.UNAUTHENTICATED=new ei(null),ei.GOOGLE_CREDENTIALS=new ei("google-credentials-uid"),ei.FIRST_PARTY=new ei("first-party-uid"),ei.MOCK_USER=new ei("mock-user");let ti="10.14.0";const ni=new pt.Vy("@firebase/firestore");function ii(){return ni.logLevel}function ri(e){if(ni.logLevel<=pt.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(ai);ni.debug(`Firestore (${ti}): ${e}`,...r)}}function si(e){if(ni.logLevel<=pt.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(ai);ni.error(`Firestore (${ti}): ${e}`,...r)}}function oi(e){if(ni.logLevel<=pt.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(ai);ni.warn(`Firestore (${ti}): ${e}`,...r)}}function ai(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(wC){return e}}function li(){const e=`FIRESTORE (${ti}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw si(e),new Error(e)}function ci(e,t){e||li()}function ui(e,t){return e}const di={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class hi extends ft.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class fi{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ei.UNAUTHENTICATED)))}shutdown(){}}class gi{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vi{constructor(e){this.t=e,this.currentUser=ei.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ci(void 0===this.o);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new pi,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{ri("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(ri("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new pi)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(ri("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ci("string"==typeof t.accessToken),new fi(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ci(null===e||"string"==typeof e),new ei(e)}}class yi{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=ei.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class bi{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new yi(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(ei.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wi{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ki{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ci(void 0===this.o);const n=e=>{null!=e.error&&ri("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,ri("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{ri("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):ri("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(ci("string"==typeof e.token),this.R=e.token,new wi(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ti(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}class Si{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Ti(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%62))}return n}}function Ei(e,t){return e<t?-1:e>t?1:0}function Ii(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}function Ci(e){return e+"\0"}class Pi{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new hi(di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new hi(di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new hi(di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new hi(di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Pi.fromMillis(Date.now())}static fromDate(e){return Pi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Pi(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ei(this.nanoseconds,e.nanoseconds):Ei(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ai{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ai(e)}static min(){return new Ai(new Pi(0,0))}static max(){return new Ai(new Pi(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class _i{constructor(e,t,n){void 0===t?t=0:t>e.length&&li(),void 0===n?n=e.length-t:n>e.length-t&&li(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===_i.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _i?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class xi extends _i{construct(e,t,n){return new xi(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n){if(r.indexOf("//")>=0)throw new hi(di.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((e=>e.length>0)))}return new xi(e)}static emptyPath(){return new xi([])}}const Ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ni extends _i{construct(e,t,n){return new Ni(e,t,n)}static isValidIdentifier(e){return Ri.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ni.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ni(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new hi(di.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new hi(di.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new hi(di.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new hi(di.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ni(t)}static emptyPath(){return new Ni([])}}class Di{constructor(e){this.path=e}static fromPath(e){return new Di(xi.fromString(e))}static fromName(e){return new Di(xi.fromString(e).popFirst(5))}static empty(){return new Di(xi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===xi.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return xi.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Di(new xi(e.slice()))}}class Li{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Oi(e){return e.fields.find((e=>2===e.kind))}function Mi(e){return e.fields.filter((e=>2!==e.kind))}Li.UNKNOWN_ID=-1;class ji{constructor(e,t){this.fieldPath=e,this.kind=t}}class Fi{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Fi(0,Bi.min())}}function Ui(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Ai.fromTimestamp(1e9===i?new Pi(n+1,0):new Pi(n,i));return new Bi(r,Di.empty(),t)}function Vi(e){return new Bi(e.readTime,e.key,-1)}class Bi{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Bi(Ai.min(),Di.empty(),-1)}static max(){return new Bi(Ai.max(),Di.empty(),-1)}}function $i(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Di.comparator(e.documentKey,t.documentKey),0!==n?n:Ei(e.largestBatchId,t.largestBatchId))}const zi="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gi{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function qi(e){if(e.code!==di.FAILED_PRECONDITION||e.message!==zi)throw e;ri("LocalStore","Unexpectedly lost primary lease")}class Hi{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&li(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Hi(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Hi?t:Hi.resolve(t)}catch(e){return Hi.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Hi.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Hi.reject(t)}static resolve(e){return new Hi(((t,n)=>{t(e)}))}static reject(e){return new Hi(((t,n)=>{n(e)}))}static waitFor(e){return new Hi(((t,n)=>{let i=0,r=0,s=!1;e.forEach((e=>{++i,e.next((()=>{++r,s&&r===i&&t()}),(e=>n(e)))})),s=!0,r===i&&t()}))}static or(e){let t=Hi.resolve(!1);for(const n of e)t=t.next((e=>e?Hi.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new Hi(((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===r&&n(s)}),(e=>i(e)))}}))}static doWhile(e,t){return new Hi(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}class Wi{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new pi,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Yi(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=nr(t.target.error);this.V.reject(new Yi(e,n))}}static open(e,t,n,i){try{return new Wi(t,e.transaction(i,n))}catch(e){throw new Yi(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ri("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Zi(t)}}class Ki{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===Ki.S((0,ft.ZQ)())&&si("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ri("SimpleDb","Removing database:",e),er(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,ft.zW)())return!1;if(Ki.v())return!0;const e=(0,ft.ZQ)(),t=Ki.S(e),n=0<t&&t<10,i=Qi(e),r=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||r)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(ri("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{const n=e.target.result;t(n)},i.onblocked=()=>{n(new Yi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=t=>{const i=t.target.error;"VersionError"===i.name?n(new hi(di.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new hi(di.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new Yi(e,i))},i.onupgradeneeded=e=>{ri("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,i.transaction,e.oldVersion,this.version).next((()=>{ri("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const r="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.M(e);const t=Wi.open(this.db,e,r?"readonly":"readwrite",n),s=i(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Hi.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(ri("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Qi(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Ji{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return er(this.B.delete())}}class Yi extends hi{constructor(e,t){super(di.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Xi(e){return"IndexedDbTransactionError"===e.name}class Zi{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(ri("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(ri("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),er(n)}add(e){return ri("SimpleDb","ADD",this.store.name,e,e),er(this.store.add(e))}get(e){return er(this.store.get(e)).next((t=>(void 0===t&&(t=null),ri("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return ri("SimpleDb","DELETE",this.store.name,e),er(this.store.delete(e))}count(){return ri("SimpleDb","COUNT",this.store.name),er(this.store.count())}U(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const e=i.getAll(n.range);return new Hi(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.W(e,((e,n)=>{t.push(n)})).next((()=>t))}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Hi(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}j(e,t){ri("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const i=this.cursor(n);return this.W(i,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.W(i,t)}Y(e){const t=this.cursor({});return new Hi(((n,i)=>{t.onerror=e=>{const t=nr(e.target.error);i(t)},t.onsuccess=t=>{const i=t.target.result;i?e(i.primaryKey,i.value).next((e=>{e?i.continue():n()})):n()}}))}W(e,t){const n=[];return new Hi(((i,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{const r=e.target.result;if(!r)return void i();const s=new Ji(r),o=t(r.primaryKey,r.value,s);if(o instanceof Hi){const e=o.catch((e=>(s.done(),Hi.reject(e))));n.push(e)}s.isDone?i():null===s.K?r.continue():r.continue(s.K)}})).next((()=>Hi.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function er(e){return new Hi(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=nr(e.target.error);n(t)}}))}let tr=!1;function nr(e){const t=Ki.S((0,ft.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new hi("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return tr||(tr=!0,setTimeout((()=>{throw e}),0)),e}}return e}class ir{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){ri("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{ri("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Xi(e)?ri("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await qi(e)}await this.X(6e4)}))}}class rr{constructor(e,t){this.localStore=e,this.persistence=t}async ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const n=new Set;let i=t,r=!0;return Hi.doWhile((()=>!0===r&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return ri("IndexBackfiller",`Processing collection: ${t}`),this.ne(e,t,i).next((e=>{i-=e,n.add(t)}));r=!1})))).next((()=>t-i))}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next((n=>{const r=n.changes;return this.localStore.indexManager.updateIndexEntries(e,r).next((()=>this.re(i,n))).next((n=>(ri("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>r.size))}))))}re(e,t){let n=e;return t.changes.forEach(((e,t)=>{const i=Vi(t);$i(i,n)>0&&(n=i)})),new Bi(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class sr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function or(e){return null==e}function ar(e){return 0===e&&1/e==-1/0}function lr(e){return"number"==typeof e&&Number.isInteger(e)&&!ar(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function cr(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=dr(t)),t=ur(e.get(n),t);return dr(t)}function ur(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const t=e.charAt(r);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function dr(e){return e+"\x01\x01"}function hr(e){const t=e.length;if(ci(t>=2),2===t)return ci("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),xi.emptyPath();const n=t-2,i=[];let r="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&li(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===r.length?o=n:(r+=n,o=r,r=""),i.push(o);break;case"\x10":r+=e.substring(s,t),r+="\0";break;case"\x11":r+=e.substring(s,t+1);break;default:li()}s=t+2}return new xi(i)}sr.oe=-1;const pr=["userId","batchId"];function fr(e,t){return[e,cr(t)]}function mr(e,t,n){return[e,cr(t),n]}const gr={},vr=["prefixPath","collectionGroup","readTime","documentId"],yr=["prefixPath","collectionGroup","documentId"],br=["collectionGroup","readTime","prefixPath","documentId"],wr=["canonicalId","targetId"],kr=["targetId","path"],Tr=["path","targetId"],Sr=["collectionId","parent"],Er=["indexId","uid"],Ir=["uid","sequenceNumber"],Cr=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Pr=["indexId","uid","orderedDocumentKey"],Ar=["userId","collectionPath","documentId"],_r=["userId","collectionPath","largestBatchId"],xr=["userId","collectionGroup","largestBatchId"],Rr=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Nr=[...Rr,"documentOverlays"],Dr=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Lr=Dr,Or=[...Lr,"indexConfiguration","indexState","indexEntries"],Mr=Or,jr=[...Or,"globals"];class Fr extends Gi{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Ur(e,t){const n=ui(e);return Ki.F(n._e,t)}function Vr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Br(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function $r(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class zr{constructor(e,t){this.comparator=e,this.root=t||qr.EMPTY}insert(e,t){return new zr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qr.BLACK,null,null))}remove(e){return new zr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gr(this.root,e,this.comparator,!0)}}class Gr{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qr{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:qr.RED,this.left=null!=i?i:qr.EMPTY,this.right=null!=r?r:qr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new qr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return qr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw li();if(this.right.isRed())throw li();const e=this.left.check();if(e!==this.right.check())throw li();return e+(this.isRed()?0:1)}}qr.EMPTY=null,qr.RED=!0,qr.BLACK=!1,qr.EMPTY=new class{constructor(){this.size=0}get key(){throw li()}get value(){throw li()}get color(){throw li()}get left(){throw li()}get right(){throw li()}copy(e,t,n,i,r){return this}insert(e,t,n){return new qr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hr{constructor(e){this.comparator=e,this.data=new zr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wr(this.data.getIterator())}getIteratorFrom(e){return new Wr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Hr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Hr(this.comparator);return t.data=e,t}}class Wr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Kr(e){return e.hasNext()?e.getNext():void 0}class Qr{constructor(e){this.fields=e,e.sort(Ni.comparator)}static empty(){return new Qr([])}unionWith(e){let t=new Hr(Ni.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Qr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ii(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Jr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Jr("Invalid base64 string: "+e):e}}(e);return new Yr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ei(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const Xr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zr(e){if(ci(!!e),"string"==typeof e){let t=0;const n=Xr.exec(e);if(ci(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:es(e.seconds),nanos:es(e.nanos)}}function es(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ts(e){return"string"==typeof e?Yr.fromBase64String(e):Yr.fromUint8Array(e)}function ns(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function is(e){const t=e.mapValue.fields.__previous_value__;return ns(t)?is(t):t}function rs(e){const t=Zr(e.mapValue.fields.__local_write_time__.timestampValue);return new Pi(t.seconds,t.nanos)}class ss{constructor(e,t,n,i,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class os{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new os("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof os&&e.projectId===this.projectId&&e.database===this.database}}const as={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ls={nullValue:"NULL_VALUE"};function cs(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ns(e)?4:Is(e)?9007199254740991:Ss(e)?10:11:li()}function us(e,t){if(e===t)return!0;const n=cs(e);if(n!==cs(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return rs(e).isEqual(rs(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Zr(e.timestampValue),i=Zr(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ts(e.bytesValue).isEqual(ts(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return es(e.geoPointValue.latitude)===es(t.geoPointValue.latitude)&&es(e.geoPointValue.longitude)===es(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return es(e.integerValue)===es(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=es(e.doubleValue),i=es(t.doubleValue);return n===i?ar(n)===ar(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Ii(e.arrayValue.values||[],t.arrayValue.values||[],us);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Vr(n)!==Vr(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!us(n[r],i[r])))return!1;return!0}(e,t);default:return li()}}function ds(e,t){return void 0!==(e.values||[]).find((e=>us(e,t)))}function hs(e,t){if(e===t)return 0;const n=cs(e),i=cs(t);if(n!==i)return Ei(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ei(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=es(e.integerValue||e.doubleValue),i=es(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return ps(e.timestampValue,t.timestampValue);case 4:return ps(rs(e),rs(t));case 5:return Ei(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ts(e),i=ts(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=Ei(n[r],i[r]);if(0!==e)return e}return Ei(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ei(es(e.latitude),es(t.latitude));return 0!==n?n:Ei(es(e.longitude),es(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return fs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,r,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,c=null===(i=a.value)||void 0===i?void 0:i.arrayValue,u=Ei((null===(r=null==l?void 0:l.values)||void 0===r?void 0:r.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:fs(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===as.mapValue&&t===as.mapValue)return 0;if(e===as.mapValue)return 1;if(t===as.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const e=Ei(i[o],s[o]);if(0!==e)return e;const t=hs(n[i[o]],r[s[o]]);if(0!==t)return t}return Ei(i.length,s.length)}(e.mapValue,t.mapValue);default:throw li()}}function ps(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ei(e,t);const n=Zr(e),i=Zr(t),r=Ei(n.seconds,i.seconds);return 0!==r?r:Ei(n.nanos,i.nanos)}function fs(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=hs(n[r],i[r]);if(e)return e}return Ei(n.length,i.length)}function ms(e){return gs(e)}function gs(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Zr(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ts(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Di.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=gs(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${gs(e.fields[r])}`;return n+"}"}(e.mapValue):li()}function vs(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function ys(e){return!!e&&"integerValue"in e}function bs(e){return!!e&&"arrayValue"in e}function ws(e){return!!e&&"nullValue"in e}function ks(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ts(e){return!!e&&"mapValue"in e}function Ss(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Es(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Br(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Es(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Es(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Is(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}const Cs={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Ps(e){return"nullValue"in e?ls:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?vs(os.empty(),Di.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Ss(e)?Cs:{mapValue:{}}:li()}function As(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?vs(os.empty(),Di.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Cs:"mapValue"in e?Ss(e)?{mapValue:{}}:as:li()}function _s(e,t){const n=hs(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function xs(e,t){const n=hs(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ts(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Es(t)}setAll(e){let t=Ni.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=Es(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Ts(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Ts(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Br(t,((t,n)=>e[t]=n));for(const i of n)delete e[i]}clone(){return new Rs(Es(this.value))}}function Ns(e){const t=[];return Br(e.fields,((e,n)=>{const i=new Ni([e]);if(Ts(n)){const e=Ns(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new Qr(t)}class Ds{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ds(e,0,Ai.min(),Ai.min(),Ai.min(),Rs.empty(),0)}static newFoundDocument(e,t,n,i){return new Ds(e,1,t,Ai.min(),n,i,0)}static newNoDocument(e,t){return new Ds(e,2,t,Ai.min(),Ai.min(),Rs.empty(),0)}static newUnknownDocument(e,t){return new Ds(e,3,t,Ai.min(),Ai.min(),Rs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ai.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ai.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ds&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ds(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ls{constructor(e,t){this.position=e,this.inclusive=t}}function Os(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?Di.comparator(Di.fromName(o.referenceValue),n.key):hs(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function Ms(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!us(e.position[n],t.position[n]))return!1;return!0}class js{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Fs(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Us{}class Vs extends Us{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Js(e,t,n):"array-contains"===t?new eo(e,n):"in"===t?new to(e,n):"not-in"===t?new no(e,n):"array-contains-any"===t?new io(e,n):new Vs(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Ys(e,n):new Xs(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(hs(t,this.value)):null!==t&&cs(this.value)===cs(t)&&this.matchesComparison(hs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return li()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bs extends Us{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Bs(e,t)}matches(e){return $s(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function $s(e){return"and"===e.op}function zs(e){return"or"===e.op}function Gs(e){return qs(e)&&$s(e)}function qs(e){for(const t of e.filters)if(t instanceof Bs)return!1;return!0}function Hs(e){if(e instanceof Vs)return e.field.canonicalString()+e.op.toString()+ms(e.value);if(Gs(e))return e.filters.map((e=>Hs(e))).join(",");{const t=e.filters.map((e=>Hs(e))).join(",");return`${e.op}(${t})`}}function Ws(e,t){return e instanceof Vs?function(e,t){return t instanceof Vs&&e.op===t.op&&e.field.isEqual(t.field)&&us(e.value,t.value)}(e,t):e instanceof Bs?function(e,t){return t instanceof Bs&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&Ws(n,t.filters[i])),!0)}(e,t):void li()}function Ks(e,t){const n=e.filters.concat(t);return Bs.create(n,e.op)}function Qs(e){return e instanceof Vs?function(e){return`${e.field.canonicalString()} ${e.op} ${ms(e.value)}`}(e):e instanceof Bs?function(e){return e.op.toString()+" {"+e.getFilters().map(Qs).join(" ,")+"}"}(e):"Filter"}class Js extends Vs{constructor(e,t,n){super(e,t,n),this.key=Di.fromName(n.referenceValue)}matches(e){const t=Di.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ys extends Vs{constructor(e,t){super(e,"in",t),this.keys=Zs("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Xs extends Vs{constructor(e,t){super(e,"not-in",t),this.keys=Zs("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Zs(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Di.fromName(e.referenceValue)))}class eo extends Vs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bs(t)&&ds(t.arrayValue,this.value)}}class to extends Vs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ds(this.value.arrayValue,t)}}class no extends Vs{constructor(e,t){super(e,"not-in",t)}matches(e){if(ds(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ds(this.value.arrayValue,t)}}class io extends Vs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>ds(this.value.arrayValue,e)))}}class ro{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ue=null}}function so(e){return new ro(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function oo(e){const t=ui(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Hs(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),or(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>ms(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>ms(e))).join(",")),t.ue=e}return t.ue}function ao(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Fs(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ws(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ms(e.startAt,t.startAt)&&Ms(e.endAt,t.endAt)}function lo(e){return Di.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function co(e,t){return e.filters.filter((e=>e instanceof Vs&&e.field.isEqual(t)))}function uo(e,t,n){let i=ls,r=!0;for(const s of co(e,t)){let e=ls,t=!0;switch(s.op){case"<":case"<=":e=Ps(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=ls}_s({value:i,inclusive:r},{value:e,inclusive:t})<0&&(i=e,r=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];_s({value:i,inclusive:r},{value:e,inclusive:n.inclusive})<0&&(i=e,r=n.inclusive);break}return{value:i,inclusive:r}}function ho(e,t,n){let i=as,r=!0;for(const s of co(e,t)){let e=as,t=!0;switch(s.op){case">=":case">":e=As(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=as}xs({value:i,inclusive:r},{value:e,inclusive:t})>0&&(i=e,r=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];xs({value:i,inclusive:r},{value:e,inclusive:n.inclusive})>0&&(i=e,r=n.inclusive);break}return{value:i,inclusive:r}}class po{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function fo(e,t,n,i,r,s,o,a){return new po(e,t,n,i,r,s,o,a)}function mo(e){return new po(e)}function go(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function vo(e){return null!==e.collectionGroup}function yo(e){const t=ui(e);if(null===t.ce){t.ce=[];const e=new Set;for(const r of t.explicitOrderBy)t.ce.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",i=function(e){let t=new Hr(Ni.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);i.forEach((i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new js(i,n))})),e.has(Ni.keyField().canonicalString())||t.ce.push(new js(Ni.keyField(),n))}return t.ce}function bo(e){const t=ui(e);return t.le||(t.le=wo(t,yo(e))),t.le}function wo(e,t){if("F"===e.limitType)return so(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new js(e.field,t)}));const n=e.endAt?new Ls(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Ls(e.startAt.position,e.startAt.inclusive):null;return so(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function ko(e,t,n){return new po(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function To(e,t){return ao(bo(e),bo(t))&&e.limitType===t.limitType}function So(e){return`${oo(bo(e))}|lt:${e.limitType}`}function Eo(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Qs(e))).join(", ")}]`),or(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>ms(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>ms(e))).join(",")),`Target(${t})`}(bo(e))}; limitType=${e.limitType})`}function Io(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Di.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of yo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=Os(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,yo(e),t))&&!(e.endAt&&!function(e,t,n){const i=Os(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,yo(e),t))}(e,t)}function Co(e){return(t,n)=>{let i=!1;for(const r of yo(e)){const e=Po(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function Po(e,t,n){const i=e.field.isKeyField()?Di.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?hs(i,r):li()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return li()}}class Ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Br(this.inner,((t,n)=>{for(const[i,r]of n)e(i,r)}))}isEmpty(){return $r(this.inner)}size(){return this.innerSize}}const _o=new zr(Di.comparator);function xo(){return _o}const Ro=new zr(Di.comparator);function No(){let e=Ro;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.insert(r.key,r);return e}function Do(e){let t=Ro;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Lo(){return Mo()}function Oo(){return Mo()}function Mo(){return new Ao((e=>e.toString()),((e,t)=>e.isEqual(t)))}const jo=new zr(Di.comparator),Fo=new Hr(Di.comparator);function Uo(){let e=Fo;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.add(r);return e}const Vo=new Hr(Ei);function Bo(){return Vo}function $o(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ar(t)?"-0":t}}function zo(e){return{integerValue:""+e}}function Go(e,t){return lr(t)?zo(t):$o(e,t)}class qo{constructor(){this._=void 0}}function Ho(e,t,n){return e instanceof Qo?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ns(t)&&(t=is(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Jo?Yo(e,t):e instanceof Xo?Zo(e,t):function(e,t){const n=Ko(e,t),i=ta(n)+ta(e.Pe);return ys(n)&&ys(e.Pe)?zo(i):$o(e.serializer,i)}(e,t)}function Wo(e,t,n){return e instanceof Jo?Yo(e,t):e instanceof Xo?Zo(e,t):n}function Ko(e,t){return e instanceof ea?function(e){return ys(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Qo extends qo{}class Jo extends qo{constructor(e){super(),this.elements=e}}function Yo(e,t){const n=na(t);for(const i of e.elements)n.some((e=>us(e,i)))||n.push(i);return{arrayValue:{values:n}}}class Xo extends qo{constructor(e){super(),this.elements=e}}function Zo(e,t){let n=na(t);for(const i of e.elements)n=n.filter((e=>!us(e,i)));return{arrayValue:{values:n}}}class ea extends qo{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function ta(e){return es(e.integerValue||e.doubleValue)}function na(e){return bs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class ia{constructor(e,t){this.field=e,this.transform=t}}class ra{constructor(e,t){this.version=e,this.transformResults=t}}class sa{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sa}static exists(e){return new sa(void 0,e)}static updateTime(e){return new sa(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oa(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class aa{}function la(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ya(e.key,sa.none()):new pa(e.key,e.data,sa.none());{const n=e.data,i=Rs.empty();let r=new Hr(Ni.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new fa(e.key,i,new Qr(r.toArray()),sa.none())}}function ca(e,t,n){e instanceof pa?function(e,t,n){const i=e.value.clone(),r=ga(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof fa?function(e,t,n){if(!oa(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=ga(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(ma(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ua(e,t,n,i){return e instanceof pa?function(e,t,n,i){if(!oa(e.precondition,t))return n;const r=e.value.clone(),s=va(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof fa?function(e,t,n,i){if(!oa(e.precondition,t))return n;const r=va(e.fieldTransforms,i,t),s=t.data;return s.setAll(ma(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return oa(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function da(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=Ko(i.transform,e||null);null!=r&&(null===n&&(n=Rs.empty()),n.set(i.field,r))}return n||null}function ha(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ii(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Jo&&t instanceof Jo||e instanceof Xo&&t instanceof Xo?Ii(e.elements,t.elements,us):e instanceof ea&&t instanceof ea?us(e.Pe,t.Pe):e instanceof Qo&&t instanceof Qo}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class pa extends aa{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fa extends aa{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function ma(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function ga(e,t,n){const i=new Map;ci(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,Wo(o,a,n[r]))}return i}function va(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,Ho(e,s,t))}return i}class ya extends aa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ba extends aa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class wa{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&ca(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ua(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ua(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Oo();return this.mutations.forEach((i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=la(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Ai.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Uo())}isEqual(e){return this.batchId===e.batchId&&Ii(this.mutations,e.mutations,((e,t)=>ha(e,t)))&&Ii(this.baseMutations,e.baseMutations,((e,t)=>ha(e,t)))}}class ka{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ci(e.mutations.length===n.length);let i=jo;const r=e.mutations;for(let s=0;s<r.length;s++)i=i.insert(r[s].key,n[s].version);return new ka(e,t,n,i)}}class Ta{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var Sa,Ea;function Ia(e){switch(e){default:return li();case di.CANCELLED:case di.UNKNOWN:case di.DEADLINE_EXCEEDED:case di.RESOURCE_EXHAUSTED:case di.INTERNAL:case di.UNAVAILABLE:case di.UNAUTHENTICATED:return!1;case di.INVALID_ARGUMENT:case di.NOT_FOUND:case di.ALREADY_EXISTS:case di.PERMISSION_DENIED:case di.FAILED_PRECONDITION:case di.ABORTED:case di.OUT_OF_RANGE:case di.UNIMPLEMENTED:case di.DATA_LOSS:return!0}}function Ca(e){if(void 0===e)return si("GRPC error has no .code"),di.UNKNOWN;switch(e){case Sa.OK:return di.OK;case Sa.CANCELLED:return di.CANCELLED;case Sa.UNKNOWN:return di.UNKNOWN;case Sa.DEADLINE_EXCEEDED:return di.DEADLINE_EXCEEDED;case Sa.RESOURCE_EXHAUSTED:return di.RESOURCE_EXHAUSTED;case Sa.INTERNAL:return di.INTERNAL;case Sa.UNAVAILABLE:return di.UNAVAILABLE;case Sa.UNAUTHENTICATED:return di.UNAUTHENTICATED;case Sa.INVALID_ARGUMENT:return di.INVALID_ARGUMENT;case Sa.NOT_FOUND:return di.NOT_FOUND;case Sa.ALREADY_EXISTS:return di.ALREADY_EXISTS;case Sa.PERMISSION_DENIED:return di.PERMISSION_DENIED;case Sa.FAILED_PRECONDITION:return di.FAILED_PRECONDITION;case Sa.ABORTED:return di.ABORTED;case Sa.OUT_OF_RANGE:return di.OUT_OF_RANGE;case Sa.UNIMPLEMENTED:return di.UNIMPLEMENTED;case Sa.DATA_LOSS:return di.DATA_LOSS;default:return li()}}(Ea=Sa||(Sa={}))[Ea.OK=0]="OK",Ea[Ea.CANCELLED=1]="CANCELLED",Ea[Ea.UNKNOWN=2]="UNKNOWN",Ea[Ea.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ea[Ea.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ea[Ea.NOT_FOUND=5]="NOT_FOUND",Ea[Ea.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ea[Ea.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ea[Ea.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ea[Ea.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ea[Ea.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ea[Ea.ABORTED=10]="ABORTED",Ea[Ea.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ea[Ea.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ea[Ea.INTERNAL=13]="INTERNAL",Ea[Ea.UNAVAILABLE=14]="UNAVAILABLE",Ea[Ea.DATA_LOSS=15]="DATA_LOSS";new Vn([4294967295,4294967295],0);Error;const Pa={asc:"ASCENDING",desc:"DESCENDING"},Aa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_a={and:"AND",or:"OR"};class xa{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ra(e,t){return e.useProto3Json||or(t)?t:{value:t}}function Na(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Da(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function La(e,t){return Na(e,t.toTimestamp())}function Oa(e){return ci(!!e),Ai.fromTimestamp(function(e){const t=Zr(e);return new Pi(t.seconds,t.nanos)}(e))}function Ma(e,t){return ja(e,t).canonicalString()}function ja(e,t){const n=function(e){return new xi(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Fa(e){const t=xi.fromString(e);return ci(ol(t)),t}function Ua(e,t){return Ma(e.databaseId,t.path)}function Va(e,t){const n=Fa(t);if(n.get(1)!==e.databaseId.projectId)throw new hi(di.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new hi(di.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Di(Ga(n))}function Ba(e,t){return Ma(e.databaseId,t)}function $a(e){const t=Fa(e);return 4===t.length?xi.emptyPath():Ga(t)}function za(e){return new xi(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ga(e){return ci(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function qa(e,t,n){return{name:Ua(e,t),fields:n.value.mapValue.fields}}function Ha(e,t,n){const i=Va(e,t.name),r=Oa(t.updateTime),s=t.createTime?Oa(t.createTime):Ai.min(),o=new Rs({mapValue:{fields:t.fields}}),a=Ds.newFoundDocument(i,r,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Wa(e,t){let n;if(t instanceof pa)n={update:qa(e,t.key,t.value)};else if(t instanceof ya)n={delete:Ua(e,t.key)};else if(t instanceof fa)n={update:qa(e,t.key,t.data),updateMask:sl(t.fieldMask)};else{if(!(t instanceof ba))return li();n={verify:Ua(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Qo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Jo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Xo)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ea)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw li()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:La(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:li()}(e,t.precondition)),n}function Ka(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?sa.updateTime(Oa(e.updateTime)):void 0!==e.exists?sa.exists(e.exists):sa.none()}(t.currentDocument):sa.none(),i=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)ci("REQUEST_TIME"===t.setToServerValue),n=new Qo;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Jo(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Xo(e)}else"increment"in t?n=new ea(e,t.increment):li();const i=Ni.fromServerFormat(t.fieldPath);return new ia(i,n)}(e,t))):[];if(t.update){t.update.name;const r=Va(e,t.update.name),s=new Rs({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Qr(t.map((e=>Ni.fromServerFormat(e))))}(t.updateMask);return new fa(r,s,e,n,i)}return new pa(r,s,n,i)}if(t.delete){const i=Va(e,t.delete);return new ya(i,n)}if(t.verify){const i=Va(e,t.verify);return new ba(i,n)}return li()}function Qa(e,t){return{documents:[Ba(e,t.path)]}}function Ja(e,t){const n={structuredQuery:{}},i=t.path;let r;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Ba(e,r);const s=function(e){if(0!==e.length)return rl(Bs.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:nl(e.field),direction:Za(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ra(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:r}}function Ya(e){let t=$a(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ci(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Xa(e);return t instanceof Bs&&Gs(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new js(il(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,or(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Ls(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Ls(n,t)}(n.endAt)),fo(t,r,o,s,a,"F",l,c)}function Xa(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=il(e.unaryFilter.field);return Vs.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=il(e.unaryFilter.field);return Vs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=il(e.unaryFilter.field);return Vs.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=il(e.unaryFilter.field);return Vs.create(r,"!=",{nullValue:"NULL_VALUE"});default:return li()}}(e):void 0!==e.fieldFilter?function(e){return Vs.create(il(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return li()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Bs.create(e.compositeFilter.filters.map((e=>Xa(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return li()}}(e.compositeFilter.op))}(e):li()}function Za(e){return Pa[e]}function el(e){return Aa[e]}function tl(e){return _a[e]}function nl(e){return{fieldPath:e.canonicalString()}}function il(e){return Ni.fromServerFormat(e.fieldPath)}function rl(e){return e instanceof Vs?function(e){if("=="===e.op){if(ks(e.value))return{unaryFilter:{field:nl(e.field),op:"IS_NAN"}};if(ws(e.value))return{unaryFilter:{field:nl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ks(e.value))return{unaryFilter:{field:nl(e.field),op:"IS_NOT_NAN"}};if(ws(e.value))return{unaryFilter:{field:nl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nl(e.field),op:el(e.op),value:e.value}}}(e):e instanceof Bs?function(e){const t=e.getFilters().map((e=>rl(e)));return 1===t.length?t[0]:{compositeFilter:{op:tl(e.op),filters:t}}}(e):li()}function sl(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function ol(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class al{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ai.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ai.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Yr.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new al(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new al(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new al(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new al(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ll{constructor(e){this.ct=e}}function cl(e,t){const n=t.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ul(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document=function(e,t){return{name:Ua(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Na(e,t.version.toTimestamp()),createTime:Na(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:dl(t.version)};else{if(!t.isUnknownDocument())return li();i.unknownDocument={path:n.path.toArray(),version:dl(t.version)}}return i}function ul(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function dl(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function hl(e){const t=new Pi(e.seconds,e.nanoseconds);return Ai.fromTimestamp(t)}function pl(e,t){const n=(t.baseMutations||[]).map((t=>Ka(e.ct,t)));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const i=t.mutations.map((t=>Ka(e.ct,t))),r=Pi.fromMillis(t.localWriteTimeMs);return new wa(t.batchId,r,n,i)}function fl(e){const t=hl(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?hl(e.lastLimboFreeSnapshotVersion):Ai.min();let i;return i=function(e){return void 0!==e.documents}(e.query)?function(e){return ci(1===e.documents.length),bo(mo($a(e.documents[0])))}(e.query):function(e){return bo(Ya(e))}(e.query),new al(i,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Yr.fromBase64String(e.resumeToken))}function ml(e,t){const n=dl(t.snapshotVersion),i=dl(t.lastLimboFreeSnapshotVersion);let r;r=lo(t.target)?Qa(e.ct,t.target):Ja(e.ct,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:oo(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function gl(e){const t=Ya({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ko(t,t.limit,"L"):t}function vl(e,t){return new Ta(t.largestBatchId,Ka(e.ct,t.overlayMutation))}function yl(e,t){const n=t.path.lastSegment();return[e,cr(t.path.popLast()),n]}function bl(e,t,n,i){return{indexId:e,uid:t,sequenceNumber:n,readTime:dl(i.readTime),documentKey:cr(i.documentKey.path),largestBatchId:i.largestBatchId}}class wl{getBundleMetadata(e,t){return kl(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:hl(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return kl(e).put(function(e){return{bundleId:e.id,createTime:dl(Oa(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Tl(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:gl(e.bundledQuery),readTime:hl(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Tl(e).put(function(e){return{name:e.name,readTime:dl(Oa(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function kl(e){return Ur(e,"bundles")}function Tl(e){return Ur(e,"namedQueries")}class Sl{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Sl(e,n)}getOverlay(e,t){return El(e).get(yl(this.userId,t)).next((e=>e?vl(this.serializer,e):null))}getOverlays(e,t){const n=Lo();return Hi.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const i=[];return n.forEach(((n,r)=>{const s=new Ta(t,r);i.push(this.ht(e,s))})),Hi.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach((e=>i.add(cr(e.getCollectionPath()))));const r=[];return i.forEach((t=>{const i=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);r.push(El(e).j("collectionPathOverlayIndex",i))})),Hi.waitFor(r)}getOverlaysForCollection(e,t,n){const i=Lo(),r=cr(t),s=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return El(e).U("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=vl(this.serializer,t);i.set(e.getKey(),e)}return i}))}getOverlaysForCollectionGroup(e,t,n,i){const r=Lo();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return El(e).J({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=vl(this.serializer,t);r.size()<i||o.largestBatchId===s?(r.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>r))}ht(e,t){return El(e).put(function(e,t,n){const[i,r,s]=yl(t,n.mutation.key);return{userId:t,collectionPath:r,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Wa(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function El(e){return Ur(e,"documentOverlays")}class Il{Pt(e){return Ur(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?Yr.fromUint8Array(t):Yr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Cl{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(es(e.integerValue));else if("doubleValue"in e){const n=es(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),ar(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Zr(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ts(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?Is(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Ss(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):li()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const r=e.fields||{};this.dt(t,53);const s="value",o=(null===(i=null===(n=r[s].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.dt(t,15),t.At(es(o)),this.Vt(s,t),this.Tt(r[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),Di.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}function Pl(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Al(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const i=Pl(255&e[n]);if(t+=i,8!==i)break}return t}(e);return Math.ceil(t/8)}Cl.vt=new Cl;class _l{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Bt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ot(e);else if(e<2048)this.Ot(960|e>>>6),this.Ot(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e);else{const e=t.codePointAt(0);this.Ot(240|e>>>18),this.Ot(128|63&e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e)}}this.Nt()}kt(e){const t=this.qt(e),n=Al(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),n=Al(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class xl{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Rl{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Nl{constructor(){this.jt=new _l,this.Ht=new xl(this.jt),this.Jt=new Rl(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class Dl{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Dl(this.indexId,this.documentKey,this.arrayValue,n)}}function Ll(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Ol(e.arrayValue,t.arrayValue),0!==n?n:(n=Ol(e.directionalValue,t.directionalValue),0!==n?n:Di.comparator(e.documentKey,t.documentKey)))}function Ol(e,t){for(let n=0;n<e.length&&n<t.length;++n){const i=e[n]-t[n];if(0!==i)return i}return e.length-t.length}class Ml{constructor(e){this.Xt=new Hr(((e,t)=>Ni.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=this.Xt.add(e):this.tn.push(e)}}get nn(){return this.Xt.size>1}rn(e){if(ci(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Oi(e);if(void 0!==t&&!this.sn(t))return!1;const n=Mi(e);let i=new Set,r=0,s=0;for(;r<n.length&&this.sn(n[r]);++r)i=i.add(n[r].fieldPath.canonicalString());if(r===n.length)return!0;if(this.Xt.size>0){const e=this.Xt.getIterator().getNext();if(!i.has(e.field.canonicalString())){const t=n[r];if(!this.on(e,t)||!this._n(this.en[s++],t))return!1}++r}for(;r<n.length;++r){const e=n[r];if(s>=this.en.length||!this._n(this.en[s++],e))return!1}return!0}an(){if(this.nn)return null;let e=new Hr(Ni.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new ji(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new ji(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new ji(n.field,"asc"===n.dir?0:1)));return new Li(Li.UNKNOWN_ID,this.collectionId,t,Fi.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function jl(e){var t,n;if(ci(e instanceof Vs||e instanceof Bs),e instanceof Vs){if(e instanceof to){const i=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Vs.create(e.field,"==",t))))||[];return Bs.create(i,"or")}return e}const i=e.filters.map((e=>jl(e)));return Bs.create(i,e.op)}function Fl(e){if(0===e.getFilters().length)return[];const t=$l(jl(e));return ci(Bl(t)),Ul(t)||Vl(t)?[t]:t.getFilters()}function Ul(e){return e instanceof Vs}function Vl(e){return e instanceof Bs&&Gs(e)}function Bl(e){return Ul(e)||Vl(e)||function(e){if(e instanceof Bs&&zs(e)){for(const t of e.getFilters())if(!Ul(t)&&!Vl(t))return!1;return!0}return!1}(e)}function $l(e){if(ci(e instanceof Vs||e instanceof Bs),e instanceof Vs)return e;if(1===e.filters.length)return $l(e.filters[0]);const t=e.filters.map((e=>$l(e)));let n=Bs.create(t,e.op);return n=ql(n),Bl(n)?n:(ci(n instanceof Bs),ci($s(n)),ci(n.filters.length>1),n.filters.reduce(((e,t)=>zl(e,t))))}function zl(e,t){let n;return ci(e instanceof Vs||e instanceof Bs),ci(t instanceof Vs||t instanceof Bs),n=e instanceof Vs?t instanceof Vs?function(e,t){return Bs.create([e,t],"and")}(e,t):Gl(e,t):t instanceof Vs?Gl(t,e):function(e,t){if(ci(e.filters.length>0&&t.filters.length>0),$s(e)&&$s(t))return Ks(e,t.getFilters());const n=zs(e)?e:t,i=zs(e)?t:e,r=n.filters.map((e=>zl(e,i)));return Bs.create(r,"or")}(e,t),ql(n)}function Gl(e,t){if($s(t))return Ks(t,e.getFilters());{const n=t.filters.map((t=>zl(e,t)));return Bs.create(n,"or")}}function ql(e){if(ci(e instanceof Vs||e instanceof Bs),e instanceof Vs)return e;const t=e.getFilters();if(1===t.length)return ql(t[0]);if(qs(e))return e;const n=t.map((e=>ql(e))),i=[];return n.forEach((t=>{t instanceof Vs?i.push(t):t instanceof Bs&&(t.op===e.op?i.push(...t.filters):i.push(t))})),1===i.length?i[0]:Bs.create(i,e.op)}class Hl{constructor(){this.un=new Wl}addToCollectionParentIndex(e,t){return this.un.add(t),Hi.resolve()}getCollectionParents(e,t){return Hi.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Hi.resolve()}deleteFieldIndex(e,t){return Hi.resolve()}deleteAllFieldIndexes(e){return Hi.resolve()}createTargetIndexes(e,t){return Hi.resolve()}getDocumentsMatchingTarget(e,t){return Hi.resolve(null)}getIndexType(e,t){return Hi.resolve(0)}getFieldIndexes(e,t){return Hi.resolve([])}getNextCollectionGroupToUpdate(e){return Hi.resolve(null)}getMinOffset(e,t){return Hi.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,t){return Hi.resolve(Bi.min())}updateCollectionGroup(e,t,n){return Hi.resolve()}updateIndexEntries(e,t){return Hi.resolve()}}class Wl{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Hr(xi.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Hr(xi.comparator)).toArray()}}const Kl=new Uint8Array(0);class Ql{constructor(e,t){this.databaseId=t,this.cn=new Wl,this.ln=new Ao((e=>oo(e)),((e,t)=>ao(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const r={collectionId:n,parent:cr(i)};return Jl(e).put(r)}return Hi.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Ci(t),""],!1,!0);return Jl(e).U(i).next((e=>{for(const i of e){if(i.collectionId!==t)break;n.push(hr(i.parent))}return n}))}addFieldIndex(e,t){const n=Xl(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete i.indexId;const r=n.add(i);if(t.indexState){const n=Zl(e);return r.next((e=>{n.put(bl(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return r.next()}deleteFieldIndex(e,t){const n=Xl(e),i=Zl(e),r=Yl(e);return n.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Xl(e),n=Yl(e),i=Zl(e);return t.j().next((()=>n.j())).next((()=>i.j()))}createTargetIndexes(e,t){return Hi.forEach(this.hn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Ml(t).an();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Yl(e);let i=!0;const r=new Map;return Hi.forEach(this.hn(t),(t=>this.Pn(e,t).next((e=>{i&&(i=!!e),r.set(t,e)})))).next((()=>{if(i){let e=Uo();const i=[];return Hi.forEach(r,((r,s)=>{ri("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(r)} to execute ${oo(t)}`);const o=function(e,t){const n=Oi(t);if(void 0===n)return null;for(const i of co(e,n.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}(s,r),a=function(e,t){const n=new Map;for(const i of Mi(t))for(const t of co(e,i.fieldPath))switch(t.op){case"==":case"in":n.set(i.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(i.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,r),l=function(e,t){const n=[];let i=!0;for(const r of Mi(t)){const t=0===r.kind?uo(e,r.fieldPath,e.startAt):ho(e,r.fieldPath,e.startAt);n.push(t.value),i&&(i=t.inclusive)}return new Ls(n,i)}(s,r),c=function(e,t){const n=[];let i=!0;for(const r of Mi(t)){const t=0===r.kind?ho(e,r.fieldPath,e.endAt):uo(e,r.fieldPath,e.endAt);n.push(t.value),i&&(i=t.inclusive)}return new Ls(n,i)}(s,r),u=this.In(r,s,l),d=this.In(r,s,c),h=this.Tn(r,s,a),p=this.En(r.indexId,o,u,l.inclusive,d,c.inclusive,h);return Hi.forEach(p,(r=>n.G(r,t.limit).next((t=>{t.forEach((t=>{const n=Di.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),i.push(n))}))}))))})).next((()=>i))}return Hi.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:Fl(Bs.create(e.filters,"and")).map((t=>so(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,n,i,r,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,r.length),l=a/(null!=t?t.length:1),c=[];for(let u=0;u<a;++u){const a=t?this.dn(t[u/l]):Kl,d=this.An(e,a,n[u%l],i),h=this.Rn(e,a,r[u%l],s),p=o.map((t=>this.An(e,a,t,!0)));c.push(...this.createRange(d,h,p))}return c}An(e,t,n,i){const r=new Dl(e,Di.empty(),t,n);return i?r:r.Zt()}Rn(e,t,n,i){const r=new Dl(e,Di.empty(),t,n);return i?r.Zt():r}Pn(e,t){const n=new Ml(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((e=>{let t=null;for(const i of e)n.rn(i)&&(!t||i.fields.length>t.fields.length)&&(t=i);return t}))}getIndexType(e,t){let n=2;const i=this.hn(t);return Hi.forEach(i,(t=>this.Pn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Hr(Ni.comparator),n=!1;for(const i of e.filters)for(const e of i.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const i of e.orderBy)i.field.isKeyField()||(t=t.add(i.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&i.length>1&&2===n?1:n))}Vn(e,t){const n=new Nl;for(const i of Mi(e)){const e=t.data.field(i.fieldPath);if(null==e)return null;const r=n.Yt(i.kind);Cl.vt.It(e,r)}return n.zt()}dn(e){const t=new Nl;return Cl.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new Nl;return Cl.vt.It(vs(this.databaseId,t),n.Yt(function(e){const t=Mi(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(null===n)return[];let i=[];i.push(new Nl);let r=0;for(const s of Mi(e)){const e=n[r++];for(const n of i)if(this.fn(t,s.fieldPath)&&bs(e))i=this.gn(i,s,e);else{const t=n.Yt(s.kind);Cl.vt.It(e,t)}}return this.pn(i)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const i=[...e],r=[];for(const s of n.arrayValue.values||[])for(const e of i){const n=new Nl;n.seed(e.zt()),Cl.vt.It(s,n.Yt(t.kind)),r.push(n)}return r}fn(e,t){return!!e.filters.find((e=>e instanceof Vs&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=Xl(e),i=Zl(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next((e=>{const t=[];return Hi.forEach(e,(e=>i.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Fi(t.sequenceNumber,new Bi(hl(t.readTime),new Di(hr(t.documentKey)),t.largestBatchId)):Fi.empty(),i=e.fields.map((e=>{let[t,n]=e;return new ji(Ni.fromServerFormat(t),n)}));return new Li(e.indexId,e.collectionGroup,i,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Ei(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const i=Xl(e),r=Zl(e);return this.yn(e).next((e=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>Hi.forEach(t,(t=>r.put(bl(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Hi.forEach(t,((t,i)=>{const r=n.get(t.collectionGroup);return(r?Hi.resolve(r):this.getFieldIndexes(e,t.collectionGroup)).next((r=>(n.set(t.collectionGroup,r),Hi.forEach(r,(n=>this.wn(e,t,n).next((t=>{const r=this.Sn(i,n);return t.isEqual(r)?Hi.resolve():this.bn(e,i,n,t,r)})))))))}))}Dn(e,t,n,i){return Yl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,i){return Yl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const i=Yl(e);let r=new Hr(Ll);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},((e,i)=>{r=r.add(new Dl(n.indexId,t,i.arrayValue,i.directionalValue))})).next((()=>r))}Sn(e,t){let n=new Hr(Ll);const i=this.Vn(t,e);if(null==i)return n;const r=Oi(t);if(null!=r){const s=e.data.field(r.fieldPath);if(bs(s))for(const r of s.arrayValue.values||[])n=n.add(new Dl(t.indexId,e.key,this.dn(r),i))}else n=n.add(new Dl(t.indexId,e.key,Kl,i));return n}bn(e,t,n,i,r){ri("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,i,r){const s=e.getIterator(),o=t.getIterator();let a=Kr(s),l=Kr(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const i=n(a,l);i<0?t=!0:i>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(i(l),l=Kr(o)):t?(r(a),a=Kr(s)):(a=Kr(s),l=Kr(o))}}(i,r,Ll,(i=>{s.push(this.Dn(e,t,n,i))}),(i=>{s.push(this.vn(e,t,n,i))})),Hi.waitFor(s)}yn(e){let t=1;return Zl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,i)=>{i.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Ll(e,t))).filter(((e,t,n)=>!t||0!==Ll(e,n[t-1])));const i=[];i.push(e);for(const s of n){const n=Ll(s,e),r=Ll(s,t);if(0===n)i[0]=e.Zt();else if(n>0&&r<0)i.push(s),i.push(s.Zt());else if(r>0)break}i.push(t);const r=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];const e=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Kl,[]],t=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Kl,[]];r.push(IDBKeyRange.bound(e,t))}return r}Cn(e,t){return Ll(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ec)}getMinOffset(e,t){return Hi.mapArray(this.hn(t),(t=>this.Pn(e,t).next((e=>e||li())))).next(ec)}}function Jl(e){return Ur(e,"collectionParents")}function Yl(e){return Ur(e,"indexEntries")}function Xl(e){return Ur(e,"indexConfiguration")}function Zl(e){return Ur(e,"indexState")}function ec(e){ci(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let i=1;i<e.length;i++){const r=e[i].indexState.offset;$i(r,t)<0&&(t=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Bi(t.readTime,t.documentKey,n)}const tc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class nc{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new nc(e,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function ic(e,t,n){const i=e.store("mutations"),r=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=i.J({range:o},((e,t,n)=>(a++,n.delete())));s.push(l.next((()=>{ci(1===a)})));const c=[];for(const u of n.mutations){const e=mr(t,u.key.path,n.batchId);s.push(r.delete(e)),c.push(u.key)}return Hi.waitFor(s).next((()=>c))}function rc(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw li();t=e.noDocument}return JSON.stringify(t).length}nc.DEFAULT_COLLECTION_PERCENTILE=10,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nc.DEFAULT=new nc(41943040,nc.DEFAULT_COLLECTION_PERCENTILE,nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nc.DISABLED=new nc(-1,0,0);class sc{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Fn={}}static lt(e,t,n,i){ci(""!==e.uid);const r=e.isAuthenticated()?e.uid:"";return new sc(r,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ac(e).J({index:"userMutationsIndex",range:n},((e,n,i)=>{t=!1,i.done()})).next((()=>t))}addMutationBatch(e,t,n,i){const r=lc(e),s=ac(e);return s.add({}).next((o=>{ci("number"==typeof o);const a=new wa(o,t,n,i),l=function(e,t,n){const i=n.baseMutations.map((t=>Wa(e.ct,t))),r=n.mutations.map((t=>Wa(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:i,mutations:r}}(this.serializer,this.userId,a),c=[];let u=new Hr(((e,t)=>Ei(e.canonicalString(),t.canonicalString())));for(const e of i){const t=mr(this.userId,e.key.path,o);u=u.add(e.key.path.popLast()),c.push(s.put(l)),c.push(r.put(t,gr))}return u.forEach((t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Fn[o]=a.keys()})),Hi.waitFor(c).next((()=>a))}))}lookupMutationBatch(e,t){return ac(e).get(t).next((e=>e?(ci(e.userId===this.userId),pl(this.serializer,e)):null))}Mn(e,t){return this.Fn[t]?Hi.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Fn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let r=null;return ac(e).J({index:"userMutationsIndex",range:i},((e,t,i)=>{t.userId===this.userId&&(ci(t.batchId>=n),r=pl(this.serializer,t)),i.done()})).next((()=>r))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return ac(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,i)=>{n=t.batchId,i.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ac(e).U("userMutationsIndex",t).next((e=>e.map((e=>pl(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=fr(this.userId,t.path),i=IDBKeyRange.lowerBound(n),r=[];return lc(e).J({range:i},((n,i,s)=>{const[o,a,l]=n,c=hr(a);if(o===this.userId&&t.path.isEqual(c))return ac(e).get(l).next((e=>{if(!e)throw li();ci(e.userId===this.userId),r.push(pl(this.serializer,e))}));s.done()})).next((()=>r))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Hr(Ei);const i=[];return t.forEach((t=>{const r=fr(this.userId,t.path),s=IDBKeyRange.lowerBound(r),o=lc(e).J({range:s},((e,i,r)=>{const[s,o,a]=e,l=hr(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):r.done()}));i.push(o)})),Hi.waitFor(i).next((()=>this.xn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,r=fr(this.userId,n),s=IDBKeyRange.lowerBound(r);let o=new Hr(Ei);return lc(e).J({range:s},((e,t,r)=>{const[s,a,l]=e,c=hr(a);s===this.userId&&n.isPrefixOf(c)?c.length===i&&(o=o.add(l)):r.done()})).next((()=>this.xn(e,o)))}xn(e,t){const n=[],i=[];return t.forEach((t=>{i.push(ac(e).get(t).next((e=>{if(null===e)throw li();ci(e.userId===this.userId),n.push(pl(this.serializer,e))})))})),Hi.waitFor(i).next((()=>n))}removeMutationBatch(e,t){return ic(e._e,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),Hi.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Hi.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),i=[];return lc(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=hr(e[1]);i.push(t)}else n.done()})).next((()=>{ci(0===i.length)}))}))}containsKey(e,t){return oc(e,this.userId,t)}Nn(e){return cc(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function oc(e,t,n){const i=fr(t,n.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return lc(e).J({range:s,H:!0},((e,n,i)=>{const[s,a,l]=e;s===t&&a===r&&(o=!0),i.done()})).next((()=>o))}function ac(e){return Ur(e,"mutations")}function lc(e){return Ur(e,"documentMutations")}function cc(e){return Ur(e,"mutationQueues")}class uc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new uc(0)}static kn(){return new uc(-1)}}class dc{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const n=new uc(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((e=>Ai.fromTimestamp(new Pi(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.qn(e).next((i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>hc(e).delete(t.targetId))).next((()=>this.qn(e))).next((t=>(ci(t.targetCount>0),t.targetCount-=1,this.Qn(e,t))))}removeTargets(e,t,n){let i=0;const r=[];return hc(e).J(((s,o)=>{const a=fl(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(i++,r.push(this.removeTargetData(e,a)))})).next((()=>Hi.waitFor(r))).next((()=>i))}forEachTarget(e,t){return hc(e).J(((e,n)=>{const i=fl(n);t(i)}))}qn(e){return pc(e).get("targetGlobalKey").next((e=>(ci(null!==e),e)))}Qn(e,t){return pc(e).put("targetGlobalKey",t)}Kn(e,t){return hc(e).put(ml(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=oo(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let r=null;return hc(e).J({range:i,index:"queryTargetsIndex"},((e,n,i)=>{const s=fl(n);ao(t,s.target)&&(r=s,i.done())})).next((()=>r))}addMatchingKeys(e,t,n){const i=[],r=fc(e);return t.forEach((t=>{const s=cr(t.path);i.push(r.put({targetId:n,path:s})),i.push(this.referenceDelegate.addReference(e,n,t))})),Hi.waitFor(i)}removeMatchingKeys(e,t,n){const i=fc(e);return Hi.forEach(t,(t=>{const r=cr(t.path);return Hi.waitFor([i.delete([n,r]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=fc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=fc(e);let r=Uo();return i.J({range:n,H:!0},((e,t,n)=>{const i=hr(e[1]),s=new Di(i);r=r.add(s)})).next((()=>r))}containsKey(e,t){const n=cr(t.path),i=IDBKeyRange.bound([n],[Ci(n)],!1,!0);let r=0;return fc(e).J({index:"documentTargetsIndex",H:!0,range:i},((e,t,n)=>{let[i,s]=e;0!==i&&(r++,n.done())})).next((()=>r>0))}ot(e,t){return hc(e).get(t).next((e=>e?fl(e):null))}}function hc(e){return Ur(e,"targets")}function pc(e){return Ur(e,"targetGlobal")}function fc(e){return Ur(e,"targetDocuments")}function mc(e,t){let[n,i]=e,[r,s]=t;const o=Ei(n,r);return 0===o?Ei(i,s):o}class gc{constructor(e){this.Un=e,this.buffer=new Hr(mc),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();mc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class vc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){ri("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Xi(e)?ri("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await qi(e)}await this.Hn(3e5)}))}}class yc{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Hi.resolve(sr.oe);const n=new gc(t);return this.Jn.forEachTarget(e,(e=>n.zn(e.sequenceNumber))).next((()=>this.Jn.Zn(e,(e=>n.zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ri("LruGarbageCollector","Garbage collection skipped; disabled"),Hi.resolve(tc)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(ri("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),tc):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,i,r,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(ri("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),i=this.params.maximumSequenceNumbersToCollect):i=t,s=Date.now(),this.nthSequenceNumber(e,i)))).next((i=>(n=i,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(r=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),ii()<=pt.$b.DEBUG&&ri("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${i} in `+(o-s)+"ms\n"+`\tRemoved ${r} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),Hi.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:e}))))}}function bc(e,t){return new yc(e,t)}class wc{constructor(e,t){this.db=e,this.garbageCollector=bc(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}er(e){let t=0;return this.Zn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((e,n)=>t(n)))}addReference(e,t,n){return kc(e,n)}removeReference(e,t,n){return kc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return kc(e,t)}nr(e,t){return function(e,t){let n=!1;return cc(e).Y((i=>oc(e,i,t).next((e=>(e&&(n=!0),Hi.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let r=0;return this.tr(e,((s,o)=>{if(o<=t){const t=this.nr(e,s).next((t=>{if(!t)return r++,n.getEntry(e,s).next((()=>(n.removeEntry(s,Ai.min()),fc(e).delete(function(e){return[0,cr(e.path)]}(s)))))}));i.push(t)}})).next((()=>Hi.waitFor(i))).next((()=>n.apply(e))).next((()=>r))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return kc(e,t)}tr(e,t){const n=fc(e);let i,r=sr.oe;return n.J({index:"documentTargetsIndex"},((e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(r!==sr.oe&&t(new Di(hr(i)),r),r=l,i=a):r=sr.oe})).next((()=>{r!==sr.oe&&t(new Di(hr(i)),r)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kc(e,t){return fc(e).put(function(e,t){return{targetId:0,path:cr(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Tc{constructor(){this.changes=new Ao((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ds.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Hi.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Sc{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Pc(e).put(n)}removeEntry(e,t,n){return Pc(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],ul(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.rr(e,n))))}getEntry(e,t){let n=Ds.newInvalidDocument(t);return Pc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(t))},((e,i)=>{n=this.ir(t,i)})).next((()=>n))}sr(e,t){let n={size:0,document:Ds.newInvalidDocument(t)};return Pc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(t))},((e,i)=>{n={document:this.ir(t,i),size:rc(i)}})).next((()=>n))}getEntries(e,t){let n=xo();return this._r(e,t,((e,t)=>{const i=this.ir(e,t);n=n.insert(e,i)})).next((()=>n))}ar(e,t){let n=xo(),i=new zr(Di.comparator);return this._r(e,t,((e,t)=>{const r=this.ir(e,t);n=n.insert(e,r),i=i.insert(e,rc(t))})).next((()=>({documents:n,ur:i})))}_r(e,t,n){if(t.isEmpty())return Hi.resolve();let i=new Hr(xc);t.forEach((e=>i=i.add(e)));const r=IDBKeyRange.bound(Ac(i.first()),Ac(i.last())),s=i.getIterator();let o=s.getNext();return Pc(e).J({index:"documentKeyIndex",range:r},((e,t,i)=>{const r=Di.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&xc(o,r)<0;)n(o,null),o=s.getNext();o&&o.isEqual(r)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?i.$(Ac(o)):i.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,i,r){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),ul(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Pc(e).U(IDBKeyRange.bound(o,a,!0)).next((e=>{null==r||r.incrementDocumentReadCount(e.length);let n=xo();for(const r of e){const e=this.ir(Di.fromSegments(r.prefixPath.concat(r.collectionGroup,r.documentId)),r);e.isFoundDocument()&&(Io(t,e)||i.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,i){let r=xo();const s=_c(t,n),o=_c(t,Bi.max());return Pc(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.ir(Di.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);r=r.insert(s.key,s),r.size===i&&n.done()})).next((()=>r))}newChangeBuffer(e){return new Ic(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Cc(e).get("remoteDocumentGlobalKey").next((e=>(ci(!!e),e)))}rr(e,t){return Cc(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Ha(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Di.fromSegments(t.noDocument.path),i=hl(t.noDocument.readTime);n=Ds.newNoDocument(e,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return li();{const e=Di.fromSegments(t.unknownDocument.path),i=hl(t.unknownDocument.version);n=Ds.newUnknownDocument(e,i)}}return t.readTime&&n.setReadTime(function(e){const t=new Pi(e[0],e[1]);return Ai.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(Ai.min()))return e}return Ds.newInvalidDocument(e)}}function Ec(e){return new Sc(e)}class Ic extends Tc{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Ao((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,i=new Hr(((e,t)=>Ei(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((r,s)=>{const o=this.lr.get(r);if(t.push(this.cr.removeEntry(e,r,o.readTime)),s.isValidDocument()){const a=cl(this.cr.serializer,s);i=i.add(r.path.popLast());const l=rc(a);n+=l-o.size,t.push(this.cr.addEntry(e,r,a))}else if(n-=o.size,this.trackRemovals){const n=cl(this.cr.serializer,s.convertToNoDocument(Ai.min()));t.push(this.cr.addEntry(e,r,n))}})),i.forEach((n=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.cr.updateMetadata(e,n)),Hi.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((e=>(this.lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((e=>{let{documents:t,ur:n}=e;return n.forEach(((e,n)=>{this.lr.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function Cc(e){return Ur(e,"remoteDocumentGlobal")}function Pc(e){return Ur(e,"remoteDocumentsV14")}function Ac(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function _c(e,t){const n=t.documentKey.path.toArray();return[e,ul(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function xc(e,t){const n=e.path.toArray(),i=t.path.toArray();let r=0;for(let s=0;s<n.length-2&&s<i.length-2;++s)if(r=Ei(n[s],i[s]),r)return r;return r=Ei(n.length,i.length),r||(r=Ei(n[n.length-2],i[i.length-2]),r||Ei(n[n.length-1],i[i.length-1]))}class Rc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Nc{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&ua(n.mutation,e,Qr.empty(),Pi.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Uo()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uo();const i=Lo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=No();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Lo();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Uo())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=xo();const s=Mo(),o=Mo();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof fa)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),ua(o.mutation,t,o.mutation.getFieldMask(),Pi.now())):s.set(t.key,Qr.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Rc(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Mo();let i=new zr(((e,t)=>e-t)),r=Uo();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Qr.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||Uo()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=Oo();l.forEach((e=>{if(!r.has(e)){const i=la(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return Hi.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,i){return function(e){return Di.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):vo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):Hi.resolve(Lo());let o=-1,a=r;return s.next((t=>Hi.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?Hi.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,Uo()))).next((e=>({batchId:o,changes:Do(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Di(t)).next((e=>{let t=No();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let s=No();return this.indexManager.getCollectionParents(e,r).next((o=>Hi.forEach(o,(o=>{const a=function(e,t){return new po(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(r));return this.getDocumentsMatchingCollectionQuery(e,a,n,i).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i)))).next((e=>{r.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,Ds.newInvalidDocument(i)))}));let n=No();return e.forEach(((e,i)=>{const s=r.get(e);void 0!==s&&ua(s.mutation,i,Qr.empty(),Pi.now()),Io(t,i)&&(n=n.insert(e,i))})),n}))}}class Dc{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Hi.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Oa(e.createTime)}}(t)),Hi.resolve()}getNamedQuery(e,t){return Hi.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:gl(e.bundledQuery),readTime:Oa(e.readTime)}}(t)),Hi.resolve()}}class Lc{constructor(){this.overlays=new zr(Di.comparator),this.Ir=new Map}getOverlay(e,t){return Hi.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Lo();return Hi.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ht(e,t,i)})),Hi.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),Hi.resolve()}getOverlaysForCollection(e,t,n){const i=Lo(),r=t.length+1,s=new Di(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return Hi.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new zr(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=Lo(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Lo(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return Hi.resolve(o)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Ta(t,n));let r=this.Ir.get(t);void 0===r&&(r=Uo(),this.Ir.set(t,r)),this.Ir.set(t,r.add(n.key))}}class Oc{constructor(){this.sessionToken=Yr.EMPTY_BYTE_STRING}getSessionToken(e){return Hi.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Hi.resolve()}}class Mc{constructor(){this.Tr=new Hr(jc.Er),this.dr=new Hr(jc.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new jc(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new jc(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new Di(new xi([])),n=new jc(t,e),i=new jc(t,e+1),r=[];return this.dr.forEachInRange([n,i],(e=>{this.Vr(e),r.push(e.key)})),r}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Di(new xi([])),n=new jc(t,e),i=new jc(t,e+1);let r=Uo();return this.dr.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new jc(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class jc{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Di.comparator(e.key,t.key)||Ei(e.wr,t.wr)}static Ar(e,t){return Ei(e.wr,t.wr)||Di.comparator(e.key,t.key)}}class Fc{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Hr(jc.Er)}checkEmpty(e){return Hi.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new wa(r,t,n,i);this.mutationQueue.push(s);for(const o of i)this.br=this.br.add(new jc(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Hi.resolve(s)}lookupMutationBatch(e,t){return Hi.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),r=i<0?0:i;return Hi.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Hi.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Hi.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new jc(t,0),i=new jc(t,Number.POSITIVE_INFINITY),r=[];return this.br.forEachInRange([n,i],(e=>{const t=this.Dr(e.wr);r.push(t)})),Hi.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Hr(Ei);return t.forEach((e=>{const t=new jc(e,0),i=new jc(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,i],(e=>{n=n.add(e.wr)}))})),Hi.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;Di.isDocumentKey(r)||(r=r.child(""));const s=new jc(new Di(r),0);let o=new Hr(Ei);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.wr)),!0)}),s),Hi.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){ci(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Hi.forEach(t.mutations,(i=>{const r=new jc(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new jc(t,0),i=this.br.firstAfterOrEqual(n);return Hi.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Hi.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Uc{constructor(e){this.Mr=e,this.docs=new zr(Di.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Hi.resolve(n?n.document.mutableCopy():Ds.newInvalidDocument(t))}getEntries(e,t){let n=xo();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ds.newInvalidDocument(e))})),Hi.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=xo();const s=t.path,o=new Di(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||$i(Vi(o),n)<=0||(i.has(o.key)||Io(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Hi.resolve(r)}getAllFromCollectionGroup(e,t,n,i){li()}Or(e,t){return Hi.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Vc(this)}getSize(e){return Hi.resolve(this.size)}}class Vc extends Tc{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)})),Hi.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Bc{constructor(e){this.persistence=e,this.Nr=new Ao((e=>oo(e)),ao),this.lastRemoteSnapshotVersion=Ai.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mc,this.targetCount=0,this.kr=uc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),Hi.resolve()}getLastRemoteSnapshotVersion(e){return Hi.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Hi.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Hi.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Hi.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new uc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Hi.resolve()}updateTargetData(e,t){return this.Kn(t),Hi.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Hi.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Nr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),Hi.waitFor(r).next((()=>i))}getTargetCount(e){return Hi.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Hi.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Hi.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),Hi.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Hi.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Hi.resolve(n)}containsKey(e,t){return Hi.resolve(this.Br.containsKey(t))}}class $c{constructor(e,t){this.qr={},this.overlays={},this.Qr=new sr(0),this.Kr=!1,this.Kr=!0,this.$r=new Oc,this.referenceDelegate=e(this),this.Ur=new Bc(this),this.indexManager=new Hl,this.remoteDocumentCache=function(e){return new Uc(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new ll(t),this.Gr=new Dc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Lc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Fc(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){ri("MemoryPersistence","Starting transaction:",e);const i=new zc(this.Qr.next());return this.referenceDelegate.zr(),n(i).next((e=>this.referenceDelegate.jr(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Hr(e,t){return Hi.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class zc extends Gi{constructor(e){super(),this.currentSequenceNumber=e}}class Gc{constructor(e){this.persistence=e,this.Jr=new Mc,this.Yr=null}static Zr(e){return new Gc(e)}get Xr(){if(this.Yr)return this.Yr;throw li()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Hi.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Hi.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Hi.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Hi.forEach(this.Xr,(n=>{const i=Di.fromPath(n);return this.ei(e,i).next((e=>{e||t.removeEntry(i,Ai.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Hi.or([()=>Hi.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class qc{constructor(e){this.serializer=e}O(e,t,n,i){const r=new Wi("createOrUpgrade",t);n<1&&i>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pr,{unique:!0}),e.createObjectStore("documentMutations")}(e),Hc(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=Hi.resolve();return n<3&&i>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Hc(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ai.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(r)))),n<4&&i>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").U().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pr,{unique:!0});const i=t.store("mutations"),r=n.map((e=>i.put(e)));return Hi.waitFor(r)}))}(e,r)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&i>=5&&(s=s.next((()=>this.ni(r)))),n<6&&i>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ri(r))))),n<7&&i>=7&&(s=s.next((()=>this.ii(r)))),n<8&&i>=8&&(s=s.next((()=>this.si(e,r)))),n<9&&i>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&i>=10&&(s=s.next((()=>this.oi(r)))),n<11&&i>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&i>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Ar});t.createIndex("collectionPathOverlayIndex",_r,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",xr,{unique:!1})}(e)}))),n<13&&i>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:vr});t.createIndex("documentKeyIndex",yr),t.createIndex("collectionGroupIndex",br)}(e))).next((()=>this._i(e,r))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&i>=14&&(s=s.next((()=>this.ai(e,r)))),n<15&&i>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Er}).createIndex("sequenceNumberIndex",Ir,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Cr}).createIndex("documentKeyIndex",Pr,{unique:!1})}(e)))),n<16&&i>=16&&(s=s.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),n<17&&i>=17&&(s=s.next((()=>{!function(e){e.createObjectStore("globals",{keyPath:"name"})}(e)}))),s}ri(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=rc(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next((t=>Hi.forEach(t,(t=>{const i=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",i).next((n=>Hi.forEach(n,(n=>{ci(n.userId===t.userId);const i=pl(this.serializer,n);return ic(e,t.userId,i).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const i=[];return n.J(((n,r)=>{const s=new xi(n),o=function(e){return[0,cr(e)]}(s);i.push(t.get(o).next((n=>n?Hi.resolve():(n=>t.put({targetId:0,path:cr(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>Hi.waitFor(i)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:Sr});const n=t.store("collectionParents"),i=new Wl,r=e=>{if(i.add(e)){const t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:cr(i)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new xi(e);return r(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},((e,t)=>{let[n,i,s]=e;const o=hr(i);return r(o.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((e,n)=>{const i=fl(n),r=ml(this.serializer,i);return t.put(r)}))}_i(e,t){const n=t.store("remoteDocuments"),i=[];return n.J(((e,n)=>{const r=t.store("remoteDocumentsV14"),s=function(e){return e.document?new Di(xi.fromString(e.document.name).popFirst(5)):e.noDocument?Di.fromSegments(e.noDocument.path):e.unknownDocument?Di.fromSegments(e.unknownDocument.path):li()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};i.push(r.put(o))})).next((()=>Hi.waitFor(i)))}ai(e,t){const n=t.store("mutations"),i=Ec(this.serializer),r=new $c(Gc.Zr,this.serializer.ct);return n.U().next((e=>{const n=new Map;return e.forEach((e=>{var t;let i=null!==(t=n.get(e.userId))&&void 0!==t?t:Uo();pl(this.serializer,e).keys().forEach((e=>i=i.add(e))),n.set(e.userId,i)})),Hi.forEach(n,((e,n)=>{const s=new ei(n),o=Sl.lt(this.serializer,s),a=r.getIndexManager(s),l=sc.lt(s,this.serializer,a,r.referenceDelegate);return new Nc(i,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Fr(t,sr.oe),e).next()}))}))}}function Hc(e){e.createObjectStore("targetDocuments",{keyPath:kr}).createIndex("documentTargetsIndex",Tr,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wr,{unique:!0}),e.createObjectStore("targetGlobal")}const Wc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Kc{constructor(e,t,n,i,r,s,o,a,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=r,this.window=s,this.document=o,this.ci=l,this.li=c,this.hi=u,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=e=>Promise.resolve(),!Kc.D())throw new hi(di.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wc(this,i),this.Ai=t+"main",this.serializer=new ll(a),this.Ri=new Ki(this.Ai,this.hi,new qc(this.serializer)),this.$r=new Il,this.Ur=new dc(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ec(this.serializer),this.Gr=new wl,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===c&&si("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new hi(di.FAILED_PRECONDITION,Wc);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new sr(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Jc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(Xi(e))return ri("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ri("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return Qc(e).get("owner").next((e=>Hi.resolve(this.vi(e))))}Ci(e){return Jc(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Ur(e,"clientMetadata");return t.U().next((e=>{const n=this.xi(e,18e5),i=e.filter((e=>-1===n.indexOf(e)));return Hi.forEach(i,(e=>t.delete(e.clientId))).next((()=>i))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Hi.resolve(!0):Qc(e).get("owner").next((t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new hi(di.FAILED_PRECONDITION,Wc);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jc(e).U().next((e=>void 0===this.xi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,i=this.networkEnabled===e.networkEnabled;if(t||n&&i)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&ri("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Fr(e,sr.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((e=>this.Mi(e.updateTimeMs,t)&&!this.Ni(e.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>Jc(e).U().next((e=>this.xi(e,18e5).map((e=>e.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return sc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ql(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Sl.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){ri("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",r=function(e){return 17===e?jr:16===e?Mr:15===e?Or:14===e?Lr:13===e?Dr:12===e?Nr:11===e?Rr:void li()}(this.hi);let s;return this.Ri.runTransaction(e,i,r,(i=>(s=new Fr(i,this.Qr?this.Qr.next():sr.oe),"readwrite-primary"===t?this.wi(s).next((e=>!!e||this.Si(s))).next((t=>{if(!t)throw si(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new hi(di.FAILED_PRECONDITION,zi);return n(s)})).next((e=>this.Di(s).next((()=>e)))):this.Ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Ki(e){return Qc(e).get("owner").next((e=>{if(null!==e&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new hi(di.FAILED_PRECONDITION,Wc)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qc(e).put("owner",t)}static D(){return Ki.D()}bi(e){const t=Qc(e);return t.get("owner").next((e=>this.vi(e)?(ri("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Hi.resolve()))}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(si(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;(0,ft.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return ri("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return si("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(vC){si("Failed to set zombie client id.",vC)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch(vC){}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qc(e){return Ur(e,"owner")}function Jc(e){return Ur(e,"clientMetadata")}function Yc(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Xc{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=Uo(),i=Uo();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Xc(e,t.fromCache,n,i)}}class Zc{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class eu{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(0,ft.nr)()?8:Qi((0,ft.ZQ)())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.Yi(e,t).next((e=>{r.result=e})).next((()=>{if(!r.result)return this.Zi(e,t,i,n).next((e=>{r.result=e}))})).next((()=>{if(r.result)return;const n=new Zc;return this.Xi(e,t,n).next((i=>{if(r.result=i,this.zi)return this.es(e,t,n,i.size)}))})).next((()=>r.result))}es(e,t,n,i){return n.documentReadCount<this.ji?(ii()<=pt.$b.DEBUG&&ri("QueryEngine","SDK will not create cache indexes for query:",Eo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Hi.resolve()):(ii()<=pt.$b.DEBUG&&ri("QueryEngine","Query:",Eo(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(ii()<=pt.$b.DEBUG&&ri("QueryEngine","The SDK decides to create cache indexes for query:",Eo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bo(t))):Hi.resolve())}Yi(e,t){if(go(t))return Hi.resolve(null);let n=bo(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=ko(t,null,"F"),n=bo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=Uo(...i);return this.Ji.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ts(t,i);return this.ns(t,s,r,n.readTime)?this.Yi(e,ko(t,null,"F")):this.rs(e,s,t,n)}))))})))))}Zi(e,t,n,i){return go(t)||i.isEqual(Ai.min())?Hi.resolve(null):this.Ji.getDocuments(e,n).next((r=>{const s=this.ts(t,r);return this.ns(t,s,n,i)?Hi.resolve(null):(ii()<=pt.$b.DEBUG&&ri("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Eo(t)),this.rs(e,s,t,Ui(i,-1)).next((e=>e)))}))}ts(e,t){let n=new Hr(Co(e));return t.forEach(((t,i)=>{Io(e,i)&&(n=n.add(i))})),n}ns(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Xi(e,t,n){return ii()<=pt.$b.DEBUG&&ri("QueryEngine","Using full collection scan to execute query:",Eo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Bi.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class tu{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new zr(Ei),this._s=new Ao((e=>oo(e)),ao),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nc(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function nu(e,t,n,i){return new tu(e,t,n,i)}async function iu(e,t){const n=ui(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],s=[];let o=Uo();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({hs:e,removedBatchIds:r,addedBatchIds:s})))}))}))}function ru(e){const t=ui(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function su(e,t){const n=ui(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}class ou{constructor(){this.activeTargetIds=Bo()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class au{constructor(){this.so=new ou,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ou,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class lu{_o(e){}shutdown(){}}class cu{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ri("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ri("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let uu=null;function du(){return null===uu?uu=268435456+Math.round(2147483648*Math.random()):uu++,"0x"+uu.toString(16)}const hu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pu{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const fu="WebChannelConnection";class mu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${i}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Fo(){return!1}Mo(e,t,n,i,r){const s=du(),o=this.xo(e,t.toUriEncodedString());ri("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,i,r),this.No(e,o,a,n).then((t=>(ri("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw oi("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Lo(e,t,n,i,r,s){return this.Mo(e,t,n,i,r)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ti,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=hu[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const r=du();return new Promise(((s,o)=>{const a=new zn;a.setWithCredentials(!0),a.listenOnce(qn.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Hn.NO_ERROR:const t=a.getResponseJson();ri(fu,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),s(t);break;case Hn.TIMEOUT:ri(fu,`RPC '${e}' ${r} timed out`),o(new hi(di.DEADLINE_EXCEEDED,"Request time out"));break;case Hn.HTTP_ERROR:const n=a.getStatus();if(ri(fu,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(di).indexOf(t)>=0?t:di.UNKNOWN}(t.status);o(new hi(e,t.message))}else o(new hi(di.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new hi(di.UNAVAILABLE,"Connection failed."));break;default:li()}}finally{ri(fu,`RPC '${e}' ${r} completed.`)}}));const l=JSON.stringify(i);ri(fu,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",l,n,15)}))}Bo(e,t,n){const i=du(),r=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Jn(),o=Qn(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=r.join("");ri(fu,`Creating RPC '${e}' stream ${i}: ${c}`,a);const u=s.createWebChannel(c,a);let d=!1,h=!1;const p=new pu({Io:t=>{h?ri(fu,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(d||(ri(fu,`Opening RPC '${e}' stream ${i} transport.`),u.open(),d=!0),ri(fu,`RPC '${e}' stream ${i} sending:`,t),u.send(t))},To:()=>u.close()}),f=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return f(u,Gn.EventType.OPEN,(()=>{h||(ri(fu,`RPC '${e}' stream ${i} transport opened.`),p.yo())})),f(u,Gn.EventType.CLOSE,(()=>{h||(h=!0,ri(fu,`RPC '${e}' stream ${i} transport closed`),p.So())})),f(u,Gn.EventType.ERROR,(t=>{h||(h=!0,oi(fu,`RPC '${e}' stream ${i} transport errored:`,t),p.So(new hi(di.UNAVAILABLE,"The operation could not be completed")))})),f(u,Gn.EventType.MESSAGE,(t=>{var n;if(!h){const r=t.data[0];ci(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){ri(fu,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=Sa[e];if(void 0!==t)return Ca(t)}(t),r=o.message;void 0===n&&(n=di.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),h=!0,p.So(new hi(n,r)),u.close()}else ri(fu,`RPC '${e}' stream ${i} received:`,r),p.bo(r)}})),f(o,Kn.STAT_EVENT,(t=>{t.stat===Wn.PROXY?ri(fu,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===Wn.NOPROXY&&ri(fu,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{p.wo()}),0),p}}function gu(){return"undefined"!=typeof window?window:null}function vu(){return"undefined"!=typeof document?document:null}function yu(e){return new xa(e,!0)}class bu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=r,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&ri("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class wu{constructor(e,t,n,i,r,s,o,a){this.ui=e,this.Ho=n,this.Jo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new bu(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===di.RESOURCE_EXHAUSTED?(si(t.toString()),si("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===di.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,i]=e;this.Yo===t&&this.P_(n,i)}),(t=>{e((()=>{const e=new hi(di.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return ri("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(ri("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ku extends wu{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ci(!!e.streamToken),this.lastStreamToken=e.streamToken,ci(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){ci(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(ci(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Oa(e.updateTime):Oa(t);return n.isEqual(Ai.min())&&(n=Oa(t)),new ra(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Oa(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=za(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Wa(this.serializer,e)))};this.a_(t)}}class Tu extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new hi(di.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[s,o]=r;return this.connection.Mo(e,ja(t,n),i,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===di.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new hi(di.UNKNOWN,e.toString())}))}Lo(e,t,n,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Lo(e,ja(t,n),i,o,a,r)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===di.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new hi(di.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Su{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(si(t),this.D_=!1):ri("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Eu{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=r,this.k_._o((e=>{n.enqueueAndForget((async()=>{Pu(this)&&(ri("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=ui(e);t.L_.add(4),await Cu(t),t.q_.set("Unknown"),t.L_.delete(4),await Iu(t)}(this))}))})),this.q_=new Su(n,i)}}async function Iu(e){if(Pu(e))for(const t of e.B_)await t(!0)}async function Cu(e){for(const t of e.B_)await t(!1)}function Pu(e){return 0===ui(e).L_.size}async function Au(e,t,n){if(!Xi(t))throw t;e.L_.add(1),await Cu(e),e.q_.set("Offline"),n||(n=()=>ru(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{ri("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await Iu(e)}))}function _u(e,t){return t().catch((n=>Au(e,n,t)))}async function xu(e){const t=ui(e),n=Bu(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;Ru(t);)try{const e=await su(t.localStore,i);if(null===e){0===t.O_.length&&n.o_();break}i=e.batchId,Nu(t,e)}catch(e){await Au(t,e)}Du(t)&&Lu(t)}function Ru(e){return Pu(e)&&e.O_.length<10}function Nu(e,t){e.O_.push(t);const n=Bu(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Du(e){return Pu(e)&&!Bu(e).n_()&&e.O_.length>0}function Lu(e){Bu(e).start()}async function Ou(e){Bu(e).p_()}async function Mu(e){const t=Bu(e);for(const n of e.O_)t.m_(n.mutations)}async function ju(e,t,n){const i=e.O_.shift(),r=ka.from(i,t,n);await _u(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await xu(e)}async function Fu(e,t){t&&Bu(e).V_&&await async function(e,t){if(function(e){return Ia(e)&&e!==di.ABORTED}(t.code)){const n=e.O_.shift();Bu(e).s_(),await _u(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await xu(e)}}(e,t),Du(e)&&Lu(e)}async function Uu(e,t){const n=ui(e);n.asyncQueue.verifyOperationInProgress(),ri("RemoteStore","RemoteStore received new credentials");const i=Pu(n);n.L_.add(3),await Cu(n),i&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await Iu(n)}async function Vu(e,t){const n=ui(e);t?(n.L_.delete(2),await Iu(n)):t||(n.L_.add(2),await Cu(n),n.q_.set("Unknown"))}function Bu(e){return e.U_||(e.U_=function(e,t,n){const i=ui(e);return i.w_(),new ku(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Ou.bind(null,e),mo:Fu.bind(null,e),f_:Mu.bind(null,e),g_:ju.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await xu(e)):(await e.U_.stop(),e.O_.length>0&&(ri("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class $u{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new $u(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new hi(di.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zu(e,t){if(si("AsyncQueue",`${t}: ${e}`),Xi(e))return new hi(di.UNAVAILABLE,`${t}: ${e}`);throw e}class Gu{constructor(){this.queries=qu(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=ui(e),i=n.queries;n.queries=qu(),i.forEach(((e,n)=>{for(const i of n.j_)i.onError(t)}))}(this,new hi(di.ABORTED,"Firestore shutting down"))}}function qu(){return new Ao((e=>So(e)),To)}function Hu(e){e.Y_.forEach((e=>{e.next()}))}var Wu,Ku;(Ku=Wu||(Wu={})).ea="default",Ku.Cache="cache";class Qu{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Ao((e=>So(e)),To),this.Ma=new Map,this.xa=new Set,this.Oa=new zr(Di.comparator),this.Na=new Map,this.La=new Mc,this.Ba={},this.ka=new Map,this.qa=uc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}function Ju(e,t,n){const i=ui(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Fa.forEach(((n,i)=>{const r=i.view.Z_(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=ui(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const r of n.j_)r.Z_(t)&&(i=!0)})),i&&Hu(n)}(i.eventManager,t),e.length&&i.Ca.d_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Yu(e,t){const n=ui(e),i=t.batch.batchId;try{const e=await function(e,t){const n=ui(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=Hi.resolve();return s.forEach((e=>{o=o.next((()=>i.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);ci(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Uo();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);ed(n,i,null),Zu(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await td(n,e)}catch(e){await qi(e)}}async function Xu(e,t,n){const i=ui(e);try{const e=await function(e,t){const n=ui(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(ci(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);ed(i,t,n),Zu(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await td(i,e)}catch(n){await qi(n)}}function Zu(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function ed(e,t,n){const i=ui(e);let r=i.Ba[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}async function td(e,t,n){const i=ui(e),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach(((e,a)=>{o.push(i.Ka(a,t,n).then((e=>{var t;if((e||n)&&i.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(a.targetId,r?"current":"not-current")}if(e){r.push(e);const t=Xc.Wi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),i.Ca.d_(r),await async function(e,t){const n=ui(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Hi.forEach(t,(t=>Hi.forEach(t.$i,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>Hi.forEach(t.Ui,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!Xi(e))throw e;ri("LocalStore","Failed to update sequence numbers: "+e)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.os.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.os=n.os.insert(e,r)}}}(i.localStore,s))}async function nd(e,t){const n=ui(e);if(!n.currentUser.isEqual(t)){ri("SyncEngine","User change. New user:",t.toKey());const e=await iu(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new hi(di.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await td(n,e.hs)}}function id(e){const t=ui(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Yu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Xu.bind(null,t),t}class rd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return nu(this.persistence,new eu,e.initialUser,this.serializer)}Ga(e){return new $c(Gc.Zr,this.serializer)}Wa(e){return new au}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rd.provider={build:()=>new rd};class sd extends rd{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await id(this.Ja.syncEngine),await xu(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return nu(this.persistence,new eu,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new vc(n,e.asyncQueue,t)}Ha(e,t){const n=new rr(t,this.persistence);return new ir(e.asyncQueue,n)}Ga(e){const t=Yc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?nc.withCacheSize(this.cacheSizeBytes):nc.DEFAULT;return new Kc(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,gu(),vu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new au}}class od{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Ju(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nd.bind(null,this.syncEngine),await Vu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Gu}createDatastore(e){const t=yu(e.databaseInfo.databaseId),n=function(e){return new mu(e)}(e.databaseInfo);return function(e,t,n,i){return new Tu(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,r){return new Eu(e,t,n,i,r)}(this.localStore,this.datastore,e.asyncQueue,(e=>Ju(this.syncEngine,e,0)),cu.D()?new cu:new lu)}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new Qu(e,t,n,i,r,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=ui(e);ri("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Cu(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}od.provider={build:()=>new od};class ad{constructor(e,t,n,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=ei.UNAUTHENTICATED,this.clientId=Si.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async e=>{ri("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(ri("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(wC){const n=zu(wC,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ld(e,t){e.asyncQueue.verifyOperationInProgress(),ri("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await iu(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function cd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ud(e);ri("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Uu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Uu(t.remoteStore,n))),e._onlineComponents=t}async function ud(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ri("FirestoreClient","Using user provided OfflineComponentProvider");try{await ld(e,e._uninitializedComponentsProvider._offline)}catch(wC){const n=wC;if(!function(e){return"FirebaseError"===e.name?e.code===di.FAILED_PRECONDITION||e.code===di.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;oi("Error using user provided cache. Falling back to memory cache: "+n),await ld(e,new rd)}}else ri("FirestoreClient","Using default OfflineComponentProvider"),await ld(e,new rd);return e._offlineComponents}async function dd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ri("FirestoreClient","Using user provided OnlineComponentProvider"),await cd(e,e._uninitializedComponentsProvider._online)):(ri("FirestoreClient","Using default OnlineComponentProvider"),await cd(e,new od))),e._onlineComponents}function hd(e){return dd(e).then((e=>e.syncEngine))}function pd(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const fd=new Map;function md(e,t,n){if(!n)throw new hi(di.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function gd(e){if(!Di.isDocumentKey(e))throw new hi(di.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function vd(e){if(Di.isDocumentKey(e))throw new hi(di.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function yd(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":li()}function bd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new hi(di.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=yd(e);throw new hi(di.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class wd{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new hi(di.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new hi(di.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new hi(di.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pd(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new hi(di.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new hi(di.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new hi(di.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kd{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new hi(di.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new hi(di.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wd(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new mi;switch(e.type){case"firstParty":return new bi(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new hi(di.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=fd.get(e);t&&(ri("ComponentProvider","Removing Datastore"),fd.delete(e),t.terminate())}(this),Promise.resolve()}}class Td{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Td(this.firestore,e,this._query)}}class Sd{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ed(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sd(this.firestore,e,this._key)}}class Ed extends Td{constructor(e,t,n){super(e,t,mo(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Sd(this.firestore,null,new Di(e))}withConverter(e){return new Ed(this.firestore,e,this._path)}}function Id(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=(0,ft.Ku)(e),1===arguments.length&&(t=Si.newId()),md("doc","path",t),e instanceof kd){const n=xi.fromString(t,...i);return gd(n),new Sd(e,null,new Di(n))}{if(!(e instanceof Sd||e instanceof Ed))throw new hi(di.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(xi.fromString(t,...i));return gd(n),new Sd(e.firestore,e instanceof Ed?e.converter:null,new Di(n))}}class Cd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new bu(this,"async_queue_retry"),this.Vu=()=>{const e=vu();e&&ri("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=vu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=vu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new pi;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(vC){if(!Xi(vC))throw vC;ri("AsyncQueue","Operation failed with retryable error: "+vC)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw si("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=$u.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(i),i}fu(){this.Eu&&li()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Pd extends kd{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Cd,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Cd(e),this._firestoreClient=void 0,await e}}}function Ad(e){if(e._terminated)throw new hi(di.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||_d(e),e._firestoreClient}function _d(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new ss(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,pd(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new ad(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function xd(e,t,n){if((e=bd(e,Pd))._firestoreClient||e._terminated)throw new hi(di.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new hi(di.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},_d(e)}class Rd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rd(Yr.fromBase64String(e))}catch(e){throw new hi(di.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Rd(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Nd{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;++i)if(0===t[i].length)throw new hi(di.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ni(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Dd{constructor(e){this._methodName=e}}class Ld{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new hi(di.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new hi(di.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ei(this._lat,e._lat)||Ei(this._long,e._long)}}class Od{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Md=/^__.*__$/;class jd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new fa(e,this.data,this.fieldMask,t,this.fieldTransforms):new pa(e,this.data,t,this.fieldTransforms)}}function Fd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw li()}}class Ud{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ud(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Jd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Fd(this.Cu)&&Md.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Vd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||yu(e)}Qu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Ud({Cu:e,methodName:t,qu:n,path:Ni.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Bd(e){const t=e._freezeSettings(),n=yu(e._databaseId);return new Vd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function $d(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,r);Hd("Data must be an object, but it was:",o,i);const a=Gd(i,o);let l,c;if(s.merge)l=new Qr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Wd(t,i,n);if(!o.contains(r))throw new hi(di.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Yd(e,r)||e.push(r)}l=new Qr(e),c=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=o.fieldTransforms;return new jd(new Rs(a),l,c)}function zd(e,t){if(qd(e=(0,ft.Ku)(e)))return Hd("Unsupported field value:",t,e),Gd(e,t);if(e instanceof Dd)return function(e,t){if(!Fd(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=zd(r,t.Lu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,ft.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Go(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Pi.fromDate(e);return{timestampValue:Na(t.serializer,n)}}if(e instanceof Pi){const n=new Pi(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Na(t.serializer,n)}}if(e instanceof Ld)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Rd)return{bytesValue:Da(t.serializer,e._byteString)};if(e instanceof Sd){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ma(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Od)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return $o(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${yd(e)}`)}(e,t)}function Gd(e,t){const n={};return $r(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Br(e,((e,i)=>{const r=zd(i,t.Mu(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function qd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Pi||e instanceof Ld||e instanceof Rd||e instanceof Sd||e instanceof Dd||e instanceof Od)}function Hd(e,t,n){if(!qd(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=yd(n);throw"an object"===i?t.Bu(e+" a custom object"):t.Bu(e+" "+i)}}function Wd(e,t,n){if((t=(0,ft.Ku)(t))instanceof Nd)return t._internalPath;if("string"==typeof t)return Qd(e,t);throw Jd("Field path arguments must be of type string or ",e,!1,void 0,n)}const Kd=new RegExp("[~\\*/\\[\\]]");function Qd(e,t,n){if(t.search(Kd)>=0)throw Jd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Nd(...t.split("."))._internalPath}catch(vP){throw Jd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Jd(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new hi(di.INVALID_ARGUMENT,a+e+l)}function Yd(e,t){return e.some((e=>e.isEqual(t)))}function Xd(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}function Zd(e,t){return function(e,t){const n=new pi;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=id(e);try{const e=await function(e,t){const n=ui(e),i=Pi.now(),r=t.reduce(((e,t)=>e.add(t.key)),Uo());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=xo(),l=Uo();return n.cs.getEntries(e,r).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((r=>{s=r;const o=[];for(const e of t){const t=da(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new fa(e.key,t,Ns(t.value.mapValue),sa.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)})).next((t=>{o=t;const i=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:Do(s)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ba[e.currentUser.toKey()];i||(i=new zr(Ei)),i=i.insert(t,n),e.Ba[e.currentUser.toKey()]=i}(i,e.batchId,n),await td(i,e.changes),await xu(i.remoteStore)}catch(e){const t=zu(e,"Failed to persist write");n.reject(t)}}(await hd(e),t,n))),n.promise}(Ad(e),t)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ti=e}(dt.MF),(0,dt.om)(new mt.uA("firestore",((e,n)=>{let{instanceIdentifier:i,options:r}=n;const s=e.getProvider("app").getImmediate(),o=new Pd(new vi(e.getProvider("auth-internal")),new ki(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new hi(di.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new os(e.options.projectId,t)}(s,i),s);return r=Object.assign({useFetchStreams:t},r),o._setSettings(r),o}),"PUBLIC").setMultipleInstances(!0)),(0,dt.KO)(Zn,"4.7.3",e),(0,dt.KO)(Zn,"4.7.3","esm2017")}();const eh=(0,dt.Wp)({apiKey:"AIzaSyBPctamWdHhnOMVtd1lGJsho3R6tTQqeFs",authDomain:"bionexa-b6b06.firebaseapp.com",projectId:"bionexa-b6b06",storageBucket:"bionexa-b6b06.firebasestorage.app",messagingSenderId:"671216681730",appId:"1:671216681730:web:8d98f382036cd44521381b",measurementId:"G-V01BCQCXQK"}),th=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,dt.Sx)();e=(0,ft.Ku)(e);const t=(0,dt.j6)(e,ln);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,dt.j6)(e,ln);if(n.isInitialized()){const e=n.getImmediate();if((0,ft.bD)(t,n.getOptions()))return e;throw hn.create("already-initialized")}const i=n.initialize({options:t})}(e)}(eh),(0,ht.getAuth)(eh)),nh=function(e,t){const n="object"==typeof e?e:(0,dt.Sx)(),i="string"==typeof e?e:t||"(default)",r=(0,dt.j6)(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const e=(0,ft.yU)("firestore");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r;const s=(e=bd(e,kd))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=ei.MOCK_USER;else{t=(0,ft.Fy)(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new hi(di.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ei(s)}e._authCredentials=new gi(new fi(t,n))}}(r,...e)}return r}(eh);try{(function(e,t){oi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return xd(e,od.provider,{build:e=>new sd(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()})(nh).then((()=>{console.log("Firestore persistence enabled")})).catch((e=>{"failed-precondition"===e.code?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):"unimplemented"===e.code?console.warn("The current browser does not support all of the features required for persistence"):console.error("Error enabling persistence:",e)}))}catch(pL){console.warn("Unable to enable persistence:",pL)}function ih(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function sh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rh(Object(n),!0).forEach((function(t){ih(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const oh=()=>{};let ah={},lh={},ch=null,uh={mark:oh,measure:oh};try{"undefined"!==typeof window&&(ah=window),"undefined"!==typeof document&&(lh=document),"undefined"!==typeof MutationObserver&&(ch=MutationObserver),"undefined"!==typeof performance&&(uh=performance)}catch(vC){}const{userAgent:dh=""}=ah.navigator||{},hh=ah,ph=lh,fh=ch,mh=uh,gh=(hh.document,!!ph.documentElement&&!!ph.head&&"function"===typeof ph.addEventListener&&"function"===typeof ph.createElement),vh=~dh.indexOf("MSIE")||~dh.indexOf("Trident/");var yh={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},bh=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],wh="classic",kh="duotone",Th=[wh,kh,"sharp","sharp-duotone"],Sh=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),Eh=["fak","fa-kit","fakd","fa-kit-duotone"],Ih={fak:"kit","fa-kit":"kit"},Ch={fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"},Ph=["fak","fakd"],Ah={kit:"fak"},_h={"kit-duotone":"fakd"},xh={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Rh=["fak","fa-kit","fakd","fa-kit-duotone"],Nh={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},Dh=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt","fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone","fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],Lh=[1,2,3,4,5,6,7,8,9,10],Oh=Lh.concat([11,12,13,14,15,16,17,18,19,20]),Mh=[...Object.keys({classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]}),"solid","regular","light","thin","duotone","brands","2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",xh.GROUP,xh.SWAP_OPACITY,xh.PRIMARY,xh.SECONDARY].concat(Lh.map((e=>"".concat(e,"x")))).concat(Oh.map((e=>"w-".concat(e))));const jh="___FONT_AWESOME___",Fh=16,Uh="svg-inline--fa",Vh="data-fa-i2svg",Bh="data-fa-pseudo-element",$h="data-prefix",zh="data-icon",Gh="fontawesome-i2svg",qh=["HTML","HEAD","STYLE","SCRIPT"],Hh=(()=>{try{return!0}catch(e){return!1}})();function Wh(e){return new Proxy(e,{get:(e,t)=>t in e?e[t]:e[wh]})}const Kh=sh({},yh);Kh[wh]=sh(sh(sh(sh({},{"fa-duotone":"duotone"}),yh[wh]),Ih),Ch);const Qh=Wh(Kh),Jh=sh({},{classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}});Jh[wh]=sh(sh(sh(sh({},{duotone:"fad"}),Jh[wh]),Ah),_h);const Yh=Wh(Jh),Xh=sh({},Nh);Xh[wh]=sh(sh({},Xh[wh]),{fak:"fa-kit"});const Zh=Wh(Xh),ep=sh({},{classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}});ep[wh]=sh(sh({},ep[wh]),{"fa-kit":"fak"});Wh(ep);const tp=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,np="fa-layers-text",ip=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,rp=(Wh(sh({},{classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}})),["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"]),sp={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},op=["kit",...Mh],ap=hh.FontAwesomeConfig||{};if(ph&&"function"===typeof ph.querySelector){[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((e=>{let[t,n]=e;const i=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=ph.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t));void 0!==i&&null!==i&&(ap[n]=i)}))}const lp={styleDefault:"solid",familyDefault:wh,cssPrefix:"fa",replacementClass:Uh,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};ap.familyPrefix&&(ap.cssPrefix=ap.familyPrefix);const cp=sh(sh({},lp),ap);cp.autoReplaceSvg||(cp.observeMutations=!1);const up={};Object.keys(lp).forEach((e=>{Object.defineProperty(up,e,{enumerable:!0,set:function(t){cp[e]=t,dp.forEach((e=>e(up)))},get:function(){return cp[e]}})})),Object.defineProperty(up,"familyPrefix",{enumerable:!0,set:function(e){cp.cssPrefix=e,dp.forEach((e=>e(up)))},get:function(){return cp.cssPrefix}}),hh.FontAwesomeConfig=up;const dp=[];const hp=Fh,pp={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function fp(){let e=12,t="";for(;e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function mp(e){const t=[];for(let n=(e||[]).length>>>0;n--;)t[n]=e[n];return t}function gp(e){return e.classList?mp(e.classList):(e.getAttribute("class")||"").split(" ").filter((e=>e))}function vp(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function yp(e){return Object.keys(e||{}).reduce(((t,n)=>t+"".concat(n,": ").concat(e[n].trim(),";")),"")}function bp(e){return e.size!==pp.size||e.x!==pp.x||e.y!==pp.y||e.rotate!==pp.rotate||e.flipX||e.flipY}function wp(){const e="fa",t=Uh,n=up.cssPrefix,i=up.replacementClass;let r=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-counter-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(-1 * var(--fa-li-width, 2em));\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  animation-name: fa-beat;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  animation-name: fa-bounce;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  animation-name: fa-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  animation-name: fa-beat-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  animation-name: fa-flip;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  animation-name: fa-shake;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  animation-name: fa-spin;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 2s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  animation-name: fa-spin;\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    animation-delay: -1ms;\n    animation-duration: 1ms;\n    animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    transform: scale(1);\n  }\n  45% {\n    transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-shake {\n  0% {\n    transform: rotate(-15deg);\n  }\n  4% {\n    transform: rotate(15deg);\n  }\n  8%, 24% {\n    transform: rotate(-18deg);\n  }\n  12%, 28% {\n    transform: rotate(18deg);\n  }\n  16% {\n    transform: rotate(-22deg);\n  }\n  20% {\n    transform: rotate(22deg);\n  }\n  32% {\n    transform: rotate(-12deg);\n  }\n  36% {\n    transform: rotate(12deg);\n  }\n  40%, 100% {\n    transform: rotate(0deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  transform: rotate(var(--fa-rotate-angle, 0));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}';if(n!==e||i!==t){const s=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),a=new RegExp("\\.".concat(t),"g");r=r.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(i))}return r}let kp=!1;function Tp(){up.autoAddCss&&!kp&&(!function(e){if(!e||!gh)return;const t=ph.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;const n=ph.head.childNodes;let i=null;for(let r=n.length-1;r>-1;r--){const e=n[r],t=(e.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(t)>-1&&(i=e)}ph.head.insertBefore(t,i)}(wp()),kp=!0)}var Sp={mixout:()=>({dom:{css:wp,insertCss:Tp}}),hooks:()=>({beforeDOMElementCreation(){Tp()},beforeI2svg(){Tp()}})};const Ep=hh||{};Ep[jh]||(Ep[jh]={}),Ep[jh].styles||(Ep[jh].styles={}),Ep[jh].hooks||(Ep[jh].hooks={}),Ep[jh].shims||(Ep[jh].shims=[]);var Ip=Ep[jh];const Cp=[],Pp=function(){ph.removeEventListener("DOMContentLoaded",Pp),Ap=1,Cp.map((e=>e()))};let Ap=!1;function _p(e){const{tag:t,attributes:n={},children:i=[]}=e;return"string"===typeof e?vp(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(((t,n)=>t+"".concat(n,'="').concat(vp(e[n]),'" ')),"").trim()}(n),">").concat(i.map(_p).join(""),"</").concat(t,">")}function xp(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}gh&&(Ap=(ph.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(ph.readyState),Ap||ph.addEventListener("DOMContentLoaded",Pp));var Rp=function(e,t,n,i){var r,s,o,a=Object.keys(e),l=a.length,c=void 0!==i?function(e,t){return function(n,i,r,s){return e.call(t,n,i,r,s)}}(t,i):t;for(void 0===n?(r=1,o=e[a[0]]):(r=0,o=n);r<l;r++)o=c(o,e[s=a[r]],s,e);return o};function Np(e){const t=function(e){const t=[];let n=0;const i=e.length;for(;n<i;){const r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){const i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&r)<<10)+(1023&i)+65536):(t.push(r),n--)}else t.push(r)}return t}(e);return 1===t.length?t[0].toString(16):null}function Dp(e){return Object.keys(e).reduce(((t,n)=>{const i=e[n];return!!i.icon?t[i.iconName]=i.icon:t[n]=i,t}),{})}function Lp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipHooks:i=!1}=n,r=Dp(t);"function"!==typeof Ip.hooks.addPack||i?Ip.styles[e]=sh(sh({},Ip.styles[e]||{}),r):Ip.hooks.addPack(e,Dp(t)),"fas"===e&&Lp("fa",t)}const{styles:Op,shims:Mp}=Ip,jp=Object.keys(Zh),Fp=jp.reduce(((e,t)=>(e[t]=Object.keys(Zh[t]),e)),{});let Up=null,Vp={},Bp={},$p={},zp={},Gp={};function qp(e,t){const n=t.split("-"),i=n[0],r=n.slice(1).join("-");return i!==e||""===r||(s=r,~op.indexOf(s))?null:r;var s}const Hp=()=>{const e=e=>Rp(Op,((t,n,i)=>(t[i]=Rp(n,e,{}),t)),{});Vp=e(((e,t,n)=>{if(t[3]&&(e[t[3]]=n),t[2]){t[2].filter((e=>"number"===typeof e)).forEach((t=>{e[t.toString(16)]=n}))}return e})),Bp=e(((e,t,n)=>{if(e[n]=n,t[2]){t[2].filter((e=>"string"===typeof e)).forEach((t=>{e[t]=n}))}return e})),Gp=e(((e,t,n)=>{const i=t[2];return e[n]=n,i.forEach((t=>{e[t]=n})),e}));const t="far"in Op||up.autoFetchSvg,n=Rp(Mp,((e,n)=>{const i=n[0];let r=n[1];const s=n[2];return"far"!==r||t||(r="fas"),"string"===typeof i&&(e.names[i]={prefix:r,iconName:s}),"number"===typeof i&&(e.unicodes[i.toString(16)]={prefix:r,iconName:s}),e}),{names:{},unicodes:{}});$p=n.names,zp=n.unicodes,Up=Xp(up.styleDefault,{family:up.familyDefault})};var Wp;function Kp(e,t){return(Vp[e]||{})[t]}function Qp(e,t){return(Gp[e]||{})[t]}function Jp(e){return $p[e]||{prefix:null,iconName:null}}function Yp(){return Up}Wp=e=>{Up=Xp(e.styleDefault,{family:up.familyDefault})},dp.push(Wp),Hp();function Xp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{family:n=wh}=t,i=Qh[n][e];if(n===kh&&!e)return"fad";const r=Yh[n][e]||Yh[n][i],s=e in Ip.styles?e:null;return r||s||null}function Zp(e){return e.sort().filter(((e,t,n)=>n.indexOf(e)===t))}function ef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{skipLookups:n=!1}=t;let i=null;const r=Dh.concat(Rh),s=Zp(e.filter((e=>r.includes(e)))),o=Zp(e.filter((e=>!Dh.includes(e)))),a=s.filter((e=>(i=e,!bh.includes(e)))),[l=null]=a,c=function(e){let t=wh;const n=jp.reduce(((e,t)=>(e[t]="".concat(up.cssPrefix,"-").concat(t),e)),{});return Th.forEach((i=>{(e.includes(n[i])||e.some((e=>Fp[i].includes(e))))&&(t=i)})),t}(s),u=sh(sh({},function(e){let t=[],n=null;return e.forEach((e=>{const i=qp(up.cssPrefix,e);i?n=i:e&&t.push(e)})),{iconName:n,rest:t}}(o)),{},{prefix:Xp(l,{family:c})});return sh(sh(sh({},u),function(e){const{values:t,family:n,canonical:i,givenPrefix:r="",styles:s={},config:o={}}=e,a=n===kh,l=t.includes("fa-duotone")||t.includes("fad"),c="duotone"===o.familyDefault,u="fad"===i.prefix||"fa-duotone"===i.prefix;!a&&(l||c||u)&&(i.prefix="fad");(t.includes("fa-brands")||t.includes("fab"))&&(i.prefix="fab");if(!i.prefix&&tf.includes(n)){if(Object.keys(s).find((e=>nf.includes(e)))||o.autoFetchSvg){const e=Sh.get(n).defaultShortPrefixId;i.prefix=e,i.iconName=Qp(i.prefix,i.iconName)||i.iconName}}"fa"!==i.prefix&&"fa"!==r||(i.prefix=Yp()||"fas");return i}({values:e,family:c,styles:Op,config:up,canonical:u,givenPrefix:i})),function(e,t,n){let{prefix:i,iconName:r}=n;if(e||!i||!r)return{prefix:i,iconName:r};const s="fa"===t?Jp(r):{},o=Qp(i,r);r=s.iconName||o||r,i=s.prefix||i,"far"!==i||Op.far||!Op.fas||up.autoFetchSvg||(i="fas");return{prefix:i,iconName:r}}(n,i,u))}const tf=Th.filter((e=>e!==wh||e!==kh)),nf=Object.keys(Nh).filter((e=>e!==wh)).map((e=>Object.keys(Nh[e]))).flat();let rf=[],sf={};const of={},af=Object.keys(of);function lf(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return(sf[e]||[]).forEach((e=>{t=e.apply(null,[t,...i])})),t}function cf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];(sf[e]||[]).forEach((e=>{e.apply(null,n)}))}function uf(){const e=arguments[0],t=Array.prototype.slice.call(arguments,1);return of[e]?of[e].apply(null,t):void 0}function df(e){"fa"===e.prefix&&(e.prefix="fas");let{iconName:t}=e;const n=e.prefix||Yp();if(t)return t=Qp(n,t)||t,xp(hf.definitions,n,t)||xp(Ip.styles,n,t)}const hf=new class{constructor(){this.definitions={}}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=t.reduce(this._pullDefinitions,{});Object.keys(i).forEach((e=>{this.definitions[e]=sh(sh({},this.definitions[e]||{}),i[e]),Lp(e,i[e]);const t=Zh[wh][e];t&&Lp(t,i[e]),Hp()}))}reset(){this.definitions={}}_pullDefinitions(e,t){const n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map((t=>{const{prefix:i,iconName:r,icon:s}=n[t],o=s[2];e[i]||(e[i]={}),o.length>0&&o.forEach((t=>{"string"===typeof t&&(e[i][t]=s)})),e[i][r]=s})),e}},pf={i2svg:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gh?(cf("beforeI2svg",e),uf("pseudoElements2svg",e),uf("i2svg",e)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t}=e;var n;!1===up.autoReplaceSvg&&(up.autoReplaceSvg=!0),up.observeMutations=!0,n=()=>{mf({autoReplaceSvgRoot:t}),cf("watch",e)},gh&&(Ap?setTimeout(n,0):Cp.push(n))}},ff={noAuto:()=>{up.autoReplaceSvg=!1,up.observeMutations=!1,cf("noAuto")},config:up,dom:pf,parse:{icon:e=>{if(null===e)return null;if("object"===typeof e&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:Qp(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){const t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Xp(e[0]);return{prefix:n,iconName:Qp(n,t)||t}}if("string"===typeof e&&(e.indexOf("".concat(up.cssPrefix,"-"))>-1||e.match(tp))){const t=ef(e.split(" "),{skipLookups:!0});return{prefix:t.prefix||Yp(),iconName:Qp(t.prefix,t.iconName)||t.iconName}}if("string"===typeof e){const t=Yp();return{prefix:t,iconName:Qp(t,e)||e}}}},library:hf,findIconDefinition:df,toHtml:_p},mf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t=ph}=e;(Object.keys(Ip.styles).length>0||up.autoFetchSvg)&&gh&&up.autoReplaceSvg&&ff.dom.i2svg({node:t})};function gf(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map((e=>_p(e)))}}),Object.defineProperty(e,"node",{get:function(){if(!gh)return;const t=ph.createElement("div");return t.innerHTML=e.html,t.children}}),e}function vf(e){const{icons:{main:t,mask:n},prefix:i,iconName:r,transform:s,symbol:o,title:a,maskId:l,titleId:c,extra:u,watchable:d=!1}=e,{width:h,height:p}=n.found?n:t,f=Ph.includes(i),m=[up.replacementClass,r?"".concat(up.cssPrefix,"-").concat(r):""].filter((e=>-1===u.classes.indexOf(e))).filter((e=>""!==e||!!e)).concat(u.classes).join(" ");let g={children:[],attributes:sh(sh({},u.attributes),{},{"data-prefix":i,"data-icon":r,class:m,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(h," ").concat(p)})};const v=f&&!~u.classes.indexOf("fa-fw")?{width:"".concat(h/p*16*.0625,"em")}:{};d&&(g.attributes[Vh]=""),a&&(g.children.push({tag:"title",attributes:{id:g.attributes["aria-labelledby"]||"title-".concat(c||fp())},children:[a]}),delete g.attributes.title);const y=sh(sh({},g),{},{prefix:i,iconName:r,main:t,mask:n,maskId:l,transform:s,symbol:o,styles:sh(sh({},v),u.styles)}),{children:b,attributes:w}=n.found&&t.found?uf("generateAbstractMask",y)||{children:[],attributes:{}}:uf("generateAbstractIcon",y)||{children:[],attributes:{}};return y.children=b,y.attributes=w,o?function(e){let{prefix:t,iconName:n,children:i,attributes:r,symbol:s}=e;const o=!0===s?"".concat(t,"-").concat(up.cssPrefix,"-").concat(n):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:sh(sh({},r),{},{id:o}),children:i}]}]}(y):function(e){let{children:t,main:n,mask:i,attributes:r,styles:s,transform:o}=e;if(bp(o)&&n.found&&!i.found){const{width:e,height:t}=n,i={x:e/t/2,y:.5};r.style=yp(sh(sh({},s),{},{"transform-origin":"".concat(i.x+o.x/16,"em ").concat(i.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:t}]}(y)}function yf(e){const{content:t,width:n,height:i,transform:r,title:s,extra:o,watchable:a=!1}=e,l=sh(sh(sh({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});a&&(l[Vh]="");const c=sh({},o.styles);bp(r)&&(c.transform=function(e){let{transform:t,width:n=Fh,height:i=Fh,startCentered:r=!1}=e,s="";return s+=r&&vh?"translate(".concat(t.x/hp-n/2,"em, ").concat(t.y/hp-i/2,"em) "):r?"translate(calc(-50% + ".concat(t.x/hp,"em), calc(-50% + ").concat(t.y/hp,"em)) "):"translate(".concat(t.x/hp,"em, ").concat(t.y/hp,"em) "),s+="scale(".concat(t.size/hp*(t.flipX?-1:1),", ").concat(t.size/hp*(t.flipY?-1:1),") "),s+="rotate(".concat(t.rotate,"deg) "),s}({transform:r,startCentered:!0,width:n,height:i}),c["-webkit-transform"]=c.transform);const u=yp(c);u.length>0&&(l.style=u);const d=[];return d.push({tag:"span",attributes:l,children:[t]}),s&&d.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),d}const{styles:bf}=Ip;function wf(e){const t=e[0],n=e[1],[i]=e.slice(4);let r=null;return r=Array.isArray(i)?{tag:"g",attributes:{class:"".concat(up.cssPrefix,"-").concat(sp.GROUP)},children:[{tag:"path",attributes:{class:"".concat(up.cssPrefix,"-").concat(sp.SECONDARY),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(up.cssPrefix,"-").concat(sp.PRIMARY),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}},{found:!0,width:t,height:n,icon:r}}const kf={found:!1,width:512,height:512};function Tf(e,t){let n=t;return"fa"===t&&null!==up.styleDefault&&(t=Yp()),new Promise(((i,r)=>{if("fa"===n){const n=Jp(e)||{};e=n.iconName||e,t=n.prefix||t}if(e&&t&&bf[t]&&bf[t][e]){return i(wf(bf[t][e]))}!function(e,t){Hh||up.showMissingIcons||!e||console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}(e,t),i(sh(sh({},kf),{},{icon:up.showMissingIcons&&e&&uf("missingIconAbstract")||{}}))}))}const Sf=()=>{},Ef=up.measurePerformance&&mh&&mh.mark&&mh.measure?mh:{mark:Sf,measure:Sf},If='FA "6.7.2"',Cf=e=>{Ef.mark("".concat(If," ").concat(e," ends")),Ef.measure("".concat(If," ").concat(e),"".concat(If," ").concat(e," begins"),"".concat(If," ").concat(e," ends"))};var Pf=e=>(Ef.mark("".concat(If," ").concat(e," begins")),()=>Cf(e));const Af=()=>{};function _f(e){return"string"===typeof(e.getAttribute?e.getAttribute(Vh):null)}function xf(e){return ph.createElementNS("http://www.w3.org/2000/svg",e)}function Rf(e){return ph.createElement(e)}function Nf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{ceFn:n=("svg"===e.tag?xf:Rf)}=t;if("string"===typeof e)return ph.createTextNode(e);const i=n(e.tag);Object.keys(e.attributes||[]).forEach((function(t){i.setAttribute(t,e.attributes[t])}));return(e.children||[]).forEach((function(e){i.appendChild(Nf(e,{ceFn:n}))})),i}const Df={replace:function(e){const t=e[0];if(t.parentNode)if(e[1].forEach((e=>{t.parentNode.insertBefore(Nf(e),t)})),null===t.getAttribute(Vh)&&up.keepOriginalSource){let e=ph.createComment(function(e){let t=" ".concat(e.outerHTML," ");return t="".concat(t,"Font Awesome fontawesome.com "),t}(t));t.parentNode.replaceChild(e,t)}else t.remove()},nest:function(e){const t=e[0],n=e[1];if(~gp(t).indexOf(up.replacementClass))return Df.replace(e);const i=new RegExp("".concat(up.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const e=n[0].attributes.class.split(" ").reduce(((e,t)=>(t===up.replacementClass||t.match(i)?e.toSvg.push(t):e.toNode.push(t),e)),{toNode:[],toSvg:[]});n[0].attributes.class=e.toSvg.join(" "),0===e.toNode.length?t.removeAttribute("class"):t.setAttribute("class",e.toNode.join(" "))}const r=n.map((e=>_p(e))).join("\n");t.setAttribute(Vh,""),t.innerHTML=r}};function Lf(e){e()}function Of(e,t){const n="function"===typeof t?t:Af;if(0===e.length)n();else{let t=Lf;"async"===up.mutateApproach&&(t=hh.requestAnimationFrame||Lf),t((()=>{const t=!0===up.autoReplaceSvg?Df.replace:Df[up.autoReplaceSvg]||Df.replace,i=Pf("mutate");e.map(t),i(),n()}))}}let Mf=!1;function jf(){Mf=!0}function Ff(){Mf=!1}let Uf=null;function Vf(e){if(!fh)return;if(!up.observeMutations)return;const{treeCallback:t=Af,nodeCallback:n=Af,pseudoElementsCallback:i=Af,observeMutationsRoot:r=ph}=e;Uf=new fh((e=>{if(Mf)return;const r=Yp();mp(e).forEach((e=>{if("childList"===e.type&&e.addedNodes.length>0&&!_f(e.addedNodes[0])&&(up.searchPseudoElements&&i(e.target),t(e.target)),"attributes"===e.type&&e.target.parentNode&&up.searchPseudoElements&&i(e.target.parentNode),"attributes"===e.type&&_f(e.target)&&~rp.indexOf(e.attributeName))if("class"===e.attributeName&&function(e){const t=e.getAttribute?e.getAttribute($h):null,n=e.getAttribute?e.getAttribute(zh):null;return t&&n}(e.target)){const{prefix:t,iconName:n}=ef(gp(e.target));e.target.setAttribute($h,t||r),n&&e.target.setAttribute(zh,n)}else(s=e.target)&&s.classList&&s.classList.contains&&s.classList.contains(up.replacementClass)&&n(e.target);var s}))})),gh&&Uf.observe(r,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function Bf(e){const t=e.getAttribute("data-prefix"),n=e.getAttribute("data-icon"),i=void 0!==e.innerText?e.innerText.trim():"";let r=ef(gp(e));return r.prefix||(r.prefix=Yp()),t&&n&&(r.prefix=t,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=(s=r.prefix,o=e.innerText,(Bp[s]||{})[o]||Kp(r.prefix,Np(e.innerText)))),!r.iconName&&up.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=e.firstChild.data)),r;var s,o}function $f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0};const{iconName:n,prefix:i,rest:r}=Bf(e),s=function(e){const t=mp(e.attributes).reduce(((e,t)=>("class"!==e.name&&"style"!==e.name&&(e[t.name]=t.value),e)),{}),n=e.getAttribute("title"),i=e.getAttribute("data-fa-title-id");return up.autoA11y&&(n?t["aria-labelledby"]="".concat(up.replacementClass,"-title-").concat(i||fp()):(t["aria-hidden"]="true",t.focusable="false")),t}(e),o=lf("parseNodeAttributes",{},e);let a=t.styleParser?function(e){const t=e.getAttribute("style");let n=[];return t&&(n=t.split(";").reduce(((e,t)=>{const n=t.split(":"),i=n[0],r=n.slice(1);return i&&r.length>0&&(e[i]=r.join(":").trim()),e}),{})),n}(e):[];return sh({iconName:n,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:i,transform:pp,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:r,styles:a,attributes:s}},o)}const{styles:zf}=Ip;function Gf(e){const t="nest"===up.autoReplaceSvg?$f(e,{styleParser:!1}):$f(e);return~t.extra.classes.indexOf(np)?uf("generateLayersText",e,t):uf("generateSvgReplacementMutation",e,t)}function qf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!gh)return Promise.resolve();const n=ph.documentElement.classList,i=e=>n.add("".concat(Gh,"-").concat(e)),r=e=>n.remove("".concat(Gh,"-").concat(e)),s=up.autoFetchSvg?[...Eh,...Dh]:bh.concat(Object.keys(zf));s.includes("fa")||s.push("fa");const o=[".".concat(np,":not([").concat(Vh,"])")].concat(s.map((e=>".".concat(e,":not([").concat(Vh,"])")))).join(", ");if(0===o.length)return Promise.resolve();let a=[];try{a=mp(e.querySelectorAll(o))}catch(u){}if(!(a.length>0))return Promise.resolve();i("pending"),r("complete");const l=Pf("onTree"),c=a.reduce(((e,t)=>{try{const n=Gf(t);n&&e.push(n)}catch(u){Hh||"MissingIcon"===u.name&&console.error(u)}return e}),[]);return new Promise(((e,n)=>{Promise.all(c).then((n=>{Of(n,(()=>{i("active"),i("complete"),r("pending"),"function"===typeof t&&t(),l(),e()}))})).catch((e=>{l(),n(e)}))}))}function Hf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Gf(e).then((e=>{e&&Of([e],t)}))}const Wf=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:n=pp,symbol:i=!1,mask:r=null,maskId:s=null,title:o=null,titleId:a=null,classes:l=[],attributes:c={},styles:u={}}=t;if(!e)return;const{prefix:d,iconName:h,icon:p}=e;return gf(sh({type:"icon"},e),(()=>(cf("beforeDOMElementCreation",{iconDefinition:e,params:t}),up.autoA11y&&(o?c["aria-labelledby"]="".concat(up.replacementClass,"-title-").concat(a||fp()):(c["aria-hidden"]="true",c.focusable="false")),vf({icons:{main:wf(p),mask:r?wf(r.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:h,transform:sh(sh({},pp),n),symbol:i,title:o,maskId:s,titleId:a,extra:{attributes:c,styles:u,classes:l}}))))};var Kf={mixout(){return{icon:(e=Wf,function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=(t||{}).icon?t:df(t||{});let{mask:r}=n;return r&&(r=(r||{}).icon?r:df(r||{})),e(i,sh(sh({},n),{},{mask:r}))})};var e},hooks:()=>({mutationObserverCallbacks:e=>(e.treeCallback=qf,e.nodeCallback=Hf,e)}),provides(e){e.i2svg=function(e){const{node:t=ph,callback:n=()=>{}}=e;return qf(t,n)},e.generateSvgReplacementMutation=function(e,t){const{iconName:n,title:i,titleId:r,prefix:s,transform:o,symbol:a,mask:l,maskId:c,extra:u}=t;return new Promise(((t,d)=>{Promise.all([Tf(n,s),l.iconName?Tf(l.iconName,l.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then((l=>{let[d,h]=l;t([e,vf({icons:{main:d,mask:h},prefix:s,iconName:n,transform:o,symbol:a,maskId:c,title:i,titleId:r,extra:u,watchable:!0})])})).catch(d)}))},e.generateAbstractIcon=function(e){let{children:t,attributes:n,main:i,transform:r,styles:s}=e;const o=yp(s);let a;return o.length>0&&(n.style=o),bp(r)&&(a=uf("generateAbstractTransformGrouping",{main:i,transform:r,containerWidth:i.width,iconWidth:i.width})),t.push(a||i.icon),{children:t,attributes:n}}}},Qf={mixout:()=>({layer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{classes:n=[]}=t;return gf({type:"layer"},(()=>{cf("beforeDOMElementCreation",{assembler:e,params:t});let i=[];return e((e=>{Array.isArray(e)?e.map((e=>{i=i.concat(e.abstract)})):i=i.concat(e.abstract)})),[{tag:"span",attributes:{class:["".concat(up.cssPrefix,"-layers"),...n].join(" ")},children:i}]}))}})},Jf={mixout:()=>({counter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{title:n=null,classes:i=[],attributes:r={},styles:s={}}=t;return gf({type:"counter",content:e},(()=>(cf("beforeDOMElementCreation",{content:e,params:t}),function(e){const{content:t,title:n,extra:i}=e,r=sh(sh(sh({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),s=yp(i.styles);s.length>0&&(r.style=s);const o=[];return o.push({tag:"span",attributes:r,children:[t]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}({content:e.toString(),title:n,extra:{attributes:r,styles:s,classes:["".concat(up.cssPrefix,"-layers-counter"),...i]}}))))}})},Yf={mixout:()=>({text(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:n=pp,title:i=null,classes:r=[],attributes:s={},styles:o={}}=t;return gf({type:"text",content:e},(()=>(cf("beforeDOMElementCreation",{content:e,params:t}),yf({content:e,transform:sh(sh({},pp),n),title:i,extra:{attributes:s,styles:o,classes:["".concat(up.cssPrefix,"-layers-text"),...r]}}))))}}),provides(e){e.generateLayersText=function(e,t){const{title:n,transform:i,extra:r}=t;let s=null,o=null;if(vh){const t=parseInt(getComputedStyle(e).fontSize,10),n=e.getBoundingClientRect();s=n.width/t,o=n.height/t}return up.autoA11y&&!n&&(r.attributes["aria-hidden"]="true"),Promise.resolve([e,yf({content:e.innerHTML,width:s,height:o,transform:i,title:n,extra:r,watchable:!0})])}}};const Xf=new RegExp('"',"ug"),Zf=[1105920,1112319],em=sh(sh(sh(sh({},{FontAwesome:{normal:"fas",400:"fas"}}),{"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}}),{"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}}),{"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}}),tm=Object.keys(em).reduce(((e,t)=>(e[t.toLowerCase()]=em[t],e)),{}),nm=Object.keys(tm).reduce(((e,t)=>{const n=tm[t];return e[t]=n[900]||[...Object.entries(n)][0][1],e}),{});function im(e,t){const n="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(((i,r)=>{if(null!==e.getAttribute(n))return i();const s=mp(e.children).filter((e=>e.getAttribute(Bh)===t))[0],o=hh.getComputedStyle(e,t),a=o.getPropertyValue("font-family"),l=a.match(ip),c=o.getPropertyValue("font-weight"),u=o.getPropertyValue("content");if(s&&!l)return e.removeChild(s),i();if(l&&"none"!==u&&""!==u){const u=o.getPropertyValue("content");let d=function(e,t){const n=e.replace(/^['"]|['"]$/g,"").toLowerCase(),i=parseInt(t),r=isNaN(i)?"normal":i;return(tm[n]||{})[r]||nm[n]}(a,c);const{value:h,isSecondary:p}=function(e){const t=e.replace(Xf,""),n=function(e,t){const n=e.length;let i,r=e.charCodeAt(t);return r>=55296&&r<=56319&&n>t+1&&(i=e.charCodeAt(t+1),i>=56320&&i<=57343)?1024*(r-55296)+i-56320+65536:r}(t,0),i=n>=Zf[0]&&n<=Zf[1],r=2===t.length&&t[0]===t[1];return{value:Np(r?t[0]:t),isSecondary:i||r}}(u),f=l[0].startsWith("FontAwesome");let m=Kp(d,h),g=m;if(f){const e=function(e){const t=zp[e],n=Kp("fas",e);return t||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}(h);e.iconName&&e.prefix&&(m=e.iconName,d=e.prefix)}if(!m||p||s&&s.getAttribute($h)===d&&s.getAttribute(zh)===g)i();else{e.setAttribute(n,g),s&&e.removeChild(s);const o={iconName:null,title:null,titleId:null,prefix:null,transform:pp,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}},{extra:a}=o;a.attributes[Bh]=t,Tf(m,d).then((r=>{const s=vf(sh(sh({},o),{},{icons:{main:r,mask:{prefix:null,iconName:null,rest:[]}},prefix:d,iconName:g,extra:a,watchable:!0})),l=ph.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===t?e.insertBefore(l,e.firstChild):e.appendChild(l),l.outerHTML=s.map((e=>_p(e))).join("\n"),e.removeAttribute(n),i()})).catch(r)}}else i()}))}function rm(e){return Promise.all([im(e,"::before"),im(e,"::after")])}function sm(e){return e.parentNode!==document.head&&!~qh.indexOf(e.tagName.toUpperCase())&&!e.getAttribute(Bh)&&(!e.parentNode||"svg"!==e.parentNode.tagName)}function om(e){if(gh)return new Promise(((t,n)=>{const i=mp(e.querySelectorAll("*")).filter(sm).map(rm),r=Pf("searchPseudoElements");jf(),Promise.all(i).then((()=>{r(),Ff(),t()})).catch((()=>{r(),Ff(),n()}))}))}var am={hooks:()=>({mutationObserverCallbacks:e=>(e.pseudoElementsCallback=om,e)}),provides(e){e.pseudoElements2svg=function(e){const{node:t=ph}=e;up.searchPseudoElements&&om(t)}}};let lm=!1;var cm={mixout:()=>({dom:{unwatch(){jf(),lm=!0}}}),hooks:()=>({bootstrap(){Vf(lf("mutationObserverCallbacks",{}))},noAuto(){Uf&&Uf.disconnect()},watch(e){const{observeMutationsRoot:t}=e;lm?Ff():Vf(lf("mutationObserverCallbacks",{observeMutationsRoot:t}))}})};const um=e=>e.toLowerCase().split(" ").reduce(((e,t)=>{const n=t.toLowerCase().split("-"),i=n[0];let r=n.slice(1).join("-");if(i&&"h"===r)return e.flipX=!0,e;if(i&&"v"===r)return e.flipY=!0,e;if(r=parseFloat(r),isNaN(r))return e;switch(i){case"grow":e.size=e.size+r;break;case"shrink":e.size=e.size-r;break;case"left":e.x=e.x-r;break;case"right":e.x=e.x+r;break;case"up":e.y=e.y-r;break;case"down":e.y=e.y+r;break;case"rotate":e.rotate=e.rotate+r}return e}),{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0});var dm={mixout:()=>({parse:{transform:e=>um(e)}}),hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-transform");return n&&(e.transform=um(n)),e}}),provides(e){e.generateAbstractTransformGrouping=function(e){let{main:t,transform:n,containerWidth:i,iconWidth:r}=e;const s={transform:"translate(".concat(i/2," 256)")},o="translate(".concat(32*n.x,", ").concat(32*n.y,") "),a="scale(".concat(n.size/16*(n.flipX?-1:1),", ").concat(n.size/16*(n.flipY?-1:1),") "),l="rotate(".concat(n.rotate," 0 0)"),c={outer:s,inner:{transform:"".concat(o," ").concat(a," ").concat(l)},path:{transform:"translate(".concat(r/2*-1," -256)")}};return{tag:"g",attributes:sh({},c.outer),children:[{tag:"g",attributes:sh({},c.inner),children:[{tag:t.icon.tag,children:t.icon.children,attributes:sh(sh({},t.icon.attributes),c.path)}]}]}}}};const hm={x:0,y:0,width:"100%",height:"100%"};function pm(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}var fm={hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-mask"),i=n?ef(n.split(" ").map((e=>e.trim()))):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=Yp()),e.mask=i,e.maskId=t.getAttribute("data-fa-mask-id"),e}}),provides(e){e.generateAbstractMask=function(e){let{children:t,attributes:n,main:i,mask:r,maskId:s,transform:o}=e;const{width:a,icon:l}=i,{width:c,icon:u}=r,d=function(e){let{transform:t,containerWidth:n,iconWidth:i}=e;const r={transform:"translate(".concat(n/2," 256)")},s="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),a="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(i/2*-1," -256)")}}}({transform:o,containerWidth:c,iconWidth:a}),h={tag:"rect",attributes:sh(sh({},hm),{},{fill:"white"})},p=l.children?{children:l.children.map(pm)}:{},f={tag:"g",attributes:sh({},d.inner),children:[pm(sh({tag:l.tag,attributes:sh(sh({},l.attributes),d.path)},p))]},m={tag:"g",attributes:sh({},d.outer),children:[f]},g="mask-".concat(s||fp()),v="clip-".concat(s||fp()),y={tag:"mask",attributes:sh(sh({},hm),{},{id:g,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[h,m]},b={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:(w=u,"g"===w.tag?w.children:[w])},y]};var w;return t.push(b,{tag:"rect",attributes:sh({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(g,")")},hm)}),{children:t,attributes:n}}}};!function(e,t){let{mixoutsTo:n}=t;rf=e,sf={},Object.keys(of).forEach((e=>{-1===af.indexOf(e)&&delete of[e]})),rf.forEach((e=>{const t=e.mixout?e.mixout():{};if(Object.keys(t).forEach((e=>{"function"===typeof t[e]&&(n[e]=t[e]),"object"===typeof t[e]&&Object.keys(t[e]).forEach((i=>{n[e]||(n[e]={}),n[e][i]=t[e][i]}))})),e.hooks){const t=e.hooks();Object.keys(t).forEach((e=>{sf[e]||(sf[e]=[]),sf[e].push(t[e])}))}e.provides&&e.provides(of)}))}([Sp,Kf,Qf,Jf,Yf,am,cm,dm,fm,{provides(e){let t=!1;hh.matchMedia&&(t=hh.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){const e=[],n={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};e.push({tag:"path",attributes:sh(sh({},n),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const r=sh(sh({},i),{},{attributeName:"opacity"}),s={tag:"circle",attributes:sh(sh({},n),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||s.children.push({tag:"animate",attributes:sh(sh({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:sh(sh({},r),{},{values:"1;0;1;1;0;1;"})}),e.push(s),e.push({tag:"path",attributes:sh(sh({},n),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:sh(sh({},r),{},{values:"1;0;0;0;0;1;"})}]}),t||e.push({tag:"path",attributes:sh(sh({},n),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:sh(sh({},r),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:e}}}},{hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-symbol"),i=null!==n&&(""===n||n);return e.symbol=i,e}})}],{mixoutsTo:ff});const mm=ff.parse,gm=ff.icon;var vm=n(173),ym=n.n(vm);function bm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function wm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bm(Object(n),!0).forEach((function(t){Tm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function km(e){return km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},km(e)}function Tm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sm(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Em(e){return function(e){if(Array.isArray(e))return Im(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Im(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Im(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Im(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Cm(e){return t=e,(t-=0)===t?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1);var t}var Pm=["style"];var Am=!1;try{Am=!0}catch(vC){}function _m(e){return e&&"object"===km(e)&&e.prefix&&e.iconName&&e.icon?e:mm.icon?mm.icon(e):null===e?null:e&&"object"===km(e)&&e.prefix&&e.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"===typeof e?{prefix:"fas",iconName:e}:void 0}function xm(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?Tm({},e,t):{}}var Rm={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},Nm=a.forwardRef((function(e,t){var n=wm(wm({},Rm),e),i=n.icon,r=n.mask,s=n.symbol,o=n.className,a=n.title,l=n.titleId,c=n.maskId,u=_m(i),d=xm("classes",[].concat(Em(function(e){var t,n=e.beat,i=e.fade,r=e.beatFade,s=e.bounce,o=e.shake,a=e.flash,l=e.spin,c=e.spinPulse,u=e.spinReverse,d=e.pulse,h=e.fixedWidth,p=e.inverse,f=e.border,m=e.listItem,g=e.flip,v=e.size,y=e.rotation,b=e.pull,w=(Tm(t={"fa-beat":n,"fa-fade":i,"fa-beat-fade":r,"fa-bounce":s,"fa-shake":o,"fa-flash":a,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":d,"fa-fw":h,"fa-inverse":p,"fa-border":f,"fa-li":m,"fa-flip":!0===g,"fa-flip-horizontal":"horizontal"===g||"both"===g,"fa-flip-vertical":"vertical"===g||"both"===g},"fa-".concat(v),"undefined"!==typeof v&&null!==v),Tm(t,"fa-rotate-".concat(y),"undefined"!==typeof y&&null!==y&&0!==y),Tm(t,"fa-pull-".concat(b),"undefined"!==typeof b&&null!==b),Tm(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(w).map((function(e){return w[e]?e:null})).filter((function(e){return e}))}(n)),Em((o||"").split(" ")))),h=xm("transform","string"===typeof n.transform?mm.transform(n.transform):n.transform),p=xm("mask",_m(r)),f=gm(u,wm(wm(wm(wm({},d),h),p),{},{symbol:s,title:a,titleId:l,maskId:c}));if(!f)return function(){var e;!Am&&console&&"function"===typeof console.error&&(e=console).error.apply(e,arguments)}("Could not find icon",u),null;var m=f.abstract,g={ref:t};return Object.keys(n).forEach((function(e){Rm.hasOwnProperty(e)||(g[e]=n[e])})),Dm(m[0],g)}));Nm.displayName="FontAwesomeIcon",Nm.propTypes={beat:ym().bool,border:ym().bool,beatFade:ym().bool,bounce:ym().bool,className:ym().string,fade:ym().bool,flash:ym().bool,mask:ym().oneOfType([ym().object,ym().array,ym().string]),maskId:ym().string,fixedWidth:ym().bool,inverse:ym().bool,flip:ym().oneOf([!0,!1,"horizontal","vertical","both"]),icon:ym().oneOfType([ym().object,ym().array,ym().string]),listItem:ym().bool,pull:ym().oneOf(["right","left"]),pulse:ym().bool,rotation:ym().oneOf([0,90,180,270]),shake:ym().bool,size:ym().oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:ym().bool,spinPulse:ym().bool,spinReverse:ym().bool,symbol:ym().oneOfType([ym().bool,ym().string]),title:ym().string,titleId:ym().string,transform:ym().oneOfType([ym().string,ym().object]),swapOpacity:ym().bool};var Dm=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof n)return n;var r=(n.children||[]).map((function(n){return e(t,n)})),s=Object.keys(n.attributes||{}).reduce((function(e,t){var i=n.attributes[t];switch(t){case"class":e.attrs.className=i,delete n.attributes.class;break;case"style":e.attrs.style=i.split(";").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var n,i=t.indexOf(":"),r=Cm(t.slice(0,i)),s=t.slice(i+1).trim();return r.startsWith("webkit")?e[(n=r,n.charAt(0).toUpperCase()+n.slice(1))]=s:e[r]=s,e}),{});break;default:0===t.indexOf("aria-")||0===t.indexOf("data-")?e.attrs[t.toLowerCase()]=i:e.attrs[Cm(t)]=i}return e}),{attrs:{}}),o=i.style,a=void 0===o?{}:o,l=Sm(i,Pm);return s.attrs.style=wm(wm({},s.attrs.style),a),t.apply(void 0,[n.tag,wm(wm({},s.attrs),l)].concat(Em(r)))}.bind(null,a.createElement);const Lm={prefix:"fas",iconName:"stethoscope",icon:[576,512,[129658],"f0f1","M142.4 21.9c5.6 16.8-3.5 34.9-20.2 40.5L96 71.1 96 192c0 53 43 96 96 96s96-43 96-96l0-120.9-26.1-8.7c-16.8-5.6-25.8-23.7-20.2-40.5s23.7-25.8 40.5-20.2l26.1 8.7C334.4 19.1 352 43.5 352 71.1L352 192c0 77.2-54.6 141.6-127.3 156.7C231 404.6 278.4 448 336 448c61.9 0 112-50.1 112-112l0-70.7c-28.3-12.3-48-40.5-48-73.3c0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3l0 70.7c0 97.2-78.8 176-176 176c-92.9 0-168.9-71.9-175.5-163.1C87.2 334.2 32 269.6 32 192L32 71.1c0-27.5 17.6-52 43.8-60.7l26.1-8.7c16.8-5.6 34.9 3.5 40.5 20.2zM480 224a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"]},Om={prefix:"fas",iconName:"calendar-days",icon:[448,512,["calendar-alt"],"f073","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm64 80l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm128 0l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zM64 400l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zm112 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16z"]},Mm=Om,jm={prefix:"fas",iconName:"right-from-bracket",icon:[512,512,["sign-out-alt"],"f2f5","M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"]},Fm=jm,Um={prefix:"fas",iconName:"comments",icon:[640,512,[128490,61670],"f086","M208 352c114.9 0 208-78.8 208-176S322.9 0 208 0S0 78.8 0 176c0 38.6 14.7 74.3 39.6 103.4c-3.5 9.4-8.7 17.7-14.2 24.7c-4.8 6.2-9.7 11-13.3 14.3c-1.8 1.6-3.3 2.9-4.3 3.7c-.5 .4-.9 .7-1.1 .8l-.2 .2s0 0 0 0s0 0 0 0C1 327.2-1.4 334.4 .8 340.9S9.1 352 16 352c21.8 0 43.8-5.6 62.1-12.5c9.2-3.5 17.8-7.4 25.2-11.4C134.1 343.3 169.8 352 208 352zM448 176c0 112.3-99.1 196.9-216.5 207C255.8 457.4 336.4 512 432 512c38.2 0 73.9-8.7 104.7-23.9c7.5 4 16 7.9 25.2 11.4c18.3 6.9 40.3 12.5 62.1 12.5c6.9 0 13.1-4.5 15.2-11.1c2.1-6.6-.2-13.8-5.8-17.9c0 0 0 0 0 0s0 0 0 0l-.2-.2c-.2-.2-.6-.4-1.1-.8c-1-.8-2.5-2-4.3-3.7c-3.6-3.3-8.5-8.1-13.3-14.3c-5.5-7-10.7-15.4-14.2-24.7c24.9-29 39.6-64.7 39.6-103.4c0-92.8-84.9-168.9-192.6-175.5c.4 5.1 .6 10.3 .6 15.5z"]},Vm={prefix:"fas",iconName:"users",icon:[640,512,[],"f0c0","M144 0a80 80 0 1 1 0 160A80 80 0 1 1 144 0zM512 0a80 80 0 1 1 0 160A80 80 0 1 1 512 0zM0 298.7C0 239.8 47.8 192 106.7 192l42.7 0c15.9 0 31 3.5 44.6 9.7c-1.3 7.2-1.9 14.7-1.9 22.3c0 38.2 16.8 72.5 43.3 96c-.2 0-.4 0-.7 0L21.3 320C9.6 320 0 310.4 0 298.7zM405.3 320c-.2 0-.4 0-.7 0c26.6-23.5 43.3-57.8 43.3-96c0-7.6-.7-15-1.9-22.3c13.6-6.3 28.7-9.7 44.6-9.7l42.7 0C592.2 192 640 239.8 640 298.7c0 11.8-9.6 21.3-21.3 21.3l-213.3 0zM224 224a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zM128 485.3C128 411.7 187.7 352 261.3 352l117.3 0C452.3 352 512 411.7 512 485.3c0 14.7-11.9 26.7-26.7 26.7l-330.7 0c-14.7 0-26.7-11.9-26.7-26.7z"]},Bm={prefix:"fas",iconName:"notes-medical",icon:[512,512,[],"f481","M96 352L96 96c0-35.3 28.7-64 64-64l256 0c35.3 0 64 28.7 64 64l0 197.5c0 17-6.7 33.3-18.7 45.3l-58.5 58.5c-12 12-28.3 18.7-45.3 18.7L160 416c-35.3 0-64-28.7-64-64zM272 128c-8.8 0-16 7.2-16 16l0 48-48 0c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l48 0 0 48c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-48 48 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-48 0 0-48c0-8.8-7.2-16-16-16l-32 0zm24 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-160 0C60.9 512 0 451.1 0 376L0 152c0-13.3 10.7-24 24-24s24 10.7 24 24l0 224c0 48.6 39.4 88 88 88l160 0z"]},$m={prefix:"fas",iconName:"user",icon:[448,512,[128100,62144],"f007","M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"]},zm={prefix:"fas",iconName:"star",icon:[576,512,[11088,61446],"f005","M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"]},Gm={prefix:"fas",iconName:"prescription",icon:[448,512,[],"f5b1","M32 0C14.3 0 0 14.3 0 32L0 192l0 96c0 17.7 14.3 32 32 32s32-14.3 32-32l0-64 50.7 0 128 128L137.4 457.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L288 397.3 393.4 502.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L333.3 352 438.6 246.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 306.7l-85.8-85.8C251.4 209.1 288 164.8 288 112C288 50.1 237.9 0 176 0L32 0zM176 160L64 160l0-96 112 0c26.5 0 48 21.5 48 48s-21.5 48-48 48z"]},qm={prefix:"fas",iconName:"arrow-left",icon:[448,512,[8592],"f060","M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"]},Hm={prefix:"fas",iconName:"user-doctor",icon:[448,512,["user-md"],"f0f0","M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-96 55.2C54 332.9 0 401.3 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7c0-81-54-149.4-128-171.1l0 50.8c27.6 7.1 48 32.2 48 62l0 40c0 8.8-7.2 16-16 16l-16 0c-8.8 0-16-7.2-16-16s7.2-16 16-16l0-24c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 24c8.8 0 16 7.2 16 16s-7.2 16-16 16l-16 0c-8.8 0-16-7.2-16-16l0-40c0-29.8 20.4-54.9 48-62l0-57.1c-6-.6-12.1-.9-18.3-.9l-91.4 0c-6.2 0-12.3 .3-18.3 .9l0 65.4c23.1 6.9 40 28.3 40 53.7c0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.4 16.9-46.8 40-53.7l0-59.1zM144 448a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"]},Wm=Hm,Km={prefix:"fas",iconName:"clock",icon:[512,512,[128339,"clock-four"],"f017","M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"]},Qm={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"]},Jm=Qm,Ym={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"]},Xm={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},Zm={prefix:"fas",iconName:"briefcase",icon:[512,512,[128188],"f0b1","M184 48l144 0c4.4 0 8 3.6 8 8l0 40L176 96l0-40c0-4.4 3.6-8 8-8zm-56 8l0 40L64 96C28.7 96 0 124.7 0 160l0 96 192 0 128 0 192 0 0-96c0-35.3-28.7-64-64-64l-64 0 0-40c0-30.9-25.1-56-56-56L184 0c-30.9 0-56 25.1-56 56zM512 288l-192 0 0 32c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-32L0 288 0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-128z"]},eg={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]},tg=eg,ng={prefix:"fas",iconName:"calendar-day",icon:[448,512,[],"f783","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm80 64c-8.8 0-16 7.2-16 16l0 96c0 8.8 7.2 16 16 16l96 0c8.8 0 16-7.2 16-16l0-96c0-8.8-7.2-16-16-16l-96 0z"]},ig={prefix:"fas",iconName:"circle-xmark",icon:[512,512,[61532,"times-circle","xmark-circle"],"f057","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"]},rg=ig,sg={prefix:"fas",iconName:"video",icon:[576,512,["video-camera"],"f03d","M0 128C0 92.7 28.7 64 64 64l256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64L0 128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2l0 256c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1l0-17.1 0-128 0-17.1 14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"]},og={prefix:"fas",iconName:"graduation-cap",icon:[640,512,[127891,"mortar-board"],"f19d","M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9l0 28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5l0-24.6c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"]};function ag(e,t){-1===e.indexOf(t)&&e.push(t)}function lg(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const cg=e=>e;let ug=cg,dg=cg;const hg=!1,pg=!1;function fg(e){let t;return()=>(void 0===t&&(t=e()),t)}const mg=(e,t,n)=>{const i=t-e;return 0===i?1:(n-e)/i};class gg{constructor(){this.subscriptions=[]}add(e){return ag(this.subscriptions,e),()=>lg(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(1===i)this.subscriptions[0](e,t,n);else for(let r=0;r<i;r++){const i=this.subscriptions[r];i&&i(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vg=e=>1e3*e,yg=e=>e/1e3;function bg(e,t){return t?e*(1e3/t):0}new Set;function wg(e){if("undefined"===typeof Proxy)return e;const t=new Map;return new Proxy((function(){return e(...arguments)}),{get:(n,i)=>"create"===i?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}function kg(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function Tg(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach(((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()})),t}function Sg(e,t,n,i){if("function"===typeof t){const[r,s]=Tg(i);t=t(void 0!==n?n:e.custom,r,s)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[r,s]=Tg(i);t=t(void 0!==n?n:e.custom,r,s)}return t}function Eg(e,t,n){const i=e.getProps();return Sg(i,t,void 0!==n?n:i.custom,e)}const Ig=fg((()=>void 0!==window.ScrollTimeline));class Cg{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map((e=>"finished"in e?e.finished:e)))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map((n=>Ig()&&n.attachTimeline?n.attachTimeline(e):"function"===typeof t?t(n):void 0));return()=>{n.forEach(((e,t)=>{e&&e(),this.animations[t].stop()}))}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach((t=>t[e]()))}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Pg extends Cg{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Ag(e,t){return e?e[t]||e.default||e:void 0}const _g=2e4;function xg(e){let t=0;let n=e.next(t);for(;!n.done&&t<_g;)t+=50,n=e.next(t);return t>=_g?1/0:t}function Rg(e){return"function"===typeof e}function Ng(e,t){e.timeline=t,e.onfinish=null}const Dg=e=>Array.isArray(e)&&"number"===typeof e[0],Lg={linearEasing:void 0};function Og(e,t){const n=fg(e);return()=>{var e;return null!==(e=Lg[t])&&void 0!==e?e:n()}}const Mg=Og((()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(vC){return!1}return!0}),"linearEasing"),jg=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i="";const r=Math.max(Math.round(t/n),2);for(let s=0;s<r;s++)i+=e(mg(0,r-1,s))+", ";return`linear(${i.substring(0,i.length-2)})`};function Fg(e){return Boolean("function"===typeof e&&Mg()||!e||"string"===typeof e&&(e in Vg||Mg())||Dg(e)||Array.isArray(e)&&e.every(Fg))}const Ug=e=>{let[t,n,i,r]=e;return`cubic-bezier(${t}, ${n}, ${i}, ${r})`},Vg={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ug([0,.65,.55,1]),circOut:Ug([.55,0,1,.45]),backIn:Ug([.31,.01,.66,-.59]),backOut:Ug([.33,1.53,.69,.99])};function Bg(e,t){return e?"function"===typeof e&&Mg()?jg(e,t):Dg(e)?Ug(e):Array.isArray(e)?e.map((e=>Bg(e,t)||Vg.easeOut)):Vg[e]:void 0}const $g=["read","resolveKeyframes","update","preRender","render","postRender"],zg={value:null,addProjectionMetrics:null};function Gg(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=$g.reduce(((e,n)=>(e[n]=function(e,t){let n=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){o.has(t)&&(u.schedule(t),e()),l++,t(a)}const u={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&r?n:i;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.add(e),t.has(e)||t.add(e),e},cancel:e=>{i.delete(e),o.delete(e)},process:e=>{a=e,r?s=!0:(r=!0,[n,i]=[i,n],n.forEach(c),t&&zg.value&&zg.value.frameloop[t].push(l),l=0,n.clear(),r=!1,s&&(s=!1,u.process(e)))}};return u}(s,t?n:void 0),e)),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:d,postRender:h}=o,p=()=>{const s=pg?r.timestamp:performance.now();n=!1,pg||(r.delta=i?1e3/60:Math.max(Math.min(s-r.timestamp,40),1)),r.timestamp=s,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),d.process(r),h.process(r),r.isProcessing=!1,n&&t&&(i=!1,e(p))},f=$g.reduce(((t,s)=>{const a=o[s];return t[s]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,i=!0,r.isProcessing||e(p)),a.schedule(t,s,o)},t}),{});return{schedule:f,cancel:e=>{for(let t=0;t<$g.length;t++)o[$g[t]].cancel(e)},state:r,steps:o}}const{schedule:qg,cancel:Hg,state:Wg,steps:Kg}=Gg("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:cg,!0),{schedule:Qg,cancel:Jg}=Gg(queueMicrotask,!1);let Yg;function Xg(){Yg=void 0}const Zg={now:()=>(void 0===Yg&&Zg.set(Wg.isProcessing||pg?Wg.timestamp:performance.now()),Yg),set:e=>{Yg=e,queueMicrotask(Xg)}},ev={x:!1,y:!1};function tv(){return ev.x||ev.y}function nv(e,t){const n=function(e,t,n){var i;if(e instanceof EventTarget)return[e];if("string"===typeof e){let r=document;t&&(r=t.current);const s=null!==(i=null===n||void 0===n?void 0:n[e])&&void 0!==i?i:r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}(e),i=new AbortController;return[n,{passive:!0,...t,signal:i.signal},()=>i.abort()]}function iv(e){return!("touch"===e.pointerType||tv())}function rv(e,t){const n=`${t}PointerCapture`;if(e.target instanceof Element&&n in e.target&&void 0!==e.pointerId)try{e.target[n](e.pointerId)}catch(vC){}}const sv=(e,t)=>!!t&&(e===t||sv(e,t.parentElement)),ov=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary,av=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const lv=new WeakSet;function cv(e){return t=>{"Enter"===t.key&&e(t)}}function uv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function dv(e){return ov(e)&&!tv()}function hv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[i,r,s]=nv(e,n),o=e=>{const n=e.currentTarget;if(!n||!dv(e)||lv.has(n))return;lv.add(n),rv(e,"set");const i=t(n,e),s=(e,t)=>{n.removeEventListener("pointerup",o),n.removeEventListener("pointercancel",a),rv(e,"release"),dv(e)&&lv.has(n)&&(lv.delete(n),"function"===typeof i&&i(e,{success:t}))},o=e=>{const t=!!e.isTrusted&&(i=e,r=n instanceof Element?n.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight},i.clientX<r.left||i.clientX>r.right||i.clientY<r.top||i.clientY>r.bottom);var i,r;s(e,!t&&(!(n instanceof Element)||sv(n,e.target)))},a=e=>{s(e,!1)};n.addEventListener("pointerup",o,r),n.addEventListener("pointercancel",a,r),n.addEventListener("lostpointercapture",a,r)};return i.forEach((e=>{let t=!1;var i;(e=n.useGlobalTarget?window:e)instanceof HTMLElement&&(t=!0,i=e,av.has(i.tagName)||-1!==i.tabIndex||null!==e.getAttribute("tabindex")||(e.tabIndex=0)),e.addEventListener("pointerdown",o,r),t&&e.addEventListener("focus",(e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const i=cv((()=>{if(lv.has(n))return;uv(n,"down");const e=cv((()=>{uv(n,"up")}));n.addEventListener("keyup",e,t),n.addEventListener("blur",(()=>uv(n,"cancel")),t)}));n.addEventListener("keydown",i,t),n.addEventListener("blur",(()=>n.removeEventListener("keydown",i)),t)})(e,r)),r)})),s}const pv={layout:0,mainThread:0,waapi:0};const fv={current:void 0};class mv{constructor(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=Zg.now();t.updatedAt!==i&&t.setPrevFrameValue(),t.prev=t.current,t.setCurrent(e),t.current!==t.prev&&t.events.change&&t.events.change.notify(t.current),n&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){var t;this.current=e,this.updatedAt=Zg.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new gg);const n=this.events[e].add(t);return"change"===e?()=>{n(),qg.read((()=>{this.events.change.getSize()||this.stop()}))}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return fv.current&&fv.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Zg.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return bg(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise((t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function gv(e,t){return new mv(e,t)}const vv=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yv=new Set(vv),bv=new Set(["width","height","top","left","right","bottom",...vv]),wv=e=>Array.isArray(e);function kv(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,gv(n))}const Tv=e=>Boolean(e&&e.getVelocity);function Sv(e,t){const n=e.getValue("willChange");if(i=n,Boolean(Tv(i)&&i.add))return n.add(t);var i}const Ev=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Iv="data-"+Ev("framerAppearId");function Cv(e){return e.props[Iv]}const Pv=!1,Av=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function _v(e,t,n,i){if(e===t&&n===i)return cg;const r=t=>function(e,t,n,i,r){let s,o,a=0;do{o=t+(n-t)/2,s=Av(o,i,r)-e,s>0?n=o:t=o}while(Math.abs(s)>1e-7&&++a<12);return o}(t,0,1,e,n);return e=>0===e||1===e?e:Av(r(e),t,i)}const xv=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Rv=e=>t=>1-e(1-t),Nv=_v(.33,1.53,.69,.99),Dv=Rv(Nv),Lv=xv(Dv),Ov=e=>(e*=2)<1?.5*Dv(e):.5*(2-Math.pow(2,-10*(e-1))),Mv=e=>1-Math.sin(Math.acos(e)),jv=Rv(Mv),Fv=xv(Mv),Uv=e=>/^0[^.\s]+$/u.test(e);const Vv=(e,t,n)=>n>t?t:n<e?e:n,Bv={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},$v={...Bv,transform:e=>Vv(0,1,e)},zv={...Bv,default:1},Gv=e=>Math.round(1e5*e)/1e5,qv=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const Hv=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Wv=(e,t)=>n=>Boolean("string"===typeof n&&Hv.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),Kv=(e,t,n)=>i=>{if("string"!==typeof i)return i;const[r,s,o,a]=i.match(qv);return{[e]:parseFloat(r),[t]:parseFloat(s),[n]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},Qv={...Bv,transform:e=>Math.round((e=>Vv(0,255,e))(e))},Jv={test:Wv("rgb","red"),parse:Kv("red","green","blue"),transform:e=>{let{red:t,green:n,blue:i,alpha:r=1}=e;return"rgba("+Qv.transform(t)+", "+Qv.transform(n)+", "+Qv.transform(i)+", "+Gv($v.transform(r))+")"}};const Yv={test:Wv("#"),parse:function(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}},transform:Jv.transform},Xv=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),Zv=Xv("deg"),ey=Xv("%"),ty=Xv("px"),ny=Xv("vh"),iy=Xv("vw"),ry={...ey,parse:e=>ey.parse(e)/100,transform:e=>ey.transform(100*e)},sy={test:Wv("hsl","hue"),parse:Kv("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:i,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+ey.transform(Gv(n))+", "+ey.transform(Gv(i))+", "+Gv($v.transform(r))+")"}},oy={test:e=>Jv.test(e)||Yv.test(e)||sy.test(e),parse:e=>Jv.test(e)?Jv.parse(e):sy.test(e)?sy.parse(e):Yv.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?Jv.transform(e):sy.transform(e)},ay=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const ly="number",cy="color",uy=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function dy(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},r=[];let s=0;const o=t.replace(uy,(e=>(oy.test(e)?(i.color.push(s),r.push(cy),n.push(oy.parse(e))):e.startsWith("var(")?(i.var.push(s),r.push("var"),n.push(e)):(i.number.push(s),r.push(ly),n.push(parseFloat(e))),++s,"${}"))).split("${}");return{values:n,split:o,indexes:i,types:r}}function hy(e){return dy(e).values}function py(e){const{split:t,types:n}=dy(e),i=t.length;return e=>{let r="";for(let s=0;s<i;s++)if(r+=t[s],void 0!==e[s]){const t=n[s];r+=t===ly?Gv(e[s]):t===cy?oy.transform(e[s]):e[s]}return r}}const fy=e=>"number"===typeof e?0:e;const my={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(qv))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(ay))||void 0===n?void 0:n.length)||0)>0},parse:hy,createTransformer:py,getAnimatableNone:function(e){const t=hy(e);return py(e)(t.map(fy))}},gy=new Set(["brightness","contrast","saturate","opacity"]);function vy(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[i]=n.match(qv)||[];if(!i)return e;const r=n.replace(i,"");let s=gy.has(t)?1:0;return i!==n&&(s*=100),t+"("+s+r+")"}const yy=/\b([a-z-]*)\(.*?\)/gu,by={...my,getAnimatableNone:e=>{const t=e.match(yy);return t?t.map(vy).join(" "):e}},wy={borderWidth:ty,borderTopWidth:ty,borderRightWidth:ty,borderBottomWidth:ty,borderLeftWidth:ty,borderRadius:ty,radius:ty,borderTopLeftRadius:ty,borderTopRightRadius:ty,borderBottomRightRadius:ty,borderBottomLeftRadius:ty,width:ty,maxWidth:ty,height:ty,maxHeight:ty,top:ty,right:ty,bottom:ty,left:ty,padding:ty,paddingTop:ty,paddingRight:ty,paddingBottom:ty,paddingLeft:ty,margin:ty,marginTop:ty,marginRight:ty,marginBottom:ty,marginLeft:ty,backgroundPositionX:ty,backgroundPositionY:ty},ky={rotate:Zv,rotateX:Zv,rotateY:Zv,rotateZ:Zv,scale:zv,scaleX:zv,scaleY:zv,scaleZ:zv,skew:Zv,skewX:Zv,skewY:Zv,distance:ty,translateX:ty,translateY:ty,translateZ:ty,x:ty,y:ty,z:ty,perspective:ty,transformPerspective:ty,opacity:$v,originX:ry,originY:ry,originZ:ty},Ty={...Bv,transform:Math.round},Sy={...wy,...ky,zIndex:Ty,size:ty,fillOpacity:$v,strokeOpacity:$v,numOctaves:Ty},Ey={...Sy,color:oy,backgroundColor:oy,outlineColor:oy,fill:oy,stroke:oy,borderColor:oy,borderTopColor:oy,borderRightColor:oy,borderBottomColor:oy,borderLeftColor:oy,filter:by,WebkitFilter:by},Iy=e=>Ey[e];function Cy(e,t){let n=Iy(e);return n!==by&&(n=my),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Py=new Set(["auto","none","0"]);const Ay=e=>180*e/Math.PI,_y=e=>{const t=Ay(Math.atan2(e[1],e[0]));return Ry(t)},xy={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:_y,rotateZ:_y,skewX:e=>Ay(Math.atan(e[1])),skewY:e=>Ay(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Ry=e=>((e%=360)<0&&(e+=360),e),Ny=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Dy=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Ly={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ny,scaleY:Dy,scale:e=>(Ny(e)+Dy(e))/2,rotateX:e=>Ry(Ay(Math.atan2(e[6],e[5]))),rotateY:e=>Ry(Ay(Math.atan2(-e[2],e[0]))),rotateZ:_y,rotate:_y,skewX:e=>Ay(Math.atan(e[4])),skewY:e=>Ay(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Oy(e){return e.includes("scale")?1:0}function My(e,t){if(!e||"none"===e)return Oy(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=Ly,r=n;else{const t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=xy,r=t}if(!r)return Oy(t);const s=i[t],o=r[1].split(",").map(jy);return"function"===typeof s?s(o):o[s]}function jy(e){return parseFloat(e.trim())}const Fy=e=>e===Bv||e===ty,Uy=new Set(["x","y","z"]),Vy=vv.filter((e=>!Uy.has(e)));const By={width:(e,t)=>{let{x:n}=e,{paddingLeft:i="0",paddingRight:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},height:(e,t)=>{let{y:n}=e,{paddingTop:i="0",paddingBottom:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:i}=t;return parseFloat(i)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:i}=t;return parseFloat(i)+(n.max-n.min)},x:(e,t)=>{let{transform:n}=t;return My(n,"x")},y:(e,t)=>{let{transform:n}=t;return My(n,"y")}};By.translateX=By.x,By.translateY=By.y;const $y=new Set;let zy=!1,Gy=!1;function qy(){if(Gy){const e=Array.from($y).filter((e=>e.needsMeasurement)),t=new Set(e.map((e=>e.element))),n=new Map;t.forEach((e=>{const t=function(e){const t=[];return Vy.forEach((n=>{const i=e.getValue(n);void 0!==i&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))})),t}(e);t.length&&(n.set(e,t),e.render())})),e.forEach((e=>e.measureInitialState())),t.forEach((e=>{e.render();const t=n.get(e);t&&t.forEach((t=>{let[n,i]=t;var r;null===(r=e.getValue(n))||void 0===r||r.set(i)}))})),e.forEach((e=>e.measureEndState())),e.forEach((e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)}))}Gy=!1,zy=!1,$y.forEach((e=>e.complete())),$y.clear()}function Hy(){$y.forEach((e=>{e.readKeyframes(),e.needsMeasurement&&(Gy=!0)}))}class Wy{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=r,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?($y.add(this),zy||(zy=!0,qg.read(Hy),qg.resolveKeyframes(qy))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;for(let r=0;r<e.length;r++)if(null===e[r])if(0===r){const r=null===i||void 0===i?void 0:i.get(),s=e[e.length-1];if(void 0!==r)e[0]=r;else if(n&&t){const i=n.readValue(t,s);void 0!==i&&null!==i&&(e[0]=i)}void 0===e[0]&&(e[0]=s),i&&void 0===r&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),$y.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,$y.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Ky=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Qy=e=>t=>"string"===typeof t&&t.startsWith(e),Jy=Qy("--"),Yy=Qy("var(--"),Xy=e=>!!Yy(e)&&Zy.test(e.split("/*")[0].trim()),Zy=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,eb=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;dg(n<=4,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`);const[i,r]=function(e){const t=eb.exec(e);if(!t)return[,];const[,n,i,r]=t;return[`--${null!==n&&void 0!==n?n:i}`,r]}(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const e=s.trim();return Ky(e)?parseFloat(e):e}return Xy(r)?tb(r,t,n+1):r}const nb=e=>t=>t.test(e),ib=[Bv,ty,ey,Zv,iy,ny,{test:e=>"auto"===e,parse:e=>e}],rb=e=>ib.find(nb(e));class sb extends Wy{constructor(e,t,n,i,r){super(e,t,n,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let a=0;a<e.length;a++){let n=e[a];if("string"===typeof n&&(n=n.trim(),Xy(n))){const i=tb(n,t.current);void 0!==i&&(e[a]=i),a===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!bv.has(n)||2!==e.length)return;const[i,r]=e,s=rb(i),o=rb(r);if(s!==o)if(Fy(s)&&Fy(o))for(let a=0;a<e.length;a++){const t=e[a];"string"===typeof t&&(e[a]=parseFloat(t))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)("number"===typeof(i=e[r])?0===i:null===i||"none"===i||"0"===i||Uv(i))&&n.push(r);var i;n.length&&function(e,t,n){let i,r=0;for(;r<e.length&&!i;){const t=e[r];"string"===typeof t&&!Py.has(t)&&dy(t).values.length&&(i=e[r]),r++}if(i&&n)for(const s of t)e[s]=Cy(n,i)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=By[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];void 0!==i&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=By[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),(null===(e=this.removedTransforms)||void 0===e?void 0:e.length)&&this.removedTransforms.forEach((e=>{let[n,i]=e;t.getValue(n).set(i)})),this.resolveNoneKeyframes()}}const ob=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!my.test(e)&&"0"!==e||e.startsWith("url(")));const ab=e=>null!==e;function lb(e,t,n){let{repeat:i,repeatType:r="loop"}=t;const s=e.filter(ab),o=i&&"loop"!==r&&i%2===1?0:s.length-1;return o&&void 0!==n?n:s[o]}class cb{constructor(e){let{autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",...a}=e;this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Zg.now(),this.options={autoplay:t,delay:n,type:i,repeat:r,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(Hy(),qy()),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Zg.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:r,delay:s,onComplete:o,onUpdate:a,isGenerator:l}=this.options;if(!l&&!function(e,t,n,i){const r=e[0];if(null===r)return!1;if("display"===t||"visibility"===t)return!0;const s=e[e.length-1],o=ob(r,t),a=ob(s,t);return ug(o===a,`You are trying to animate ${t} from "${r}" to "${s}". ${r} is not an animatable value - to enable this animation set ${r} to a value animatable to ${s} via the \`style\` property.`),!(!o||!a)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||Rg(n))&&i)}(e,n,i,r)){if(Pv||!s)return a&&a(lb(e,this.options,t)),o&&o(),void this.resolveFinishedPromise();this.options.duration=0}const c=this.initPlayback(e,t);!1!==c&&(this._resolved={keyframes:e,finalKeyframe:t,...c},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise((e=>{this.resolveFinishedPromise=e}))}}const ub=(e,t,n)=>e+(t-e)*n;function db(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function hb(e,t){return n=>n>0?t:e}const pb=(e,t,n)=>{const i=e*e,r=n*(t*t-i)+i;return r<0?0:Math.sqrt(r)},fb=[Yv,Jv,sy];function mb(e){const t=(n=e,fb.find((e=>e.test(n))));var n;if(ug(Boolean(t),`'${e}' is not an animatable color. Use the equivalent color code instead.`),!Boolean(t))return!1;let i=t.parse(e);return t===sy&&(i=function(e){let{hue:t,saturation:n,lightness:i,alpha:r}=e;t/=360,n/=100,i/=100;let s=0,o=0,a=0;if(n){const e=i<.5?i*(1+n):i+n-i*n,r=2*i-e;s=db(r,e,t+1/3),o=db(r,e,t),a=db(r,e,t-1/3)}else s=o=a=i;return{red:Math.round(255*s),green:Math.round(255*o),blue:Math.round(255*a),alpha:r}}(i)),i}const gb=(e,t)=>{const n=mb(e),i=mb(t);if(!n||!i)return hb(e,t);const r={...n};return e=>(r.red=pb(n.red,i.red,e),r.green=pb(n.green,i.green,e),r.blue=pb(n.blue,i.blue,e),r.alpha=ub(n.alpha,i.alpha,e),Jv.transform(r))},vb=(e,t)=>n=>t(e(n)),yb=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(vb)},bb=new Set(["none","hidden"]);function wb(e,t){return n=>ub(e,t,n)}function kb(e){return"number"===typeof e?wb:"string"===typeof e?Xy(e)?hb:oy.test(e)?gb:Eb:Array.isArray(e)?Tb:"object"===typeof e?oy.test(e)?gb:Sb:hb}function Tb(e,t){const n=[...e],i=n.length,r=e.map(((e,n)=>kb(e)(e,t[n])));return e=>{for(let t=0;t<i;t++)n[t]=r[t](e);return n}}function Sb(e,t){const n={...e,...t},i={};for(const r in n)void 0!==e[r]&&void 0!==t[r]&&(i[r]=kb(e[r])(e[r],t[r]));return e=>{for(const t in i)n[t]=i[t](e);return n}}const Eb=(e,t)=>{const n=my.createTransformer(t),i=dy(e),r=dy(t);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?bb.has(e)&&!r.values.length||bb.has(t)&&!i.values.length?function(e,t){return bb.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):yb(Tb(function(e,t){var n;const i=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const o=t.types[s],a=e.indexes[o][r[o]],l=null!==(n=e.values[a])&&void 0!==n?n:0;i[s]=l,r[o]++}return i}(i,r),r.values),n):(ug(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),hb(e,t))};function Ib(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return ub(e,t,n);return kb(e)(e,t)}function Cb(e,t,n){const i=Math.max(t-5,0);return bg(n-e(i),t-i)}const Pb={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ab=.001;function _b(e){let t,n,{duration:i=Pb.duration,bounce:r=Pb.bounce,velocity:s=Pb.velocity,mass:o=Pb.mass}=e;ug(i<=vg(Pb.maxDuration),"Spring duration must be 10 seconds or less");let a=1-r;a=Vv(Pb.minDamping,Pb.maxDamping,a),i=Vv(Pb.minDuration,Pb.maxDuration,yg(i)),a<1?(t=e=>{const t=e*a,n=t*i,r=t-s,o=Rb(e,a),l=Math.exp(-n);return Ab-r/o*l},n=e=>{const n=e*a*i,r=n*s+s,o=Math.pow(a,2)*Math.pow(e,2)*i,l=Math.exp(-n),c=Rb(Math.pow(e,2),a);return(-t(e)+Ab>0?-1:1)*((r-o)*l)/c}):(t=e=>Math.exp(-e*i)*((e-s)*i+1)-.001,n=e=>Math.exp(-e*i)*(i*i*(s-e)));const l=function(e,t,n){let i=n;for(let r=1;r<xb;r++)i-=e(i)/t(i);return i}(t,n,5/i);if(i=vg(i),isNaN(l))return{stiffness:Pb.stiffness,damping:Pb.damping,duration:i};{const e=Math.pow(l,2)*o;return{stiffness:e,damping:2*a*Math.sqrt(o*e),duration:i}}}const xb=12;function Rb(e,t){return e*Math.sqrt(1-t*t)}const Nb=["duration","bounce"],Db=["stiffness","damping","mass"];function Lb(e,t){return t.some((t=>void 0!==e[t]))}function Ob(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pb.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pb.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:r}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=function(e){let t={velocity:Pb.velocity,stiffness:Pb.stiffness,damping:Pb.damping,mass:Pb.mass,isResolvedFromDuration:!1,...e};if(!Lb(e,Db)&&Lb(e,Nb))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(1.2*n),r=i*i,s=2*Vv(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:Pb.mass,stiffness:r,damping:s}}else{const n=_b(e);t={...t,...n,mass:Pb.mass},t.isResolvedFromDuration=!0}return t}({...n,velocity:-yg(n.velocity||0)}),f=h||0,m=c/(2*Math.sqrt(l*u)),g=o-s,v=yg(Math.sqrt(l/u)),y=Math.abs(g)<5;let b;if(i||(i=y?Pb.restSpeed.granular:Pb.restSpeed.default),r||(r=y?Pb.restDelta.granular:Pb.restDelta.default),m<1){const e=Rb(v,m);b=t=>{const n=Math.exp(-m*v*t);return o-n*((f+m*v*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===m)b=e=>o-Math.exp(-v*e)*(g+(f+v*g)*e);else{const e=v*Math.sqrt(m*m-1);b=t=>{const n=Math.exp(-m*v*t),i=Math.min(e*t,300);return o-n*((f+m*v*g)*Math.sinh(i)+e*g*Math.cosh(i))/e}}const w={calculatedDuration:p&&d||null,next:e=>{const t=b(e);if(p)a.done=e>=d;else{let n=0;m<1&&(n=0===e?vg(f):Cb(b,e,t));const s=Math.abs(n)<=i,l=Math.abs(o-t)<=r;a.done=s&&l}return a.value=a.done?o:t,a},toString:()=>{const e=Math.min(xg(w),_g),t=jg((t=>w.next(e*t).value),e,30);return e+"ms "+t}};return w}function Mb(e){let{keyframes:t,velocity:n=0,power:i=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:d}=e;const h=t[0],p={done:!1,value:h},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let m=i*n;const g=h+m,v=void 0===a?g:a(g);v!==g&&(m=v-h);const y=e=>-m*Math.exp(-e/r),b=e=>v+y(e),w=e=>{const t=y(e),n=b(e);p.done=Math.abs(t)<=u,p.value=p.done?v:n};let k,T;const S=e=>{var t;(t=p.value,void 0!==l&&t<l||void 0!==c&&t>c)&&(k=e,T=Ob({keyframes:[p.value,f(p.value)],velocity:Cb(b,e,p.value),damping:s,stiffness:o,restDelta:u,restSpeed:d}))};return S(0),{calculatedDuration:null,next:e=>{let t=!1;return T||void 0!==k||(t=!0,w(e),S(e)),void 0!==k&&e>=k?T.next(e-k):(!t&&w(e),p)}}}const jb=_v(.42,0,1,1),Fb=_v(0,0,.58,1),Ub=_v(.42,0,.58,1),Vb={linear:cg,easeIn:jb,easeInOut:Ub,easeOut:Fb,circIn:Mv,circInOut:Fv,circOut:jv,backIn:Dv,backInOut:Lv,backOut:Nv,anticipate:Ov},Bb=e=>{if(Dg(e)){dg(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,n,i,r]=e;return _v(t,n,i,r)}return"string"===typeof e?(dg(void 0!==Vb[e],`Invalid easing type '${e}'`),Vb[e]):e};function $b(e,t){let{clamp:n=!0,ease:i,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(dg(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=function(e,t,n){const i=[],r=n||Ib,s=e.length-1;for(let o=0;o<s;o++){let n=r(e[o],e[o+1]);if(t){const e=Array.isArray(t)?t[o]||cg:t;n=yb(e,n)}i.push(n)}return i}(t,i,r),l=a.length,c=n=>{if(o&&n<e[0])return t[0];let i=0;if(l>1)for(;i<e.length-2&&!(n<e[i+1]);i++);const r=mg(e[i],e[i+1],n);return a[i](r)};return n?t=>c(Vv(e[0],e[s-1],t)):c}function zb(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=mg(0,t,i);e.push(ub(n,1,r))}}(t,e.length-1),t}function Gb(e){let{duration:t=300,keyframes:n,times:i,ease:r="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(r)?r.map(Bb):Bb(r),o={done:!1,value:n[0]},a=function(e,t){return e.map((e=>e*t))}(i&&i.length===n.length?i:zb(n),t),l=$b(a,n,{ease:Array.isArray(s)?s:(c=n,u=s,c.map((()=>u||Ub)).splice(0,c.length-1))});var c,u;return{calculatedDuration:t,next:e=>(o.value=l(e),o.done=e>=t,o)}}const qb=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:()=>qg.update(t,!0),stop:()=>Hg(t),now:()=>Wg.isProcessing?Wg.timestamp:Zg.now()}},Hb={decay:Mb,inertia:Mb,tween:Gb,keyframes:Gb,spring:Ob},Wb=e=>e/100;class Kb extends cb{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();const{onStop:e}=this.options;e&&e()};const{name:t,motionValue:n,element:i,keyframes:r}=this.options,s=(null===i||void 0===i?void 0:i.KeyframeResolver)||Wy;this.resolver=new s(r,((e,t)=>this.onKeyframesResolved(e,t)),t,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:r,velocity:s=0}=this.options,o=Rg(t)?t:Hb[t]||Gb;let a,l;o!==Gb&&"number"!==typeof e[0]&&(a=yb(Wb,Ib(e[0],e[1])),e=[0,100]);const c=o({...this.options,keyframes:e});"mirror"===r&&(l=o({...this.options,keyframes:[...e].reverse(),velocity:-s})),null===c.calculatedDuration&&(c.calculatedDuration=xg(c));const{calculatedDuration:u}=c,d=u+i;return{generator:c,mirroredGenerator:l,mapPercentToKeyframes:a,calculatedDuration:u,resolvedDuration:d,totalDuration:d*(n+1)-i}}onPostResolved(){const{autoplay:e=!0}=this.options;pv.mainThread++,this.play(),"paused"!==this.pendingPlayState&&e?this.state=this.pendingPlayState:this.pause()}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{resolved:n}=this;if(!n){const{keyframes:e}=this.options;return{done:!0,value:e[e.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:s,mapPercentToKeyframes:o,keyframes:a,calculatedDuration:l,totalDuration:c,resolvedDuration:u}=n;if(null===this.startTime)return r.next(0);const{delay:d,repeat:h,repeatType:p,repeatDelay:f,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-d*(this.speed>=0?1:-1),v=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let y=this.currentTime,b=r;if(h){const e=Math.min(this.currentTime,c)/u;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,h+1);Boolean(t%2)&&("reverse"===p?(n=1-n,f&&(n-=f/u)):"mirror"===p&&(b=s)),y=Vv(0,1,n)*u}const w=v?{done:!1,value:a[0]}:b.next(y);o&&(w.value=o(w.value));let{done:k}=w;v||null===l||(k=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const T=null===this.holdTime&&("finished"===this.state||"running"===this.state&&k);return T&&void 0!==i&&(w.value=lb(a,this.options,i)),m&&m(w.value),T&&this.finish(),w}get duration(){const{resolved:e}=this;return e?yg(e.calculatedDuration):0}get time(){return yg(this.currentTime)}set time(e){e=vg(e),this.currentTime=e,null!==this.holdTime||0===this.speed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=yg(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved)return void(this.pendingPlayState="running");if(this.isStopped)return;const{driver:e=qb,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e((e=>this.tick(e)))),t&&t();const i=this.driver.now();null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=i):this.startTime=null!==n&&void 0!==n?n:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;this._resolved?(this.state="paused",this.holdTime=null!==(e=this.currentTime)&&void 0!==e?e:0):this.pendingPlayState="paused"}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel(),pv.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Qb=new Set(["opacity","clipPath","filter","transform"]);const Jb=fg((()=>Object.hasOwnProperty.call(Element.prototype,"animate")));const Yb={anticipate:Ov,backInOut:Lv,circInOut:Fv};class Xb extends cb{constructor(e){super(e);const{name:t,motionValue:n,element:i,keyframes:r}=this.options;this.resolver=new sb(r,((e,t)=>this.onKeyframesResolved(e,t)),t,n,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:n=300,times:i,ease:r,type:s,motionValue:o,name:a,startTime:l}=this.options;if(!o.owner||!o.owner.current)return!1;var c;if("string"===typeof r&&Mg()&&r in Yb&&(r=Yb[r]),Rg((c=this.options).type)||"spring"===c.type||!Fg(c.ease)){const{onComplete:t,onUpdate:o,motionValue:a,element:l,...c}=this.options,u=function(e,t){const n=new Kb({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:e[0]};const r=[];let s=0;for(;!i.done&&s<2e4;)i=n.sample(s),r.push(i.value),s+=10;return{times:void 0,keyframes:r,duration:s-10,ease:"linear"}}(e,c);1===(e=u.keyframes).length&&(e[1]=e[0]),n=u.duration,i=u.times,r=u.ease,s="keyframes"}const u=function(e,t,n){let{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[t]:n};l&&(c.offset=l);const u=Bg(a,r);Array.isArray(u)&&(c.easing=u),zg.value&&pv.waapi++;const d=e.animate(c,{delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===o?"alternate":"normal"});return zg.value&&d.finished.finally((()=>{pv.waapi--})),d}(o.owner.current,a,e,{...this.options,duration:n,times:i,ease:r});return u.startTime=null!==l&&void 0!==l?l:this.calcStartTime(),this.pendingTimeline?(Ng(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:n}=this.options;o.set(lb(e,this.options,t)),n&&n(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:n,times:i,type:s,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return yg(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return yg(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=vg(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(this._resolved){const{resolved:t}=this;if(!t)return cg;const{animation:n}=t;Ng(n,e)}else this.pendingTimeline=e;return cg}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;"finished"===t.playState&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:i,type:r,ease:s,times:o}=e;if("idle"===t.playState||"finished"===t.playState)return;if(this.time){const{motionValue:e,onUpdate:t,onComplete:a,element:l,...c}=this.options,u=new Kb({...c,keyframes:n,duration:i,type:r,ease:s,times:o,isGenerator:!0}),d=vg(this.time);e.setWithVelocity(u.sample(d-10).value,u.sample(d).value,10)}const{onStop:a}=this.options;a&&a(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:s,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:a,transformTemplate:l}=t.owner.getProps();return Jb()&&n&&Qb.has(n)&&!a&&!l&&!i&&"mirror"!==r&&0!==s&&"inertia"!==o}}const Zb={type:"spring",stiffness:500,damping:25,restSpeed:10},ew={type:"keyframes",duration:.8},tw={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},nw=(e,t)=>{let{keyframes:n}=t;return n.length>2?ew:yv.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:Zb:tw};const iw=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return o=>{const a=Ag(i,e)||{},l=a.delay||i.delay||0;let{elapsed:c=0}=i;c-=vg(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-c,onUpdate:e=>{t.set(e),a.onUpdate&&a.onUpdate(e)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:s?void 0:r};(function(e){let{when:t,delay:n,delayChildren:i,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:l,from:c,elapsed:u,...d}=e;return!!Object.keys(d).length})(a)||(u={...u,...nw(e,u)}),u.duration&&(u.duration=vg(u.duration)),u.repeatDelay&&(u.repeatDelay=vg(u.repeatDelay)),void 0!==u.from&&(u.keyframes[0]=u.from);let d=!1;if((!1===u.type||0===u.duration&&!u.repeatDelay)&&(u.duration=0,0===u.delay&&(d=!0)),(Pv||hg)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&void 0!==t.get()){const e=lb(u.keyframes,a);if(void 0!==e)return qg.update((()=>{u.onUpdate(e),u.onComplete()})),new Pg([])}return!s&&Xb.supports(u)?new Xb(u):new Kb(u)}};function rw(e,t){let{protectedKeys:n,needsAnimating:i}=e;const r=n.hasOwnProperty(t)&&!0!==i[t];return i[t]=!1,r}function sw(e,t){let{delay:n=0,transitionOverride:i,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s;let{transition:o=e.getDefaultTransition(),transitionEnd:a,...l}=t;i&&(o=i);const c=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const d in l){const t=e.getValue(d,null!==(s=e.latestValues[d])&&void 0!==s?s:null),i=l[d];if(void 0===i||u&&rw(u,d))continue;const r={delay:n,...Ag(o||{},d)};let a=!1;if(window.MotionHandoffAnimation){const t=Cv(e);if(t){const e=window.MotionHandoffAnimation(t,d,qg);null!==e&&(r.startTime=e,a=!0)}}Sv(e,d),t.start(iw(d,t,i,e.shouldReduceMotion&&bv.has(d)?{type:!1}:r,e,a));const h=t.animation;h&&c.push(h)}return a&&Promise.all(c).then((()=>{qg.update((()=>{a&&function(e,t){const n=Eg(e,t);let{transitionEnd:i={},transition:r={},...s}=n||{};s={...s,...i};for(const a in s)kv(e,a,(o=s[a],wv(o)?o[o.length-1]||0:o));var o}(e,a)}))})),c}function ow(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;const r=Eg(e,t,"exit"===n.type?null===(i=e.presenceContext)||void 0===i?void 0:i.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const o=r?()=>Promise.all(sw(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:r=0,staggerChildren:o,staggerDirection:a}=s;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5?arguments[5]:void 0;const o=[],a=(e.variantChildren.size-1)*i,l=1===r?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i}:function(){return a-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i};return Array.from(e.variantChildren).sort(aw).forEach(((e,i)=>{e.notify("AnimationStart",t),o.push(ow(e,t,{...s,delay:n+l(i)}).then((()=>e.notify("AnimationComplete",t))))})),Promise.all(o)}(e,t,r+i,o,a,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[e,t]="beforeChildren"===l?[o,a]:[a,o];return e().then((()=>t()))}return Promise.all([o(),a(n.delay)])}function aw(e,t){return e.sortNodePosition(t)}function lw(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function cw(e){return"string"===typeof e||Array.isArray(e)}const uw=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dw=["initial",...uw],hw=dw.length;function pw(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&pw(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<hw;n++){const i=dw[n],r=e.props[i];(cw(r)||!1===r)&&(t[i]=r)}return t}const fw=[...uw].reverse(),mw=uw.length;function gw(e){return t=>Promise.all(t.map((t=>{let{animation:n,options:i}=t;return function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const r=t.map((t=>ow(e,t,i)));n=Promise.all(r)}else if("string"===typeof t)n=ow(e,t,i);else{const r="function"===typeof t?Eg(e,t,i.custom):t;n=Promise.all(sw(e,r,i))}return n.then((()=>{e.notify("AnimationComplete",t)}))}(e,n,i)})))}function vw(e){let t=gw(e),n=ww(),i=!0;const r=t=>(n,i)=>{var r;const s=Eg(e,i,"exit"===t?null===(r=e.presenceContext)||void 0===r?void 0:r.custom:void 0);if(s){const{transition:e,transitionEnd:t,...i}=s;n={...n,...i,...t}}return n};function s(s){const{props:o}=e,a=pw(e.parent)||{},l=[],c=new Set;let u={},d=1/0;for(let t=0;t<mw;t++){const h=fw[t],p=n[h],f=void 0!==o[h]?o[h]:a[h],m=cw(f),g=h===s?p.isActive:null;!1===g&&(d=t);let v=f===a[h]&&f!==o[h]&&m;if(v&&i&&e.manuallyAnimateOnMount&&(v=!1),p.protectedKeys={...u},!p.isActive&&null===g||!f&&!p.prevProp||kg(f)||"boolean"===typeof f)continue;const y=yw(p.prevProp,f);let b=y||h===s&&p.isActive&&!v&&m||t>d&&m,w=!1;const k=Array.isArray(f)?f:[f];let T=k.reduce(r(h),{});!1===g&&(T={});const{prevResolvedValues:S={}}=p,E={...S,...T},I=t=>{b=!0,c.has(t)&&(w=!0,c.delete(t)),p.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in E){const t=T[e],n=S[e];if(u.hasOwnProperty(e))continue;let i=!1;i=wv(t)&&wv(n)?!lw(t,n):t!==n,i?void 0!==t&&null!==t?I(e):c.add(e):void 0!==t&&c.has(e)?I(e):p.protectedKeys[e]=!0}p.prevProp=f,p.prevResolvedValues=T,p.isActive&&(u={...u,...T}),i&&e.blockInitialAnimation&&(b=!1);b&&(!(v&&y)||w)&&l.push(...k.map((e=>({animation:e,options:{type:h}}))))}if(c.size){const t={};if("boolean"!==typeof o.initial){const n=Eg(e,Array.isArray(o.initial)?o.initial[0]:o.initial);n&&n.transition&&(t.transition=n.transition)}c.forEach((n=>{const i=e.getBaseTarget(n),r=e.getValue(n);r&&(r.liveStyle=!0),t[n]=null!==i&&void 0!==i?i:null})),l.push({animation:t})}let h=Boolean(l.length);return!i||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(h=!1),i=!1,h?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,i){var r;if(n[t].isActive===i)return Promise.resolve();null===(r=e.variantChildren)||void 0===r||r.forEach((e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,i)})),n[t].isActive=i;const o=s(t);for(const e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=ww(),i=!0}}}function yw(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!lw(t,e)}function bw(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ww(){return{animate:bw(!0),whileInView:bw(),whileHover:bw(),whileTap:bw(),whileDrag:bw(),whileFocus:bw(),exit:bw()}}class kw{constructor(e){this.isMounted=!1,this.node=e}update(){}}let Tw=0;const Sw={animation:{Feature:class extends kw{constructor(e){super(e),e.animationState||(e.animationState=vw(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();kg(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends kw{constructor(){super(...arguments),this.id=Tw++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then((()=>{t(this.id)}))}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}};function Ew(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}function Iw(e){return{point:{x:e.pageX,y:e.pageY}}}function Cw(e,t,n,i){return Ew(e,t,(e=>t=>ov(t)&&e(t,Iw(t)))(n),i)}function Pw(e){let{top:t,left:n,right:i,bottom:r}=e;return{x:{min:n,max:i},y:{min:t,max:r}}}function Aw(e){return e.max-e.min}function _w(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=i,e.originPoint=ub(t.min,t.max,e.origin),e.scale=Aw(n)/Aw(t),e.translate=ub(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function xw(e,t,n,i){_w(e.x,t.x,n.x,i?i.originX:void 0),_w(e.y,t.y,n.y,i?i.originY:void 0)}function Rw(e,t,n){e.min=n.min+t.min,e.max=e.min+Aw(t)}function Nw(e,t,n){e.min=t.min-n.min,e.max=e.min+Aw(t)}function Dw(e,t,n){Nw(e.x,t.x,n.x),Nw(e.y,t.y,n.y)}const Lw=()=>({x:{min:0,max:0},y:{min:0,max:0}});function Ow(e){return[e("x"),e("y")]}function Mw(e){return void 0===e||1===e}function jw(e){let{scale:t,scaleX:n,scaleY:i}=e;return!Mw(t)||!Mw(n)||!Mw(i)}function Fw(e){return jw(e)||Uw(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Uw(e){return Vw(e.x)||Vw(e.y)}function Vw(e){return e&&"0%"!==e}function Bw(e,t,n){return n+t*(e-n)}function $w(e,t,n,i,r){return void 0!==r&&(e=Bw(e,r,i)),Bw(e,n,i)+t}function zw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=$w(e.min,t,n,i,r),e.max=$w(e.max,t,n,i,r)}function Gw(e,t){let{x:n,y:i}=t;zw(e.x,n.translate,n.scale,n.originPoint),zw(e.y,i.translate,i.scale,i.originPoint)}const qw=.999999999999,Hw=1.0000000000001;function Ww(e,t){e.min=e.min+t,e.max=e.max+t}function Kw(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;zw(e,t,n,ub(e.min,e.max,r),i)}function Qw(e,t){Kw(e.x,t.x,t.scaleX,t.scale,t.originX),Kw(e.y,t.y,t.scaleY,t.scale,t.originY)}function Jw(e,t){return Pw(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}(e.getBoundingClientRect(),t))}const Yw=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null};function Xw(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}const Zw=(e,t)=>Math.abs(e-t);class ek{constructor(e,t){let{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ik(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=Zw(e.x,t.x),i=Zw(e.y,t.y);return Math.sqrt(n**2+i**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;const{point:i}=e,{timestamp:r}=Wg;this.history.push({...i,timestamp:r});const{onStart:s,onMove:o}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=tk(t,this.transformPagePoint),qg.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:i,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=ik("pointercancel"===e.type?this.lastMoveEventInfo:tk(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),i&&i(e,s)},!ov(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const s=tk(Iw(e),this.transformPagePoint),{point:o}=s,{timestamp:a}=Wg;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=t;l&&l(e,ik(s,this.history)),this.removeListeners=yb(Cw(this.contextWindow,"pointermove",this.handlePointerMove),Cw(this.contextWindow,"pointerup",this.handlePointerUp),Cw(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Hg(this.updatePoint)}}function tk(e,t){return t?{point:t(e.point)}:e}function nk(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ik(e,t){let{point:n}=e;return{point:n,delta:nk(n,sk(t)),offset:nk(n,rk(t)),velocity:ok(t,.1)}}function rk(e){return e[0]}function sk(e){return e[e.length-1]}function ok(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=sk(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>vg(t)));)n--;if(!i)return{x:0,y:0};const s=yg(r.timestamp-i.timestamp);if(0===s)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function ak(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function lk(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}const ck=.35;function uk(e,t,n){return{min:dk(e,t),max:dk(e,n)}}function dk(e,t){return"number"===typeof e?e:e[t]||0}const hk=new WeakMap;class pk{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:i}=this.getProps();this.panSession=new ek(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Iw(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:i,onDragStart:r}=this.getProps();if(n&&!i&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(s=n)||"y"===s?ev[s]?null:(ev[s]=!0,()=>{ev[s]=!1}):ev.x||ev.y?null:(ev.x=ev.y=!0,()=>{ev.x=ev.y=!1}),!this.openDragLock))return;var s;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ow((e=>{let t=this.getAxisMotionValue(e).get()||0;if(ey.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const i=n.layout.layoutBox[e];if(i){t=Aw(i)*(parseFloat(t)/100)}}}this.originPoint[e]=t})),r&&qg.postRender((()=>r(e,t))),Sv(this.visualElement,"transform");const{animationState:o}=this.visualElement;o&&o.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:n,dragDirectionLock:i,onDirectionLock:r,onDrag:s}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:o}=t;if(i&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(o),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",t.point,o),this.updateAxis("y",t.point,o),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>Ow((e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:Yw(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&qg.postRender((()=>r(e,t)))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!fk(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,t,n){let{min:i,max:r}=t;return void 0!==i&&e<i?e=n?ub(i,e,n.min):Math.max(e,i):void 0!==r&&e>r&&(e=n?ub(r,e,n.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),r.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,r=this.constraints;t&&Xw(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!i)&&function(e,t){let{top:n,left:i,bottom:r,right:s}=t;return{x:ak(e.x,i,s),y:ak(e.y,n,r)}}(i.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ck;return!1===e?e=0:!0===e&&(e=ck),{x:uk(e,"left","right"),y:uk(e,"top","bottom")}}(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ow((e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(i.layoutBox[e],this.constraints[e]))}))}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Xw(e))return!1;const n=e.current;dg(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=function(e,t,n){const i=Jw(e,n),{scroll:r}=t;return r&&(Ww(i.x,r.offset.x),Ww(i.y,r.offset.y)),i}(n,i.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:lk(e.x,t.x),y:lk(e.y,t.y)}}(i.layout.layoutBox,r);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=Pw(e))}return s}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},l=Ow((o=>{if(!fk(o,t,this.currentDirection))return;let l=a&&a[o]||{};s&&(l={min:0,max:0});const c=i?200:1e6,u=i?40:1e7,d={type:"inertia",velocity:n?e[o]:0,bounceStiffness:c,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10,...r,...l};return this.startAxisValueAnimation(o,d)}));return Promise.all(l).then(o)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return Sv(this.visualElement,e),n.start(iw(e,n,0,t,this.visualElement,!1))}stopAnimation(){Ow((e=>this.getAxisMotionValue(e).stop()))}pauseAnimation(){Ow((e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()}))}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Ow((t=>{const{drag:n}=this.getProps();if(!fk(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(t);if(i&&i.layout){const{min:n,max:s}=i.layout.layoutBox[t];r.set(e[t]-ub(n,s,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Xw(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ow((e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();i[e]=function(e,t){let n=.5;const i=Aw(e),r=Aw(t);return r>i?n=mg(t.min,t.max-i,e.min):i>r&&(n=mg(e.min,e.max-r,t.min)),Vv(0,1,n)}({min:n,max:n},this.constraints[e])}}));const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ow((t=>{if(!fk(t,e,null))return;const n=this.getAxisMotionValue(t),{min:r,max:s}=this.constraints[t];n.set(ub(r,s,i[t]))}))}addListeners(){if(!this.visualElement.current)return;hk.set(this.visualElement,this);const e=Cw(this.visualElement.current,"pointerdown",(e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)})),t=()=>{const{dragConstraints:e}=this.getProps();Xw(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),qg.read(t);const r=Ew(window,"resize",(()=>this.scalePositionWithinConstraints())),s=n.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(Ow((e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))})),this.visualElement.render())}));return()=>{r(),e(),i(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:s=ck,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:s,dragMomentum:o}}}function fk(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const mk=e=>(t,n)=>{e&&qg.postRender((()=>e(t,n)))};var gk=n(579);const vk=(0,a.createContext)(null);const yk=(0,a.createContext)({}),bk=(0,a.createContext)({}),wk={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function kk(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Tk={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!ty.test(e))return e;e=parseFloat(e)}return`${kk(e,t.target.x)}% ${kk(e,t.target.y)}%`}},Sk={correct:(e,t)=>{let{treeScale:n,projectionDelta:i}=t;const r=e,s=my.parse(e);if(s.length>5)return r;const o=my.createTransformer(e),a="number"!==typeof s[0]?1:0,l=i.x.scale*n.x,c=i.y.scale*n.y;s[0+a]/=l,s[1+a]/=c;const u=ub(l,c,.5);return"number"===typeof s[2+a]&&(s[2+a]/=u),"number"===typeof s[3+a]&&(s[3+a]/=u),o(s)}},Ek={};class Ik extends a.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=e;!function(e){for(const t in e)Ek[t]=e[t],Jy(t)&&(Ek[t].isCSSVariable=!0)}(Pk),r&&(t.group&&t.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",(()=>{this.safeToRemove()})),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),wk.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:r}=this.props,s=n.projection;return s?(s.isPresent=r,i||e.layoutDependency!==t||void 0===t||e.isPresent!==r?s.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?s.promote():s.relegate()||qg.postRender((()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Qg.postRender((()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ck(e){const[t,n]=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=(0,a.useContext)(vk);if(null===t)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=t,s=(0,a.useId)();(0,a.useEffect)((()=>{if(e)return r(s)}),[e]);const o=(0,a.useCallback)((()=>e&&i&&i(s)),[s,i,e]);return!n&&i?[!1,o]:[!0]}(),i=(0,a.useContext)(yk);return(0,gk.jsx)(Ik,{...e,layoutGroup:i,switchLayoutGroup:(0,a.useContext)(bk),isPresent:t,safeToRemove:n})}const Pk={borderRadius:{...Tk,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Tk,borderTopRightRadius:Tk,borderBottomLeftRadius:Tk,borderBottomRightRadius:Tk,boxShadow:Sk};const Ak=(e,t)=>e.depth-t.depth;class _k{constructor(){this.children=[],this.isDirty=!1}add(e){ag(this.children,e),this.isDirty=!0}remove(e){lg(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ak),this.isDirty=!1,this.children.forEach(e)}}function xk(e,t){const n=Zg.now(),i=r=>{let{timestamp:s}=r;const o=s-n;o>=t&&(Hg(i),e(o-t))};return qg.read(i,!0),()=>Hg(i)}function Rk(e){const t=Tv(e)?e.get():e;return n=t,Boolean(n&&"object"===typeof n&&n.mix&&n.toValue)?t.toValue():t;var n}const Nk=["TopLeft","TopRight","BottomLeft","BottomRight"],Dk=Nk.length,Lk=e=>"string"===typeof e?parseFloat(e):e,Ok=e=>"number"===typeof e||ty.test(e);function Mk(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const jk=Uk(0,.5,jv),Fk=Uk(.5,.95,cg);function Uk(e,t,n){return i=>i<e?0:i>t?1:n(mg(e,t,i))}function Vk(e,t){e.min=t.min,e.max=t.max}function Bk(e,t){Vk(e.x,t.x),Vk(e.y,t.y)}function $k(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function zk(e,t,n,i,r){return e=Bw(e-=t,1/n,i),void 0!==r&&(e=Bw(e,1/r,i)),e}function Gk(e,t,n,i,r){let[s,o,a]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;ey.test(t)&&(t=parseFloat(t),t=ub(o.min,o.max,t/100)-o.min);if("number"!==typeof t)return;let a=ub(s.min,s.max,i);e===s&&(a-=t),e.min=zk(e.min,t,n,a,r),e.max=zk(e.max,t,n,a,r)}(e,t[s],t[o],t[a],t.scale,i,r)}const qk=["x","scaleX","originX"],Hk=["y","scaleY","originY"];function Wk(e,t,n,i){Gk(e.x,t,qk,n?n.x:void 0,i?i.x:void 0),Gk(e.y,t,Hk,n?n.y:void 0,i?i.y:void 0)}function Kk(e){return 0===e.translate&&1===e.scale}function Qk(e){return Kk(e.x)&&Kk(e.y)}function Jk(e,t){return e.min===t.min&&e.max===t.max}function Yk(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Xk(e,t){return Yk(e.x,t.x)&&Yk(e.y,t.y)}function Zk(e){return Aw(e.x)/Aw(e.y)}function eT(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class tT{constructor(){this.members=[]}add(e){ag(this.members,e),e.scheduleRender()}remove(e){if(lg(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex((t=>e===t));if(0===t)return!1;let n;for(let i=t;i>=0;i--){const e=this.members[i];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;!1===i&&n.hide()}}exitAnimationComplete(){this.members.forEach((e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()}))}scheduleRender(){this.members.forEach((e=>{e.instance&&e.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const nT={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},iT=["","X","Y","Z"],rT={visibility:"hidden"};let sT=0;function oT(e,t,n,i){const{latestValues:r}=t;r[e]&&(n[e]=r[e],t.setStaticValue(e,0),i&&(i[e]=0))}function aT(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Cv(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",qg,!(t||i))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&aT(i)}function lT(e){let{attachResizeListener:t,defaultParent:n,measureScroll:i,checkIsScrollRoot:r,resetTransform:s}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=sT++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,zg.value&&(nT.nodes=nT.calculatedTargetDeltas=nT.calculatedProjections=0),this.nodes.forEach(dT),this.nodes.forEach(yT),this.nodes.forEach(bT),this.nodes.forEach(hT),zg.addProjectionMetrics&&zg.addProjectionMetrics(nT)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new _k)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new gg),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&t.notify(...i)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var i;this.isSVG=(i=e)instanceof SVGElement&&"svg"!==i.tagName,this.instance=e;const{layoutId:r,layout:s,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(s||r)&&(this.isLayoutDirty=!0),t){let n;const i=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,n&&n(),n=xk(i,250),wk.hasAnimatedSinceResize&&(wk.hasAnimatedSinceResize=!1,this.nodes.forEach(vT))}))}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&o&&(r||s)&&this.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n,hasRelativeLayoutChanged:i,layout:r}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const s=this.options.transition||o.getDefaultTransition()||IT,{onLayoutAnimationStart:a,onLayoutAnimationComplete:l}=o.getProps(),c=!this.targetLayout||!Xk(this.targetLayout,r),u=!n&&i;if(this.options.layoutRoot||this.resumeFrom||u||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,u);const e={...Ag(s,"layout"),onPlay:a,onComplete:l};(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else n||vT(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Hg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(wT),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&aT(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let r=0;r<this.path.length;r++){const e=this.path[r];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(fT);this.isUpdating||this.nodes.forEach(mT),this.isUpdating=!1,this.nodes.forEach(gT),this.nodes.forEach(cT),this.nodes.forEach(uT),this.clearAllSnapshots();const e=Zg.now();Wg.delta=Vv(0,1e3/60,e-Wg.timestamp),Wg.timestamp=e,Wg.isProcessing=!0,Kg.update.process(Wg),Kg.preRender.process(Wg),Kg.render.process(Wg),Wg.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Qg.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(pT),this.sharedNodes.forEach(kT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qg.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qg.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||Aw(this.snapshot.measuredBox.x)||Aw(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t){const t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!s)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!Qk(this.projectionDelta),n=this.getTransformTemplate(),i=n?n(this.latestValues,""):void 0,r=i!==this.prevTransformTemplateValue;e&&(t||Fw(this.latestValues)||r)&&(s(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var i;return e&&(n=this.removeTransform(n)),AT((i=n).x),AT(i.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(xT))){const{scroll:e}=this.root;e&&(Ww(n.x,e.offset.x),Ww(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(Bk(n,e),null===(t=this.scroll)||void 0===t?void 0:t.wasRoot)return n;for(let i=0;i<this.path.length;i++){const t=this.path[i],{scroll:r,options:s}=t;t!==this.root&&r&&s.layoutScroll&&(r.wasRoot&&Bk(n,e),Ww(n.x,r.offset.x),Ww(n.y,r.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};Bk(n,e);for(let i=0;i<this.path.length;i++){const e=this.path[i];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&Qw(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),Fw(e.latestValues)&&Qw(n,e.latestValues)}return Fw(this.latestValues)&&Qw(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};Bk(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!Fw(e.latestValues))continue;jw(e.latestValues)&&e.updateSnapshot();const i={x:{min:0,max:0},y:{min:0,max:0}};Bk(i,e.measurePageBox()),Wk(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,i)}return Fw(this.latestValues)&&Wk(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Wg.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const i=Boolean(this.resumingFrom)||this!==n;if(!(e||i&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:r,layoutId:s}=this.options;if(this.layout&&(r||s)){if(this.resolvedRelativeTargetAt=Wg.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Dw(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),Bk(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,a,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,a=this.relativeTarget,l=this.relativeParent.target,Rw(o.x,a.x,l.x),Rw(o.y,a.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):Bk(this.target,this.layout.layoutBox),Gw(this.target,this.targetDelta)):Bk(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Dw(this.relativeTargetOrigin,this.target,e.target),Bk(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zg.value&&nT.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!jw(this.parent.latestValues)&&!Uw(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let i=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(i=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===Wg.timestamp&&(i=!1),i)return;const{layout:r,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!s)return;Bk(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=n.length;if(!r)return;let s,o;t.x=t.y=1;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const{visualElement:r}=s.options;r&&r.props.style&&"contents"===r.props.style.display||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Qw(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,Gw(e,o)),i&&Fw(s.latestValues)&&Qw(e,s.latestValues))}t.x<Hw&&t.x>qw&&(t.x=1),t.y<Hw&&t.y>qw&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?($k(this.prevProjectionDelta.x,this.projectionDelta.x),$k(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),xw(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===o&&this.treeScale.y===a&&eT(this.projectionDelta.x,this.prevProjectionDelta.x)&&eT(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),zg.value&&nT.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t;if(null===(t=this.options.visualElement)||void 0===t||t.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,i=n?n.latestValues:{},r={...this.latestValues},s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const o={x:{min:0,max:0},y:{min:0,max:0}},a=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,u=Boolean(a&&!c&&!0===this.options.crossfade&&!this.path.some(ET));let d;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,h,p,f,m,g;TT(s.x,e.x,n),TT(s.y,e.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Dw(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=o,g=n,ST(p.x,f.x,m.x,g),ST(p.y,f.y,m.y,g),d&&(l=this.relativeTarget,h=d,Jk(l.x,h.x)&&Jk(l.y,h.y))&&(this.isProjectionDirty=!1),d||(d={x:{min:0,max:0},y:{min:0,max:0}}),Bk(d,this.relativeTarget)),a&&(this.animationValues=r,function(e,t,n,i,r,s){r?(e.opacity=ub(0,void 0!==n.opacity?n.opacity:1,jk(i)),e.opacityExit=ub(void 0!==t.opacity?t.opacity:1,0,Fk(i))):s&&(e.opacity=ub(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,i));for(let o=0;o<Dk;o++){const r=`border${Nk[o]}Radius`;let s=Mk(t,r),a=Mk(n,r);void 0===s&&void 0===a||(s||(s=0),a||(a=0),0===s||0===a||Ok(s)===Ok(a)?(e[r]=Math.max(ub(Lk(s),Lk(a),i),0),(ey.test(a)||ey.test(s))&&(e[r]+="%")):e[r]=a)}(t.rotate||n.rotate)&&(e.rotate=ub(t.rotate||0,n.rotate||0,i))}(r,i,this.latestValues,n,u,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Hg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qg.update((()=>{wk.hasAnimatedSinceResize=!0,pv.layout++,this.currentAnimation=function(e,t,n){const i=Tv(e)?e:gv(e);return i.start(iw("",i,t,n)),i.animation}(0,1e3,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{pv.layout--},onComplete:()=>{pv.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:i,latestValues:r}=e;if(t&&n&&i){if(this!==e&&this.layout&&i&&_T(this.options.animationType,this.layout.layoutBox,i.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=Aw(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const i=Aw(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+i}Bk(t,n),Qw(t,r),xw(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new tT);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this.getStack();i&&i.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const i={};n.z&&oT("z",e,i,this.animationValues);for(let r=0;r<iT.length;r++)oT(`rotate${iT[r]}`,e,i,this.animationValues),oT(`skew${iT[r]}`,e,i,this.animationValues);e.render();for(const r in i)e.setStaticValue(r,i[r]),this.animationValues&&(this.animationValues[r]=i[r]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return rT;const i={visibility:""},r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=Rk(null===e||void 0===e?void 0:e.pointerEvents)||"",i.transform=r?r(this.latestValues,""):"none",i;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=Rk(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!Fw(this.latestValues)&&(t.transform=r?r({},""):"none",this.hasProjected=!1),t}const o=s.animationValues||s.latestValues;this.applyTransformsToTarget(),i.transform=function(e,t,n){let i="";const r=e.x.translate/t.x,s=e.y.translate/t.y,o=(null===n||void 0===n?void 0:n.z)||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),1===t.x&&1===t.y||(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:e,rotate:t,rotateX:r,rotateY:s,skewX:o,skewY:a}=n;e&&(i=`perspective(${e}px) ${i}`),t&&(i+=`rotate(${t}deg) `),r&&(i+=`rotateX(${r}deg) `),s&&(i+=`rotateY(${s}deg) `),o&&(i+=`skewX(${o}deg) `),a&&(i+=`skewY(${a}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return 1===a&&1===l||(i+=`scale(${a}, ${l})`),i||"none"}(this.projectionDeltaWithTransform,this.treeScale,o),r&&(i.transform=r(o,i.transform));const{x:a,y:l}=this.projectionDelta;i.transformOrigin=`${100*a.origin}% ${100*l.origin}% 0`,s.animationValues?i.opacity=s===this?null!==(n=null!==(t=o.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:i.opacity=s===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const c in Ek){if(void 0===o[c])continue;const{correct:e,applyTo:t,isCSSVariable:n}=Ek[c],r="none"===i.transform?o[c]:e(o[c],s);if(t){const e=t.length;for(let n=0;n<e;n++)i[t[n]]=r}else n?this.options.visualElement.renderState.vars[c]=r:i[c]=r}return this.options.layoutId&&(i.pointerEvents=s===this?Rk(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()})),this.root.nodes.forEach(fT),this.root.sharedNodes.clear()}}}function cT(e){e.updateLayout()}function uT(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:i}=e.layout,{animationType:r}=e.options,s=n.source!==e.layout.source;"size"===r?Ow((e=>{const i=s?n.measuredBox[e]:n.layoutBox[e],r=Aw(i);i.min=t[e].min,i.max=i.min+r})):_T(r,n.layoutBox,t)&&Ow((i=>{const r=s?n.measuredBox[i]:n.layoutBox[i],o=Aw(t[i]);r.max=r.min+o,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[i].max=e.relativeTarget[i].min+o)}));const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};xw(o,t,n.layoutBox);const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?xw(a,e.applyTransform(i,!0),n.measuredBox):xw(a,t,n.layoutBox);const l=!Qk(o);let c=!1;if(!e.resumeFrom){const i=e.getClosestProjectingParent();if(i&&!i.resumeFrom){const{snapshot:r,layout:s}=i;if(r&&s){const o={x:{min:0,max:0},y:{min:0,max:0}};Dw(o,n.layoutBox,r.layoutBox);const a={x:{min:0,max:0},y:{min:0,max:0}};Dw(a,t,s.layoutBox),Xk(o,a)||(c=!0),i.options.layoutRoot&&(e.relativeTarget=a,e.relativeTargetOrigin=o,e.relativeParent=i)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function dT(e){zg.value&&nT.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function hT(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function pT(e){e.clearSnapshot()}function fT(e){e.clearMeasurements()}function mT(e){e.isLayoutDirty=!1}function gT(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function vT(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function yT(e){e.resolveTargetDelta()}function bT(e){e.calcProjection()}function wT(e){e.resetSkewAndRotation()}function kT(e){e.removeLeadSnapshot()}function TT(e,t,n){e.translate=ub(t.translate,0,n),e.scale=ub(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function ST(e,t,n,i){e.min=ub(t.min,n.min,i),e.max=ub(t.max,n.max,i)}function ET(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const IT={duration:.45,ease:[.4,0,.1,1]},CT=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),PT=CT("applewebkit/")&&!CT("chrome/")?Math.round:cg;function AT(e){e.min=PT(e.min),e.max=PT(e.max)}function _T(e,t,n){return"position"===e||"preserve-aspect"===e&&(i=Zk(t),r=Zk(n),s=.2,!(Math.abs(i-r)<=s));var i,r,s}function xT(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const RT=lT({attachResizeListener:(e,t)=>Ew(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),NT={current:void 0},DT=lT({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!NT.current){const e=new RT({});e.mount(window),e.setOptions({layoutScroll:!0}),NT.current=e}return NT.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),LT={pan:{Feature:class extends kw{constructor(){super(...arguments),this.removePointerDownListener=cg}onPointerDown(e){this.session=new ek(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Yw(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:mk(e),onStart:mk(t),onMove:n,onEnd:(e,t)=>{delete this.session,i&&qg.postRender((()=>i(e,t)))}}}mount(){this.removePointerDownListener=Cw(this.node.current,"pointerdown",(e=>this.onPointerDown(e)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends kw{constructor(e){super(e),this.removeGroupControls=cg,this.removeListeners=cg,this.controls=new pk(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||cg}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:DT,MeasureLayout:Ck}};function OT(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover","Start"===n);const r=i["onHover"+n];r&&qg.postRender((()=>r(t,Iw(t))))}function MT(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap","Start"===n);const r=i["onTap"+("End"===n?"":n)];r&&qg.postRender((()=>r(t,Iw(t))))}const jT=new WeakMap,FT=new WeakMap,UT=e=>{const t=jT.get(e.target);t&&t(e)},VT=e=>{e.forEach(UT)};function BT(e,t,n){const i=function(e){let{root:t,...n}=e;const i=t||document;FT.has(i)||FT.set(i,{});const r=FT.get(i),s=JSON.stringify(n);return r[s]||(r[s]=new IntersectionObserver(VT,{root:t,...n})),r[s]}(t);return jT.set(e,n),i.observe(e),()=>{jT.delete(e),i.unobserve(e)}}const $T={some:0,all:1};const zT={inView:{Feature:class extends kw{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:r}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof i?i:$T[i]};return BT(this.node.current,s,(e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,r&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:i}=this.node.getProps(),s=t?n:i;s&&s(e)}))}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends kw{mount(){const{current:e}=this.node;e&&(this.unmount=hv(e,((e,t)=>(MT(this.node,t,"Start"),(e,t)=>{let{success:n}=t;return MT(this.node,e,n?"End":"Cancel")})),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends kw{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(vC){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=yb(Ew(this.node.current,"focus",(()=>this.onFocus())),Ew(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends kw{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[i,r,s]=nv(e,n),o=e=>{if(!iv(e))return;const{target:n}=e,i=t(n,e);if("function"!==typeof i||!n)return;const s=e=>{iv(e)&&(i(e),n.removeEventListener("pointerleave",s))};n.addEventListener("pointerleave",s,r)};return i.forEach((e=>{e.addEventListener("pointerenter",o,r)})),s}(e,((e,t)=>(OT(this.node,t,"Start"),e=>OT(this.node,e,"End")))))}unmount(){}}}},GT={layout:{ProjectionNode:DT,MeasureLayout:Ck}},qT=(0,a.createContext)({strict:!1}),HT=(0,a.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),WT=(0,a.createContext)({});function KT(e){return kg(e.animate)||dw.some((t=>cw(e[t])))}function QT(e){return Boolean(KT(e)||e.variants)}function JT(e){const{initial:t,animate:n}=function(e,t){if(KT(e)){const{initial:t,animate:n}=e;return{initial:!1===t||cw(t)?t:void 0,animate:cw(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,a.useContext)(WT));return(0,a.useMemo)((()=>({initial:t,animate:n})),[YT(t),YT(n)])}function YT(e){return Array.isArray(e)?e.join(" "):e}const XT="undefined"!==typeof window,ZT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eS={};for(const n in ZT)eS[n]={isEnabled:e=>ZT[n].some((t=>!!e[t]))};const tS=Symbol.for("motionComponentSymbol");function nS(e,t,n){return(0,a.useCallback)((i=>{i&&e.onMount&&e.onMount(i),t&&(i?t.mount(i):t.unmount()),n&&("function"===typeof n?n(i):Xw(n)&&(n.current=i))}),[t])}const iS=XT?a.useLayoutEffect:a.useEffect;function rS(e,t,n,i,r){var s,o;const{visualElement:l}=(0,a.useContext)(WT),c=(0,a.useContext)(qT),u=(0,a.useContext)(vk),d=(0,a.useContext)(HT).reducedMotion,h=(0,a.useRef)(null);i=i||c.renderer,!h.current&&i&&(h.current=i(e,{visualState:t,parent:l,props:n,presenceContext:u,blockInitialAnimation:!!u&&!1===u.initial,reducedMotionConfig:d}));const p=h.current,f=(0,a.useContext)(bk);!p||p.projection||!r||"html"!==p.type&&"svg"!==p.type||function(e,t,n,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:sS(e.parent)),e.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:Boolean(o)||a&&Xw(a),visualElement:e,animationType:"string"===typeof s?s:"both",initialPromotionConfig:i,layoutScroll:l,layoutRoot:c})}(h.current,n,r,f);const m=(0,a.useRef)(!1);(0,a.useInsertionEffect)((()=>{p&&m.current&&p.update(n,u)}));const g=n[Iv],v=(0,a.useRef)(Boolean(g)&&!(null===(s=window.MotionHandoffIsComplete)||void 0===s?void 0:s.call(window,g))&&(null===(o=window.MotionHasOptimisedAnimation)||void 0===o?void 0:o.call(window,g)));return iS((()=>{p&&(m.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),Qg.render(p.render),v.current&&p.animationState&&p.animationState.animateChanges())})),(0,a.useEffect)((()=>{p&&(!v.current&&p.animationState&&p.animationState.animateChanges(),v.current&&(queueMicrotask((()=>{var e;null===(e=window.MotionHandoffMarkAsComplete)||void 0===e||e.call(window,g)})),v.current=!1))})),p}function sS(e){if(e)return!1!==e.options.allowProjection?e.projection:sS(e.parent)}function oS(e){let{preloadedFeatures:t,createVisualElement:n,useRender:i,useVisualState:r,Component:s}=e;var o,l;function c(e,t){let o;const l={...(0,a.useContext)(HT),...e,layoutId:aS(e)},{isStatic:c}=l,u=JT(e),d=r(e,c);if(!c&&XT){!function(){(0,a.useContext)(qT).strict;0}();const e=function(e){const{drag:t,layout:n}=eS;if(!t&&!n)return{};const i={...t,...n};return{MeasureLayout:(null===t||void 0===t?void 0:t.isEnabled(e))||(null===n||void 0===n?void 0:n.isEnabled(e))?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}(l);o=e.MeasureLayout,u.visualElement=rS(s,d,l,n,e.ProjectionNode)}return(0,gk.jsxs)(WT.Provider,{value:u,children:[o&&u.visualElement?(0,gk.jsx)(o,{visualElement:u.visualElement,...l}):null,i(s,e,nS(d,u.visualElement,t),d,c,u.visualElement)]})}t&&function(e){for(const t in e)eS[t]={...eS[t],...e[t]}}(t),c.displayName=`motion.${"string"===typeof s?s:`create(${null!==(l=null!==(o=s.displayName)&&void 0!==o?o:s.name)&&void 0!==l?l:""})`}`;const u=(0,a.forwardRef)(c);return u[tS]=s,u}function aS(e){let{layoutId:t}=e;const n=(0,a.useContext)(yk).id;return n&&void 0!==t?n+"-"+t:t}function lS(e,t){let{layout:n,layoutId:i}=t;return yv.has(e)||e.startsWith("origin")||(n||void 0!==i)&&(!!Ek[e]||"opacity"===e)}const cS=(e,t)=>t&&"number"===typeof e?t.transform(e):e,uS={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},dS=vv.length;function hS(e,t,n){const{style:i,vars:r,transformOrigin:s}=e;let o=!1,a=!1;for(const l in t){const e=t[l];if(yv.has(l))o=!0;else if(Jy(l))r[l]=e;else{const t=cS(e,Sy[l]);l.startsWith("origin")?(a=!0,s[l]=t):i[l]=t}}if(t.transform||(o||n?i.transform=function(e,t,n){let i="",r=!0;for(let s=0;s<dS;s++){const o=vv[s],a=e[o];if(void 0===a)continue;let l=!0;if(l="number"===typeof a?a===(o.startsWith("scale")?1:0):0===parseFloat(a),!l||n){const e=cS(a,Sy[o]);l||(r=!1,i+=`${uS[o]||o}(${e}) `),n&&(t[o]=e)}}return i=i.trim(),n?i=n(t,r?"":i):r&&(i="none"),i}(t,e.transform,n):i.transform&&(i.transform="none")),a){const{originX:e="50%",originY:t="50%",originZ:n=0}=s;i.transformOrigin=`${e} ${t} ${n}`}}const pS=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function fS(e,t,n){for(const i in t)Tv(t[i])||lS(i,n)||(e[i]=t[i])}function mS(e,t){const n={};return fS(n,e.style||{},e),Object.assign(n,function(e,t){let{transformTemplate:n}=e;return(0,a.useMemo)((()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return hS(e,t,n),Object.assign({},e.vars,e.style)}),[t])}(e,t)),n}function gS(e,t){const n={},i=mS(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const vS=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function yS(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||vS.has(e)}let bS=e=>!yS(e);try{(wS=require("@emotion/is-prop-valid").default)&&(bS=e=>e.startsWith("on")?!yS(e):wS(e))}catch(fL){}var wS;const kS=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TS(e){return"string"===typeof e&&!e.includes("-")&&!!(kS.indexOf(e)>-1||/[A-Z]/u.test(e))}const SS={offset:"stroke-dashoffset",array:"stroke-dasharray"},ES={offset:"strokeDashoffset",array:"strokeDasharray"};function IS(e,t,n){return"string"===typeof e?e:ty.transform(t+n*e)}function CS(e,t,n,i){let{attrX:r,attrY:s,attrScale:o,originX:a,originY:l,pathLength:c,pathSpacing:u=1,pathOffset:d=0,...h}=t;if(hS(e,h,i),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:p,style:f,dimensions:m}=e;p.transform&&(m&&(f.transform=p.transform),delete p.transform),m&&(void 0!==a||void 0!==l||f.transform)&&(f.transformOrigin=function(e,t,n){return`${IS(t,e.x,e.width)} ${IS(n,e.y,e.height)}`}(m,void 0!==a?a:.5,void 0!==l?l:.5)),void 0!==r&&(p.x=r),void 0!==s&&(p.y=s),void 0!==o&&(p.scale=o),void 0!==c&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=r?SS:ES;e[s.offset]=ty.transform(-i);const o=ty.transform(t),a=ty.transform(n);e[s.array]=`${o} ${a}`}(p,c,u,d,!1)}const PS=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),AS=e=>"string"===typeof e&&"svg"===e.toLowerCase();function _S(e,t,n,i){const r=(0,a.useMemo)((()=>{const n={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return CS(n,t,AS(i),e.transformTemplate),{...n.attrs,style:{...n.style}}}),[t]);if(e.style){const t={};fS(t,e.style,e),r.style={...t,...r.style}}return r}function xS(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(t,n,i,r,s)=>{let{latestValues:o}=r;const l=(TS(t)?_S:gS)(n,o,s,t),c=function(e,t,n){const i={};for(const r in e)"values"===r&&"object"===typeof e.values||(bS(r)||!0===n&&yS(r)||!t&&!yS(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}(n,"string"===typeof t,e),u=t!==a.Fragment?{...c,...l,ref:i}:{},{children:d}=n,h=(0,a.useMemo)((()=>Tv(d)?d.get():d),[d]);return(0,a.createElement)(t,{...u,children:h})}}const RS=e=>(t,n)=>{const i=(0,a.useContext)(WT),r=(0,a.useContext)(vk),s=()=>function(e,t,n,i){let{scrapeMotionValuesFromProps:r,createRenderState:s,onUpdate:o}=e;const a={latestValues:NS(t,n,i,r),renderState:s()};return o&&(a.onMount=e=>o({props:t,current:e,...a}),a.onUpdate=e=>o(e)),a}(e,t,i,r);return n?s():function(e){const t=(0,a.useRef)(null);return null===t.current&&(t.current=e()),t.current}(s)};function NS(e,t,n,i){const r={},s=i(e,{});for(const h in s)r[h]=Rk(s[h]);let{initial:o,animate:a}=e;const l=KT(e),c=QT(e);t&&c&&!l&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===a&&(a=t.animate));let u=!!n&&!1===n.initial;u=u||!1===o;const d=u?a:o;if(d&&"boolean"!==typeof d&&!kg(d)){const t=Array.isArray(d)?d:[d];for(let n=0;n<t.length;n++){const i=Sg(e,t[n]);if(i){const{transitionEnd:e,transition:t,...n}=i;for(const i in n){let e=n[i];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(r[i]=e)}for(const i in e)r[i]=e[i]}}}return r}function DS(e,t,n){var i;const{style:r}=e,s={};for(const o in r)(Tv(r[o])||t.style&&Tv(t.style[o])||lS(o,e)||void 0!==(null===(i=null===n||void 0===n?void 0:n.getValue(o))||void 0===i?void 0:i.liveStyle))&&(s[o]=r[o]);return s}const LS={useVisualState:RS({scrapeMotionValuesFromProps:DS,createRenderState:pS})};function OS(e,t){try{t.dimensions="function"===typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}catch(vC){t.dimensions={x:0,y:0,width:0,height:0}}}function MS(e,t,n,i){let{style:r,vars:s}=t;Object.assign(e.style,r,i&&i.getProjectionStyles(n));for(const o in s)e.style.setProperty(o,s[o])}const jS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function FS(e,t,n,i){MS(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(jS.has(r)?r:Ev(r),t.attrs[r])}function US(e,t,n){const i=DS(e,t,n);for(const r in e)if(Tv(e[r])||Tv(t[r])){i[-1!==vv.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]}return i}const VS=["x","y","width","height","cx","cy","r"],BS={useVisualState:RS({scrapeMotionValuesFromProps:US,createRenderState:PS,onUpdate:e=>{let{props:t,prevProps:n,current:i,renderState:r,latestValues:s}=e;if(!i)return;let o=!!t.drag;if(!o)for(const l in s)if(yv.has(l)){o=!0;break}if(!o)return;let a=!n;if(n)for(let l=0;l<VS.length;l++){const e=VS[l];t[e]!==n[e]&&(a=!0)}a&&qg.read((()=>{OS(i,r),qg.render((()=>{CS(r,s,AS(i.tagName),t.transformTemplate),FS(i,r)}))}))}})};function $S(e,t){return function(n){let{forwardMotionProps:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{forwardMotionProps:!1};return oS({...TS(n)?BS:LS,preloadedFeatures:e,useRender:xS(i),createVisualElement:t,Component:n})}}const zS={current:null},GS={current:!1};const qS=[...ib,oy,my],HS=new WeakMap;const WS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class KS{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Wy,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=Zg.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,qg.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=Boolean(s),this.isControllingVariants=KT(n),this.isVariantNode=QT(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in h){const e=h[p];void 0!==l[p]&&Tv(e)&&e.set(l[p],!1)}}mount(e){this.current=e,HS.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((e,t)=>this.bindToMotionValue(t,e))),GS.current||function(){if(GS.current=!0,XT)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>zS.current=e.matches;e.addListener(t),t()}else zS.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||zS.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Hg(this.notifyUpdate),Hg(this.render),this.valueSubscriptions.forEach((e=>e())),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=yv.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",(t=>{this.latestValues[e]=t,this.props.onUpdate&&qg.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)})),r=t.on("renderRequest",this.scheduleRender);let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,(()=>{i(),r(),s&&s(),t.owner&&t.stop()}))}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in eS){const t=eS[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<WS.length;n++){const t=WS[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const i=e["on"+t];i&&(this.propEventSubscriptions[t]=this.on(t,i))}this.prevMotionValues=function(e,t,n){for(const i in t){const r=t[i],s=n[i];if(Tv(r))e.addValue(i,r);else if(Tv(s))e.addValue(i,gv(r,{owner:e}));else if(s!==r)if(e.hasValue(i)){const t=e.getValue(i);!0===t.liveStyle?t.jump(r):t.hasAnimated||t.set(r)}else{const t=e.getStaticValue(i);e.addValue(i,gv(void 0!==t?t:r,{owner:e}))}}for(const i in n)void 0===t[i]&&e.removeValue(i);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=gv(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let i=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var r;return void 0!==i&&null!==i&&("string"===typeof i&&(Ky(i)||Uv(i))?i=parseFloat(i):(r=i,!qS.find(nb(r))&&my.test(t)&&(i=Cy(e,t))),this.setBaseTarget(e,Tv(i)?i.get():i)),Tv(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let i;if("string"===typeof n||"object"===typeof n){const r=Sg(this.props,n,null===(t=this.presenceContext)||void 0===t?void 0:t.custom);r&&(i=r[e])}if(n&&void 0!==i)return i;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||Tv(r)?void 0!==this.initialValues[e]&&void 0===i?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new gg),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.events[e].notify(...n)}}}class QS extends KS{constructor(){super(...arguments),this.KeyframeResolver=sb}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:i}=t;delete n[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Tv(e)&&(this.childSubscription=e.on("change",(e=>{this.current&&(this.current.textContent=`${e}`)})))}}class JS extends QS{constructor(){super(...arguments),this.type="html",this.renderInstance=MS}readValueFromInstance(e,t){if(yv.has(t))return((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return My(n,t)})(e,t);{const i=(n=e,window.getComputedStyle(n)),r=(Jy(t)?i.getPropertyValue(t):i[t])||0;return"string"===typeof r?r.trim():r}var n}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return Jw(e,n)}build(e,t,n){hS(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return DS(e,t,n)}}class YS extends QS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Lw,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&OS(this.current,this.renderState)}}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(yv.has(t)){const e=Iy(t);return e&&e.default||0}return t=jS.has(t)?t:Ev(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return US(e,t,n)}onBindTransform(){this.current&&!this.renderState.dimensions&&qg.postRender(this.updateDimensions)}build(e,t,n){CS(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,i){FS(e,t,0,i)}mount(e){this.isSVGTag=AS(e.tagName),super.mount(e)}}const XS=wg($S({...Sw,...zT,...LT,...GT},((e,t)=>TS(e)?new YS(t):new JS(t,{allowProjection:e!==a.Fragment}))));function ZS(e,t){return e===t}var eE=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=0,o=i.pop(),a=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}(i),l=e.apply(void 0,[function(){return s++,o.apply(null,arguments)}].concat(n)),c=e((function(){for(var e=[],t=a.length,n=0;n<t;n++)e.push(a[n].apply(null,arguments));return l.apply(null,e)}));return c.resultFunc=o,c.dependencies=a,c.recomputations=function(){return s},c.resetRecomputations=function(){return s=0},c}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ZS,n=null,i=null;return function(){return function(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}));var tE,nE=n(121),iE=new Uint8Array(16);function rE(){if(!tE&&!(tE="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tE(iE)}const sE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const oE=function(e){return"string"===typeof e&&sE.test(e)};for(var aE=[],lE=0;lE<256;++lE)aE.push((lE+256).toString(16).substr(1));const cE=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(aE[e[t+0]]+aE[e[t+1]]+aE[e[t+2]]+aE[e[t+3]]+"-"+aE[e[t+4]]+aE[e[t+5]]+"-"+aE[e[t+6]]+aE[e[t+7]]+"-"+aE[e[t+8]]+aE[e[t+9]]+"-"+aE[e[t+10]]+aE[e[t+11]]+aE[e[t+12]]+aE[e[t+13]]+aE[e[t+14]]+aE[e[t+15]]).toLowerCase();if(!oE(n))throw TypeError("Stringified UUID is invalid");return n};const uE=function(e,t,n){var i=(e=e||{}).random||(e.rng||rE)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return cE(i)};var dE=n(67),hE=n.n(dE);let pE=!0,fE=!0;function mE(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function gE(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const s=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,s),r.apply(this,[e,s])};const s=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return s.apply(this,arguments);if(!this._eventMap[t].has(n))return s.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function vE(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(pE=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function yE(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(fE=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function bE(){if("object"===typeof window){if(pE)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function wE(e,t){fE&&console.warn(e+" is deprecated, please use "+t+" instead.")}function kE(e){return"[object Object]"===Object.prototype.toString.call(e)}function TE(e){return kE(e)?Object.keys(e).reduce((function(t,n){const i=kE(e[n]),r=i?TE(e[n]):e[n],s=i&&!Object.keys(r).length;return void 0===r||s?t:Object.assign(t,{[n]:r})}),{}):e}function SE(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?SE(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{SE(e,e.get(t),n)}))})))}function EE(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const s=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&s.push(e)})),s.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&SE(e,n,r)}))})),r}const IE=bE;function CE(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let s=e.video.facingMode;s=s&&("object"===typeof s?s:{ideal:s});const o=t.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?t=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let o=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!o&&n.length&&t.includes("back")&&(o=n[n.length-1]),o&&(e.video.deviceId=s.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),IE("chrome: "+JSON.stringify(e)),r(e)}))}e.video=i(e.video)}return IE("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(s(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(s(e))))))}}}function PE(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,r=n.video&&n.video.height,s=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:s||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function AE(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function _E(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else gE(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function xE(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function RE(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(s(r(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(s(r(t)))},n])})).then(n,i)}}function NE(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>EE(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),gE(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>EE(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function DE(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function LE(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return DE(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=s(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>s(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function OE(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function ME(e,t){gE(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}function jE(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){wE("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function FE(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function UE(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function VE(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,s]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(vC){if("TypeError"!==vC.name)throw vC;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,s)}}function BE(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function $E(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),gE(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function zE(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){wE("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function GE(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function qE(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function HE(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function WE(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function KE(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function QE(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function JE(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function YE(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,s=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function XE(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ZE(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function ZE(e){return e&&void 0!==e.video?Object.assign({},e,{video:TE(e.video)}):e}function eI(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(wE("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function tI(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function nI(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function iI(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var rI=n(824),sI=n.n(rI);function oI(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=sI().parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,gE(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function aI(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||gE(e,"icecandidate",(e=>{if(e.candidate){const t=sI().parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function lI(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=sI().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=sI().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=sI().matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const s={};Object.defineProperty(s,"maxMessageSize",{get:()=>r}),this._sctp=s}return n.apply(this,arguments)}}function cI(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},gE(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function uI(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function dI(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function hI(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function pI(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}const fI=function(){let{window:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const o=bE,a=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=mE(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=mE(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=mE(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(n),l={browserDetails:a,commonShim:r,extractVersion:mE,disableLog:vE,disableWarnings:yE,sdp:rI};switch(a.browser){case"chrome":if(!e||!OE||!s.shimChrome)return o("Chrome shim is not included in this adapter release."),l;if(null===a.version)return o("Chrome shim can not determine version, not shimming."),l;o("adapter.js shimming chrome."),l.browserShim=e,hI(n,a),pI(n),CE(n,a),AE(n),OE(n,a),_E(n),LE(n,a),xE(n),RE(n),NE(n),ME(n,a),oI(n),aI(n),uI(n),lI(n,a),cI(n),dI(n,a);break;case"firefox":if(!t||!VE||!s.shimFirefox)return o("Firefox shim is not included in this adapter release."),l;o("adapter.js shimming firefox."),l.browserShim=t,hI(n,a),pI(n),jE(n,a),VE(n,a),UE(n),zE(n),BE(n),$E(n),GE(n),qE(n),HE(n),WE(n),KE(n),oI(n),uI(n),lI(n,a),cI(n);break;case"safari":if(!i||!s.shimSafari)return o("Safari shim is not included in this adapter release."),l;o("adapter.js shimming safari."),l.browserShim=i,hI(n,a),pI(n),eI(n),nI(n),YE(n),QE(n),JE(n),tI(n),XE(n),iI(n),oI(n),aI(n),lI(n,a),cI(n),dI(n,a);break;default:o("Unsupported browser!")}return l}({window:"undefined"===typeof window?void 0:window});var mI=n(476),gI=n.n(mI);function vI(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function yI(e){return!!e&&!!e[rC]}function bI(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===sC}(e)||Array.isArray(e)||!!e[iC]||!!(null===(t=e.constructor)||void 0===t?void 0:t[iC])||CI(e)||PI(e))}function wI(e,t,n){void 0===n&&(n=!1),0===kI(e)?(n?Object.keys:oC)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function kI(e){var t=e[rC];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:CI(e)?2:PI(e)?3:0}function TI(e,t){return 2===kI(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function SI(e,t){return 2===kI(e)?e.get(t):e[t]}function EI(e,t,n){var i=kI(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function II(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function CI(e){return ZI&&e instanceof Map}function PI(e){return eC&&e instanceof Set}function AI(e){return e.o||e.t}function _I(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=aC(e);delete t[rC];for(var n=oC(t),i=0;i<n.length;i++){var r=n[i],s=t[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function xI(e,t){return void 0===t&&(t=!1),NI(e)||yI(e)||!bI(e)||(kI(e)>1&&(e.set=e.add=e.clear=e.delete=RI),Object.freeze(e),t&&wI(e,(function(e,t){return xI(t,!0)}),!0)),e}function RI(){vI(2)}function NI(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function DI(e){var t=lC[e];return t||vI(18,e),t}function LI(){return YI}function OI(e,t){t&&(DI("Patches"),e.u=[],e.s=[],e.v=t)}function MI(e){jI(e),e.p.forEach(UI),e.p=null}function jI(e){e===YI&&(YI=e.l)}function FI(e){return YI={p:[],l:YI,h:e,m:!0,_:0}}function UI(e){var t=e[rC];0===t.i||1===t.i?t.j():t.g=!0}function VI(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.O||DI("ES5").S(t,e,i),i?(n[rC].P&&(MI(t),vI(4)),bI(e)&&(e=BI(t,e),t.l||zI(t,e)),t.u&&DI("Patches").M(n[rC].t,e,t.u,t.s)):e=BI(t,n,[]),MI(t),t.u&&t.v(t.u,t.s),e!==nC?e:void 0}function BI(e,t,n){if(NI(t))return t;var i=t[rC];if(!i)return wI(t,(function(r,s){return $I(e,i,t,r,s,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return zI(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=_I(i.k):i.o,s=r,o=!1;3===i.i&&(s=new Set(r),r.clear(),o=!0),wI(s,(function(t,s){return $I(e,i,r,t,s,n,o)})),zI(e,r,!1),n&&e.u&&DI("Patches").N(i,n,e.u,e.s)}return i.o}function $I(e,t,n,i,r,s,o){if(yI(r)){var a=BI(e,r,s&&t&&3!==t.i&&!TI(t.R,i)?s.concat(i):void 0);if(EI(n,i,a),!yI(a))return;e.m=!1}else o&&n.add(r);if(bI(r)&&!NI(r)){if(!e.h.D&&e._<1)return;BI(e,r),t&&t.A.l||zI(e,r)}}function zI(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&xI(t,n)}function GI(e,t){var n=e[rC];return(n?AI(n):e)[t]}function qI(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function HI(e){e.P||(e.P=!0,e.l&&HI(e.l))}function WI(e){e.o||(e.o=_I(e.t))}function KI(e,t,n){var i=CI(t)?DI("MapSet").F(t,n):PI(t)?DI("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:LI(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=i,s=cC;n&&(r=[i],s=uC);var o=Proxy.revocable(r,s),a=o.revoke,l=o.proxy;return i.k=l,i.j=a,l}(t,n):DI("ES5").J(t,n);return(n?n.A:LI()).p.push(i),i}function QI(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return _I(e)}var JI,YI,XI="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),ZI="undefined"!=typeof Map,eC="undefined"!=typeof Set,tC="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,nC=XI?Symbol.for("immer-nothing"):((JI={})["immer-nothing"]=!0,JI),iC=XI?Symbol.for("immer-draftable"):"__$immer_draftable",rC=XI?Symbol.for("immer-state"):"__$immer_state",sC=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),oC="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,aC=Object.getOwnPropertyDescriptors||function(e){var t={};return oC(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},lC={},cC={get:function(e,t){if(t===rC)return e;var n=AI(e);if(!TI(n,t))return function(e,t,n){var i,r=qI(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!bI(i)?i:i===GI(e.t,t)?(WI(e),e.o[t]=KI(e.A.h,i,e)):i},has:function(e,t){return t in AI(e)},ownKeys:function(e){return Reflect.ownKeys(AI(e))},set:function(e,t,n){var i=qI(AI(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var r=GI(AI(e),t),s=null==r?void 0:r[rC];if(s&&s.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(II(n,r)&&(void 0!==n||TI(e.t,t)))return!0;WI(e),HI(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==GI(e.t,t)||t in e.t?(e.R[t]=!1,WI(e),HI(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=AI(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){vI(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){vI(12)}},uC={};wI(cC,(function(e,t){uC[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),uC.deleteProperty=function(e,t){return uC.set.call(this,e,t,void 0)},uC.set=function(e,t,n){return cC.set.call(this,e[0],t,n,e[0])};var dC=function(){function e(e){var t=this;this.O=tC,this.D=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var r=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return s.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&vI(6),void 0!==i&&"function"!=typeof i&&vI(7),bI(e)){var a=FI(t),l=KI(t,e,void 0),c=!0;try{o=n(l),c=!1}finally{c?MI(a):jI(a)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return OI(a,i),VI(e,a)}),(function(e){throw MI(a),e})):(OI(a,i),VI(o,a))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===nC&&(o=void 0),t.D&&xI(o,!0),i){var u=[],d=[];DI("Patches").M(e,o,u,d),i(u,d)}return o}vI(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(r))}))};var i,r,s=t.produce(e,n,(function(e,t){i=e,r=t}));return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return[e,i,r]})):[s,i,r]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){bI(e)||vI(8),yI(e)&&(e=function(e){return yI(e)||vI(22,e),function e(t){if(!bI(t))return t;var n,i=t[rC],r=kI(t);if(i){if(!i.P&&(i.i<4||!DI("ES5").K(i)))return i.t;i.I=!0,n=QI(t,r),i.I=!1}else n=QI(t,r);return wI(n,(function(t,r){i&&SI(i.t,t)===r||EI(n,t,e(r))})),3===r?new Set(n):n}(e)}(e));var t=FI(this),n=KI(this,e,void 0);return n[rC].C=!0,jI(t),n},t.finishDraft=function(e,t){var n=(e&&e[rC]).A;return OI(n,t),VI(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!tC&&vI(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=DI("Patches").$;return yI(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}(),hC=new dC,pC=hC.produce;hC.produceWithPatches.bind(hC),hC.setAutoFreeze.bind(hC),hC.setUseProxies.bind(hC),hC.applyPatches.bind(hC),hC.createDraft.bind(hC),hC.finishDraft.bind(hC);const fC=function(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!Object.is(e[n[i]],t[n[i]]))return!1;return!0};const mC=function(e){let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(r!==t){const e=t;t=i?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,subscribe:(e,i,s)=>i||s?function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,o=i(t);function a(){const n=i(t);if(!s(o,n)){const t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)}(e,i,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,s),s};var gC,vC,yC,bC,wC,kC=n(640),TC=Object.defineProperty,SC=Object.defineProperties,EC=Object.getOwnPropertyDescriptors,IC=Object.getOwnPropertySymbols,CC=Object.getPrototypeOf,PC=Object.prototype.hasOwnProperty,AC=Object.prototype.propertyIsEnumerable,_C=Reflect.get,xC=(e,t,n)=>t in e?TC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,RC=(e,t)=>{for(var n in t||(t={}))PC.call(t,n)&&xC(e,n,t[n]);if(IC)for(var n of IC(t))AC.call(t,n)&&xC(e,n,t[n]);return e},NC=(e,t)=>SC(e,EC(t)),DC=(e,t)=>{var n={};for(var i in e)PC.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&IC)for(var i of IC(e))t.indexOf(i)<0&&AC.call(e,i)&&(n[i]=e[i]);return n},LC=(e,t,n)=>_C(CC(e),n,t),OC=(e,t,n)=>new Promise(((i,r)=>{var s=e=>{try{a(n.next(e))}catch(t){r(t)}},o=e=>{try{a(n.throw(e))}catch(t){r(t)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);a((n=n.apply(e,t)).next())})),MC=(gC=(e,t)=>{t.exports={version:"0.12.33",license:"MIT",repository:{type:"git",url:"https://github.com/100mslive/web-sdks.git",directory:"packages/hms-video-store"},main:"dist/index.cjs.js",module:"dist/index.js",typings:"dist/index.d.ts",files:["dist","src"],engines:{node:">=12"},exports:{".":{require:"./dist/index.cjs.js",import:"./dist/index.js",default:"./dist/index.js"}},sideEffects:!1,scripts:{prestart:"rm -rf dist && yarn types:build",start:'concurrently "yarn dev" "yarn types"',dev:"node ../../scripts/dev","build:only":"node ../../scripts/build",build:"yarn build:only && yarn types:build",types:"tsc -w","types:build":"tsc -p tsconfig.json",format:"prettier --write src/**/*.ts",test:"jest --maxWorkers=1","test:watch":"jest --watch","test:coverage":"jest --coverage",lint:"eslint -c ../../.eslintrc .","lint:fix":"yarn lint --fix",prepare:"yarn build",size:"size-limit",analyze:"size-limit --why",docs:"rm -rf ./docs && typedoc && rm -f ./docs/README.md && mkdir ./docs/home &&mv ./docs/modules.md ./docs/home/content.md && node ../../scripts/docs-store && npx prettier --write './docs/**/*'"},name:"@100mslive/hms-video-store",author:"100ms",dependencies:{eventemitter2:"^6.4.9",immer:"^9.0.6","lodash.isequal":"^4.5.0",reselect:"4.0.0","sdp-transform":"^2.14.1","ua-parser-js":"^1.0.1",uuid:"^8.3.2","webrtc-adapter":"^8.0.0",zustand:"3.5.7"},devDependencies:{"@types/dom-screen-wake-lock":"^1.0.1","@types/lodash.isequal":"^4.5.8","@types/sdp-transform":"^2.4.4","@types/ua-parser-js":"^0.7.36","@types/uuid":"^8.3.0","jest-canvas-mock":"^2.3.1","jsdom-worker":"^0.3.0",tslib:"^2.2.0"},description:"@100mslive Core SDK which abstracts the complexities of webRTC while providing a reactive store for data management with a unidirectional data flow",keywords:["video","webrtc","conferencing","100ms"],gitHead:"6a043f0362fdbf8e5d643ee56845714aff509c5b"}},()=>(vC||gC((vC={exports:{}}).exports,vC),vC.exports)),jC=((yC=jC||{}).Disconnected="Disconnected",yC.Preview="Preview",yC.Connecting="Connecting",yC.Connected="Connected",yC.Reconnecting="Reconnecting",yC.Disconnecting="Disconnecting",yC.Failed="Failed",yC),FC=()=>({room:{id:"",isConnected:!1,name:"",peers:[],localPeer:"",roomState:"Disconnected",recording:{browser:{running:!1},server:{running:!1},hls:{running:!1}},rtmp:{running:!1},hls:{running:!1,variants:[]},sessionId:""},peers:{},tracks:{},playlist:{audio:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1},video:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1}},messages:{byID:{},allIDs:[]},speakers:{},connectionQualities:{},settings:{audioInputDeviceId:"",audioOutputDeviceId:"",videoInputDeviceId:""},devices:{audioInput:[],audioOutput:[],videoInput:[]},roles:{},roleChangeRequests:[],errors:[],sessionStore:{},templateAppData:{},polls:{},whiteboards:{},hideLocalPeer:!1}),UC=()=>({peerStats:{},remoteTrackStats:{},localTrackStats:{},localPeer:{id:""}}),VC=(e=>(e.CHAT="chat",e))(VC||{}),BC=((wC=BC||{}).INFO="info",wC.ERROR="error",wC),$C=((bC=$C||{}).PEER_JOINED="PEER_JOINED",bC.PEER_LEFT="PEER_LEFT",bC.PEER_LIST="PEER_LIST",bC.NEW_MESSAGE="NEW_MESSAGE",bC.ERROR="ERROR",bC.RECONNECTING="RECONNECTING",bC.RECONNECTED="RECONNECTED",bC.TRACK_ADDED="TRACK_ADDED",bC.TRACK_REMOVED="TRACK_REMOVED",bC.TRACK_MUTED="TRACK_MUTED",bC.TRACK_UNMUTED="TRACK_UNMUTED",bC.TRACK_DEGRADED="TRACK_DEGRADED",bC.TRACK_RESTORED="TRACK_RESTORED",bC.TRACK_DESCRIPTION_CHANGED="TRACK_DESCRIPTION_CHANGED",bC.ROLE_UPDATED="ROLE_UPDATED",bC.CHANGE_TRACK_STATE_REQUEST="CHANGE_TRACK_STATE_REQUEST",bC.CHANGE_MULTI_TRACK_STATE_REQUEST="CHANGE_MULTI_TRACK_STATE_REQUEST",bC.ROOM_ENDED="ROOM_ENDED",bC.REMOVED_FROM_ROOM="REMOVED_FROM_ROOM",bC.DEVICE_CHANGE_UPDATE="DEVICE_CHANGE_UPDATE",bC.PLAYLIST_TRACK_ENDED="PLAYLIST_TRACK_ENDED",bC.NAME_UPDATED="NAME_UPDATED",bC.METADATA_UPDATED="METADATA_UPDATED",bC.POLL_CREATED="POLL_CREATED",bC.POLL_STARTED="POLL_STARTED",bC.POLL_STOPPED="POLL_STOPPED",bC.POLL_VOTES_UPDATED="POLL_VOTES_UPDATED",bC.POLLS_LIST="POLLS_LIST",bC.HAND_RAISE_CHANGED="HAND_RAISE_CHANGED",bC.TRANSCRIPTION_STATE_UPDATED="TRANSCRIPTION_STATE_UPDATED",bC),zC=(e=>(e.audio="audio",e.video="video",e))(zC||{});function GC(e,t){let n,i;if(t)for(let r of t.auxiliaryTracks){let t=e[r];WC(t)&&(i=qC(t)?t:i,n=HC(t)?t:n)}return{video:n,audio:i}}function qC(e){return e&&"audio"===e.type}function HC(e){return e&&"video"===e.type}function WC(e){return e&&"screen"===e.source}function KC(e){return e&&"audioplaylist"===e.source}function QC(e){return e&&"videoplaylist"===e.source}function JC(e){return!!e&&!(null==e||!e.degraded)}function YC(e,t){return!(!t||!e.tracks[t])&&e.tracks[t].enabled}function XC(e){var t;let n=!1,i=!1,r=!1;return null!=(t=null==e?void 0:e.publishParams)&&t.allowed&&(n=e.publishParams.allowed.includes("video"),i=e.publishParams.allowed.includes("audio"),r=e.publishParams.allowed.includes("screen")),{video:n,audio:i,screen:r}}var ZC,eP=((ZC=eP||{})[ZC.VERBOSE=0]="VERBOSE",ZC[ZC.DEBUG=1]="DEBUG",ZC[ZC.INFO=2]="INFO",ZC[ZC.WARN=3]="WARN",ZC[ZC.TIME=4]="TIME",ZC[ZC.TIMEEND=5]="TIMEEND",ZC[ZC.ERROR=6]="ERROR",ZC[ZC.NONE=7]="NONE",ZC),tP="undefined"!=typeof window&&"undefined"!=typeof window.expect,nP=class{static v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(0,e,...n)}static d(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(1,e,...n)}static i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(2,e,...n)}static w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(3,e,...n)}static e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(6,e,...n)}static time(e){this.log(4,"[HMSPerformanceTiming]",e)}static timeEnd(e){this.log(5,"[HMSPerformanceTiming]",e,e)}static cleanup(){performance.clearMarks(),performance.clearMeasures()}static log(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(!(this.level.valueOf()>e.valueOf()))switch(e){case 0:console.log(t,...i);break;case 1:console.debug(t,...i);break;case 2:console.info(t,...i);break;case 3:console.warn(t,...i);break;case 6:console.error(t,...i);break;case 4:performance.mark(i[0]);break;case 5:{let e=i[0];try{let n=performance.measure(e,e);this.log(1,t,e,null==n?void 0:n.duration),performance.clearMarks(e),performance.clearMeasures(e)}catch(tN){this.log(1,t,e,tN)}break}}}};nP.level=tP?7:0;var iP,rP,sP,oP,aP,lP,cP=class{constructor(e){this.tracks=new Array,this.nativeStream=e,this.id=e.id}updateId(e){this.id=e}},uP=new nE.UAParser,dP="undefined"!=typeof window,hP="undefined"==typeof window&&!(null!=(iP=uP.getBrowser().name)&&iP.toLowerCase().includes("electron")),pP=()=>"mobile"===uP.getDevice().type,fP=null==(sP=null==(rP=uP.getBrowser())?void 0:rP.name)?void 0:sP.toLowerCase().includes("safari"),mP="firefox"===(null==(aP=null==(oP=uP.getBrowser())?void 0:oP.name)?void 0:aP.toLowerCase()),gP=((lP=gP||{}).CUSTOM="CUSTOM",lP.LOCAL="LOCAL",lP.HMS="HMS",lP);var vP,yP=function(){if(dP&&window){let e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"LOCAL":e.includes("app.100ms.live")?"HMS":"CUSTOM"}return"CUSTOM"}(),bP={WebSocketConnectionErrors:{FAILED_TO_CONNECT:1e3,WEBSOCKET_CONNECTION_LOST:1003,ABNORMAL_CLOSE:1006},APIErrors:{SERVER_ERRORS:2e3,INIT_CONFIG_NOT_AVAILABLE:2002,ENDPOINT_UNREACHABLE:2003,INVALID_TOKEN_FORMAT:2004},TracksErrors:{GENERIC_TRACK:3e3,CANT_ACCESS_CAPTURE_DEVICE:3001,DEVICE_NOT_AVAILABLE:3002,DEVICE_IN_USE:3003,DEVICE_LOST_MIDWAY:3004,NOTHING_TO_RETURN:3005,INVALID_VIDEO_SETTINGS:3006,CODEC_CHANGE_NOT_PERMITTED:3007,AUTOPLAY_ERROR:3008,OVER_CONSTRAINED:3009,NO_AUDIO_DETECTED:3010,SYSTEM_DENIED_PERMISSION:3011,CURRENT_TAB_NOT_SHARED:3012,AUDIO_PLAYBACK_ERROR:3013,SELECTED_DEVICE_MISSING:3014,NO_DATA:3015},WebrtcErrors:{CREATE_OFFER_FAILED:4001,CREATE_ANSWER_FAILED:4002,SET_LOCAL_DESCRIPTION_FAILED:4003,SET_REMOTE_DESCRIPTION_FAILED:4004,ICE_FAILURE:4005,ICE_DISCONNECTED:4006,STATS_FAILED:4007},WebsocketMethodErrors:{SERVER_ERRORS:5e3,ALREADY_JOINED:5001,CANNOT_JOIN_PREVIEW_IN_PROGRESS:5002},GenericErrors:{NOT_CONNECTED:6e3,SIGNALLING:6001,UNKNOWN:6002,NOT_READY:6003,JSON_PARSING_FAILED:6004,TRACK_METADATA_MISSING:6005,RTC_TRACK_MISSING:6006,PEER_METADATA_MISSING:6007,INVALID_ROLE:6008,PREVIEW_IN_PROGRESS:6009,MISSING_MEDIADEVICES:6010,MISSING_RTCPEERCONNECTION:6011,LOCAL_STORAGE_ACCESS_DENIED:6012,VALIDATION_FAILED:6013},PlaylistErrors:{NO_ENTRY_TO_PLAY:8001,NO_ENTRY_IS_PLAYING:8002}},wP=class e extends Error{constructor(t,n,i,r,s){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(r),this.code=t,this.name=n,this.message=r,this.description=s,this.isTerminal=o,Object.setPrototypeOf(this,e.prototype),this.action=i.toString()}toAnalyticsProperties(){return{error_name:this.name,error_code:this.code,error_message:this.message,error_description:this.description,action:this.action,is_terminal:this.isTerminal}}addNativeError(e){this.nativeError=e}toString(){var e;return`{\n        code: ${this.code};\n        name: ${this.name};\n        action: ${this.action};\n        message: ${this.message};\n        description: ${this.description};\n        isTerminal: ${this.isTerminal};\n        nativeError: ${null==(e=this.nativeError)?void 0:e.message};\n      }`}},kP=class extends wP{constructor(e,t,n,i,r,s){super(e,t,n,i,r,!1),this.code=e,this.name=t,this.message=i,this.description=r,this.trackType=s}toAnalyticsProperties(){return NC(RC({},super.toAnalyticsProperties()),{track_type:this.trackType})}toString(){var e;return`{\n        code: ${this.code};\n        name: ${this.name};\n        action: ${this.action};\n        message: ${this.message};\n        description: ${this.description};\n        isTerminal: ${this.isTerminal};\n        nativeError: ${null==(e=this.nativeError)?void 0:e.message};\n        trackType: ${this.trackType};\n      }`}},TP=((vP=TP||{}).AUDIO="audio",vP.VIDEO="video",vP.AUDIO_VIDEO="audio, video",vP.SCREEN="screen",vP);function SP(e){switch(e){case"join":return"JOIN";case"offer":return"PUBLISH";case"answer":return"SUBSCRIBE";case"track-update":return"TRACK";default:return"NONE"}}var EP=["join","offer","answer","trickle","on-error","JOIN"],IP={WebSocketConnectionErrors:{FailedToConnect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebSocketConnectionErrors.FAILED_TO_CONNECT,"WebsocketFailedToConnect",e,`[WS]: ${t}`,`[WS]: ${t}`)},WebSocketConnectionLost(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,"WebSocketConnectionLost",e,"Network connection lost",t)},AbnormalClose(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebSocketConnectionErrors.ABNORMAL_CLOSE,"WebSocketAbnormalClose",e,"Websocket closed abnormally",t)}},APIErrors:{ServerErrors(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new wP(e,"ServerErrors",t,`[${t}]: Server error ${n}`,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])},EndpointUnreachable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.APIErrors.ENDPOINT_UNREACHABLE,"EndpointUnreachable",e,`Endpoint is not reachable - ${t}`,t)},InvalidTokenFormat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.APIErrors.INVALID_TOKEN_FORMAT,"InvalidTokenFormat",e,`Token is not in proper JWT format - ${t}`,t,!0)},InitConfigNotAvailable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.APIErrors.INIT_CONFIG_NOT_AVAILABLE,"InitError",e,`[INIT]: ${t}`,`[INIT]: ${t}`)}},TracksErrors:{GenericTrack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new kP(bP.TracksErrors.GENERIC_TRACK,"GenericTrack",e,`[TRACK]: ${t}`,`[TRACK]: ${t}`,"audio, video")},CantAccessCaptureDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,"CantAccessCaptureDevice",e,`User denied permission to access capture device - ${t}`,n,t)},DeviceNotAvailable(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.DEVICE_NOT_AVAILABLE,"DeviceNotAvailable",e,`[TRACK]: Capture device is no longer available - ${t}`,n,t)},DeviceInUse(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.DEVICE_IN_USE,"DeviceInUse",e,`[TRACK]: Capture device is in use by another application - ${t}`,n,t)},DeviceLostMidway(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.DEVICE_LOST_MIDWAY,"DeviceLostMidway",e,`Lost access to capture device midway - ${t}`,n,t)},NothingToReturn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"There is no media to return. Please select either video or audio or both.";return new kP(bP.TracksErrors.NOTHING_TO_RETURN,"NothingToReturn",e,n,t,"audio, video")},InvalidVideoSettings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new kP(bP.TracksErrors.INVALID_VIDEO_SETTINGS,"InvalidVideoSettings",e,"Cannot enable simulcast when no video settings are provided",t,"video")},AutoplayBlocked(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new kP(bP.TracksErrors.AUTOPLAY_ERROR,"AutoplayBlocked",e,"Autoplay blocked because the user didn't interact with the document first",t,"audio")},CodecChangeNotPermitted(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new kP(bP.TracksErrors.CODEC_CHANGE_NOT_PERMITTED,"CodecChangeNotPermitted",e,"Codec can't be changed mid call.",t,"audio, video")},OverConstrained(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.OVER_CONSTRAINED,"OverConstrained",e,`[TRACK]: Requested constraints cannot be satisfied with the device hardware - ${t}`,n,t)},NoAudioDetected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Please check the mic or use another audio input";return new kP(bP.TracksErrors.NO_AUDIO_DETECTED,"NoAudioDetected",e,"No audio input detected from microphone",t,"audio")},SystemDeniedPermission(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new kP(bP.TracksErrors.SYSTEM_DENIED_PERMISSION,"SystemDeniedPermission",e,`Operating System denied permission to access capture device - ${t}`,n,t)},CurrentTabNotShared:()=>new kP(bP.TracksErrors.CURRENT_TAB_NOT_SHARED,"CurrentTabNotShared","TRACK","The app requires you to share the current tab","You must screen share the current tab in order to proceed","screen"),AudioPlaybackError:e=>new kP(bP.TracksErrors.AUDIO_PLAYBACK_ERROR,"Audio playback error","TRACK",e,e,"audio"),SelectedDeviceMissing:e=>new kP(bP.TracksErrors.SELECTED_DEVICE_MISSING,"SelectedDeviceMissing","TRACK",`Could not detect selected ${e} device`,`Please check connection to the ${e} device`,e),NoDataInTrack:e=>new kP(bP.TracksErrors.NO_DATA,"Track does not have any data","TRACK",e,"This could possibily due to another application taking priority over the access to camera or microphone or due to an incoming call","audio, video")},WebrtcErrors:{CreateOfferFailed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.CREATE_OFFER_FAILED,"CreateOfferFailed",e,`[${e.toString()}]: Failed to create offer. `,t)},CreateAnswerFailed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.CREATE_ANSWER_FAILED,"CreateAnswerFailed",e,`[${e.toString()}]: Failed to create answer. `,t)},SetLocalDescriptionFailed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.SET_LOCAL_DESCRIPTION_FAILED,"SetLocalDescriptionFailed",e,`[${e.toString()}]: Failed to set offer. `,t)},SetRemoteDescriptionFailed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.SET_REMOTE_DESCRIPTION_FAILED,"SetRemoteDescriptionFailed",e,`[${e.toString()}]: Failed to set answer. `,t,!0)},ICEFailure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new wP(bP.WebrtcErrors.ICE_FAILURE,"ICEFailure",e,`[${e.toString()}]: Ice connection state FAILED`,t,n)},ICEDisconnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.ICE_DISCONNECTED,"ICEDisconnected",e,`[${e.toString()}]: Ice connection state DISCONNECTED`,t)},StatsFailed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebrtcErrors.STATS_FAILED,"StatsFailed",e,`Failed to WebRTC get stats - ${t}`,t)}},WebsocketMethodErrors:{ServerErrors:(e,t,n)=>new wP(e,"ServerErrors",t,n,n,EP.includes(t)),AlreadyJoined(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebsocketMethodErrors.ALREADY_JOINED,"AlreadyJoined",e,"[JOIN]: You have already joined this room.",t)},CannotJoinPreviewInProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.WebsocketMethodErrors.CANNOT_JOIN_PREVIEW_IN_PROGRESS,"CannotJoinPreviewInProgress",e,"[JOIN]: Cannot join if preview is in progress",t)}},GenericErrors:{NotConnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.NOT_CONNECTED,"NotConnected",e,"Client is not connected",t)},Signalling:(e,t)=>new wP(bP.GenericErrors.SIGNALLING,"Signalling",e,`Unknown signalling error: ${e.toString()} ${t} `,t),Unknown:(e,t)=>new wP(bP.GenericErrors.UNKNOWN,"Unknown",e,`Unknown exception: ${t}`,t),NotReady(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.NOT_READY,"NotReady",e,t,t)},JsonParsingFailed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new wP(bP.GenericErrors.JSON_PARSING_FAILED,"JsonParsingFailed",e,`Failed to parse JSON message - ${t}`,n)},TrackMetadataMissing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.TRACK_METADATA_MISSING,"TrackMetadataMissing",e,"Track Metadata Missing",t)},RTCTrackMissing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.RTC_TRACK_MISSING,"RTCTrackMissing",e,"RTC Track missing",t)},PeerMetadataMissing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.PEER_METADATA_MISSING,"PeerMetadataMissing",e,"Peer Metadata Missing",t)},ValidationFailed:(e,t)=>new wP(bP.GenericErrors.VALIDATION_FAILED,"ValidationFailed","VALIDATION",e,t?JSON.stringify(t):""),InvalidRole:(e,t)=>new wP(bP.GenericErrors.INVALID_ROLE,"InvalidRole",e,"Invalid role. Join with valid role",t,!0),PreviewAlreadyInProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new wP(bP.GenericErrors.PREVIEW_IN_PROGRESS,"PreviewAlreadyInProgress",e,"[Preview]: Cannot join if preview is in progress",t)},LocalStorageAccessDenied(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Access to localStorage has been denied";return new wP(bP.GenericErrors.LOCAL_STORAGE_ACCESS_DENIED,"LocalStorageAccessDenied","NONE","LocalStorageAccessDenied",e)},MissingMediaDevices:()=>new wP(bP.GenericErrors.MISSING_MEDIADEVICES,"MissingMediaDevices","JOIN","navigator.mediaDevices is undefined. 100ms SDK won't work on this website as WebRTC is not supported on HTTP endpoints(missing navigator.mediaDevices). Please ensure you're using the SDK either on localhost or a valid HTTPS endpoint.","",!0),MissingRTCPeerConnection:()=>new wP(bP.GenericErrors.MISSING_RTCPEERCONNECTION,"MissingRTCPeerConnection","JOIN","RTCPeerConnection which is a core requirement for WebRTC call was not found, this could be due to an unsupported browser or browser extensions blocking WebRTC","",!0)},MediaPluginErrors:{PlatformNotSupported(e){return new wP(7001,"PlatformNotSupported",e,"Check HMS Docs to see the list of supported platforms",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},InitFailed(e){return new wP(7002,"InitFailed",e,"Plugin init failed",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},ProcessingFailed(e){return new wP(7003,"ProcessingFailed",e,"Plugin processing failed",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},AddAlreadyInProgress(e){return new wP(7004,"AddAlreadyInProgress",e,"Plugin add already in progress",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},DeviceNotSupported(e){return new wP(7005,"DeviceNotSupported",e,"Check HMS Docs to see the list of supported devices",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")}},PlaylistErrors:{NoEntryToPlay:(e,t)=>new wP(bP.PlaylistErrors.NO_ENTRY_TO_PLAY,"NoEntryToPlay",e,"Reached end of playlist",t),NoEntryPlaying:(e,t)=>new wP(bP.PlaylistErrors.NO_ENTRY_IS_PLAYING,"NoEntryIsPlaying",e,"No entry is playing at this time",t)}},CP=class{constructor(){this.valuesMap=new Map}getItem(e){return this.valuesMap.has(e)?String(this.valuesMap.get(e)):null}setItem(e,t){this.valuesMap.set(e,t)}removeItem(e){this.valuesMap.delete(e)}clear(){this.valuesMap.clear()}key(e){if(0===arguments.length)throw new TypeError("Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.");return Array.from(this.valuesMap.keys())[e]}get length(){return this.valuesMap.size}},PP=class{constructor(e){this.key=e,this.storage=null}getStorage(){try{return dP&&!this.storage&&((()=>{try{dP&&!localStorage&&(window.localStorage=new CP)}catch(gC){nP.e("Error initialising localStorage",IP.GenericErrors.LocalStorageAccessDenied())}})(),this.storage=window.localStorage),this.storage}catch(vC){return nP.e("Error initialising localStorage",IP.GenericErrors.LocalStorageAccessDenied()),null}}get(){var e;let t=null==(e=this.getStorage())?void 0:e.getItem(this.key);return t?JSON.parse(t):void 0}set(e){var t;let n=JSON.stringify(e);null==(t=this.getStorage())||t.setItem(this.key,n)}clear(){var e;null==(e=this.getStorage())||e.removeItem(this.key)}},AP=()=>{let e,t=new PP("hms-analytics-deviceId"),n=t.get();return n?e=n:(e=uE(),t.set(e)),e},_P="[VALIDATIONS]";function xP(e){return null!=e}var RP=()=>{if(!xP(RTCPeerConnection)){let e=IP.GenericErrors.MissingRTCPeerConnection();throw nP.e(_P,e),e}},NP=()=>{if(!xP(navigator.mediaDevices)){let e=IP.GenericErrors.MissingMediaDevices();throw nP.e(_P,e),e}},DP=MC().version;function LP(){let e=arguments.length>1?arguments[1]:void 0,t="LOCAL"!==yP&&"prod"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"prod")?"prod":"debug";if(hP)return MP({os:"web_nodejs",os_version:process.version,sdk:"web",sdk_version:DP,env:t,domain:yP,is_prebuilt:!(null==e||!e.isPrebuilt),framework:"node",framework_version:process.version,framework_sdk_version:null==e?void 0:e.sdkVersion});let n=uP.getOS(),i=uP.getDevice(),r=uP.getBrowser(),s=OP(`web_${n.name}`),o=n.version||"",a=OP(`${r.name}_${r.version}`),l=a;return i.type&&(l=`${OP(`${i.vendor}_${i.type}`)}/${a}`),MP({os:s,os_version:o,sdk:"web",sdk_version:DP,device_model:l,env:t,domain:yP,is_prebuilt:!(null==e||!e.isPrebuilt),framework:null==e?void 0:e.type,framework_version:null==e?void 0:e.version,framework_sdk_version:null==e?void 0:e.sdkVersion})}function OP(e){return e.replace(/ /g,"_")}var MP=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return Object.keys(e).filter((t=>xP(e[t]))).map((t=>`${t}:${e[t]}`)).join(t)},jP=class{constructor(e){let{name:t,level:n,properties:i,includesPII:r,timestamp:s}=e;this.metadata={peer:{},userAgent:LP()},this.name=t,this.level=n,this.includesPII=r||!1,this.properties=i||{},this.timestamp=s||(new Date).getTime(),this.event_id=uE(),this.device_id=AP()}toSignalParams(){return{name:this.name,info:NC(RC({},this.properties),{timestamp:this.timestamp,domain:yP}),timestamp:(new Date).getTime()}}},FP=class{static connect(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date,r=arguments.length>4?arguments[4]:void 0,s=this.eventNameFor("connect",void 0===e),o=e?2:1,a=this.getPropertiesWithError(NC(RC({},t),{[this.KEY_REQUESTED_AT]:null==n?void 0:n.getTime(),[this.KEY_RESPONDED_AT]:null==i?void 0:i.getTime(),endpoint:r}),e);return new jP({name:s,level:o,properties:a})}static disconnect(e,t){let n=e?2:1,i=this.getPropertiesWithError(t,e);return new jP({name:"disconnected",level:n,properties:i})}static preview(e){var t=e,{error:n}=t,i=DC(t,["error"]);let r=this.eventNameFor("preview",void 0===n),s=n?2:1,o=this.getPropertiesWithError(i,n);return new jP({name:r,level:s,properties:o})}static join(e){var t=e,{error:n}=t,i=DC(t,["error"]);let r=this.eventNameFor("join",void 0===n),s=n?2:1,o=this.getPropertiesWithError(NC(RC({},i),{is_preview_called:!!i.is_preview_called}),n);return new jP({name:r,level:s,properties:o})}static publish(e){let{devices:t,settings:n,error:i}=e,r=this.eventNameFor("publish",void 0===i),s=i?2:1,o=this.getPropertiesWithError({devices:t,audio:null==n?void 0:n.audio,video:null==n?void 0:n.video},i);return new jP({name:r,level:s,properties:o})}static hlsPlayerError(e){return new jP({name:"hlsPlayerError",level:2,properties:this.getErrorProperties(e)})}static subscribeFail(e){let t=this.eventNameFor("subscribe",!1),n=this.getErrorProperties(e);return new jP({name:t,level:2,properties:n})}static leave(){return new jP({name:"leave",level:1})}static autoplayError(){return new jP({name:"autoplayError",level:2})}static audioPlaybackError(e){return new jP({name:"audioPlaybackError",level:2,properties:this.getErrorProperties(e)})}static audioRecovered(e){return new jP({name:"audioRecovered",level:1,properties:{message:e}})}static permissionChange(e,t){return new jP({name:"permissionChanged",level:1,properties:{message:`Perrmission for ${e} changed to ${t}`}})}static deviceChange(e){let{isUserSelection:t,selection:n,type:i,devices:r,error:s}=e,o=this.eventNameFor(s?"publish":`device.${i}`,void 0===s),a=s?2:1,l=this.getPropertiesWithError({selection:n,devices:r,isUserSelection:t},s);return new jP({name:o,level:a,properties:l})}static performance(e){let t=e.toAnalyticsProperties();return new jP({name:"perf.stats",level:1,properties:t})}static rtcStats(e){let t=e.toAnalyticsProperties();return new jP({name:"rtc.stats",level:1,properties:t})}static rtcStatsFailed(e){return new jP({name:"rtc.stats.failed",level:2,properties:this.getErrorProperties(e)})}static degradationStats(e,t){let n={degradedAt:e.degradedAt,trackId:e.trackId};if(!t&&e.degradedAt instanceof Date){let t=new Date,i=t.valueOf()-e.degradedAt.valueOf();n=NC(RC({},n),{duration:i,restoredAt:t})}return new jP({name:"video.degradation.stats",level:1,properties:n})}static audioDetectionFail(e,t){let n=this.getPropertiesWithError({device:t},e);return new jP({name:"audiopresence.failed",level:2,properties:n})}static previewNetworkQuality(e){return new jP({name:"perf.networkquality.preview",level:e.error?2:1,properties:e})}static publishStats(e){return new jP({name:"publisher.stats",level:1,properties:e})}static subscribeStats(e){return new jP({name:"subscriber.stats",level:1,properties:e})}static getKrispUsage(e){return new jP({name:"krisp.usage",level:1,properties:{duration:e}})}static krispStart(){return new jP({name:"krisp.start",level:1})}static krispStop(){return new jP({name:"krisp.stop",level:1})}static interruption(e){let{started:t,type:n,reason:i,deviceInfo:r}=e;return new jP({name:""+(t?"interruption.start":"interruption.stop"),level:1,properties:RC({reason:i,type:n},r)})}static eventNameFor(e,t){return`${e}.${t?"success":"failed"}`}static getPropertiesWithError(e,t){let n=this.getErrorProperties(t);return e=RC(RC({},n),e)}static getErrorProperties(e){return e?e instanceof wP?e.toAnalyticsProperties():{error_name:e.name,error_message:e.message,error_description:e.cause}:{}}};FP.KEY_REQUESTED_AT="requested_at",FP.KEY_RESPONDED_AT="responded_at";var UP=e=>e?`{\n    trackId: ${e.id};\n    kind: ${e.kind};\n    enabled: ${e.enabled};\n    muted: ${e.muted};\n    readyState: ${e.readyState};\n  }`:"",VP=class{constructor(e,t,n){this.logIdentifier="",this.isTrackNotPublishing=()=>"ended"===this.nativeTrack.readyState||this.nativeTrack.muted,this.stream=e,this.nativeTrack=t,this.source=n}get enabled(){return this.nativeTrack.enabled}get trackId(){return this.firstTrackId||this.sdpTrackId||this.nativeTrack.id}getMediaTrackSettings(){return this.nativeTrack.getSettings()}setEnabled(e){return OC(this,null,(function*(){this.nativeTrack.enabled=e}))}setSdpTrackId(e){this.sdpTrackId=e}setFirstTrackId(e){this.firstTrackId=e}sendInterruptionEvent(e){let{started:t,reason:n}=e;return FP.interruption({started:t,type:this.type,reason:n,deviceInfo:{deviceId:this.nativeTrack.getSettings().deviceId,groupId:this.nativeTrack.getSettings().groupId}})}cleanup(){var e;nP.d("[HMSTrack]","Stopping track",this.toString()),null==(e=this.nativeTrack)||e.stop()}toString(){var e;return`{\n      streamId: ${this.stream.id};\n      peerId: ${this.peerId};\n      trackId: ${this.trackId};\n      mid: ${(null==(e=this.transceiver)?void 0:e.mid)||"-"};\n      logIdentifier: ${this.logIdentifier};\n      source: ${this.source};\n      enabled: ${this.enabled};\n      nativeTrack: ${UP(this.nativeTrack)};\n    }`}},BP=class extends VP{constructor(e,t,n){if(super(e,t,n),this.type="audio",this.audioElement=null,"audio"!==t.kind)throw new Error("Expected 'track' kind = 'audio'")}getVolume(){return this.audioElement?Math.floor(100*this.audioElement.volume):null}setVolume(e){return OC(this,null,(function*(){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");yield this.subscribeToAudio(0!==e&&this.enabled),this.audioElement&&(this.audioElement.volume=e/100)}))}setAudioElement(e){nP.d("[HMSAudioTrack]",this.logIdentifier,"adding audio element",`${this}`,e),this.audioElement=e}getAudioElement(){return this.audioElement}getOutputDevice(){return this.outputDevice}cleanup(){super.cleanup(),this.audioElement&&(this.audioElement.srcObject=null,this.audioElement.remove(),this.audioElement=null)}setOutputDevice(e){return OC(this,null,(function*(){var t;if(e){if(!this.audioElement)return nP.d("[HMSAudioTrack]",this.logIdentifier,"no audio element to set output",`${this}`),void(this.outputDevice=e);try{"function"==typeof this.audioElement.setSinkId&&(mP||(yield null==(t=this.audioElement)?void 0:t.setSinkId(e.deviceId)),this.outputDevice=e)}catch(vP){nP.d("[HMSAudioTrack]","error in setSinkId",vP)}}else nP.d("[HMSAudioTrack]",this.logIdentifier,"device is null",`${this}`)}))}subscribeToAudio(e){return OC(this,null,(function*(){this.stream instanceof S_&&(yield this.stream.setAudio(e,this.trackId,this.logIdentifier))}))}},$P=new class{constructor(){this.storage=new PP("hms-device-selection"),this.remember=!1,this.TAG="[HMSDeviceStorage]"}setDevices(e){this.devices=e}rememberDevices(e){this.remember=e}updateSelection(e,t){let{deviceId:n,groupId:i}=t;if(!this.devices||!this.remember)return;let r=this.devices[e].find((e=>this.isSame({deviceId:n,groupId:i},e)));if(!r)return void nP.w(this.TAG,`Could not find device with deviceId: ${n}, groupId: ${i}`);let s=this.storage.get()||{};s[e]=r,this.storage.set(s)}getSelection(){if(this.remember)return this.storage.get()}cleanup(){this.remember=!1,this.devices=void 0}isSame(e,t){return e.deviceId===t.deviceId&&(e.groupId===t.groupId||!e.groupId)}},zP=(e=>(e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE",e))(zP||{}),GP=(e=>(e.PLATFORM_NOT_SUPPORTED="PLATFORM_NOT_SUPPORTED",e.DEVICE_NOT_SUPPORTED="DEVICE_NOT_SUPPORTED",e))(GP||{}),qP=class{static failure(e,t){let n=RC({plugin_name:e},t.toAnalyticsProperties());return new jP({name:"mediaPlugin.failed",level:2,properties:n})}static audioPluginFailure(e,t,n){let i=RC({plugin_name:e,sampleRate:t},n.toAnalyticsProperties());return new jP({name:"mediaPlugin.failed",level:2,properties:i})}static audioPluginStats(e){let{pluginName:t,duration:n,loadTime:i,sampleRate:r}=e;return new jP({name:"mediaPlugin.stats",level:1,properties:{plugin_name:t,duration:n,load_time:i,sampleRate:r}})}static added(e,t){return new jP({name:"mediaPlugin.added",level:1,properties:{plugin_name:e,added_at:t}})}static stats(e){let{pluginName:t,duration:n,loadTime:i,avgPreProcessingTime:r,avgProcessingTime:s,inputFrameRate:o,pluginFrameRate:a}=e;return new jP({name:"mediaPlugin.stats",level:1,properties:{plugin_name:t,duration:n,load_time:i,avg_preprocessing_time:r,avg_processing_time:s,input_frame_rate:o,plugin_frame_rate:a}})}},HP=class{constructor(e){this.eventBus=e,this.TAG="[AudioPluginsAnalytics]",this.initTime={},this.addedTimestamps={},this.pluginAdded={},this.pluginSampleRate={}}added(e,t){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.pluginSampleRate[e]=t,this.eventBus.analytics.publish(qP.added(e,this.addedTimestamps[e]))}removed(e){if(this.pluginAdded[e]){let t={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],sampleRate:this.pluginSampleRate[e]};this.eventBus.analytics.publish(qP.audioPluginStats(t)),this.clean(e)}}failure(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(qP.audioPluginFailure(e,this.pluginSampleRate[e],t)),this.clean(e))}initWithTime(e,t){return OC(this,null,(function*(){if(this.initTime[e])return void nP.i(this.TAG,`Plugin Already loaded ${e}, time it took: ${this.initTime[e]}`);let n;try{n=yield this.timeInMs(t),nP.i(this.TAG,`Time taken for Plugin ${e} initialization : ${n}`)}catch(vP){let n=IP.MediaPluginErrors.InitFailed("AUDIO_PLUGINS",`failed during initialization of plugin${vP.message||vP}`);throw nP.e(this.TAG,n),this.failure(e,n),n}n&&(this.initTime[e]=n)}))}timeInMs(e){return OC(this,null,(function*(){let t=Date.now();return yield e(),Math.floor(Date.now()-t)}))}clean(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.pluginAdded[e],delete this.pluginSampleRate[e]}},WP=class{constructor(e,t,n){this.eventBus=t,this.TAG="[AudioPluginsManager]",this.pluginAddInProgress=!1,this.hmsTrack=e,this.pluginsMap=new Map,this.analytics=new HP(t),this.audioContext=eA.getAudioContext(),this.room=n}getPlugins(){return Array.from(this.pluginsMap.keys())}addPlugin(e){return OC(this,null,(function*(){var t,n;let i=null==(t=e.getName)?void 0:t.call(e);if(i){if(this.pluginAddInProgress){let e=IP.MediaPluginErrors.AddAlreadyInProgress("AUDIO_PLUGINS","Add Plugin is already in Progress");throw this.analytics.added(i,this.audioContext.sampleRate),this.analytics.failure(i,e),nP.w("can't add another plugin when previous add is in progress"),e}if("HMSKrispPlugin"===e.getName()){if(null==(n=this.room)||!n.isNoiseCancellationEnabled){let e="Krisp Noise Cancellation is not enabled for this room";if(0===this.pluginsMap.size)throw Error(e);return void nP.w(this.TAG,e)}this.eventBus.analytics.publish(FP.krispStart())}this.pluginAddInProgress=!0;try{yield this.addPluginInternal(e)}finally{this.pluginAddInProgress=!1}}else nP.w("no name provided by the plugin")}))}addPluginInternal(e){return OC(this,null,(function*(){var t,n;let i=null==(t=e.getName)?void 0:t.call(e);if(this.pluginsMap.get(i))nP.w(this.TAG,`plugin - ${i} already added.`);else{yield this.validateAndThrow(i,e),null==(n=e.setEventBus)||n.call(e,this.eventBus);try{0===this.pluginsMap.size?yield this.initAudioNodes():this.prevAudioNode&&this.prevAudioNode.disconnect(),this.analytics.added(i,this.audioContext.sampleRate),yield this.analytics.initWithTime(i,(()=>OC(this,null,(function*(){return e.init()})))),this.pluginsMap.set(i,e),yield this.processPlugin(e),yield this.connectToDestination(),yield this.updateProcessedTrack()}catch(tN){throw nP.e(this.TAG,"failed to add plugin",tN),tN}}}))}validatePlugin(e){return e.checkSupport(this.audioContext)}validateAndThrow(e,t){return OC(this,null,(function*(){let n=this.validatePlugin(t);if(n.isSupported)nP.i(this.TAG,`plugin is supported,- ${t.getName()}`);else{if(this.analytics.added(e,this.audioContext.sampleRate),"PLATFORM_NOT_SUPPORTED"===n.errType){let t=IP.MediaPluginErrors.PlatformNotSupported("AUDIO_PLUGINS","platform not supported, see docs");throw this.analytics.failure(e,t),yield this.cleanup(),t}if("DEVICE_NOT_SUPPORTED"===n.errType){let t=IP.MediaPluginErrors.DeviceNotSupported("AUDIO_PLUGINS","audio device not supported, see docs");throw this.analytics.failure(e,t),yield this.cleanup(),t}}}))}removePlugin(e){return OC(this,null,(function*(){if("HMSKrispPlugin"===e.getName())this.eventBus.analytics.publish(FP.krispStop());yield this.removePluginInternal(e),0===this.pluginsMap.size?(yield this.cleanup(),nP.i(this.TAG,"No plugins left, stopping plugins loop"),yield this.hmsTrack.setProcessedTrack(void 0)):yield this.reprocessPlugins()}))}cleanup(){return OC(this,null,(function*(){var e,t,n;for(let i of this.pluginsMap.values())yield this.removePluginInternal(i);yield this.hmsTrack.setProcessedTrack(void 0),null==(e=this.sourceNode)||e.disconnect(),null==(t=this.prevAudioNode)||t.disconnect(),null==(n=this.outputTrack)||n.stop(),this.sourceNode=void 0,this.destinationNode=void 0,this.prevAudioNode=void 0,this.outputTrack=void 0}))}closeContext(){return OC(this,null,(function*(){this.audioContext=void 0}))}reprocessPlugins(){return OC(this,null,(function*(){if(0===this.pluginsMap.size||!this.sourceNode)return;let e=Array.from(this.pluginsMap.values());yield this.cleanup(),yield this.initAudioNodes();for(let t of e)yield this.addPlugin(t);yield this.updateProcessedTrack()}))}initAudioNodes(){return OC(this,null,(function*(){if(this.audioContext){let e=new MediaStream([this.hmsTrack.nativeTrack]);this.sourceNode=this.audioContext.createMediaStreamSource(e),this.destinationNode||(this.destinationNode=this.audioContext.createMediaStreamDestination(),this.outputTrack=this.destinationNode.stream.getAudioTracks()[0])}}))}updateProcessedTrack(){return OC(this,null,(function*(){try{yield this.hmsTrack.setProcessedTrack(this.outputTrack)}catch(vC){throw nP.e(this.TAG,"error in setting processed track",vC),vC}}))}processPlugin(e){return OC(this,null,(function*(){try{let t=yield e.processAudioTrack(this.audioContext,this.prevAudioNode||this.sourceNode);this.prevAudioNode&&this.prevAudioNode.connect(t),this.prevAudioNode=t}catch(wC){let n=e.getName();nP.e(this.TAG,`error in processing plugin ${n}`,wC),yield this.removePluginInternal(e)}}))}connectToDestination(){return OC(this,null,(function*(){try{this.prevAudioNode&&this.destinationNode&&this.prevAudioNode.context===this.destinationNode.context&&this.prevAudioNode.connect(this.destinationNode)}catch(vC){nP.e(this.TAG,"error in connecting to destination node",vC)}}))}removePluginInternal(e){return OC(this,null,(function*(){var t;let n=null==(t=e.getName)?void 0:t.call(e);this.pluginsMap.get(n)?(nP.i(this.TAG,`removing plugin ${n}`),this.pluginsMap.delete(n),e.stop(),this.analytics.removed(n)):nP.w(this.TAG,`plugin - ${n} not found to remove.`)}))}};function KP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("chrome"===fI.browserDetails.browser&&"NotAllowedError"===e.name&&e.message.includes("denied by system"))return IP.TracksErrors.SystemDeniedPermission("TRACK",t,e.message);if("firefox"===fI.browserDetails.browser&&"NotFoundError"===e.name){let n=IP.TracksErrors.SystemDeniedPermission("TRACK",t,e.message);return n.description=`Capture device is either blocked at Operating System level or not available - ${t}`,n}switch(e.name){case"OverconstrainedError":return IP.TracksErrors.OverConstrained("TRACK",t,e.constraint);case"NotAllowedError":return IP.TracksErrors.CantAccessCaptureDevice("TRACK",t,e.message);case"NotFoundError":return IP.TracksErrors.DeviceNotAvailable("TRACK",t,e.message);case"NotReadableError":return IP.TracksErrors.DeviceInUse("TRACK",t,e.message);case"TypeError":return IP.TracksErrors.NothingToReturn("TRACK",e.message);default:return function(e,t){let n=e.toLowerCase(),i=IP.TracksErrors.GenericTrack("TRACK",e);return n.includes("device not found")?i=IP.TracksErrors.DeviceNotAvailable("TRACK",t,e):n.includes("permission denied")&&(i=IP.TracksErrors.CantAccessCaptureDevice("TRACK",t,e)),i}(e.message,t)}}function QP(e,t){let n=KP(e,t);return n.addNativeError(e),n}function JP(e){return OC(this,null,(function*(){try{return(yield navigator.mediaDevices.getUserMedia({audio:!!e&&e.toConstraints()})).getAudioTracks()[0]}catch(vC){throw QP(vC,"audio")}}))}function YP(e){return OC(this,null,(function*(){try{return(yield navigator.mediaDevices.getUserMedia({video:!!e&&e.toConstraints()})).getVideoTracks()[0]}catch(vC){throw QP(vC,"video")}}))}function XP(e){return"canvas"in e||"MediaStreamAudioDestinationNode"===e.label||""===e.label}var ZP=(e,t)=>{navigator.permissions?navigator.permissions.query({name:e}).then((e=>{e.onchange=()=>{t(e.state)}})):nP.d("Permissions API not supported")},eA={audioContext:null,getAudioContext(){return this.audioContext||(this.audioContext=mP?new AudioContext:new AudioContext({sampleRate:32e3})),this.audioContext},resumeContext(){return OC(this,null,(function*(){try{return yield this.getAudioContext().resume()}catch(gC){nP.e("AudioContext",gC)}}))}},tA=(e=>(e.SPEAKERPHONE="SPEAKERPHONE",e.WIRED="WIRED",e.BLUETOOTH="BLUETOOTH",e.EARPIECE="EARPIECE",e))(tA||{}),nA=e=>{if(!e)return nP.w("[DeviceManager]:","No device label provided"),"SPEAKERPHONE";let t=e.toLowerCase();return t.includes("speakerphone")?"SPEAKERPHONE":t.includes("wired")?"WIRED":/airpods|buds|wireless|bluetooth/gi.test(t)?"BLUETOOTH":t.includes("earpiece")?"EARPIECE":"SPEAKERPHONE"},iA=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;this.capacity=e,this.storage=[]}size(){return this.storage.length}toList(){return this.storage.slice(0)}enqueue(e){this.size()===this.capacity&&this.dequeue(),this.storage.push(e)}dequeue(){return this.storage.shift()}aggregate(e){return e(this.storage)}},rA="(function workerSetup() {\n  function ticker() {\n    self.postMessage('tick');\n  }\n  self.onmessage = function (event) {\n    const [data, time] = event.data;\n    switch (data) {\n      case 'start':\n        setTimeout(ticker, time);\n        break;\n      default:\n        break;\n    }\n  };\n})()";function sA(e){if(e<0)throw Error("`ms` should be a positive integer");return new Promise((t=>{setTimeout(t,e)}))}function oA(e){if(e<0)throw Error("`ms` should be a positive integer");if("undefined"==typeof Worker)return sA(e);let t=new Worker(URL.createObjectURL(new Blob([rA],{type:"application/javascript"})));return t.postMessage(["start",e]),new Promise((e=>{t.onmessage=n=>{"tick"===n.data&&(e(),t.terminate())}}))}function aA(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];clearTimeout(t),t=void 0;let o=this;t=setTimeout((()=>{e.apply(o,r)}),n)}}var lA=class{constructor(e,t,n){this.track=e,this.audioLevelEvent=t,this.silenceEvent=n,this.TAG="[TrackAudioLevelMonitor]",this.audioLevel=0,this.isMonitored=!1,this.interval=100,this.historyInterval=700,this.history=new iA(this.historyInterval/this.interval),this.detectSilence=()=>OC(this,null,(function*(){let e=0;for(;this.isMonitored;){if(this.track.enabled){if(!this.isSilentThisInstant())break;if(e++,e>50){this.silenceEvent.publish({track:this.track});break}}yield sA(20)}}));try{let e=new MediaStream([this.track.nativeTrack]);this.analyserNode=this.createAnalyserNodeForStream(e);let t=this.analyserNode.frequencyBinCount;this.dataArray=new Uint8Array(t)}catch(vP){nP.w(this.TAG,"Unable to initialize AudioContext",vP)}}start(){this.stop(),this.isMonitored=!0,nP.d(this.TAG,"Starting track Monitor",`${this.track}`),this.loop().then((()=>nP.d(this.TAG,"Stopping track Monitor",`${this.track}`)))}stop(){this.analyserNode?(this.sendAudioLevel(0),this.isMonitored=!1):nP.d(this.TAG,"AudioContext not initialized")}loop(){return OC(this,null,(function*(){for(;this.isMonitored;)this.sendAudioLevel(this.getMaxAudioLevelOverPeriod()),yield sA(this.interval)}))}sendAudioLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e=e>35?e:0,Math.abs(this.audioLevel-e)>5){this.audioLevel=e;let t={track:this.track,audioLevel:this.audioLevel};this.audioLevelEvent.publish(t)}}getMaxAudioLevelOverPeriod(){if(!this.analyserNode)return void nP.d(this.TAG,"AudioContext not initialized");let e=this.calculateAudioLevel();return void 0!==e&&this.history.enqueue(e),this.history.aggregate((e=>Math.max(...e)))}calculateAudioLevel(){if(!this.analyserNode||!this.dataArray)return void nP.d(this.TAG,"AudioContext not initialized");this.analyserNode.getByteTimeDomainData(this.dataArray);let e=.009,t=e;for(let i of this.dataArray)t=Math.max(t,(i-128)/128);let n=(Math.log(e)-Math.log(t))/Math.log(e);return Math.ceil(Math.min(Math.max(100*n,0),100))}isSilentThisInstant(){if(this.analyserNode&&this.dataArray)return this.analyserNode.getByteTimeDomainData(this.dataArray),this.dataArray.every((e=>128===e||0===e));nP.d(this.TAG,"AudioContext not initialized")}createAnalyserNodeForStream(e){let t=eA.getAudioContext(),n=t.createMediaStreamSource(e),i=t.createAnalyser();return i.fftSize=2048,n.connect(i),i}},cA=(e=>(e.SIP="sip",e.REGULAR="regular",e))(cA||{}),uA=(e=>(e.NONE="none",e.INITIALISED="initialised",e.STARTED="started",e.PAUSED="paused",e.RESUMED="resumed",e.STOPPED="stopped",e.FAILED="failed",e))(uA||{}),dA=(e=>(e.DVR="dvr",e.NO_DVR="no-dvr",e))(dA||{}),hA=(e=>(e.REGULAR="regular",e.SCREEN="screen",e.COMPOSITE="composite",e))(hA||{}),pA=(e=>(e.INITIALISED="initialised",e.STARTED="started",e.STOPPED="stopped",e.FAILED="failed",e))(pA||{}),fA=(e=>(e.CAPTION="caption",e))(fA||{}),mA={f:"high",h:"medium",q:"low"},gA=(e=>(e.VOICE="voice",e.MUSIC="music",e))(gA||{}),vA=(e=>(e.videoInput="videoInput",e.audioInput="audioInput",e.audioOutput="audioOutput",e))(vA||{}),yA=class{constructor(){this._volume=1,this._codec="opus",this._maxBitrate=32,this._deviceId="default",this._audioMode="voice",this._advanced=[{autoGainControl:{exact:!0}},{noiseSuppression:{exact:!0}},{highpassFilter:{exact:!0}},{audioMirroring:{exact:!0}}]}volume(e){if(!(0<=e&&e<=1))throw Error("volume can only be in range [0.0, 1.0]");return this._volume=e,this}codec(e){return this._codec=e,this}maxBitrate(e){if(e&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate="music"===this._audioMode?320:e,this}deviceId(e){return this._deviceId=e,this}audioMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"voice";return this._audioMode=e,"music"===this._audioMode?this._maxBitrate=320:this._maxBitrate=32,this}advanced(e){return this._advanced=e,this}build(){return new bA(this._volume,this._codec,this._maxBitrate,this._deviceId,this._advanced,this._audioMode)}},bA=class{constructor(e,t,n,i,r,s){this.volume=e,this.codec=t,this.maxBitrate=n,this.deviceId=i,this.advanced=r,this.audioMode=s,"music"===this.audioMode?this.maxBitrate=320:this.maxBitrate=32}toConstraints(){return{deviceId:this.deviceId,advanced:"music"===this.audioMode?[]:this.advanced}}toAnalyticsProperties(){return{audio_bitrate:this.maxBitrate,audio_codec:this.codec}}},wA=class{constructor(){this._width=320,this._height=180,this._codec="vp8",this._maxFramerate=30,this._maxBitrate=150,this._advanced=[]}setWidth(e){return this._width=e,this}setHeight(e){return this._height=e,this}codec(e){return this._codec=e,this}maxFramerate(e){if(e&&e<=0)throw Error("maxFramerate should be >= 1");return this._maxFramerate=e,this}maxBitrate(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("number"==typeof e&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate=e,!this._maxBitrate&&t&&(this._maxBitrate=15e4),this}deviceId(e){return this._deviceId=e,this}advanced(e){return this._advanced=e,this}facingMode(e){return this._facingMode=e,this}build(){return new kA(this._width,this._height,this._codec,this._maxFramerate,this._deviceId,this._advanced,this._maxBitrate,this._facingMode)}},kA=class{constructor(e,t,n,i,r,s,o,a){this.width=e,this.height=t,this.codec=n,this.maxFramerate=i,this.maxBitrate=o,this.deviceId=r,this.advanced=s,this.facingMode=a}toConstraints(e){let t="ideal";e&&(t="max");let n=this.improviseConstraintsAspect();return{width:{[t]:n.width},height:{[t]:n.height},frameRate:this.maxFramerate,deviceId:this.deviceId,facingMode:this.facingMode}}toAnalyticsProperties(){return{width:this.width,height:this.height,video_bitrate:this.maxBitrate,framerate:this.maxFramerate,video_codec:this.codec,facingMode:this.facingMode}}improviseConstraintsAspect(){return pP()&&this.height&&this.width&&this.height>this.width?{width:this.height,height:this.width}:{width:this.width,height:this.height}}},TA=class{constructor(){this._video=(new wA).build(),this._audio=(new yA).build(),this._screen=(new wA).build(),this._simulcast=!1}video(e){return this._video=e,this}audio(e){return this._audio=e,this}screen(e){return this._screen=e,this}simulcast(e){return this._simulcast=e,this}build(){if(null===this._audio&&null===this._video)throw IP.TracksErrors.NothingToReturn("TRACK");if(null===this._video&&this._simulcast)throw IP.TracksErrors.InvalidVideoSettings("TRACK","Cannot enable simulcast when no video settings are provided");return new SA(this._video,this._audio,this._simulcast,this._screen||void 0)}},SA=class{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.video=e,this.audio=t,this.simulcast=n,this.screen=i}toAnalyticsProperties(){let e={audio_enabled:null!==this.audio,video_enabled:null!==this.video};return this.audio&&(e=RC(RC({},this.audio.toAnalyticsProperties()),e)),this.video&&(e=RC(RC({},this.video.toAnalyticsProperties()),e)),e}};function EA(e,t){return function(n){return!hE()(e[n],t[n])}}var IA,CA,PA=class e extends BP{constructor(e,t,n,i){var r;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(new yA).build(),o=arguments.length>5?arguments[5]:void 0;super(e,t,n),r=this,this.eventBus=i,this.room=o,this.TAG="[HMSLocalAudioTrack]",this.tracksCreated=new Set,this.isPublished=!1,this.handleVisibilityChange=()=>OC(this,null,(function*(){if(this.shouldReacquireTrack())if("hidden"===document.visibilityState)this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:"visibility-change"}));else{nP.d(this.TAG,"On visibile replacing track as it is not publishing");try{yield this.replaceTrackWith(this.settings)}catch(e){this.eventBus.error.publish(e)}this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:"visibility-change"}))}else nP.d(this.TAG,`visibiltiy: ${document.visibilityState}`,`${this}`)})),this.trackPermissions=()=>{ZP("microphone",(e=>{this.eventBus.analytics.publish(FP.permissionChange(this.type,e)),"denied"===e&&this.eventBus.localAudioEnabled.publish({enabled:!1,track:this})}))},this.handleTrackMute=()=>{nP.d(this.TAG,"muted natively");let e="hidden"===document.visibilityState?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:e})),this.eventBus.localAudioEnabled.publish({enabled:!1,track:this})},this.handleTrackUnmute=()=>OC(this,null,(function*(){nP.d(this.TAG,"unmuted natively");let e="hidden"===document.visibilityState?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:e}));try{yield this.setEnabled(this.enabled,!0),this.eventBus.localAudioUnmutedNatively.publish()}catch(t){this.eventBus.error.publish(t)}})),this.replaceSenderTrack=()=>OC(this,null,(function*(){this.transceiver&&"sendonly"===this.transceiver.direction?yield this.transceiver.sender.replaceTrack(this.processedTrack||this.nativeTrack):nP.d(this.TAG,`transceiver for ${this.trackId} not available or not connected yet`)})),this.shouldReacquireTrack=()=>XP(this.nativeTrack)||this.isTrackNotPublishing(),this.handleSettingsChange=e=>OC(this,null,(function*(){let t=this.stream,n=EA(e,this.settings);(n("maxBitrate")||n("audioMode"))&&e.maxBitrate&&(yield t.setMaxBitrateAndFramerate(this,e)),(n("advanced")||n("audioMode"))&&(yield this.replaceTrackWith(e))})),this.handleDeviceChange=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(r,null,(function*(){if(EA(e,this.settings)("deviceId")){this.manuallySelectedDeviceId=t?this.manuallySelectedDeviceId:e.deviceId,nP.d(this.TAG,"device change","manual selection:",this.manuallySelectedDeviceId,"new device:",e.deviceId),yield this.replaceTrackWith(e);let n=this.nativeTrack.getSettings().groupId;!t&&e.deviceId&&($P.updateSelection("audioInput",{deviceId:e.deviceId,groupId:n}),this.eventBus.deviceChange.publish({isUserSelection:!0,type:"audioInput",selection:{deviceId:e.deviceId,groupId:n}}))}}))},e.tracks.push(this),this.addTrackEventListeners(t),this.trackPermissions(),this.settings=s,s.deviceId!==t.getSettings().deviceId&&!XP(t)&&(this.settings=this.buildNewSettings({deviceId:t.getSettings().deviceId})),this.pluginsManager=new WP(this,i,o),this.setFirstTrackId(t.id),"regular"===n&&document.addEventListener("visibilitychange",this.handleVisibilityChange)}clone(t){let n=this.nativeTrack.clone();t.nativeStream.addTrack(n);let i=new e(t,n,this.source,this.eventBus,this.settings,this.room);return i.peerId=this.peerId,this.pluginsManager.pluginsMap.size>0&&this.pluginsManager.pluginsMap.forEach((e=>{i.addPlugin(e).catch((t=>nP.e(this.TAG,"Plugin add failed while migrating",e,t)))})),i}getManuallySelectedDeviceId(){return this.manuallySelectedDeviceId}resetManuallySelectedDeviceId(){this.manuallySelectedDeviceId=void 0}updateTrack(e){return OC(this,null,(function*(){e.enabled=this.enabled,yield this.stream.replaceStreamTrack(this.nativeTrack,e),this.nativeTrack=e,yield this.replaceSenderTrack(),this.audioLevelMonitor&&this.initAudioLevelMonitor()}))}replaceTrackWith(e){return OC(this,null,(function*(){let t=this.nativeTrack;null==t||t.stop(),this.removeTrackEventListeners(t),this.tracksCreated.forEach((e=>e.stop())),this.tracksCreated.clear();try{let n=yield JP(e);this.addTrackEventListeners(n),this.tracksCreated.add(n),nP.d(this.TAG,"replaceTrack, Previous track stopped",t,"newTrack",n),yield this.updateTrack(n)}catch(vP){let t=yield JP(this.settings);throw this.addTrackEventListeners(t),this.tracksCreated.add(t),yield this.updateTrack(t),this.isPublished&&this.eventBus.analytics.publish(FP.publish({error:vP})),vP}try{yield this.pluginsManager.reprocessPlugins()}catch(vP){this.eventBus.audioPluginFailed.publish(vP)}}))}setEnabled(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){t===this.enabled&&!n||(t&&this.shouldReacquireTrack()&&(yield this.replaceTrackWith(this.settings)),yield LC(e.prototype,this,"setEnabled").call(this,t),t&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),this.eventBus.localAudioEnabled.publish({enabled:t,track:this}))}))}isPublishedTrackId(e){return this.publishedTrackId===e}setSettings(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){let n=this.buildNewSettings(e);XP(this.nativeTrack)||(yield this.handleDeviceChange(n,t),yield this.handleSettingsChange(n)),this.settings=n}))}getPlugins(){return this.pluginsManager.getPlugins()}addPlugin(e){return OC(this,null,(function*(){return this.pluginsManager.addPlugin(e)}))}removePlugin(e){return OC(this,null,(function*(){return this.pluginsManager.removePlugin(e)}))}validatePlugin(e){return this.pluginsManager.validatePlugin(e)}setProcessedTrack(e){return OC(this,null,(function*(){e?e!==this.processedTrack&&(this.processedTrack=e):this.processedTrack=void 0,yield this.replaceSenderTrack()}))}initAudioLevelMonitor(){this.audioLevelMonitor&&this.destroyAudioLevelMonitor(),nP.d(this.TAG,"Monitor Audio Level for",this,this.getMediaTrackSettings().deviceId),this.audioLevelMonitor=new lA(this,this.eventBus.trackAudioLevelUpdate,this.eventBus.localAudioSilence),this.audioLevelMonitor.start(),this.audioLevelMonitor.detectSilence()}destroyAudioLevelMonitor(){var e;null==(e=this.audioLevelMonitor)||e.stop(),this.audioLevelMonitor=void 0}cleanup(){return OC(this,null,(function*(){var t;LC(e.prototype,this,"cleanup").call(this),yield this.pluginsManager.cleanup(),yield this.pluginsManager.closeContext(),this.transceiver=void 0,null==(t=this.processedTrack)||t.stop(),this.tracksCreated.forEach((e=>e.stop())),this.tracksCreated.clear(),this.isPublished=!1,this.destroyAudioLevelMonitor(),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}))}getTrackIDBeingSent(){return this.processedTrack?this.processedTrack.id:this.nativeTrack.id}getTrackBeingSent(){return this.processedTrack||this.nativeTrack}addTrackEventListeners(e){e.addEventListener("mute",this.handleTrackMute),e.addEventListener("unmute",this.handleTrackUnmute)}removeTrackEventListeners(e){e.removeEventListener("mute",this.handleTrackMute),e.removeEventListener("unmute",this.handleTrackUnmute)}buildNewSettings(e){let{volume:t,codec:n,maxBitrate:i,deviceId:r,advanced:s,audioMode:o}=RC(RC({},this.settings),e);return new bA(t,n,i,r,s,o)}},AA=class e extends BP{setEnabled(t){return OC(this,null,(function*(){t!==this.enabled&&(yield LC(e.prototype,this,"setEnabled").call(this,t),yield this.subscribeToAudio(t))}))}},_A=class extends VP{constructor(e,t,n){if(super(e,t,n),this.type="video",this.sinkCount=0,this.handleTrackUnmute=()=>{this.getSinks().forEach((e=>this.reTriggerPlay({videoElement:e})))},this.reTriggerPlay=e=>{let{videoElement:t}=e;setTimeout((()=>{t.play().catch((e=>{nP.w("[HMSVideoTrack]","failed to play",e.message)}))}),0)},"video"!==t.kind)throw new Error("Expected 'track' kind = 'video'")}setVideoHandler(e){this.videoHandler=e}hasSinks(){return this.sinkCount>0}getSinks(){return this.videoHandler.getVideoElements()||[]}attach(e){this.videoHandler.addVideoElement(e)}detach(e){this.videoHandler.removeVideoElement(e)}addSink(e){this.addSinkInternal(e,this.nativeTrack)}removeSink(e){null!==e.srcObject&&(e.srcObject=null,this.reduceSinkCount())}cleanup(){super.cleanup(),this.videoHandler.cleanup()}addSinkInternal(e,t){let n=e.srcObject;if(null!==n&&n instanceof MediaStream){let e=n.getVideoTracks()[0];if((null==e?void 0:e.id)===t.id){if(!e.muted&&"live"===e.readyState)return;this.reduceSinkCount()}else this.reduceSinkCount()}this.addPropertiesToElement(e);let i=new MediaStream([t]);e.srcObject=i,this.reTriggerPlay({videoElement:e}),this.sinkCount++}reduceSinkCount(){this.sinkCount>0&&this.sinkCount--}addPropertiesToElement(e){fP||(e.autoplay=!0),e.playsInline=!0,e.muted=!0,e.controls=!1}},xA={none:-1,low:0,medium:1,high:2},RA=(e,t)=>{let n="high",i=t.width>t.height?"width":"height",r=[...e].sort(((e,t)=>xA[e.layer]-xA[t.layer])),s=t[i]*((null==window?void 0:window.devicePixelRatio)||1);for(let o=0;o<r.length;o++){let{resolution:e,layer:t}=r[o],a=e[i];if(s<=a){n=t;break}{let e=r[o+1];if((s-a)/((e?e.resolution[i]:Number.POSITIVE_INFINITY)-a)<.5){n=t;break}}}return n},NA=new class{constructor(){this.TAG="[HMSIntersectionObserverWrapper]",this.listeners=new WeakMap,this.observe=(e,t)=>{var n;this.createObserver(),this.unobserve(e),null==(n=this.intersectionObserver)||n.observe(e),this.listeners.set(e,t)},this.unobserve=e=>{var t;null==(t=this.intersectionObserver)||t.unobserve(e),this.listeners.delete(e)},this.createObserver=()=>{this.isSupported()&&!this.intersectionObserver&&(this.intersectionObserver=new IntersectionObserver(this.handleIntersection))},this.handleIntersection=e=>{var t;for(let n of e)null==(t=this.listeners.get(n.target))||t(n)},this.createObserver()}isSupported(){let e=dP&&"undefined"!=typeof window.IntersectionObserver;return e||nP.w(this.TAG,"IntersectionObserver is not supported, fallback will be used instead"),e}},DA=new class{constructor(){var e=this;this.TAG="[HMSResizeObserverWrapper]",this.listeners=new WeakMap,this.observe=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{box:"border-box"};var r;e.createObserver(),e.unobserve(t),null==(r=e.resizeObserver)||r.observe(t,i),e.listeners.set(t,n)},this.unobserve=e=>{var t;null==(t=this.resizeObserver)||t.unobserve(e),this.listeners.delete(e)},this.createObserver=()=>{this.isSupported()&&!this.resizeObserver&&(this.resizeObserver=new ResizeObserver(aA(this.handleResize,300)))},this.handleResize=e=>{var t;for(let n of e)null==(t=this.listeners.get(n.target))||t(n)},this.createObserver()}isSupported(){let e=dP&&"undefined"!=typeof window.ResizeObserver;return e||nP.w(this.TAG,"Resize Observer is not supported"),e}},LA=class{constructor(e){this.track=e,this.TAG="[VideoElementManager]",this.videoElements=new Set,this.entries=new WeakMap,this.handleIntersection=e=>OC(this,null,(function*(){let t="visible"===getComputedStyle(e.target).visibility;this.track.enabled&&(e.isIntersecting&&t||!document.contains(e.target))?(nP.d(this.TAG,"add sink intersection",`${this.track}`,this.id),this.entries.set(e.target,e.boundingClientRect),yield this.selectMaxLayer(),yield this.track.addSink(e.target)):(nP.d(this.TAG,"remove sink intersection",`${this.track}`,this.id),yield this.track.removeSink(e.target))})),this.handleResize=e=>OC(this,null,(function*(){!this.track.enabled||!(this.track instanceof w_)||(this.entries.set(e.target,e.contentRect),yield this.selectMaxLayer())})),this.cleanup=()=>{this.videoElements.forEach((e=>{var t,n;e.srcObject=null,null==(t=this.resizeObserver)||t.unobserve(e),null==(n=this.intersectionObserver)||n.unobserve(e)})),this.videoElements.clear(),this.resizeObserver=void 0,this.intersectionObserver=void 0},this.init(),this.id=uE()}updateSinks(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(let t of this.videoElements)this.track.enabled?this.track.addSink(t,e):this.track.removeSink(t,e)}addVideoElement(e){return OC(this,null,(function*(){var t;this.videoElements.has(e)||(this.init(),nP.d(this.TAG,`Adding video element for ${this.track}`,this.id),this.videoElements.add(e),this.videoElements.size>=10&&nP.w(this.TAG,`${this.track}`,`the track is added to ${this.videoElements.size} video elements, while this may be intentional, it's likely that there is a bug leading to unnecessary creation of video elements in the UI`),null!=(t=this.intersectionObserver)&&t.isSupported()?this.intersectionObserver.observe(e,this.handleIntersection):dP&&(this.isElementInViewport(e)?this.track.addSink(e):this.track.removeSink(e)),this.resizeObserver?this.resizeObserver.observe(e,this.handleResize):this.track instanceof w_&&(yield this.track.setPreferredLayer(this.track.getPreferredLayer())))}))}removeVideoElement(e){var t,n;this.track.removeSink(e),this.videoElements.delete(e),this.entries.delete(e),null==(t=this.resizeObserver)||t.unobserve(e),null==(n=this.intersectionObserver)||n.unobserve(e),nP.d(this.TAG,`Removing video element for ${this.track}`)}getVideoElements(){return Array.from(this.videoElements)}init(){dP&&(this.resizeObserver=DA,this.intersectionObserver=NA)}isElementInViewport(e){let t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight,{hidden:s}=e,{opacity:o,display:a}=getComputedStyle(e);for(;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset&&!s&&(""===o||parseFloat(o)>0)&&"none"!==a}selectMaxLayer(){return OC(this,null,(function*(){if(!(this.track instanceof w_)||0===this.videoElements.size)return;let e;for(let t of this.videoElements){let n=this.entries.get(t);if(!n)continue;let{width:i,height:r}=n;if(0===i||0===r)continue;let s=RA(this.track.getSimulcastDefinitions(),{width:i,height:r});e=e?xA[s]>xA[e]?s:e:s}e&&(nP.d(this.TAG,`selecting max layer ${e} for the track`,`${this.track}`),yield this.track.setPreferredLayer(e))}))}},OA=(e=>(e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE",e))(OA||{}),MA=(e=>(e["2D"]="2d",e.WEBGL="webgl",e.WEBGL2="webgl2",e))(MA||{}),jA=class{constructor(){this.total=0,this.count=0}add(e){this.count++,this.total+=e}getAvg(){return Math.floor(this.total/this.count)}reset(){this.total=0,this.count=0}},FA=class{constructor(e){this.eventBus=e,this.TAG="[VideoPluginsAnalytics]",this.initTime={},this.preProcessingAvgs=new jA,this.addedTimestamps={},this.processingAvgs={},this.pluginAdded={},this.pluginInputFrameRate={},this.pluginFrameRate={}}added(e,t,n){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.processingAvgs[e]=new jA,t&&(this.pluginInputFrameRate[e]=t,this.pluginFrameRate[e]=n||t),this.eventBus.analytics.publish(qP.added(e,this.addedTimestamps[e]))}removed(e){var t;if(this.pluginAdded[e]){let n={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],avgPreProcessingTime:this.preProcessingAvgs.getAvg(),avgProcessingTime:null==(t=this.processingAvgs[e])?void 0:t.getAvg(),inputFrameRate:this.pluginInputFrameRate[e],pluginFrameRate:this.pluginFrameRate[e]};this.eventBus.analytics.publish(qP.stats(n)),this.clean(e)}}failure(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(qP.failure(e,t)),this.clean(e))}initWithTime(e,t){return OC(this,null,(function*(){if(this.initTime[e])return void nP.i(this.TAG,`Plugin Already loaded ${e}, time it took: ${this.initTime[e]}`);let n;try{n=yield this.timeInMs(t),nP.i(this.TAG,`Time taken for Plugin ${e} initialization : ${n}`)}catch(vP){let n=IP.MediaPluginErrors.InitFailed("VIDEO_PLUGINS",`failed during initialization of plugin${vP.message||vP}`);throw nP.e(this.TAG,n),this.failure(e,n),n}n&&(this.initTime[e]=n)}))}preProcessWithTime(e){return OC(this,null,(function*(){let t=yield this.timeInMs(e);this.preProcessingAvgs.add(t)}))}processWithTime(e,t){return OC(this,null,(function*(){var n;let i;try{i=yield this.timeInMs(t)}catch(tN){let n=IP.MediaPluginErrors.ProcessingFailed("VIDEO_PLUGINS",`Failed during processing of plugin${tN.message||tN}`);throw nP.e(this.TAG,n),this.failure(e,n),n}i&&(null==(n=this.processingAvgs[e])||n.add(i))}))}timeInMs(e){return OC(this,null,(function*(){let t=Date.now();return yield e(),Math.floor(Date.now()-t)}))}clean(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.processingAvgs[e],delete this.pluginAdded[e],delete this.pluginInputFrameRate[e],delete this.pluginFrameRate[e]}},UA=320,VA=240,BA=class{constructor(e,t){this.TAG="[VideoPluginsManager]",this.pluginsLoopRunning=!1,this.pluginsLoopState="paused",this.pluginAddInProgress=!1,this.reusableWorker=function(){if("undefined"==typeof Worker)return{sleep:e=>sA(e)};let e=new Worker(URL.createObjectURL(new Blob([rA],{type:"application/javascript"})));return{sleep:t=>(e.postMessage(["start",t]),new Promise((t=>{e.onmessage=e=>{"tick"===e.data&&t()}})))}}(),this.hmsTrack=e,this.pluginsMap=new Map,this.pluginNumFramesToSkip={},this.pluginNumFramesSkipped={},this.analytics=new FA(t),this.canvases=new Array}getPlugins(){return Array.from(this.pluginsMap.keys())}addPlugin(e,t){return OC(this,null,(function*(){var n;if(this.pluginAddInProgress){let t=null==(n=e.getName)?void 0:n.call(e);if(!t||""===t)return void nP.w("no name provided by the plugin");let i=IP.MediaPluginErrors.AddAlreadyInProgress("VIDEO_PLUGINS","Add Plugin is already in Progress");throw this.analytics.failure(t,i),nP.w("can't add another plugin when previous add is in progress"),i}this.pluginAddInProgress=!0;try{yield this.addPluginInternal(e,t)}finally{this.pluginAddInProgress=!1}}))}addPluginInternal(e,t){return OC(this,null,(function*(){var n,i;let r=null==(n=e.getName)?void 0:n.call(e);if(!r||""===r)return void nP.w("no name provided by the plugin");if(this.pluginsMap.has(r))return void nP.w(this.TAG,`plugin - ${e.getName()} already added.`);let s=this.hmsTrack.getMediaTrackSettings().frameRate||24,o=0;t&&t>0?(nP.i(this.TAG,`adding plugin ${e.getName()} with framerate ${t}`),t<s&&(o=Math.ceil(s/t)-1),this.analytics.added(r,s,t)):(nP.i(this.TAG,`adding plugin ${e.getName()}`),this.analytics.added(r,s)),nP.i(this.TAG,"numFrames to skip processing",o),this.pluginNumFramesToSkip[r]=o,this.pluginNumFramesSkipped[r]=o,this.validateAndThrow(r,e);try{if(yield this.analytics.initWithTime(r,(()=>OC(this,null,(function*(){return yield e.init()})))),this.pluginsMap.set(r,e),this.pluginsMap.size+1>this.canvases.length)for(let e=this.canvases.length;e<=this.pluginsMap.size;e++)this.canvases[e]=document.createElement("canvas");yield this.startPluginsLoop(null==(i=e.getContextType)?void 0:i.call(e))}catch(ZC){throw nP.e(this.TAG,"failed to add plugin",ZC),yield this.removePlugin(e),ZC}}))}validatePlugin(e){return e.checkSupport()}validateAndThrow(e,t){let n=this.validatePlugin(t);if(n.isSupported)nP.i(this.TAG,`plugin is supported,- ${t.getName()}`);else{let t;switch(n.errType){case"PLATFORM_NOT_SUPPORTED":throw t=IP.MediaPluginErrors.PlatformNotSupported("VIDEO_PLUGINS","platform not supported, see docs"),this.analytics.failure(e,t),t;case"DEVICE_NOT_SUPPORTED":throw t=IP.MediaPluginErrors.DeviceNotSupported("VIDEO_PLUGINS","video device not supported, see docs"),this.analytics.failure(e,t),t}}}removePlugin(e){return OC(this,null,(function*(){let t=e.getName();this.pluginsMap.get(t)?(nP.i(this.TAG,`removing plugin ${t}`),this.removePluginEntry(t),0===this.pluginsMap.size&&(nP.i(this.TAG,"No plugins left, stopping plugins loop"),yield this.stopPluginsLoop()),e.stop(),this.analytics.removed(t)):nP.w(this.TAG,`plugin - ${t} not found to remove.`)}))}removePluginEntry(e){this.pluginsMap.delete(e),this.pluginNumFramesToSkip[e]&&delete this.pluginNumFramesToSkip[e],this.pluginNumFramesSkipped[e]&&delete this.pluginNumFramesSkipped[e]}waitForRestart(){return OC(this,null,(function*(){if(this.pluginsLoopRunning&&"running"!==this.pluginsLoopState)for(;"paused"===this.pluginsLoopState;)yield oA(100)}))}cleanup(){return OC(this,null,(function*(){var e;for(let t of this.pluginsMap.values())yield this.removePlugin(t);null==(e=this.outputTrack)||e.stop()}))}initElementsAndStream(e){this.inputCanvas||(this.inputCanvas=document.createElement("canvas")),this.outputCanvas=document.createElement("canvas"),this.inputVideo||(this.inputVideo=document.createElement("video")),this.inputCanvas.getContext("2d"),this.outputCanvas.getContext(e||"2d");let t=this.outputCanvas.captureStream();this.outputTrack=t.getVideoTracks()[0]}startPluginsLoop(e){return OC(this,null,(function*(){if(!this.pluginsLoopRunning){this.initElementsAndStream(e),this.pluginsLoopRunning=!0;try{yield this.hmsTrack.setProcessedTrack(this.outputTrack)}catch(wC){throw this.pluginsLoopRunning=!1,nP.e(this.TAG,"error in setting processed track",wC),wC}this.pluginsLoop().then((()=>{nP.d(this.TAG,"processLoop stopped")}))}}))}stopPluginsLoop(){return OC(this,null,(function*(){var e;this.pluginsLoopRunning=!1,yield this.hmsTrack.setProcessedTrack(void 0),this.resetCanvases(),null==(e=this.outputTrack)||e.stop(),this.inputVideo&&(this.inputVideo.srcObject=null,this.inputVideo=void 0)}))}pluginsLoop(){return OC(this,null,(function*(){for(;this.pluginsLoopRunning;){let e=this.hmsTrack.getMediaTrackSettings().frameRate||24,t=Math.floor(1e3/e);if(!this.hmsTrack.enabled||"ended"===this.hmsTrack.nativeTrack.readyState){"running"===this.pluginsLoopState&&this.resetCanvases(),this.pluginsLoopState="paused",yield this.reusableWorker.sleep(t);continue}let n=0;try{yield this.analytics.preProcessWithTime((()=>OC(this,null,(function*(){return yield this.doPreProcessing()}))));let e=Date.now();yield this.processFramesThroughPlugins(),n=Math.floor(Date.now()-e),n>t&&(n=t)}catch(vP){nP.e(this.TAG,"error in plugins loop",vP)}this.pluginsLoopState="running",yield this.reusableWorker.sleep(t-n)}}))}doPreProcessing(){return OC(this,null,(function*(){yield this.addTrackToVideo(),yield this.updateInputCanvas()}))}processFramesThroughPlugins(){return OC(this,null,(function*(){this.canvases[0]=this.inputCanvas;let e=0;for(let t of this.pluginsMap.values()){let n=t.getName();if(t){try{let i=this.checkIfSkipRequired(n);if("TRANSFORM"===t.getPluginType()){let r=(e,r)=>OC(this,null,(function*(){try{yield t.processVideoFrame(e,r,i)}catch(ZC){nP.e(this.TAG,`error in processing plugin ${n}`,ZC)}}));if(i)e===this.pluginsMap.size-1?yield r(this.canvases[e],this.outputCanvas):yield r(this.canvases[e],this.canvases[e+1]);else{let t=this.canvases[e],i=this.canvases[e+1];e===this.pluginsMap.size-1?yield this.analytics.processWithTime(n,(()=>OC(this,null,(function*(){return r(t,this.outputCanvas)})))):yield this.analytics.processWithTime(n,(()=>OC(this,null,(function*(){return r(t,i)}))))}}else"ANALYZE"===t.getPluginType()&&!i&&(yield this.analytics.processWithTime(n,(()=>OC(this,null,(function*(){return yield t.processVideoFrame(this.inputCanvas)})))))}catch(vP){nP.e(this.TAG,`error in processing plugin ${n}`,vP),yield this.removePlugin(t)}e++}}}))}addTrackToVideo(){return OC(this,null,(function*(){var e;if(!this.inputVideo)return;let t=this.inputVideo.srcObject;null!==t&&t instanceof MediaStream&&(null==(e=t.getVideoTracks()[0])?void 0:e.id)===this.hmsTrack.nativeTrack.id||(this.inputVideo.pause(),this.inputVideo.srcObject=new MediaStream([this.hmsTrack.nativeTrack]),this.inputVideo.muted=!0,this.inputVideo.playsInline=!0,yield this.inputVideo.play())}))}updateInputCanvas(){return OC(this,null,(function*(){if(!this.inputCanvas||!this.inputVideo)return;let{width:e=UA,height:t=VA}=this.hmsTrack.getMediaTrackSettings();this.inputCanvas.height!==t&&(this.inputCanvas.height=t),this.inputCanvas.width!==e&&(this.inputCanvas.width=e),this.inputCanvas.getContext("2d").drawImage(this.inputVideo,0,0,e,t)}))}resetCanvases(){if(!this.outputCanvas||!this.inputCanvas)return;let e=this.inputCanvas.getContext("2d");e&&(e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height)),this.canvases=[]}checkIfSkipRequired(e){let t=!1;return this.pluginNumFramesSkipped[e]<this.pluginNumFramesToSkip[e]?(this.pluginNumFramesSkipped[e]++,t=!0):(t=!1,this.pluginNumFramesSkipped[e]=0),t}},$A=class{constructor(e,t){this.TAG="[MediaStreamPluginsManager]",this.plugins=new Set,this.analytics=new FA(e),this.room=t}addPlugins(e){e.forEach((e=>{var t;if("HMSEffectsPlugin"===e.getName())if(null==(t=this.room)||!t.isEffectsEnabled){let e="Effects Virtual Background is not enabled for this room";if(0===this.plugins.size)throw Error(e);return void nP.w(this.TAG,e)}this.plugins.add(e)}))}removePlugins(e){e.forEach((e=>{e.stop(),this.analytics.removed(e.getName()),this.plugins.delete(e)}))}applyPlugins(e){let t=e;for(let n of this.plugins){let e=n.getName();try{t=n.apply(t),this.analytics.added(e)}catch(tN){this.analytics.failure(e,tN),nP.e("Could not apply plugin",tN,e)}}return t}getPlugins(){return Array.from(this.plugins).map((e=>e.getName()))}cleanup(){return OC(this,null,(function*(){this.removePlugins(Array.from(this.plugins))}))}},zA=["init_response_time","ws_connect_time","on_policy_change_time","local_audio_track_time","local_video_track_time","peer_list_time","room_state_time","join_response_time"],GA=class{constructor(){this.eventPerformanceMeasures={}}start(e){performance.mark(e)}end(e){var t;try{this.eventPerformanceMeasures[e]=performance.measure(e,e),nP.d("[HMSPerformanceTiming]",e,null==(t=this.eventPerformanceMeasures[e])?void 0:t.duration)}catch(lP){nP.w("[AnalyticsTimer]",`Error in measuring performance for event ${e}`,{error:lP})}}getTimeTaken(e){var t;return null==(t=this.eventPerformanceMeasures[e])?void 0:t.duration}getTimes(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[...zA,...t].reduce(((e,t)=>NC(RC({},e),{[t]:this.getTimeTaken(t)})),{})}cleanup(){this.eventPerformanceMeasures={}}},qA={isAudioMuted:!1,isVideoMuted:!1,audioInputDeviceId:"default",audioOutputDeviceId:"default",videoDeviceId:"default",audioMode:"voice"},HA=class e{constructor(e,t,n,i,r){this.store=e,this.observer=t,this.deviceManager=n,this.eventBus=i,this.analyticsTimer=r,this.TAG="[LocalTrackManager]",this.setScreenCaptureHandleConfig()}getTracksToPublish(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qA;return function*(){let n=e.getAVTrackSettings(t);if(!n)return[];let i=!!n.audio,r=!!n.video,s=[],{videoTrack:o,audioTrack:a}=yield e.updateCurrentLocalTrackSettings(n),l=(null==o?void 0:o.stream)||(null==a?void 0:a.stream),c=!(!o||!e.store.getTrackById(o.trackId)),u=!(!a||!e.store.getTrackById(a.trackId));if(c&&u)return[];let d={audio:i&&!a&&(!t.isAudioMuted||"empty"),video:r&&!o&&(!t.isVideoMuted||"empty")};d.audio&&e.analyticsTimer.start("local_audio_track_time"),d.video&&e.analyticsTimer.start("local_video_track_time");try{nP.d(e.TAG,"Init Local Tracks",{fetchTrackOptions:d}),s=yield e.getLocalTracks(d,n,l)}catch(h){s=yield e.retryGetLocalTracks(h,n,d,l)}return d.audio&&e.analyticsTimer.end("local_audio_track_time"),d.video&&e.analyticsTimer.end("local_video_track_time"),o&&r&&!c&&s.push(o),a&&i&&!u&&s.push(a),s}()}))}getLocalTracks(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!0},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return function*(){try{let r=yield e.getNativeLocalTracks(t,n);return e.createHMSLocalTracks(r,n,i)}catch(vP){throw e.eventBus.analytics.publish(FP.publish({devices:e.deviceManager.getDevices(),error:vP,settings:n})),vP}}()}))}getNativeLocalTracks(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!1,video:!1},n=arguments.length>1?arguments[1]:void 0;return function*(){let i=new SA(!0===t.video?n.video:null,!0===t.audio?n.audio:null,n.simulcast),r=[];return(i.audio||i.video)&&r.push(...yield e.getAVTracks(i)),r.push(...e.getEmptyTracks(t)),r}()}))}optimizeScreenShareConstraint(e,t){return OC(this,null,(function*(){var n,i,r;if("boolean"==typeof t.video||null==(n=t.video)||!n.width||null==(i=t.video)||!i.height)return;let s=this.store.getPublishParams();if(!s||null==(r=s.allowed)||!r.includes("screen"))return;let o=document.createElement("video");o.srcObject=e,o.addEventListener("loadedmetadata",(()=>OC(this,null,(function*(){let{videoWidth:n,videoHeight:i}=o,r=s.screen,a=r.width*r.height,l=n/i,c=r.width/r.height;if(l>c){let r=t.video,s=l/c,o=Math.sqrt(s);n*i>a?(r.width=n/o,r.height=i/o):(r.height=i*o,r.width=n*o),yield e.getVideoTracks()[0].applyConstraints(r)}}))))}))}getLocalScreen(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){var n;let i,r=yield this.getOrDefaultScreenshareConfig(e),s=this.getScreenshareSettings(r.videoOnly),o={video:NC(RC({},null==s?void 0:s.video.toConstraints(!0)),{displaySurface:r.displaySurface}),preferCurrentTab:r.preferCurrentTab,selfBrowserSurface:r.selfBrowserSurface,surfaceSwitching:r.surfaceSwitching,systemAudio:r.systemAudio};if(null!=s&&s.audio){let e=null==(n=null==s?void 0:s.audio)?void 0:n.toConstraints();delete e.advanced,o.audio=NC(RC({},e),{autoGainControl:!1,noiseSuppression:!1,googAutoGainControl:!1,echoCancellation:!1})}else null!=e&&e.forceCurrentTab&&e.preferCurrentTab&&e.cropElement&&(o.audio={echoCancellation:!0,noiseSuppression:!0});try{nP.d("retrieving screenshare with ",{config:r},{constraints:o}),i=yield navigator.mediaDevices.getDisplayMedia(o),t&&(yield this.optimizeScreenShareConstraint(i,o))}catch(h){nP.w(this.TAG,"error in getting screenshare - ",h);let e=QP(h,"screen");throw this.eventBus.analytics.publish(FP.publish({error:e,devices:this.deviceManager.getDevices(),settings:new SA(null==s?void 0:s.video,null==s?void 0:s.audio,!1)})),e}let a=[],l=new T_(i),c=i.getVideoTracks()[0],u=new KA(l,c,"screen",this.eventBus,null==s?void 0:s.video,this.store.getRoom());u.setSimulcastDefinitons(this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer(),"screen"));try{let e=this.validateCurrentTabCapture(u,r.forceCurrentTab);u.isCurrentTab=e,yield u.cropTo(r.cropTarget)}catch(h){throw i.getTracks().forEach((e=>e.stop())),h}a.push(u);let d=i.getAudioTracks()[0];if(d){let e=new PA(l,d,"screen",this.eventBus,null==s?void 0:s.audio,this.store.getRoom());a.push(e)}return nP.v(this.TAG,"getLocalScreen",a),a}))}setScreenCaptureHandleConfig(e){var t;null==(t=navigator.mediaDevices)||!t.setCaptureHandleConfig||this.isInIframe()||(e=e||{},Object.assign(e,{handle:uE(),exposeOrigin:!1,permittedOrigins:[window.location.origin]}),nP.d("setting capture handle - ",e.handle),navigator.mediaDevices.setCaptureHandleConfig(e),this.captureHandleIdentifier=e.handle)}validateCurrentTabCapture(e,t){let n=e.getCaptureHandle(),i=!(!this.captureHandleIdentifier||(null==n?void 0:n.handle)!==this.captureHandleIdentifier);if(t&&!i)throw nP.e(this.TAG,"current tab was not shared with forceCurrentTab as true"),IP.TracksErrors.CurrentTabNotShared();return i}requestPermissions(){return OC(this,null,(function*(){try{(yield navigator.mediaDevices.getUserMedia({audio:!0,video:!0})).getTracks().forEach((e=>e.stop()))}catch(vC){nP.e(this.TAG,vC)}}))}static getEmptyVideoTrack(e){var t,n,i;let r=(null==(t=null==e?void 0:e.getSettings())?void 0:t.width)||320,s=(null==(n=null==e?void 0:e.getSettings())?void 0:n.height)||240;IA||((IA=document.createElement("canvas")).width=r,IA.height=s,null==(i=IA.getContext("2d"))||i.fillRect(0,0,r,s)),CA||(CA=setInterval((()=>{let e=null==IA?void 0:IA.getContext("2d");e&&e.fillRect(0,0,1,1)}),1e3));let o=IA.captureStream(1).getVideoTracks()[0];return o.enabled=!1,o}static getEmptyAudioTrack(){let e=eA.getAudioContext(),t=e.createOscillator(),n=e.createMediaStreamDestination();t.connect(n),t.start();let i=n.stream.getAudioTracks()[0];return i.enabled=!1,i}static cleanup(){clearInterval(CA),CA=void 0,IA=void 0}getAVTracks(e){return OC(this,null,(function*(){try{let t=yield navigator.mediaDevices.getUserMedia({audio:!!e.audio&&e.audio.toConstraints(),video:!!e.video&&e.video.toConstraints()});return t.getVideoTracks().concat(t.getAudioTracks())}catch(wC){yield this.deviceManager.init();let n=!(this.deviceManager.hasWebcamPermission||!e.video),i=!(this.deviceManager.hasMicrophonePermission||!e.audio);throw QP(wC,this.getErrorType(n,i))}}))}getAVTrackSettings(e){let t=this.getAudioSettings(e),n=this.getVideoSettings(e);return t||n?(new TA).video(n).audio(t).build():null}isInIframe(){try{return window.self!==window.top}catch(vC){return!0}}retryGetLocalTracks(e,t,n,i){return OC(this,null,(function*(){if(!(e instanceof wP&&"TRACK"===e.action))return nP.w(this.TAG,"Fetch AV Tracks failed - unknown exception",e),this.observer.onFailure(e),[];{this.observer.onFailure(e);let s=e.code===bP.TracksErrors.OVER_CONSTRAINED,o=e.message.includes("audio"),a=e.message.includes("video");if(s){let s=(new TA).video(new kA).audio(new bA).build();nP.w(this.TAG,"Fetch AV Tracks failed with overconstrained error",{fetchTrackOptions:n},{error:e});try{return yield this.getLocalTracks(n,s,i)}catch(r){let e=r instanceof wP?r.nativeError:r,s=r;if("OverconstrainedError"===(null==e?void 0:e.name)){let t=IP.TracksErrors.GenericTrack("TRACK","Overconstrained error after dropping all constraints");t.addNativeError(e),s=t}return yield this.retryGetLocalTracks(s,t,n,i)}}n.audio=o?"empty":n.audio,n.video=a?"empty":n.video,nP.w(this.TAG,"Fetch AV Tracks failed",{fetchTrackOptions:n},e);try{return yield this.getLocalTracks(n,t,i)}catch(ZC){return nP.w(this.TAG,"Fetch empty tacks failed",ZC),n.audio=n.audio&&"empty",n.video=n.video&&"empty",this.observer.onFailure(ZC),yield this.getLocalTracks(n,t,i)}}}))}getErrorType(e,t){return e&&t?"audio, video":e?"video":t?"audio":"audio, video"}getEmptyTracks(t){let n=[];return"empty"===t.audio&&n.push(e.getEmptyAudioTrack()),"empty"===t.video&&n.push(e.getEmptyVideoTrack()),n}updateCurrentLocalTrackSettings(e){return OC(this,null,(function*(){let t=this.store.getLocalPeerTracks(),n=t.find((e=>"video"===e.type&&"regular"===e.source)),i=t.find((e=>"audio"===e.type&&"regular"===e.source)),r=t.find((e=>"video"===e.type&&"screen"===e.source));null!=e&&e.video&&(yield null==n?void 0:n.setSettings(e.video)),null!=e&&e.audio&&(yield null==i?void 0:i.setSettings(e.audio));let s=this.getScreenshareSettings(!0);return null!=s&&s.video&&(yield null==r?void 0:r.setSettings(null==s?void 0:s.video)),{videoTrack:n,audioTrack:i}}))}getAudioSettings(e){var t;let n=this.store.getPublishParams();if(!n||null==(t=n.allowed)||!t.includes("audio"))return null;let i=this.store.getLocalPeer(),r=null==i?void 0:i.audioTrack,s=(null==r?void 0:r.settings.deviceId)||e.audioInputDeviceId;return(new yA).codec(n.audio.codec).maxBitrate(n.audio.bitRate).deviceId(s||qA.audioInputDeviceId).build()}getVideoSettings(e){var t;let n=this.store.getPublishParams();if(!n||null==(t=n.allowed)||!t.includes("video"))return null;let i=this.store.getLocalPeer(),r=null==i?void 0:i.videoTrack,s=(null==r?void 0:r.settings.deviceId)||e.videoDeviceId,o=n.video;return(new wA).codec(o.codec).maxBitrate(o.bitRate).maxFramerate(o.frameRate).setWidth(o.width).setHeight(o.height).deviceId(s||qA.videoDeviceId).build()}getScreenshareSettings(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;let n=this.store.getPublishParams();if(!n||null==(t=n.allowed)||!t.includes("screen"))return null;let i=n.screen;return{video:(new wA).maxBitrate(i.bitRate,!1).codec(i.codec).maxFramerate(i.frameRate).setWidth(i.width).setHeight(i.height).build(),audio:e?void 0:(new yA).build()}}getOrDefaultScreenshareConfig(e){return OC(this,null,(function*(){var t;let n=Object.assign({videoOnly:!1,audioOnly:!1,forceCurrentTab:!1,preferCurrentTab:!1,selfBrowserSurface:"exclude",surfaceSwitching:"include",systemAudio:"exclude",displaySurface:"monitor"},e||{});return n.forceCurrentTab&&(n.videoOnly=!0,n.preferCurrentTab=!0,n.selfBrowserSurface="include",n.surfaceSwitching="exclude"),n.preferCurrentTab&&(n.selfBrowserSurface="include",n.displaySurface=void 0),n.cropElement&&null!=(t=window.CropTarget)&&t.fromElement&&(n.cropTarget=yield window.CropTarget.fromElement(n.cropElement)),n}))}createHMSLocalTracks(e,t,n){let i=e.find((e=>"video"===e.kind)),r=e.find((e=>"audio"===e.kind));n?e.forEach((e=>null==n?void 0:n.nativeStream.addTrack(e))):n=new T_(new MediaStream(e));let s=[];if(r&&null!=t&&t.audio){let e=new PA(n,r,"regular",this.eventBus,t.audio,this.store.getRoom());s.push(e)}if(i&&null!=t&&t.video){let e=new KA(n,i,"regular",this.eventBus,t.video,this.store.getRoom());e.setSimulcastDefinitons(this.store.getSimulcastDefinitionsForPeer(this.store.getLocalPeer(),"regular")),s.push(e)}return s}};function WA(e,t){return function(n){return!hE()(e[n],t[n])}}var KA=class e extends _A{constructor(e,t,n,i){var r;let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(new wA).build(),o=arguments.length>5?arguments[5]:void 0;super(e,t,n),r=this,this.eventBus=i,this.room=o,this._layerDefinitions=[],this.TAG="[HMSLocalVideoTrack]",this.enabledStateBeforeBackground=!1,this.isCurrentTab=!1,this.isPublished=!1,this.replaceSenderTrack=e=>OC(this,null,(function*(){this.transceiver&&"sendonly"===this.transceiver.direction?yield this.transceiver.sender.replaceTrack(e):nP.d(this.TAG,`transceiver for ${this.trackId} not available or not connected yet`)})),this.buildNewSettings=e=>{let{width:t,height:n,codec:i,maxFramerate:r,maxBitrate:s,deviceId:o,advanced:a,facingMode:l}=RC(RC({},this.settings),e);return new kA(t,n,i,r,o,a,s,l)},this.handleSettingsChange=e=>OC(this,null,(function*(){let t=this.stream,n=WA(e,this.settings);if(n("maxBitrate")&&e.maxBitrate&&(yield t.setMaxBitrateAndFramerate(this)),n("width")||n("height")||n("advanced"))if("video"===this.source){let t=yield this.replaceTrackWith(e);yield this.replaceSender(t,this.enabled),this.nativeTrack=t,yield this.processPlugins(),this.videoHandler.updateSinks()}else yield this.nativeTrack.applyConstraints(e.toConstraints())})),this.handleDeviceChange=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(r,null,(function*(){if(WA(e,this.settings)("deviceId")&&"regular"===this.source){if(this.enabled){delete e.facingMode;let t=yield this.replaceTrackWith(e);yield this.replaceSender(t,this.enabled),this.nativeTrack=t,yield this.processPlugins(),this.videoHandler.updateSinks()}let n=this.nativeTrack.getSettings().groupId;!t&&e.deviceId&&($P.updateSelection("videoInput",{deviceId:e.deviceId,groupId:n}),this.eventBus.deviceChange.publish({isUserSelection:!0,type:"video",selection:{deviceId:e.deviceId,groupId:n}}))}}))},this.trackPermissions=()=>{ZP("camera",(e=>{this.eventBus.analytics.publish(FP.permissionChange(this.type,e)),"denied"===e&&this.eventBus.localVideoEnabled.publish({enabled:!1,track:this})}))},this.handleTrackMute=()=>{nP.d(this.TAG,"muted natively",document.visibilityState);let e="hidden"===document.visibilityState?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:e})),this.eventBus.localVideoEnabled.publish({enabled:!1,track:this})},this.handleTrackUnmuteNatively=()=>OC(this,null,(function*(){nP.d(this.TAG,"unmuted natively");let e="hidden"===document.visibilityState?"visibility-change":"incoming-call";this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:e})),this.handleTrackUnmute(),this.eventBus.localVideoEnabled.publish({enabled:this.enabled,track:this}),this.eventBus.localVideoUnmutedNatively.publish(),yield this.setEnabled(this.enabled)})),this.removeOrReplaceProcessedTrack=e=>OC(this,null,(function*(){e?e!==this.processedTrack&&(this.processedTrack=e):this.processedTrack=void 0,yield this.replaceSenderTrack(this.processedTrack||this.nativeTrack)})),this.handleVisibilityChange=()=>OC(this,null,(function*(){if("hidden"===document.visibilityState)this.enabledStateBeforeBackground=this.enabled,this.enabled&&(yield this.setEnabled(!1)),this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!0,reason:"visibility-change"}));else{if(nP.d(this.TAG,"visibility visible, restoring track state",this.enabledStateBeforeBackground),this.enabledStateBeforeBackground)try{yield this.setEnabled(!0)}catch(e){this.eventBus.error.publish(e)}this.eventBus.analytics.publish(this.sendInterruptionEvent({started:!1,reason:"visibility-change"}))}})),this.addTrackEventListeners(t),this.trackPermissions(),e.tracks.push(this),this.setVideoHandler(new LA(this)),this.settings=s,s.deviceId!==t.getSettings().deviceId&&t.enabled&&(this.settings=this.buildNewSettings({deviceId:t.getSettings().deviceId})),this.pluginsManager=new BA(this,i),this.mediaStreamPluginsManager=new $A(i,o),this.setFirstTrackId(this.trackId),this.eventBus.localAudioUnmutedNatively.subscribe(this.handleTrackUnmute),dP&&"regular"===n&&pP()&&document.addEventListener("visibilitychange",this.handleVisibilityChange)}clone(t){let n=this.nativeTrack.clone();t.nativeStream.addTrack(n);let i=new e(t,n,this.source,this.eventBus,this.settings,this.room);return i.peerId=this.peerId,this.pluginsManager.pluginsMap.size>0&&this.pluginsManager.pluginsMap.forEach((e=>{i.addPlugin(e).catch((t=>nP.e(this.TAG,"Plugin add failed while migrating",e,t)))})),this.mediaStreamPluginsManager.plugins.size>0&&i.addStreamPlugins(Array.from(this.mediaStreamPluginsManager.plugins)),i}setSimulcastDefinitons(e){this._layerDefinitions=e}getSimulcastDefinitions(){return this._layerDefinitions}setEnabled(t){return OC(this,null,(function*(){var n;if(t!==this.enabled){if("regular"===this.source){let i;i=t?yield this.replaceTrackWith(this.settings):yield this.replaceTrackWithBlank(),yield this.replaceSender(i,t),null==(n=this.nativeTrack)||n.stop(),this.nativeTrack=i,yield LC(e.prototype,this,"setEnabled").call(this,t),t&&(yield this.pluginsManager.waitForRestart(),yield this.processPlugins(),this.settings=this.buildNewSettings({deviceId:i.getSettings().deviceId})),this.videoHandler.updateSinks()}this.eventBus.localVideoEnabled.publish({enabled:t,track:this})}}))}processPlugins(){return OC(this,null,(function*(){try{if(this.pluginsManager.getPlugins().length>0)return;if(this.mediaStreamPluginsManager.getPlugins().length>0){let e=this.mediaStreamPluginsManager.applyPlugins(new MediaStream([this.nativeTrack])).getVideoTracks()[0];yield this.setProcessedTrack(e)}else yield this.setProcessedTrack();this.videoHandler.updateSinks()}catch(wC){console.error("error in processing plugin(s)",wC)}}))}addStreamPlugins(e){return OC(this,null,(function*(){if(this.pluginsManager.getPlugins().length>0)throw Error("Plugins of type HMSMediaStreamPlugin and HMSVideoPlugin cannot be used together");this.mediaStreamPluginsManager.addPlugins(e),yield this.processPlugins()}))}removeStreamPlugins(e){return OC(this,null,(function*(){this.mediaStreamPluginsManager.removePlugins(e),yield this.processPlugins()}))}isPublishedTrackId(e){return this.publishedTrackId===e}addSink(e){this.addSinkInternal(e,this.processedTrack||this.nativeTrack)}setSettings(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){let n=this.buildNewSettings(e);yield this.handleDeviceChange(n,t),this.enabled&&!XP(this.nativeTrack)?(yield this.pluginsManager.waitForRestart(),yield this.handleSettingsChange(n),this.settings=n):this.settings=n}))}getPlugins(){return this.mediaStreamPluginsManager.getPlugins().length>0?this.mediaStreamPluginsManager.getPlugins():this.pluginsManager.getPlugins()}addPlugin(e,t){return OC(this,null,(function*(){if(this.mediaStreamPluginsManager.getPlugins().length>0)throw Error("Plugins of type HMSVideoPlugin and HMSMediaStreamPlugin cannot be used together");return this.pluginsManager.addPlugin(e,t)}))}removePlugin(e){return OC(this,null,(function*(){return this.pluginsManager.removePlugin(e)}))}validatePlugin(e){return this.pluginsManager.validatePlugin(e)}cleanup(){return OC(this,null,(function*(){var t;this.eventBus.localAudioUnmutedNatively.unsubscribe(this.handleTrackUnmute),this.removeTrackEventListeners(this.nativeTrack),yield this.mediaStreamPluginsManager.cleanup(),yield this.pluginsManager.cleanup(),LC(e.prototype,this,"cleanup").call(this),this.transceiver=void 0,null==(t=this.processedTrack)||t.stop(),this.isPublished=!1,dP&&pP()&&document.removeEventListener("visibilitychange",this.handleVisibilityChange)}))}cropTo(e){return OC(this,null,(function*(){if(e&&"screen"===this.source)try{this.nativeTrack.cropTo&&(yield this.nativeTrack.cropTo(e))}catch(lP){throw nP.e(this.TAG,"failed to crop screenshare capture - ",lP),IP.TracksErrors.GenericTrack("TRACK","failed to crop screenshare capture")}}))}getCaptureHandle(){if(this.nativeTrack.getCaptureHandle)return this.nativeTrack.getCaptureHandle()}setProcessedTrack(e){return OC(this,null,(function*(){this.nativeTrack.enabled?(yield this.removeOrReplaceProcessedTrack(e),this.videoHandler.updateSinks()):this.processedTrack=e}))}getTrackIDBeingSent(){return this.getTrackBeingSent().id}getTrackBeingSent(){return this.enabled&&this.processedTrack||this.nativeTrack}switchCamera(){return OC(this,null,(function*(){var e;let t=this.getMediaTrackSettings().facingMode;if(!t||"regular"!==this.source)return void nP.d(this.TAG,"facingMode not supported");let n="environment"===t?"user":"environment";null==(e=this.nativeTrack)||e.stop();let i=yield this.replaceTrackWith(this.buildNewSettings({facingMode:n,deviceId:void 0}));yield this.replaceSender(i,this.enabled),this.nativeTrack=i,yield this.processPlugins(),this.videoHandler.updateSinks(),this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId,facingMode:n}),$P.updateSelection("videoInput",{deviceId:this.settings.deviceId,groupId:this.nativeTrack.getSettings().groupId})}))}replaceTrackWith(e){return OC(this,null,(function*(){let t=this.nativeTrack;this.removeTrackEventListeners(t),null==t||t.stop();try{let n=yield YP(e);return this.addTrackEventListeners(n),nP.d(this.TAG,"replaceTrack, Previous track stopped",t,"newTrack",n),"default"===this.settings.deviceId&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),n}catch(vP){let t=yield YP(this.settings);throw this.addTrackEventListeners(t),yield this.replaceSender(t,this.enabled),this.nativeTrack=t,yield this.processPlugins(),this.videoHandler.updateSinks(),this.isPublished&&this.eventBus.analytics.publish(FP.publish({error:vP})),vP}}))}replaceTrackWithBlank(){return OC(this,null,(function*(){let e=this.nativeTrack,t=HA.getEmptyVideoTrack(e);return this.removeTrackEventListeners(e),this.addTrackEventListeners(t),null==e||e.stop(),nP.d(this.TAG,"replaceTrackWithBlank, Previous track stopped",e,"newTrack",t),t}))}replaceSender(e,t){return OC(this,null,(function*(){t?yield this.replaceSenderTrack(this.processedTrack||e):yield this.replaceSenderTrack(e),this.stream.replaceStreamTrack(this.nativeTrack,e)}))}addTrackEventListeners(e){e.addEventListener("mute",this.handleTrackMute),e.addEventListener("unmute",this.handleTrackUnmuteNatively)}removeTrackEventListeners(e){e.removeEventListener("mute",this.handleTrackMute),e.removeEventListener("unmute",this.handleTrackUnmuteNatively)}},QA="renegotiation-callback-id",JA="ion-sfu",YA="SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID",XA=Math.pow(2,31)-1,ZA="device-change",e_="local-audio-enabled",t_="local-video-enabled",n_="local-video-unmuted-natively",i_="local-audio-unmuted-natively",r_="stats-update",s_="track-degraded",o_="track-restored",a_="track-audio-level-update",l_="local-audio-silence",c_="analytics",u_="audio-plugin-failed",d_="policy-change",h_="local-role-update",p_="audio-track-update",f_="audio-track-added",m_="audio-track-removed",g_="autoplay-error",v_="leave",y_="error",b_="_handraise",w_=class e extends _A{constructor(e,t,n,i){super(e,t,n),this._degraded=!1,this._degradedAt=null,this._layerDefinitions=[],this.history=new k_,this.preferredLayer="high",this.disableNoneLayerRequest=!1,this.disableNoneLayerRequest=!!i,this.setVideoHandler(new LA(this))}setTrackId(e){this.bizTrackId=e}get trackId(){return this.bizTrackId||super.trackId}get degraded(){return this._degraded}get degradedAt(){return this._degradedAt}setEnabled(t){return OC(this,null,(function*(){t!==this.enabled&&(LC(e.prototype,this,"setEnabled").call(this,t),this.videoHandler.updateSinks(!0))}))}setPreferredLayer(e){return OC(this,null,(function*(){if("none"!==e){if(this.preferredLayer=e,this.shouldSendVideoLayer(e,"preferLayer")){if(!this.hasSinks())return void nP.d(`[Remote Track] ${this.logIdentifier}\n        streamId=${this.stream.id} \n        trackId=${this.trackId}\n        saving ${e}, source=${this.source}\n        Track does not have any sink`);yield this.requestLayer(e,"preferLayer"),this.pushInHistory(`uiPreferLayer-${e}`)}}else nP.w("layer none will be ignored")}))}getSimulcastLayer(){return this.stream.getSimulcastLayer()}getLayer(){return this.stream.getVideoLayer()}getPreferredLayer(){return this.preferredLayer}getPreferredLayerDefinition(){return this._layerDefinitions.find((e=>e.layer===this.preferredLayer))}replaceTrack(e){this.nativeTrack=e.nativeTrack,e.transceiver&&(this.transceiver=e.transceiver,this.stream.updateId(e.stream.id)),this.videoHandler.updateSinks()}addSink(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return OC(this,null,(function*(){XP(this.nativeTrack)?yield this.requestLayer(this.preferredLayer,"addSink"):(LC(e.prototype,this,"addSink").call(this,t),n&&(yield this.updateLayer("addSink"))),this.pushInHistory("uiSetLayer-high")}))}removeSink(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return OC(this,null,(function*(){LC(e.prototype,this,"removeSink").call(this,t),n&&(yield this.updateLayer("removeSink")),this._degraded=!1,this.pushInHistory("uiSetLayer-none")}))}getSimulcastDefinitions(){return[...this._layerDefinitions]}setSimulcastDefinitons(e){this._layerDefinitions=e}setLayerFromServer(e){this._degraded=this.getDegradationValue(e),this._degradedAt=this._degraded?new Date:this._degradedAt;let t=e.current_layer;return nP.d(`[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id} \n      trackId=${this.trackId}\n      layer update from sfu\n      currLayer=${e.current_layer}\n      preferredLayer=${e.expected_layer}\n      sub_degraded=${e.subscriber_degraded}\n      pub_degraded=${e.publisher_degraded}\n      isDegraded=${this._degraded}`),this.stream.setVideoLayerLocally(t,this.logIdentifier,"setLayerFromServer"),this.pushInHistory(`sfuLayerUpdate-${t}`),this._degraded}getDegradationValue(e){return this.enabled&&(e.publisher_degraded||e.subscriber_degraded)&&"none"===e.current_layer}updateLayer(e){return OC(this,null,(function*(){let t=this.preferredLayer;this.enabled&&this.hasSinks()?t=this.preferredLayer:this.disableNoneLayerRequest||(t="none"),this.shouldSendVideoLayer(t,e)&&(yield this.requestLayer(t,e))}))}pushInHistory(e){}requestLayer(e,t){return OC(this,null,(function*(){try{let n=yield this.stream.setVideoLayer(e,this.trackId,this.logIdentifier,t);return nP.d(`[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id}\n      trackId=${this.trackId}\n      Requested layer ${e}, source=${t}`),n}catch(vP){throw nP.d(`[Remote Track] ${this.logIdentifier} \n      streamId=${this.stream.id}\n      trackId=${this.trackId}\n      Failed to set layer ${e}, source=${t}\n      error=${vP.message}`),vP}}))}shouldSendVideoLayer(e,t){let n=this.getLayer();return!(!this.degraded||"none"!==e)||(n!==e||(nP.d(`[Remote Track] ${this.logIdentifier}`,`Not sending update, already on layer ${e}, source=${t}`),!1))}},k_=class{constructor(){this.history=[]}push(e){e.time=(new Date).toISOString().split("T")[1],this.history.push(e)}},T_=class extends cP{constructor(){super(...arguments),this.TAG="[HMSLocalStream]",this.connection=null}setConnection(e){this.connection=e}addTransceiver(e,t){let n=this.connection.addTransceiver(e.getTrackBeingSent(),{streams:[this.nativeStream],direction:"sendonly",sendEncodings:this.getTrackEncodings(e,t)});return this.setPreferredCodec(n,e.nativeTrack.kind),e.transceiver=n,n}setMaxBitrateAndFramerate(e,t){return OC(this,null,(function*(){var n;yield null==(n=this.connection)?void 0:n.setMaxBitrateAndFramerate(e,t)}))}setPreferredCodec(e,t){}replaceStreamTrack(e,t){this.nativeStream.addTrack(t),this.nativeStream.removeTrack(e)}removeSender(e){var t,n;if(!this.connection||"closed"===this.connection.connectionState)return void nP.d(this.TAG,"publish connection is not initialised or closed");let i=null==(t=e.transceiver)?void 0:t.sender;if(!i)return void nP.w(this.TAG,`No sender found for trackId=${e.trackId}`);null==(n=this.connection)||n.removeTrack(i);let r=this.tracks.indexOf(e);-1!==r?this.tracks.splice(r,1):nP.w(this.TAG,`Cannot find ${e.trackId} in locally stored tracks`)}getTrackEncodings(e,t){let n=[];if(e instanceof KA)if(t.length>0)nP.d(this.TAG,"Simulcast enabled with layers",t),n.push(...t);else{let t={active:this.nativeStream.active};e.settings.maxBitrate&&!hP&&(t.maxBitrate=e.settings.maxBitrate),n.push(t)}return n}},S_=class extends cP{constructor(e,t){super(e),this.audio=!0,this.video="none",this.connection=t}setAudio(e,t,n){return OC(this,null,(function*(){this.audio!==e&&(this.audio=e,nP.d(`[Remote stream] ${n||""} \n    streamId=${this.id}\n    trackId=${t}\n    subscribing audio - ${this.audio}`),yield this.connection.sendOverApiDataChannelWithResponse({params:{subscribed:this.audio,track_id:t},method:"prefer-audio-track-state"}))}))}setVideoLayerLocally(e,t,n){this.video=e,nP.d(`[Remote stream] ${t}\n    streamId=${this.id}\n    source: ${n}\n    Setting layer field to=${e}`)}setVideoLayer(e,t,n,i){return nP.d(`[Remote stream] ${n} \n      streamId=${this.id}\n      trackId=${t} \n      source: ${i} request ${e} layer`),this.setVideoLayerLocally(e,n,i),this.connection.sendOverApiDataChannelWithResponse({params:{max_spatial_layer:this.video,track_id:t},method:"prefer-video-track-state"})}getSimulcastLayer(){return this.video}getVideoLayer(){return this.video}isAudioSubscribed(){return this.audio}},E_=(e,t,n,i)=>OC(void 0,null,(function*(){var r;let s,o={};if(null!=(r=t.transceiver)&&r.sender.track){try{s=yield t.transceiver.sender.getStats();let e={},r={},a={};null==s||s.forEach((t=>{switch(t.type){case"outbound-rtp":r[t.id]=t;break;case"remote-inbound-rtp":a[t.ssrc]=t;break;case"codec":e[t.id]=t.mimeType}})),Object.keys(RC({},r)).forEach((s=>{var l,c;let u,d=null==(l=r[s])?void 0:l.codecId,h=d?e[d]:void 0;h&&(u=h.substring(h.indexOf("/")+1));let p=NC(RC({},r[s]),{rid:null==(c=r[s])?void 0:c.rid}),f=a[p.ssrc];o[s]=NC(RC({},p),{bitrate:__("bytesSent",p,null==i?void 0:i[s]),packetsLost:null==f?void 0:f.packetsLost,jitter:null==f?void 0:f.jitter,roundTripTime:null==f?void 0:f.roundTripTime,totalRoundTripTime:null==f?void 0:f.totalRoundTripTime,peerName:n,peerID:t.peerId,enabled:t.enabled,codec:u})}))}catch(yC){e.analytics.publish(FP.rtcStatsFailed(IP.WebrtcErrors.StatsFailed("TRACK",`Error getting local track stats ${t.trackId} - ${yC.message}`))),nP.w("[HMSWebrtcStats]","Error in getting local track stats",t,yC,yC.name)}return o}})),I_=(e,t,n,i)=>OC(void 0,null,(function*(){var r;let s;try{s=yield null==(r=t.transceiver)?void 0:r.receiver.getStats()}catch(c){e.analytics.publish(FP.rtcStatsFailed(IP.WebrtcErrors.StatsFailed("TRACK",`Error getting remote track stats ${t.trackId} - ${c.message}`))),nP.w("[HMSWebrtcStats]","Error in getting remote track stats",t,c)}let o=C_(s),a=__("bytesReceived",o,i),l=x_("packetsLost",o,i);return null!=o&&o.remote&&Object.assign(o.remote,{packetsLostRate:x_("packetsLost",o.remote,null==i?void 0:i.remote)}),o&&NC(RC({},o),{bitrate:a,packetsLostRate:l,peerID:t.peerId,enabled:t.enabled,peerName:n,codec:o.codec})})),C_=e=>{let t,n,i={};null==e||e.forEach((e=>{switch(e.type){case"inbound-rtp":case"outbound-rtp":t=e;break;case"remote-inbound-rtp":n=e;break;case"codec":i[e.id]=e.mimeType}}));let r,s=null!=t&&t.codecId?i[t.codecId]:void 0;return s&&(r=s.substring(s.indexOf("/")+1)),t&&Object.assign(t,{remote:n,codec:r})},P_=(e,t,n)=>{let i=A_(t),r=__("publish"===e?"bytesSent":"bytesReceived",i,n&&n[e]);return i&&Object.assign(i,{bitrate:r})},A_=e=>{let t;return null==e||e.forEach((n=>{"transport"===n.type&&(t=null==e?void 0:e.get(n.selectedCandidatePairId))})),t||null==e||e.forEach((e=>{"candidate-pair"===e.type&&e.selected&&(t=e)})),t},__=(e,t,n)=>8*x_(e,t,n),x_=(e,t,n)=>{let i=t&&t[e],r=n?n[e]:null;return[t,n,xP(i),xP(r)].every((e=>!!e))?1e3*R_(i,r,null==t?void 0:t.timestamp,null==n?void 0:n.timestamp):0},R_=(e,t,n,i)=>xP(e)&&xP(t)&&n&&i?(e-t)/(n-i):0,N_=class{constructor(e,t,n,i){var r;this.store=e,this.eventBus=t,this.publishConnection=n,this.subscribeConnection=i,this.TAG="[HMSWebrtcStats]",this.peerStats={},this.remoteTrackStats={},this.localTrackStats={},this.getLocalPeerStats=()=>this.peerStats[this.localPeerID],this.getRemoteTrackStats=e=>this.remoteTrackStats[e],this.getAllRemoteTracksStats=()=>this.remoteTrackStats,this.getLocalTrackStats=()=>this.localTrackStats,this.updateStats=()=>OC(this,null,(function*(){yield this.updateLocalPeerStats(),yield this.updateLocalTrackStats(),yield this.updateRemoteTrackStats()})),this.updateLocalPeerStats=()=>OC(this,null,(function*(){var e,t,n,i;let r,s=this.getLocalPeerStats();try{r=yield null==(e=this.publishConnection)?void 0:e.getStats()}catch(eN){this.eventBus.analytics.publish(FP.rtcStatsFailed(IP.WebrtcErrors.StatsFailed("PUBLISH",eN.message))),nP.w(this.TAG,"Error in getting publish stats",eN)}let o,a=r&&P_("publish",r,s);try{o=yield null==(t=this.subscribeConnection)?void 0:t.getStats()}catch(eN){this.eventBus.analytics.publish(FP.rtcStatsFailed(IP.WebrtcErrors.StatsFailed("SUBSCRIBE",eN.message))),nP.w(this.TAG,"Error in getting subscribe stats",eN)}let l=o&&P_("subscribe",o,s),{packetsLost:c,jitter:u}=(e=>{let t={packetsLost:0,jitter:0};return null==e||e.forEach((e=>{e.packetsLost&&(t.packetsLost+=e.packetsLost),e.jitter>t.jitter&&(t.jitter=e.jitter)})),t})(o),d=R_(c,null==(n=null==s?void 0:s.subscribe)?void 0:n.packetsLost,null==l?void 0:l.timestamp,null==(i=null==s?void 0:s.subscribe)?void 0:i.timestamp),h=l&&Object.assign(l,{packetsLostRate:d,jitter:u,packetsLost:c});this.peerStats[this.localPeerID]={publish:a,subscribe:h}})),this.updateRemoteTrackStats=()=>OC(this,null,(function*(){var e;let t=Array.from(this.store.getTracksMap().values()).filter((e=>e instanceof w_||e instanceof AA)),n=t.map((e=>e.trackId));Object.keys(this.remoteTrackStats).forEach((e=>{n.includes(e)||delete this.remoteTrackStats[e]}));for(let i of t){let t=i.peerId&&(null==(e=this.store.getPeerById(i.peerId))?void 0:e.name),n=this.getRemoteTrackStats(i.trackId),r=yield I_(this.eventBus,i,t,n);r&&(this.remoteTrackStats[i.trackId]=r)}})),this.updateLocalTrackStats=()=>OC(this,null,(function*(){var e;let t=this.store.getLocalPeerTracks().reduce(((e,t)=>(e[t.getTrackIDBeingSent()]=t,e)),{}),n=((e,t)=>Array.from(new Set(e.concat(t))))(Object.keys(this.localTrackStats),Object.keys(t));for(let i of n){let n=t[i];if(n){let t=null==(e=this.store.getLocalPeer())?void 0:e.name,r=yield E_(this.eventBus,n,t,this.localTrackStats[i]);r&&(this.localTrackStats[i]=r)}else delete this.localTrackStats[i]}})),this.localPeerID=null==(r=this.store.getLocalPeer())?void 0:r.peerId}setPeerConnections(e){let{publish:t,subscribe:n}=e;this.publishConnection=t,this.subscribeConnection=n}getPublishPeerConnection(){return this.publishConnection}getSubscribePeerConnection(){return this.subscribeConnection}},D_=class{constructor(e,t){this.store=e,this.eventBus=t,this.TAG="[HMSWebrtcInternals]",this.interval=1e3,this.isMonitored=!1,this.handleStatsUpdate=()=>OC(this,null,(function*(){var e;yield null==(e=this.hmsStats)?void 0:e.updateStats(),this.hmsStats&&this.eventBus.statsUpdate.publish(this.hmsStats)}))}getCurrentStats(){return this.hmsStats}getPublishPeerConnection(){var e;return null==(e=this.hmsStats)?void 0:e.getPublishPeerConnection()}getSubscribePeerConnection(){var e;return null==(e=this.hmsStats)?void 0:e.getSubscribePeerConnection()}onStatsChange(e){return this.eventBus.statsUpdate.subscribe(e),()=>{this.eventBus.statsUpdate.unsubscribe(e)}}setPeerConnections(e){let{publish:t,subscribe:n}=e;this.hmsStats?this.hmsStats.setPeerConnections({publish:t,subscribe:n}):this.hmsStats=new N_(this.store,this.eventBus,t,n)}start(){return OC(this,null,(function*(){this.isMonitored?nP.d(this.TAG,"Already started"):(this.stop(),this.isMonitored=!0,nP.d(this.TAG,"Starting Webrtc Stats Monitor"),this.startLoop().then((()=>nP.d(this.TAG,"Stopping Webrtc Stats Monitor"))).catch((e=>{this.eventBus.analytics.publish(FP.rtcStatsFailed(IP.WebrtcErrors.StatsFailed("PUBLISH",e.message))),nP.e(this.TAG,e.message)})))}))}stop(){this.isMonitored=!1}startLoop(){return OC(this,null,(function*(){for(;this.isMonitored;)yield this.handleStatsUpdate(),yield sA(this.interval)}))}cleanup(){this.stop(),this.eventBus.statsUpdate.removeAllListeners()}},L_=class{constructor(e){let{peerId:t,name:n,isLocal:i,customerUserId:r,metadata:s,role:o,joinedAt:a,groups:l,realtime:c,type:u}=e;this.customerUserId="",this.metadata="",this.auxiliaryTracks=[],this.name=n,this.peerId=t,this.isLocal=i,this.customerUserId=r,this.metadata=s,this.joinedAt=a,this.groups=l,this.realtime=c,this.type=u,o&&(this.role=o)}get isHandRaised(){var e;return!(null==(e=this.groups)||!e.includes(b_))}updateRole(e){this.role=e}updateName(e){this.name=e}updateNetworkQuality(e){this.networkQuality=e}updateMetadata(e){this.metadata=e}updateGroups(e){this.groups=e}toString(){var e,t,n,i;return`{\n      name: ${this.name};\n      role: ${null==(e=this.role)?void 0:e.name};\n      peerId: ${this.peerId};\n      customerUserId: ${this.customerUserId};\n      ${this.audioTrack?`audioTrack: ${null==(t=this.audioTrack)?void 0:t.trackId};`:""}\n      ${this.videoTrack?`videoTrack: ${null==(n=this.videoTrack)?void 0:n.trackId};`:""}\n      groups: ${null==(i=this.groups)?void 0:i.join()}\n    }`}},O_=class{};O_.makePeerId=()=>uE();var M_=class extends L_{constructor(e){super(NC(RC({},e),{peerId:O_.makePeerId(),isLocal:!0})),this.isLocal=!0,this.auxiliaryTracks=[],this.asRole=e.asRole}isInPreview(){return!!this.asRole}toString(){var e,t,n;return`{\n      name: ${this.name};\n      role: ${null==(e=this.role)?void 0:e.name};\n      peerId: ${this.peerId};\n      customerUserId: ${this.customerUserId};\n      ${this.asRole?`asRole: ${this.asRole.name};`:""}\n      ${this.audioTrack?`audioTrack: ${null==(t=this.audioTrack)?void 0:t.trackId};`:""}\n      ${this.videoTrack?`videoTrack: ${null==(n=this.videoTrack)?void 0:n.trackId};`:""}\n    }`}},j_=class extends L_{constructor(e){super(NC(RC({},e),{isLocal:!1})),this.isLocal=!1,this.auxiliaryTracks=[],this.fromRoomState=!1,this.fromRoomState=!!e.fromRoomState}},F_=(e,t)=>new j_({peerId:e.peer_id,name:e.info.name,role:t.getPolicyForRole(e.role),customerUserId:e.info.user_id,metadata:e.info.data,groups:e.groups,type:e.info.type}),U_=class{constructor(e,t,n){this.transport=e,this.store=t,this.options=n,this.isEnd=!1,this.iterator=null,this.total=0,this.defaultPaginationLimit=10}validateConnection(){if(!this.transport||!this.store)throw Error("Use usePaginatedParticipants or hmsActions.getPeerListIterator after preview or join has happened")}hasNext(){return!this.isEnd}getTotal(){return this.total}findPeers(){return OC(this,null,(function*(){var e;this.validateConnection();let t=yield this.transport.signal.findPeers(NC(RC({},this.options||{}),{limit:(null==(e=this.options)?void 0:e.limit)||this.defaultPaginationLimit}));return this.updateState(t),this.processPeers(t.peers)}))}next(){return OC(this,null,(function*(){var e;let t;return this.validateConnection(),this.iterator||this.isEnd?this.iterator?(t=yield this.transport.signal.peerIterNext({iterator:this.iterator,limit:(null==(e=this.options)?void 0:e.limit)||this.defaultPaginationLimit}),this.updateState(t),this.processPeers(t.peers)):[]:yield this.findPeers()}))}processPeers(e){let t=[];return e.forEach((e=>{let n=F_(e,this.store);t.push(n)})),t}updateState(e){this.isEnd=e.eof,this.total=e.total,e.iterator&&(this.iterator=e.iterator)}},V_=class{constructor(e){this.TAG="[AudioContextManager]",this.audioContext=new AudioContext,this.source=this.audioContext.createMediaElementSource(e),this.source.connect(this.audioContext.destination)}resumeContext(){return OC(this,null,(function*(){"suspended"===this.audioContext.state&&(yield this.audioContext.resume(),nP.d(this.TAG,"AudioContext is resumed"))}))}getAudioTrack(){return this.destinationNode&&this.source.disconnect(this.destinationNode),this.destinationNode=this.audioContext.createMediaStreamDestination(),this.source.connect(this.destinationNode),this.destinationNode.stream.getAudioTracks()[0]}cleanup(){"closed"!==this.audioContext.state&&this.audioContext.close().catch((e=>{nP.d(this.TAG,"AudioContext close error",e.message)}))}},B_=class extends mI.EventEmitter2{on(e,t){return super.on(e,t)}off(e,t){return super.off(e,t)}emit(e,t){return super.emit(e,t)}listeners(e){return super.listeners(e)}},$_=class extends B_{constructor(){super(...arguments),this.audioElement=null,this.TAG="[PlaylistAudioManager]",this.seeked=!1}play(e){return OC(this,null,(function*(){return this.audioElement=this.getAudioElement(),new Promise(((t,n)=>{this.audioElement=this.getAudioElement(),this.audioElement.src=e,this.seeked=!1,this.audioElement.onerror=()=>{let t=`Error loading ${e}`;nP.e(this.TAG,t),this.stop(),n(t)},this.audioElement.oncanplaythrough=()=>OC(this,null,(function*(){try{if(!this.audioElement)return;if(this.audioContextManager.resumeContext(),this.track)this.seeked?this.seeked=!1:(yield this.audioElement.play(),t([this.track]));else{yield this.audioElement.play();let e=this.audioContextManager.getAudioTrack();this.track=e,t([e])}}catch(tN){nP.e(this.TAG,"Error playing audio",e,tN.message),n(tN)}})),this.audioElement.onseeked=()=>{this.seeked=!0}}))}))}getTracks(){return this.track?[this.track.id]:[]}getElement(){return this.audioElement||(this.audioElement=this.getAudioElement()),this.audioElement}stop(){var e,t,n;null==(e=this.audioElement)||e.pause(),null==(t=this.audioElement)||t.removeAttribute("src"),this.audioElement=null,null==(n=this.audioContextManager)||n.cleanup(),this.track=void 0}getAudioElement(){if(this.audioElement)return this.audioElement;let e=document.createElement("audio");return e.crossOrigin="anonymous",e.addEventListener("timeupdate",(e=>this.emit("progress",e))),e.addEventListener("ended",(()=>{this.emit("ended",null)})),this.audioContextManager=new V_(e),e}},z_=class extends B_{constructor(){super(...arguments),this.TAG="[PlaylistVideoManager]",this.videoElement=null,this.canvasContext=null,this.tracks=[],this.DEFAUL_FPS=24,this.seeked=!1,this.drawImage=()=>{var e,t,n;this.videoElement&&!this.videoElement.paused&&!this.videoElement.ended&&(null==(n=this.canvasContext)||n.drawImage(this.videoElement,0,0,null==(e=this.canvas)?void 0:e.width,null==(t=this.canvas)?void 0:t.height),this.timer=setTimeout((()=>{this.drawImage()}),1e3/this.DEFAUL_FPS))}}play(e){return this.videoElement=this.getVideoElement(),this.createCanvas(),new Promise(((t,n)=>{this.videoElement=this.getVideoElement(),this.videoElement.src=e,this.seeked=!1,this.videoElement.onerror=()=>{let t=`Error loading ${e}`;nP.e(this.TAG,t),this.stop(),n(t)},this.videoElement.oncanplaythrough=()=>OC(this,null,(function*(){var i,r,s;try{if(!this.videoElement)return;if(this.canvas.width=this.videoElement.videoWidth,this.canvas.height=this.videoElement.videoHeight,0===this.tracks.length){this.clearCanvasAndTracks();let e=this.canvas.captureStream();if(!e)return void nP.e(this.TAG,"Browser does not support captureStream");this.videoElement.onplay=this.drawImage,yield this.audioContextManager.resumeContext(),yield this.videoElement.play();let n=this.audioContextManager.getAudioTrack();e.addTrack(n),e.getTracks().forEach((e=>{this.tracks.push(e)})),t(this.tracks)}else this.seeked?(this.seeked=!1,null==(s=this.canvasContext)||s.drawImage(this.videoElement,0,0,null==(i=this.canvas)?void 0:i.width,null==(r=this.canvas)?void 0:r.height)):(yield this.videoElement.play(),t(this.tracks))}catch(ZC){nP.e(this.TAG,"Error playing video",e,ZC.message),n(ZC)}})),this.videoElement.onseeked=()=>{this.seeked=!0}}))}getTracks(){return this.tracks.map((e=>e.id))}getElement(){return this.videoElement||(this.videoElement=this.getVideoElement()),this.videoElement}stop(){var e,t,n;null==(e=this.videoElement)||e.pause(),null==(t=this.videoElement)||t.removeAttribute("src"),this.videoElement=null,null==(n=this.audioContextManager)||n.cleanup(),this.clearCanvasAndTracks()}clearCanvasAndTracks(){var e;this.tracks=[],null==(e=this.canvasContext)||e.clearRect(0,0,this.canvas.width,this.canvas.height),clearTimeout(this.timer)}getVideoElement(){if(this.videoElement)return this.videoElement;let e=document.createElement("video");return e.crossOrigin="anonymous",e.addEventListener("timeupdate",(e=>this.emit("progress",e))),e.addEventListener("ended",(()=>{this.emit("ended",null)})),this.audioContextManager=new V_(e),e}createCanvas(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"))}},G_={list:[],currentIndex:-1,isAutoplayOn:!0},q_={list:[],currentIndex:-1,isAutoplayOn:!0},H_=class extends B_{constructor(e,t){super(),this.sdk=e,this.eventBus=t,this.state={audio:RC({},G_),video:RC({},q_)},this.TAG="[PlaylistManager]",this.handlePausePlaylist=e=>OC(this,[e],(function(e){var t=this;let{enabled:n,track:i}=e;return function*(){var e;if(n)return;let r;"audioplaylist"===i.source&&(r="audio"),"videoplaylist"===i.source&&(r="video"),r&&(null==(e=t.getElement(r))||e.pause())}()})),this.addTrack=(e,t)=>OC(this,null,(function*(){yield this.sdk.addTrack(e,t),nP.d(this.TAG,"Playlist track added",UP(e))})),this.removeTrack=e=>OC(this,null,(function*(){yield this.sdk.removeTrack(e,!0),nP.d(this.TAG,"Playlist track removed",e)})),this.audioManager=new $_,this.videoManager=new z_,this.addListeners()}getList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return this.state[e].list}setList(e){e&&0!==e.length?e.forEach((e=>{this.state[e.type].list.find((t=>t.id===e.id))||this.state[e.type].list.push(e)})):nP.w(this.TAG,"Please pass in a list of HMSPlaylistItem's")}clearList(e){return OC(this,null,(function*(){this.isPlaying(e)&&(yield this.stop(e)),this.state[e].list=[]}))}removeItem(e,t){return OC(this,null,(function*(){let{list:n,currentIndex:i}=this.state[t],r=n.findIndex((t=>e===t.id));return r>-1&&(i===r&&this.isPlaying(t)&&(yield this.stop(t)),n.splice(r,1),!0)}))}seek(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio",{currentIndex:n}=this.state[t];if(-1===n)throw IP.PlaylistErrors.NoEntryToPlay("PLAYLIST","No item is currently playing");let i=this.getElement(t);if(i){let t=Math.max(i.currentTime+e,0);i.currentTime=Math.min(t,i.duration)}}seekTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio",{currentIndex:n}=this.state[t];if(-1===n)throw IP.PlaylistErrors.NoEntryToPlay("PLAYLIST","No item is currently playing");if(e<0)throw Error("value cannot be negative");let i=this.getElement(t);i&&(i.currentTime=Math.min(e,i.duration))}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio";if(e<0||e>100)throw Error("Please pass a valid number between 0-100");let n=this.getElement(t);n&&(n.volume=.01*e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.getElement(e);return t?Math.floor(100*t.volume):0}getCurrentTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.getElement(e);return(null==t?void 0:t.currentTime)||0}getCurrentIndex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return this.state[e].currentIndex}getCurrentProgress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";var t;let{list:n,currentIndex:i}=this.state[e],r=null==(t=n[i])?void 0:t.url,s=this.getElement(e);return r&&s?Math.floor(s.currentTime/s.duration*100):0}getCurrentSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",{list:t,currentIndex:n}=this.state[e];if(-1!==n)return t[n]}isPlaying(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.getElement(e);return!!t&&!t.paused}setIsAutoplayOn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=arguments.length>1?arguments[1]:void 0;this.state[e].isAutoplayOn=t}getPlaybackRate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.getElement(e);return t?t.playbackRate:1}setPlaybackRate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=arguments.length>1?arguments[1]:void 0;if(t<.25||t>2)throw Error("Please pass a value between 0.25 and 2.0");let n=this.getElement(e);n&&(n.playbackRate=t)}setEnabled(e,t){return OC(this,arguments,(function(e,t){var n=this;let{id:i,type:r="audio"}=t;return function*(){let t=n.state[r].list.findIndex((e=>e.id===i));if(!i||-1===t)return void nP.w(n.TAG,"Pass a valid id");let s=n.state[r].list[t].url;e?yield n.play(s,r):yield n.pause(s,r),n.state[r].currentIndex=t,n.setDuration(r)}()}))}playNext(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return function*(){let{list:n,currentIndex:i}=e.state[t];if(i>=n.length-1)throw IP.PlaylistErrors.NoEntryToPlay("PLAYLIST","Reached end of playlist");yield e.play(n[i+1].url,t),e.state[t].currentIndex=i+1,e.setDuration(t)}()}))}playPrevious(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return function*(){let{list:n,currentIndex:i}=e.state[t];if(i<=0)throw IP.PlaylistErrors.NoEntryToPlay("PLAYLIST","Reached start of playlist");yield e.play(n[i-1].url,t),e.state[t].currentIndex=i-1,e.setDuration(t)}()}))}stop(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return function*(){var n;let i="audio"===t?e.audioManager:e.videoManager;null==(n=i.getElement())||n.pause(),yield e.removeTracks(t),i.stop(),e.state[t].currentIndex=-1}()}))}cleanup(){this.state={audio:RC({},G_),video:RC({},q_)},this.eventBus.localAudioEnabled.unsubscribe(this.handlePausePlaylist),this.eventBus.localVideoEnabled.unsubscribe(this.handlePausePlaylist),this.audioManager.stop(),this.videoManager.stop()}onProgress(e){this.videoManager.on("progress",(()=>{try{e({type:"video",progress:this.getCurrentProgress("video")})}catch(lP){nP.e(this.TAG,"Error in onProgress callback")}})),this.audioManager.on("progress",(()=>{try{e({type:"audio",progress:this.getCurrentProgress("audio")})}catch(lP){nP.e(this.TAG,"Error in onProgress callback")}}))}onNewTrackStart(e){this.on("newTrackStart",e)}onPlaylistEnded(e){this.on("playlistEnded",e)}onCurrentTrackEnded(e){this.on("currentTrackEnded",e)}getElement(){return"audio"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio")?this.audioManager.getElement():this.videoManager.getElement()}removeTracks(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return function*(){let n=("audio"===t?e.audioManager:e.videoManager).getTracks();for(let t of n)yield e.removeTrack(t)}()}))}play(e){return OC(this,arguments,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio";return function*(){let i="audio"===n?t.audioManager:t.videoManager,r=i.getElement();if(t.isItemCurrentlyPlaying(e,n))nP.w(t.TAG,`The ${n} is currently playing`);else if(null!=r&&r.src.includes(e))yield r.play();else{null==r||r.pause();let s=yield i.play(e);for(let e of s)yield t.addTrack(e,"audio"===n?"audioplaylist":"videoplaylist")}}()}))}isItemCurrentlyPlaying(e,t){let n=this.getElement(t);return!(!n||n.paused||!n.src.includes(e))}setDuration(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.getElement(e),{list:n,currentIndex:i}=this.state[e];n[i]&&(n[i].duration=(null==t?void 0:t.duration)||0),this.emit("newTrackStart",n[i])}pause(e){return OC(this,arguments,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio";return function*(){let i=t.getElement(n);i&&!i.paused&&i.src.includes(e)?(i.pause(),nP.d(t.TAG,"paused url",e)):nP.w(t.TAG,"The passed in url is not currently playing")}()}))}addListeners(){this.audioManager.on("ended",(()=>this.handleEnded("audio"))),this.videoManager.on("ended",(()=>this.handleEnded("video"))),this.eventBus.localAudioEnabled.subscribe(this.handlePausePlaylist),this.eventBus.localVideoEnabled.subscribe(this.handlePausePlaylist)}handleEnded(){return OC(this,arguments,(function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return function*(){let{list:n,currentIndex:i,isAutoplayOn:r}=e.state[t];i===n.length-1?(yield e.stop(t),e.emit("playlistEnded",t)):r?e.playNext(t):yield e.pause(n[i].url,t),e.emit("currentTrackEnded",n[i])}()}))}},W_=e=>e.room,K_=(eE((e=>e.errors),(e=>0===e.length?null:e.at(-1))),eE(W_,(e=>e.id)),e=>e.peers),Q_=e=>e.messages.byID,J_=e=>e.messages.allIDs,Y_=e=>e.tracks,X_=e=>e.settings,Z_=e=>e.appData,ex=eE([W_],(e=>e&&e.isConnected)),tx=(eE([ex,W_],((e,t)=>e?void 0!==t.peerCount?t.peerCount||1:t.peers.length:Math.max(void 0!==t.peerCount?t.peerCount:t.peers.length-1,0))),eE([W_,K_,e=>e.hideLocalPeer],((e,t,n)=>n?e.peers.filter((t=>e.localPeer!==t)).map((e=>t[e])):e.peers.map((e=>t[e]))))),nx=eE(Y_,(e=>Object.values(e))),ix=eE(W_,K_,((e,t)=>t[e.localPeer])),rx=eE(W_,(e=>e.localPeer)),sx=(eE(ix,(e=>null==e?void 0:e.name)),eE(ix,(e=>null==e?void 0:e.roleName)),eE(ix,(e=>null==e?void 0:e.audioTrack))),ox=eE(ix,(e=>null==e?void 0:e.videoTrack)),ax=eE(ix,(e=>null==e?void 0:e.auxiliaryTracks)),lx=eE([sx,ox,ax],((e,t,n)=>{let i=n?[...n]:[];return e&&i.unshift(e),t&&i.unshift(t),i})),cx=(eE(tx,(e=>e.filter((e=>!e.isLocal)))),eE(K_,(e=>e.speakers),((e,t)=>{let n=Object.entries(t).sort(((e,t)=>{var n,i;let r=(null==(n=e[1])?void 0:n.audioLevel)||0;return((null==(i=t[1])?void 0:i.audioLevel)||0)>r?1:-1}));if(n.length>0&&n[0][1].audioLevel&&n[0][1].audioLevel>0){let t=n[0][1].peerID;if(t in e)return e[t]}return null})),e=>{let t=ix(e);return YC(e,null==t?void 0:t.audioTrack)}),ux=e=>{let t=ix(e);return YC(e,null==t?void 0:t.videoTrack)},dx=e=>{let t=ix(e);return function(e,t){return!(!t||!e.tracks[t])&&e.tracks[t].displayEnabled}(e,null==t?void 0:t.videoTrack)},hx=eE(ix,Y_,((e,t)=>{let{video:n,audio:i}=GC(t,e);return!(!n&&!i)})),px=eE(K_,Y_,((e,t)=>{let n;for(let i in e){let r=e[i],{video:s,audio:o}=GC(t,r);if(s)return r;o&&!n&&(n=r)}return n})),fx=(eE(px,(e=>!!e)),eE(K_,Y_,((e,t)=>{for(let n in e){let i=e[n],{audio:r,video:s}=GC(t,i);if(!s&&r)return i}})),eE(K_,Y_,((e,t)=>{let n=[],i=[];for(let r in e){let s=e[r],{video:o,audio:a}=GC(t,s);o?n.push(s):a&&i.push(s)}return n.concat(i)})),eE(K_,Y_,((e,t)=>{for(let n in t){let i=t[n];if(QC(i)&&HC(i)&&i.peerId)return e[i.peerId]}})),eE(K_,Y_,((e,t)=>{for(let n in t){let i=t[n];if(KC(i)&&i.peerId)return e[i.peerId]}})),eE(nx,(e=>e.filter(JC))),eE(J_,(e=>e.length)),eE(Q_,(e=>Object.values(e).filter((e=>!e.read)).length)),eE(J_,Q_,((e,t)=>{let n=[];return e.forEach((e=>{n.push(t[e])})),n}))),mx=eE(fx,(e=>e.filter((e=>{var t;return!e.recipientPeer&&!(e.recipientRoles&&(null==(t=e.recipientRoles)?void 0:t.length)>0)})))),gx=(eE(mx,(e=>e.filter((e=>!e.read)).length)),eE([W_],(e=>e&&e.roomState))),vx=eE(gx,(e=>"Preview"===e)),yx=(eE(W_,(e=>"Disconnected"!==e.roomState)),eE(W_,(e=>!(!e.transcriptions||e.transcriptions.length<=0)&&e.transcriptions.some((e=>"caption"===e.mode&&"started"===e.state)))),e=>e.roles),bx=(eE([yx],(e=>Object.keys(e))),eE([ix,yx],((e,t)=>null!=e&&e.roleName?t[e.roleName]:null))),wx=eE([e=>{var t;return null==(t=e.preview)?void 0:t.asRole},yx],((e,t)=>e?t[e]:null)),kx=(eE([bx],(e=>{var t;return!(null==(t=null==e?void 0:e.subscribeParams)||!t.subscribeToRoles)&&e.subscribeParams.subscribeToRoles.length>0})),eE(bx,(e=>null==e?void 0:e.permissions))),Tx=(eE(W_,(e=>e.recording)),eE(W_,(e=>e.rtmp)),eE(W_,(e=>e.hls)),eE(W_,(e=>e.transcriptions)),eE(W_,(e=>e.sessionId)),eE(W_,(e=>e.startedAt)),eE(W_,(e=>!!e.isLargeRoom)),eE(W_,(e=>!!e.isEffectsEnabled)),eE(W_,(e=>!!e.isVBEnabled)),eE(W_,(e=>e.effectsKey)),eE(tx,(e=>e.filter((e=>e.isHandRaised)))),eE((e=>e.whiteboards),(e=>Object.values(e)[0])),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].list}),Sx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].selection},Ex=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].progress},Ix=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].currentTime},Cx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].playbackRate},Px=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return t=>t.playlist[e].volume},Ax=function(){return eE(Tx(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio"),(e=>Object.values(e)))},_x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio";return eE(Tx(e),Sx(e),((e,t)=>{if(t.id)return e[t.id]}))},xx={selection:Sx("audio"),progress:Ex("audio"),currentTime:Ix("audio"),playbackRate:Cx("audio"),volume:Px("audio"),list:Ax("audio"),selectedItem:_x("audio")},Rx={selection:Sx("video"),progress:Ex("video"),currentTime:Ix("video"),playbackRate:Cx("video"),volume:Px("video"),list:Ax("video"),selectedItem:_x("video")};function Nx(e){return t=>n=>e(n,t)}var Dx="HMS-Store:",Lx=class{static v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(0,e,...n)}static d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(1,...t)}static i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(2,...t)}static w(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(3,...t)}static e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log(6,...t)}static time(e){this.log(4,"[HMSPerformanceTiming]",e)}static timeEnd(e){this.log(5,"[HMSPerformanceTiming]",e,e)}static cleanup(){performance.clearMarks(),performance.clearMeasures()}static log(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(!(this.level.valueOf()>e.valueOf()))switch(e){case 0:console.log(Dx,...n);break;case 1:console.debug(Dx,...n);break;case 2:console.info(Dx,...n);break;case 3:console.warn(Dx,...n);break;case 6:console.error(Dx,...n);break;case 4:performance.mark(n[1]);break;case 5:{let e=n[0],t=n[1];try{let n=performance.measure(t,t);this.log(1,e,t,null==n?void 0:n.duration),performance.clearMarks(t),performance.clearMeasures(t)}catch(tN){this.log(1,e,t,tN)}break}}}};Lx.level=0;var Ox=(e,t)=>t,Mx=(e,t)=>t,jx=(e,t)=>t,Fx=eE([K_,Ox],((e,t)=>t?e[t]:null)),Ux=eE([Y_,Mx],((e,t)=>t?e[t]:null)),Vx=eE([Y_,Mx],((e,t)=>{if(!t)return null;let n=e[t];return"video"===(null==n?void 0:n.type)?n:null})),Bx=eE([Y_,Mx],((e,t)=>{if(!t)return null;let n=e[t];return"audio"===(null==n?void 0:n.type)?n:null})),$x=eE([Y_,Mx],((e,t)=>{if(!t)return null;let n=e[t];return"audio"===(null==n?void 0:n.type)&&"screen"===(null==n?void 0:n.source)?n:null})),zx=eE([Y_,Mx],((e,t)=>{if(!t)return null;let n=e[t];return"video"===(null==n?void 0:n.type)&&"screen"===(null==n?void 0:n.source)?n:null})),Gx=eE([e=>e.polls,(e,t)=>t],((e,t)=>t?e[t]:null)),qx=Nx(Fx);Nx(eE([Z_,(e,t)=>t],((e,t)=>{if(e)return t?e[t]:e})));Nx(eE(Fx,(e=>null==e?void 0:e.name))),Nx(eE(Fx,(e=>null==e?void 0:e.type)));var Hx=Nx(Ux),Wx=Nx(Vx),Kx=(Nx(Bx),Nx($x),Nx(zx),Nx(((e,t)=>{let n=Fx(e,t);if(n&&n.videoTrack&&""!==n.videoTrack)return e.tracks[n.videoTrack]})),Nx(((e,t)=>{let n=Fx(e,t);if(n&&n.audioTrack&&""!==n.audioTrack)return e.tracks[n.audioTrack]}))),Qx=(Nx(((e,t)=>{let n=Fx(e,t);return(null==n?void 0:n.auxiliaryTracks.map((t=>e.tracks[t])))||[]})),(e,t)=>t?e.speakers[t]:null),Jx=(Nx(eE(Qx,(e=>(null==e?void 0:e.audioLevel)||0))),Nx(eE(((e,t)=>{let n=Kx(t)(e);return Qx(e,null==n?void 0:n.id)}),(e=>(null==e?void 0:e.audioLevel)||0))),Nx(((e,t)=>{if(t)return e.connectionQualities[t]})),Nx(((e,t)=>{let n=Fx(e,t);if(n){let t=null==n?void 0:n.auxiliaryTracks.find((t=>qC(e.tracks[t])));return t?e.tracks[t]:void 0}})),Nx(eE(Y_,Fx,((e,t)=>{let n=null==t?void 0:t.auxiliaryTracks.find((t=>{let n=e[t];return QC(n)&&HC(n)}));return n?e[n]:void 0}))),Nx(eE(Y_,Fx,((e,t)=>{let n=null==t?void 0:t.auxiliaryTracks.find((t=>{let n=e[t];return QC(n)&&qC(n)}));return n?e[n]:void 0}))),Nx(eE(Y_,Fx,((e,t)=>{let n=null==t?void 0:t.auxiliaryTracks.find((t=>{let n=e[t];return KC(n)&&qC(n)}));return n?e[n]:void 0}))),Nx(eE(Y_,Fx,((e,t)=>GC(e,t))))),Yx=e=>eE(Jx(e),(e=>e.audio)),Xx=Nx(((e,t)=>{let n=Fx(e,t);return YC(e,null==n?void 0:n.audioTrack)})),Zx=Nx(((e,t)=>{let n=Fx(e,t);return YC(e,null==n?void 0:n.videoTrack)})),eR=Nx(((e,t)=>{if(t&&e.tracks[t])return 0===e.tracks[t].volume})),tR=(Nx(((e,t)=>{let n=Fx(e,t);return eR(null==n?void 0:n.audioTrack)(e)})),Nx(((e,t)=>{let n=Yx(t)(e);return eR(null==n?void 0:n.id)(e)})),Nx(((e,t)=>{let n=Ux(e,t);if(n)return"audio"!==n.type?void Lx.w("Please pass audio track here"):n.volume}))),nR=(Nx(((e,t)=>{let n=Fx(e,t);return tR(null==n?void 0:n.audioTrack)(e)})),Nx(((e,t)=>{let n=Yx(t)(e);return tR(null==n?void 0:n.id)(e)})),Nx(((e,t)=>{let n=Ux(e,t);if(n)return"video"!==n.type?void Lx.w("Please pass video track here"):n.layer})),eE([fx,rx,Ox],((e,t,n)=>{if(n)return e.filter((e=>{var i;return!(!(e.recipientPeer||null!=(i=e.recipientRoles)&&i.length)||e.sender&&![t,n].includes(e.sender))&&[t,n].includes(e.recipientPeer)}))}))),iR=eE([fx,jx],((e,t)=>{if(t)return e.filter((e=>{var n,i;return!(null==(n=e.recipientRoles)||!n.length)&&(null==(i=e.recipientRoles)?void 0:i.includes(t))}))})),rR=eE(fx,(e=>e.filter((e=>{var t;return!e.recipientPeer&&!(null!=(t=e.recipientRoles)&&t.length)})))),sR=eE([iR,jx],(e=>e?e.filter((e=>!e.read)).length:0)),oR=eE([nR,Ox],(e=>e?e.filter((e=>!e.read)).length:0)),aR=(eE(rR,(e=>e.filter((e=>!e.read)).length)),Nx(nR),Nx(iR),Nx(sR),Nx(oR),Nx(Gx)),lR=(eE([K_,Y_],((e,t)=>Object.values(e).map((e=>{var n;return{peer:e,isAudioEnabled:!!e.audioTrack&&(null==(n=t[e.audioTrack])?void 0:n.enabled)}})))),eE([e=>e.roleChangeRequests[0]||null,K_,yx],((e,t,n)=>e?{requestedBy:e.requestedBy?t[e.requestedBy]:void 0,role:n[e.roleName],token:e.token}:null)),eE([bx],(e=>XC(e))),eE([wx],(e=>XC(e))),eE([ox,Y_],((e,t)=>{let n=null;return e&&(n=t[e]),(null==n?void 0:n.plugins)||[]})),eE([sx,Y_],((e,t)=>{let n=null;return e&&(n=t[e]),(null==n?void 0:n.plugins)||[]})),{0:"PEER_JOINED",1:"PEER_LEFT",8:"ROLE_UPDATED",10:"NAME_UPDATED",11:"METADATA_UPDATED",12:"HAND_RAISE_CHANGED"}),cR={0:"TRACK_ADDED",1:"TRACK_REMOVED",2:"TRACK_MUTED",3:"TRACK_UNMUTED",5:"TRACK_DEGRADED",6:"TRACK_RESTORED",4:"TRACK_DESCRIPTION_CHANGED"},uR={0:"POLL_CREATED",1:"POLL_STARTED",2:"POLL_STOPPED",4:"POLL_VOTES_UPDATED",3:"POLLS_LIST"},dR="TRANSCRIPTION_STATE_UPDATED",hR="hmsNotification",pR=class{constructor(e){this.id=0,this.onNotification=(e,t)=>{let n=n=>{if(t){let e;if(e=Array.isArray(t)?t.includes(n.type):t===n.type,!e)return}e(n)};return this.eventEmitter.addListener(hR,n),()=>{this.eventEmitter.removeListener(hR,n)}},this.store=e,this.eventEmitter=new mI.EventEmitter2({maxListeners:Object.keys($C).length})}sendPlaylistTrackEnded(e){let t=this.createNotification("PLAYLIST_TRACK_ENDED",e,"info");this.emitEvent(t)}sendDeviceChange(e){var t;let n=this.createNotification("DEVICE_CHANGE_UPDATE",e,e.error?"error":"info",`Selected ${e.type} device - ${null==(t=e.selection)?void 0:t.label}`);this.emitEvent(n)}sendLeaveRoom(e){var t;let n=null==(t=e.requestedBy)?void 0:t.name,i=this.createNotification(e.roomEnded||!n?"ROOM_ENDED":"REMOVED_FROM_ROOM",e,"info",`${e.roomEnded?"Room ended":"Removed from room"} ${n?`by ${n}`:""}`);this.emitEvent(i)}sendPeerList(e){if(0===e.length)return;let t=this.createNotification("PEER_LIST",e,"info");this.emitEvent(t)}sendPeerUpdate(e,t){let n=this.store.getState(qx(null==t?void 0:t.id))||t,i=lR[e];if(i&&n){let e=this.createNotification(i,n,"info");this.emitEvent(e)}}sendTrackUpdate(e,t){let n=this.store.getState(Hx(t)),i=cR[e];if(i){let e=this.createNotification(i,n,"info");this.emitEvent(e)}}sendMessageReceived(e){let t=this.createNotification("NEW_MESSAGE",e,"info");this.emitEvent(t)}sendError(e){let t=this.createNotification("ERROR",e,"error");this.emitEvent(t)}sendReconnecting(e){let t=this.createNotification("RECONNECTING",e,"error");this.emitEvent(t)}sendReconnected(){let e=this.createNotification("RECONNECTED",null,"info");this.emitEvent(e)}sendChangeTrackStateRequest(e){let t=this.createNotification("CHANGE_TRACK_STATE_REQUEST",e,"info");this.emitEvent(t)}sendChangeMultiTrackStateRequest(e){let t=this.createNotification("CHANGE_MULTI_TRACK_STATE_REQUEST",e,"info");this.emitEvent(t)}sendPollUpdate(e,t){let n=uR[e],i=this.store.getState(aR(t));if(n){let e=this.createNotification(n,i,"info");this.emitEvent(e)}}sendTranscriptionUpdate(e){let t=this.createNotification(dR,e,"info");this.emitEvent(t)}emitEvent(e){this.eventEmitter.emit(hR,e)}createNotification(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.id++,{id:this.id,type:e,message:i,data:t,severity:n}}},fR=class{constructor(e){this.queuedUpdates={},this.timers={},this.DEFAULT_INTERVAL_MS=50,this.store=e}setState(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.DEFAULT_INTERVAL_MS;this.queuedUpdates[t]=this.queuedUpdates[t]||[],this.queuedUpdates[t].push(e),!this.timers[t]&&(window?this.timers[t]=window.setTimeout((()=>this.setStateBatched(t)),n):this.setStateBatched(t))}setStateBatched(e){var t;if((null==(t=this.queuedUpdates[e])?void 0:t.length)>0){let t=t=>{this.queuedUpdates[e].forEach((e=>{try{e(t)}catch(n){Lx.w("failed to update store",n)}}))};console.time(`timed-${e}`),this.store.namedSetState(t,e),console.timeEnd(`timed-${e}`)}delete this.queuedUpdates[e],window&&this.timers[e]&&(window.clearTimeout(this.timers[e]),delete this.timers[e])}};var mR,gR,vR=(e,t)=>{let n=SR(Object.keys(e),Object.keys(t));for(let i of n){let n=e[i],r=t[i];bR(n,r)?Object.assign(n,r):wR(n,r)?delete e[i]:kR(n,r)&&(e[i]=r)}},yR=(e,t)=>{e.plugins&&TR(e.plugins,t.plugins)&&(t.plugins=e.plugins),"video"===e.type&&e.layerDefinitions&&TR(e.layerDefinitions,t.layerDefinitions)&&(t.layerDefinitions=e.layerDefinitions)},bR=(e,t)=>e&&t,wR=(e,t)=>e&&!t,kR=(e,t)=>!e&&t,TR=(e,t)=>{if(e===t||0===e.length&&0===(null==t?void 0:t.length))return!0;if(!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},SR=(e,t)=>{let n=new Set;for(let i of e)n.add(i);for(let i of t)n.add(i);return Array.from(n)},ER=class e{static convertPeer(e){var t,n,i;return{id:e.peerId,name:e.name,roleName:null==(t=e.role)?void 0:t.name,isLocal:e.isLocal,videoTrack:null==(n=e.videoTrack)?void 0:n.trackId,audioTrack:null==(i=e.audioTrack)?void 0:i.trackId,auxiliaryTracks:e.auxiliaryTracks.map((e=>e.trackId)),customerUserId:e.customerUserId,metadata:e.metadata,joinedAt:e.joinedAt,groups:e.groups,isHandRaised:e.isHandRaised,type:e.type}}static convertTrack(e,t){let n={id:e.trackId,source:e.source,type:e.type,enabled:e.enabled,displayEnabled:e.enabled,peerId:e.peerId||t};return this.enrichTrack(n,e),n}static enrichTrack(t,n){let i=n.getMediaTrackSettings();n instanceof AA&&(t.volume=n.getVolume()||0),e.updateDeviceID(t,n),e.enrichLocalTrack(t,n),"video"===t.type&&("screen"===t.source?(t.displaySurface=i.displaySurface,e.enrichScreenTrack(t,n)):"regular"===t.source&&(t.facingMode=i.facingMode),t.height=i.height,t.width=i.width,e.enrichVideoTrack(t,n)),e.enrichPluginsDetails(t,n)}static enrichLocalTrack(e,t){(t instanceof KA||t instanceof PA)&&(e.isPublished=t.isPublished)}static updateDeviceID(e,t){var n;e.deviceID=t instanceof KA||t instanceof PA?t.settings.deviceId:null==(n=t.getMediaTrackSettings())?void 0:n.deviceId}static enrichVideoTrack(e,t){t instanceof w_&&(e.layer=t.getLayer(),e.preferredLayer=t.getPreferredLayer(),e.degraded=t.degraded),(t instanceof w_||t instanceof KA)&&(TR(t.getSimulcastDefinitions(),e.layerDefinitions)||(e.layerDefinitions=t.getSimulcastDefinitions()))}static enrichScreenTrack(e,t){var n,i;if(t instanceof KA){let r=null==(n=t.getCaptureHandle)?void 0:n.call(t);(null==r?void 0:r.handle)!==(null==(i=e.captureHandle)?void 0:i.handle)&&(e.captureHandle=r),t.isCurrentTab&&(e.displaySurface="selfBrowser")}}static enrichPluginsDetails(e,t){(t instanceof KA||t instanceof PA)&&(TR(t.getPlugins(),e.plugins)||(e.plugins=t.getPlugins()))}static convertRoom(t,n){let{recording:i,rtmp:r,hls:s,transcriptions:o}=e.convertRecordingStreamingState(t.recording,t.rtmp,t.hls,t.transcriptions);return{id:t.id,name:t.name,localPeer:n,recording:i,rtmp:r,hls:s,transcriptions:o,sessionId:t.sessionId,startedAt:t.startedAt,joinedAt:t.joinedAt,peerCount:t.peerCount,isLargeRoom:t.large_room_optimization,isEffectsEnabled:t.isEffectsEnabled,disableNoneLayerRequest:t.disableNoneLayerRequest,isVBEnabled:t.isVBEnabled,effectsKey:t.effectsKey,isHipaaEnabled:t.isHipaaEnabled,isNoiseCancellationEnabled:t.isNoiseCancellationEnabled}}static convertMessage(e,t){var n,i,r,s;return{sender:null==(n=e.peer)?void 0:n.peer_id,senderName:null==(i=e.peer)?void 0:i.info.name,senderRole:null==(r=e.peer)?void 0:r.role,senderUserId:null==(s=e.peer)?void 0:s.info.user_id,recipientPeer:e.private?t:void 0,recipientRoles:e.roles,time:new Date(e.timestamp),type:e.info.type,message:e.info.message,id:e.message_id}}static convertRoles(e){let t={};return e&&e.forEach((e=>{t[e.name]=e})),t}static convertRoleChangeRequest(e){var t;return{requestedBy:null==(t=e.requestedBy)?void 0:t.peerId,roleName:e.role.name,token:e.token}}static convertException(e){let t="trackType"in e,n={code:e.code,action:e.action,name:e.name,message:e.message,description:e.description,isTerminal:e.isTerminal,nativeError:e.nativeError,timestamp:new Date};return t&&(n.trackType=null==e?void 0:e.trackType),n}static convertDeviceChangeUpdate(e){let t={devices:e.devices,selection:e.selection,type:e.type};return e.error&&(t.error=this.convertException(e.error)),t}static convertPlaylist(e){return{audio:this.getConvertedPlaylistType(e,"audio"),video:this.getConvertedPlaylistType(e,"video")}}static convertPlaylistItem(e,t){let n=t.type,i=e.getCurrentSelection(n),r=e.isPlaying(n),s=t.url===(null==i?void 0:i.url);return NC(RC({},t),{type:t.type,selected:s,playing:s&&r})}static getConvertedPlaylistType(t,n){let i={},r=t.getCurrentSelection(n),s=t.getCurrentProgress(n),o=t.getVolume(n),a=t.getList(n),l=t.getCurrentIndex(n);return t.getList(n).forEach((n=>{i[n.id]=e.convertPlaylistItem(t,n)})),{list:i,selection:{id:null==r?void 0:r.id,hasPrevious:l>0,hasNext:l<a.length-1},progress:s,volume:o,currentTime:t.getCurrentTime(n),playbackRate:t.getPlaybackRate(n)}}static convertRecordingStreamingState(e,t,n,i){var r;return{recording:{browser:RC({running:!1},null==e?void 0:e.browser),server:RC({running:!1},null==e?void 0:e.server),hls:RC({running:!1},null==e?void 0:e.hls)},rtmp:RC({running:!1},t),hls:{variants:(null==(r=null==n?void 0:n.variants)?void 0:r.map((e=>e)))||[],running:!(null==n||!n.running),error:null==n?void 0:n.error},transcriptions:i||[]}}},IR=class{constructor(e,t,n,i){this.playlistManager=e,this.syncPlaylistState=n,this.store=i,this.type=t}play(e){return OC(this,null,(function*(){e?yield this.playlistManager.setEnabled(!0,{id:e,type:this.type}):Lx.w("Please pass id to play")}))}pause(){return OC(this,null,(function*(){let e="audio"===this.type?xx:Rx,t=this.store.getState(e.selection);t.id?yield this.playlistManager.setEnabled(!1,{id:t.id,type:this.type}):Lx.w("No item is currently playing to pause")}))}playNext(){return OC(this,null,(function*(){yield this.playlistManager.playNext(this.type)}))}playPrevious(){return OC(this,null,(function*(){yield this.playlistManager.playPrevious(this.type)}))}seek(e){this.playlistManager.seek(e,this.type),this.syncPlaylistState(`seekOn${this.type}Playlist`)}seekTo(e){this.playlistManager.seekTo(e,this.type),this.syncPlaylistState(`seekToOn${this.type}Playlist`)}setVolume(e){this.playlistManager.setVolume(e,this.type),this.syncPlaylistState(`setVolumeOn${this.type}Playlist`)}setList(e){this.playlistManager.setList(e),this.syncPlaylistState(`setListOn${this.type}Playlist`)}stop(){return OC(this,null,(function*(){yield this.playlistManager.stop(this.type),this.syncPlaylistState(`stop${this.type}Playlist`)}))}setIsAutoplayOn(e){this.playlistManager.setIsAutoplayOn(this.type,e)}setPlaybackRate(e){this.playlistManager.setPlaybackRate(this.type,e),this.syncPlaylistState(`set${this.type}PlaybackRate`)}removeItem(e){return OC(this,null,(function*(){let t=yield this.playlistManager.removeItem(e,this.type);return t&&this.syncPlaylistState(`remove${this.type}PlaylistItem`),t}))}clearList(){return OC(this,null,(function*(){yield this.playlistManager.clearList(this.type),this.syncPlaylistState(`clear${this.type}Playlist`)}))}},CR=class{constructor(e,t){this.sdk=e,this.setLocally=t}get sdkSessionStore(){return this.sdk.getSessionStore()}set(e,t){return OC(this,null,(function*(){let{value:n}=yield this.sdkSessionStore.set(String(e),t);this.setLocally({key:e,value:n})}))}observe(e){return OC(this,null,(function*(){let t=Array.isArray(e)?e.map((e=>String(e))):[String(e)];yield this.sdkSessionStore.observe(t)}))}unobserve(e){return OC(this,null,(function*(){let t=Array.isArray(e)?e.map((e=>String(e))):[String(e)];yield this.sdkSessionStore.unobserve(t)}))}},PR=class{constructor(e,t){this.TAG="[BeamSpeakerLabelsLogger]",this.intervalMs=100,this.shouldMonitor=!1,this.hasStarted=!1,this.unsubs=[],this.analysers={},this.store=e,this.actions=t}start(){return OC(this,null,(function*(){if(this.hasStarted)return;this.hasStarted=!0,Lx.d("starting audio level monitor for remote peers",this.store);let e=this.store.getState(ex);Lx.d("starting audio levels is connected to room",e),e&&(yield this.monitorAudioLevels());let t=this.store.subscribe(this.monitorAudioLevels.bind(this),ex);this.unsubs.push(t)}))}stop(){return OC(this,null,(function*(){this.hasStarted&&(this.hasStarted=!1,this.shouldMonitor=!1,this.unsubs.forEach((e=>e())),Lx.d("stopped audio level monitor for remote peers"))}))}monitorAudioLevels(){return OC(this,null,(function*(){if(!this.store.getState(ex))return void(this.shouldMonitor&&(Lx.i("room no longer connected, stopping audio level monitoring for remote"),this.shouldMonitor=!1));if(this.shouldMonitor)return;Lx.i("monitoring audio levels"),this.shouldMonitor=!0;let e=()=>{this.shouldMonitor?(this.logAllPeersAudioLevels(),setTimeout(e,this.intervalMs)):Lx.i("stopped monitoring audio levels")};setTimeout(e,1e3)}))}logAllPeersAudioLevels(){return OC(this,null,(function*(){var e;if(!window.__triggerBeamEvent__)return;let t=this.store.getState(tx),n=t.filter((e=>!!e.audioTrack));Lx.d(this.TAG,"Peers Without audio track",t.filter((e=>!e.audioTrack)).map((e=>e.id)).join(","));let i=[];for(let r of n){let t=this.actions.getTrackById(r.audioTrack||""),n=null==(e=null==t?void 0:t.stream)?void 0:e.nativeStream;if(r.joinedAt&&n){let e=yield this.getAudioLevel(r,n);Lx.d(this.TAG,r.id,e),e.level>0&&i.push(e)}}if(i.length>0){let e={event:"app-audio-level",data:i};Lx.d("logging audio levels",JSON.stringify(i)),window.__triggerBeamEvent__(JSON.stringify(e))}}))}getAudioLevel(e,t){return OC(this,null,(function*(){this.analysers[t.id]||(this.analysers[t.id]=this.createAnalyserNode(t));let n=this.analysers[t.id],i=this.calculateAudioLevel(n);return{peerId:e.id,peerName:e.name,level:i}}))}createAnalyserNode(e){this.audioContext||(this.audioContext=new AudioContext);let t=this.audioContext.createAnalyser();return this.audioContext.createMediaStreamSource(e).connect(t),t}calculateAudioLevel(e){let t=new Uint8Array(e.fftSize);e.getByteTimeDomainData(t);let n=.009,i=n;for(let s of t)i=Math.max(i,(s-128)/128);let r=(Math.log(n)-Math.log(i))/Math.log(n);return Math.ceil(Math.min(Math.max(100*r,0),100))}},AR=1e4,_R={name:"diagnostics-role",priority:1,publishParams:{allowed:["audio","video"],audio:{bitRate:32,codec:"opus"},video:{bitRate:100,codec:"vp8",frameRate:30,height:720,width:1280},screen:{bitRate:100,codec:"vp8",frameRate:10,height:1080,width:1920}},subscribeParams:{subscribeToRoles:[],maxSubsBitRate:3200},permissions:{browserRecording:!1,changeRole:!1,endRoom:!1,hlsStreaming:!1,mute:!1,pollRead:!1,pollWrite:!1,removeOthers:!1,rtmpStreaming:!1,unmute:!1}},xR=class{constructor(){this.networkScores=[],this.lastPushedAt=0}pushScore(e){!e||e<0||(0===this.networkScores.length?(this.networkScores.push(e),this.lastPushedAt=Date.now()):this.addPendingCQSTillNow())}addPendingCQSTillNow(){if(this.networkScores.length>0){let e=(Date.now()-this.lastPushedAt)/1e3;for(;e>0;)this.networkScores.push(this.networkScores[this.networkScores.length-1]),e-=1;this.lastPushedAt=Date.now()}}getCQS(){return this.networkScores.reduce(((e,t)=>e+t),0)/this.networkScores.length}},RR=e=>e[e.length-1],NR=(e,t)=>{let n=e.filter((e=>(e=>!!e&&!isNaN(e))(t(e))));return n.reduce(((e,n)=>e+(t(n)||0)),0)/n.length},DR=class{constructor(e){this.sdk=e,this.peerStatsList=[],this.localAudioTrackStatsList=[],this.localVideoTrackStatsList=[],this.remoteAudioTrackStatsList=[],this.remoteVideoTrackStatsList=[]}handleStatsUpdate(e){return OC(this,null,(function*(){var t,n,i,r,s,o,a,l;let c=e.getLocalPeerStats();c&&this.peerStatsList.push(c);let u=null==(i=null==(n=null==(t=this.sdk.getLocalPeer())?void 0:t.audioTrack)?void 0:n.nativeTrack)?void 0:i.id,d=null==(o=null==(s=null==(r=this.sdk.getLocalPeer())?void 0:r.videoTrack)?void 0:s.nativeTrack)?void 0:o.id,h=e.getLocalTrackStats();h&&(u&&this.localAudioTrackStatsList.push(h[u]),d&&this.localVideoTrackStatsList.push(h[d]));let p=yield null==(l=null==(a=this.sdk.getWebrtcInternals())?void 0:a.getSubscribePeerConnection())?void 0:l.getStats();null==p||p.forEach((e=>{if("inbound-rtp"===e.type){let t="audio"===e.kind?this.remoteAudioTrackStatsList:this.remoteVideoTrackStatsList,n=__("bytesReceived",e,RR(t));t.push(NC(RC({},e),{bitrate:n}))}}))}))}buildReport(){var e,t,n,i,r,s,o,a,l,c;let u=null==(e=RR(this.peerStatsList))?void 0:e.publish,d=null==(t=RR(this.peerStatsList))?void 0:t.subscribe,h=null!=u&&u.responsesReceived?((null==u?void 0:u.totalRoundTripTime)||0)/u.responsesReceived:0,p=null!=d&&d.responsesReceived?((null==d?void 0:d.totalRoundTripTime)||0)/d.responsesReceived:0,f=Number(((h+p)/2*1e3).toFixed(2)),m=(null==(n=RR(this.remoteAudioTrackStatsList))?void 0:n.packetsReceived)||0,g=(null==(i=RR(this.remoteVideoTrackStatsList))?void 0:i.packetsReceived)||0,v=this.localAudioTrackStatsList.map((e=>e?NR(Object.values(e),(e=>e.bitrate)):0)),y=this.localVideoTrackStatsList.map((e=>e?NR(Object.values(e),(e=>e.bitrate)):0)),b=(null==(r=RR(this.remoteAudioTrackStatsList))?void 0:r.jitter)||0,w=(null==(s=RR(this.remoteVideoTrackStatsList))?void 0:s.jitter)||0,k=Math.max(b,w),T=RR(this.localAudioTrackStatsList),S=RR(this.localVideoTrackStatsList);return{combined:{roundTripTime:f,packetsReceived:m+g,packetsLost:(null==d?void 0:d.packetsLost)||0,bytesSent:(null==u?void 0:u.bytesSent)||0,bytesReceived:(null==d?void 0:d.bytesReceived)||0,bitrateSent:NR(this.peerStatsList,(e=>{var t;return null==(t=e.publish)?void 0:t.bitrate})),bitrateReceived:NR(this.peerStatsList,(e=>{var t;return null==(t=e.subscribe)?void 0:t.bitrate})),jitter:k},audio:{roundTripTime:f,packetsReceived:m,packetsLost:(null==(o=RR(this.remoteAudioTrackStatsList))?void 0:o.packetsLost)||0,bytesReceived:(null==(a=RR(this.remoteAudioTrackStatsList))?void 0:a.bytesReceived)||0,bitrateSent:NR(v,(e=>e)),bitrateReceived:NR(this.remoteAudioTrackStatsList,(e=>e.bitrate)),bytesSent:T?Object.values(T).reduce(((e,t)=>e+(t.bytesSent||0)),0):0,jitter:b},video:{roundTripTime:f,packetsLost:(null==(l=RR(this.remoteVideoTrackStatsList))?void 0:l.packetsLost)||0,bytesReceived:(null==(c=RR(this.remoteVideoTrackStatsList))?void 0:c.bytesReceived)||0,packetsReceived:g,bitrateSent:NR(y,(e=>e)),bitrateReceived:NR(this.remoteVideoTrackStatsList,(e=>e.bitrate)),bytesSent:S?Object.values(S).reduce(((e,t)=>e+(t.bytesSent||0)),0):0,jitter:w}}}},LR=(e=>(e[e.STARTING=0]="STARTING",e[e.INIT_FETCHED=1]="INIT_FETCHED",e[e.SIGNAL_CONNECTED=2]="SIGNAL_CONNECTED",e[e.ICE_ESTABLISHED=3]="ICE_ESTABLISHED",e[e.MEDIA_CAPTURED=4]="MEDIA_CAPTURED",e[e.MEDIA_PUBLISHED=5]="MEDIA_PUBLISHED",e[e.COMPLETED=6]="COMPLETED",e))(LR||{}),OR=class{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e4;this.sdk=e,this.sdkListener=t,this.progressCallback=n,this.completionCallback=i,this.connectivityDuration=r,this.wsConnected=!1,this.initConnected=!1,this.isPublishICEConnected=!1,this.isSubscribeICEConnected=!1,this.gatheredPublishICECandidates=[],this.gatheredSubscribeICECandidates=[],this.errors=[],this.isAudioTrackCaptured=!1,this.isVideoTrackCaptured=!1,this.isAudioTrackPublished=!1,this.isVideoTrackPublished=!1,this.cqsCalculator=new xR,this.timestamp=Date.now(),this.onRoomUpdate=this.sdkListener.onRoomUpdate.bind(this.sdkListener),this.onPeerUpdate=this.sdkListener.onPeerUpdate.bind(this.sdkListener),this.onMessageReceived=this.sdkListener.onMessageReceived.bind(this.sdkListener),this.onReconnected=this.sdkListener.onReconnected.bind(this.sdkListener),this.onRoleChangeRequest=this.sdkListener.onRoleChangeRequest.bind(this.sdkListener),this.onRoleUpdate=this.sdkListener.onRoleUpdate.bind(this.sdkListener),this.onChangeTrackStateRequest=this.sdkListener.onChangeTrackStateRequest.bind(this.sdkListener),this.onChangeMultiTrackStateRequest=this.sdkListener.onChangeMultiTrackStateRequest.bind(this.sdkListener),this.onRemovedFromRoom=this.sdkListener.onRemovedFromRoom.bind(this.sdkListener),this.onNetworkQuality=null==(mR=this.sdkListener.onNetworkQuality)?void 0:mR.bind(this.sdkListener),this.onPreview=this.sdkListener.onPreview.bind(this.sdkListener),this.onDeviceChange=null==(gR=this.sdkListener.onDeviceChange)?void 0:gR.bind(this.sdkListener),this.onSessionStoreUpdate=this.sdkListener.onSessionStoreUpdate.bind(this.sdkListener),this.onPollsUpdate=this.sdkListener.onPollsUpdate.bind(this.sdkListener),this.onWhiteboardUpdate=this.sdkListener.onWhiteboardUpdate.bind(this.sdkListener),this.handleConnectionQualityUpdate=e=>{let t=e.find((e=>{var t,n;return e.peerID===(null==(n=null==(t=this.sdk)?void 0:t.store.getLocalPeer())?void 0:n.peerId)}));this.cqsCalculator.pushScore(null==t?void 0:t.downlinkQuality)},this.statsCollector=new DR(e),this.state=0}get state(){return this._state}set state(e){var t;void 0===e||void 0!==this._state&&e<this._state||(this._state=e,null==(t=this.progressCallback)||t.call(this,e))}onICESuccess(e){e?this.isPublishICEConnected=!0:this.isSubscribeICEConnected=!0,this.isPublishICEConnected&&this.isSubscribeICEConnected&&(this.state=3)}onSelectedICECandidatePairChange(e,t){t?this.selectedPublishICECandidate=e:this.selectedSubscribeICECandidate=e}onICECandidate(e,t){t?this.gatheredPublishICECandidates.push(e):this.gatheredSubscribeICECandidates.push(e)}onMediaPublished(e){switch(e.type){case"audio":this.isAudioTrackPublished=!0;break;case"video":this.isVideoTrackPublished=!0}this.isVideoTrackPublished&&this.isAudioTrackPublished&&(this.state=5)}onInitSuccess(e){this.websocketURL=e,this.initConnected=!0,this.state=1}onSignallingSuccess(){this.wsConnected=!0,this.state=2}onJoin(e){var t,n;this.sdkListener.onJoin(e),null==(t=this.sdk.getWebrtcInternals())||t.onStatsChange((e=>this.statsCollector.handleStatsUpdate(e))),null==(n=this.sdk.getWebrtcInternals())||n.start(),this.cleanupTimer=window.setTimeout((()=>{this.cleanupAndReport()}),this.connectivityDuration)}onError(e){this.sdkListener.onError(e),this.errors.push(e),null!=e&&e.isTerminal&&this.cleanupAndReport()}onTrackUpdate(e,t,n){if(this.sdkListener.onTrackUpdate(e,t,n),n.isLocal&&0===e){switch(t.type){case"audio":this.isAudioTrackCaptured=!0;break;case"video":this.isVideoTrackCaptured=!0}this.isVideoTrackCaptured&&this.isAudioTrackCaptured&&(this.state=4)}}onReconnecting(e){this.sdkListener.onReconnecting(e),this.cqsCalculator.addPendingCQSTillNow()}cleanupAndReport(){var e;clearTimeout(this.cleanupTimer),this.cleanupTimer=void 0,5===this.state&&(this.state=6),null==(e=this.completionCallback)||e.call(this,this.buildReport()),this.sdk.leave()}buildReport(){this.cqsCalculator.addPendingCQSTillNow();let e=this.cqsCalculator.getCQS(),t=this.statsCollector.buildReport();return{testTimestamp:this.timestamp,connectivityState:this.state,errors:this.errors,signallingReport:{isConnected:this.wsConnected,isInitConnected:this.initConnected,websocketUrl:this.websocketURL},mediaServerReport:{stats:t,connectionQualityScore:e,isPublishICEConnected:this.isPublishICEConnected,isSubscribeICEConnected:this.isSubscribeICEConnected,publishICECandidatePairSelected:this.selectedPublishICECandidate,subscribeICECandidatePairSelected:this.selectedSubscribeICECandidate,publishIceCandidatesGathered:this.gatheredPublishICECandidates,subscribeIceCandidatesGathered:this.gatheredSubscribeICECandidates}}}},MR=class{constructor(e){this.recording={server:{running:!1},browser:{running:!1},hls:{running:!1}},this.rtmp={running:!1},this.hls={running:!1,variants:[]},this.transcriptions=[],this.id=e}},jR=(e,t,n)=>OC(void 0,null,(function*(){let i=Error("something went wrong during fetch");for(let s=0;s<4;s++)try{let i=yield fetch(e,t),r=yield i.clone().json();if(n&&n.length&&!i.ok&&n.includes(r.code))throw IP.APIErrors.ServerErrors(r.code,"GET_TOKEN",r.message,!1);return i}catch(r){i=r}throw["Failed to fetch","NetworkError"].some((e=>i.message.includes(e)))?IP.APIErrors.EndpointUnreachable("GET_TOKEN",i.message):i})),FR=class{constructor(e,t){this.sdk=e,this.sdkListener=t,this.recordedAudio="https://100ms.live/test-audio.wav",this.sdk.setIsDiagnostics(!0),this.initSdkWithLocalPeer()}get localPeer(){var e;return null==(e=this.sdk)?void 0:e.store.getLocalPeer()}checkBrowserSupport(){NP(),RP()}requestPermission(e){return OC(this,null,(function*(){try{let t=yield navigator.mediaDevices.getUserMedia(e);return t.getTracks().forEach((e=>e.stop())),yield this.sdk.deviceManager.init(!0),{audio:t.getAudioTracks().length>0,video:t.getVideoTracks().length>0}}catch(wC){throw QP(wC,this.sdk.localTrackManager.getErrorType(!!e.video,!!e.audio))}}))}startCameraCheck(e){return OC(this,null,(function*(){var t,n,i,r;if(this.initSdkWithLocalPeer(),!this.localPeer)throw new Error("Local peer not found");this.sdk.store.setSimulcastEnabled(!1),this.localPeer.role=NC(RC({},_R),{publishParams:NC(RC({},_R.publishParams),{allowed:["video"]})});let s=(new TA).video((new wA).deviceId(e||"default").build()).build(),o=yield null==(t=this.sdk)?void 0:t.localTrackManager.getLocalTracks({audio:!1,video:!0},s),a=null==o?void 0:o.find((e=>"video"===e.type));if(!a)throw new Error("No video track found");null==(n=this.sdk)||n.deviceManager.init(!0),this.localPeer.videoTrack=a,null==(r=null==(i=this.sdk)?void 0:i.listener)||r.onPeerUpdate(9,[this.localPeer])}))}stopCameraCheck(){var e,t;null==(t=null==(e=this.localPeer)?void 0:e.videoTrack)||t.cleanup(),this.localPeer&&(this.localPeer.videoTrack=void 0)}startMicCheck(e){return OC(this,arguments,(function(e){var t=this;let{inputDevice:n,onError:i,onStop:r,time:s=AR}=e;return function*(){var e,o,a,l;t.initSdkWithLocalPeer((e=>{t.stopMicCheck(),null==i||i(e)}));let c=yield t.getLocalAudioTrack(n);if(null==(e=t.sdk)||e.deviceManager.init(!0),!t.localPeer)throw new Error("Local peer not found");if(!c)throw new Error("No audio track found");t.localPeer.audioTrack=c,null==(o=t.sdk)||o.initPreviewTrackAudioLevelMonitor(),null==(l=null==(a=t.sdk)?void 0:a.listener)||l.onPeerUpdate(9,[t.localPeer]),t.mediaRecorder=new MediaRecorder(c.stream.nativeStream);let u=[];t.mediaRecorder.ondataavailable=function(e){u.push(e.data)},t.mediaRecorder.onstop=()=>{var e,n;let i=new Blob(u,{type:null==(e=t.mediaRecorder)?void 0:e.mimeType});t.recordedAudio=URL.createObjectURL(i),null==(n=t.onStopMicCheck)||n.call(t)},t.mediaRecorder.start();let d=setTimeout((()=>{t.stopMicCheck()}),s);t.onStopMicCheck=()=>{clearTimeout(d),null==r||r()}}()}))}stopMicCheck(){var e,t,n;null==(e=this.mediaRecorder)||e.stop(),null==(n=null==(t=this.localPeer)?void 0:t.audioTrack)||n.cleanup(),this.localPeer&&(this.localPeer.audioTrack=void 0)}getRecordedAudio(){return this.recordedAudio}startConnectivityCheck(e,t,n,i){return OC(this,null,(function*(){if(!this.sdk)throw new Error("SDK not found");this.connectivityCheck=new OR(this.sdk,this.sdkListener,e,t,i);let r=yield this.getAuthToken(n);yield this.sdk.leave(),yield this.sdk.join({authToken:r,userName:"diagnostics-test"},this.connectivityCheck),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:e=>{var t;null==(t=this.connectivityCheck)||t.handleConnectionQualityUpdate(e)}})}))}stopConnectivityCheck(){return OC(this,null,(function*(){var e;return null==(e=this.connectivityCheck)?void 0:e.cleanupAndReport()}))}initSdkWithLocalPeer(e){var t,n,i;this.sdkListener&&(null==(t=this.sdk)||t.initStoreAndManagers(NC(RC({},this.sdkListener),{onError:t=>{null==e||e(t),this.sdkListener.onError(t)}})));let r=new M_({name:"diagnostics-peer",role:_R,type:"regular"});null==(n=this.sdk)||n.store.addPeer(r);let s=new MR("diagnostics-room");this.sdk.store.setRoom(s),this.sdkListener.onRoomUpdate("ROOM_PEER_COUNT_UPDATED",s),null==(i=this.sdk)||i.deviceManager.init(!0)}getAuthToken(e){return OC(this,null,(function*(){let t=new URL("https://api.100ms.live/v2/diagnostics/token");e&&t.searchParams.append("region",e);let n=yield jR(t.toString(),{method:"GET"},[429,500,501,502,503,504,505,506,507,508,509,510,511]),i=yield n.json();if(!n.ok)throw IP.APIErrors.ServerErrors(i.code,"GET_TOKEN",i.message,!1);let{token:r}=i;if(!r)throw Error(i.message);return r}))}getLocalAudioTrack(e){return OC(this,null,(function*(){var t;if(!this.localPeer)return;this.localPeer.role=NC(RC({},_R),{publishParams:NC(RC({},_R.publishParams),{allowed:["audio"]})});let n=(new TA).audio((new yA).deviceId(e||"default").build()).build(),i=yield null==(t=this.sdk)?void 0:t.localTrackManager.getLocalTracks({audio:!0,video:!1},n);return null==i?void 0:i.find((e=>"audio"===e.type))}))}},UR=class{constructor(e,t,n){this.isRoomJoinCalled=!1,this.ignoredMessageTypes=[],this.setProgress=e=>{let{type:t,progress:n}=e;this.setState((e=>{e.playlist[t].progress=n,e.playlist[t].currentTime=this.sdk.getPlaylistManager().getCurrentTime(t)}),"playlistProgress")},this.syncPlaylistState=e=>{this.setState((e=>{Object.assign(e.playlist,ER.convertPlaylist(this.sdk.getPlaylistManager()))}),e)},this.sendPeerUpdateNotification=(e,t)=>{let n=this.store.getState(qx(t.peerId)),i=lR[e]||"peerUpdate";if(8===e)this.syncRoomState(i),this.updateMidCallPreviewRoomState(e,t);else if([0,1].includes(e))this.syncRoomState(i),n||(n=this.store.getState(qx(t.peerId)));else if([12,13,14].includes(e))this.syncRoomState(i),n||(n=this.store.getState(qx(t.peerId)));else{let e=ER.convertPeer(t);this.setState((t=>{let i=t.peers[e.id];bR(i,e)&&(TR(i.auxiliaryTracks,e.auxiliaryTracks)&&(i.auxiliaryTracks=e.auxiliaryTracks),Object.assign(i,e)),n=e}),i)}this.hmsNotifications.sendPeerUpdate(e,n)},this.getSDKHMSPeer=e=>this.sdk.getPeerMap()[e],this.setState=(e,t)=>this.store.namedSetState(e,t),this.store=e,this.sdk=t,this.hmsNotifications=n,this.sessionStore=new CR(this.sdk,this.setSessionStoreValueLocally.bind(this)),this.actionBatcher=new fR(e)}submitSessionFeedback(e,t){return this.sdk.submitSessionFeedback(e,t)}getLocalTrack(e){return this.sdk.store.getLocalPeerTracks().find((t=>t.trackId===e))}get interactivityCenter(){return this.sdk.getInteractivityCenter()}setPlaylistSettings(e){this.sdk.updatePlaylistSettings(e)}refreshDevices(){return OC(this,null,(function*(){yield this.sdk.refreshDevices()}))}unblockAudio(){return OC(this,null,(function*(){yield this.sdk.getAudioOutput().unblockAutoplay()}))}setVolume(e,t){return OC(this,null,(function*(){t?yield this.setTrackVolume(e,t):(yield this.sdk.getAudioOutput().setVolume(e),this.syncRoomState("setOutputVolume"))}))}setAudioOutputDevice(e){return OC(this,null,(function*(){(yield this.sdk.getAudioOutput().setDevice(e))&&this.setState((t=>{t.settings.audioOutputDeviceId=e}),"setAudioOutputDevice")}))}setPreferredLayer(e,t){return OC(this,null,(function*(){var n;let i=this.getTrackById(e);if(i)if(i instanceof w_){if("none"===t)return void Lx.d("layer none will be ignored");if((null==(n=this.store.getState(Wx(e)))?void 0:n.preferredLayer)===t)return void Lx.d(`preferred layer is already ${t}`);this.setState((n=>{let i=n.tracks[e];i&&(i.preferredLayer=t)}),"setPreferredLayer"),yield i.setPreferredLayer(t)}else Lx.d(`track ${e} is not a remote video track`);else this.logPossibleInconsistency(`track ${e} not present, unable to set preffer layer`)}))}getNativeTrackById(e){var t;return null==(t=this.sdk.store.getTrackById(e))?void 0:t.nativeTrack}getTrackById(e){return this.sdk.store.getTrackById(e)}getAuthTokenByRoomCode(e,t){return this.sdk.getAuthTokenByRoomCode(e,t)}preview(e){return OC(this,null,(function*(){let t=this.store.getState(gx);if("Preview"!==t&&"Connecting"!==t)try{"Connected"!==t&&this.setState((e=>{e.room.roomState="Connecting"}),"connecting"),yield this.sdkPreviewWithListeners(e)}catch(lP){throw Lx.e("Cannot show preview. Failed to connect to room - ",lP),lP}else this.logPossibleInconsistency("attempting to call preview while room is in preview/connecting")}))}cancelMidCallPreview(){return OC(this,null,(function*(){return this.sdk.cancelMidCallPreview()}))}join(e){return OC(this,null,(function*(){if(this.isRoomJoinCalled)this.logPossibleInconsistency("room join is called again");else try{this.isRoomJoinCalled=!0,this.setState((e=>{e.room.roomState="Connecting"}),"join"),yield this.sdkJoinWithListeners(e)}catch(wC){throw this.isRoomJoinCalled=!1,Lx.e("Failed to connect to room - ",wC),wC}}))}leave(){return OC(this,null,(function*(){let e=!0;this.store.getState(ex)||(e=!1,this.logPossibleInconsistency("room leave is called when no room is connected"));let t=this.store.getState(gx);return this.setState((e=>{e.room.roomState="Disconnecting"}),"leaving"),this.sdk.leave(e).then((()=>{this.resetState("leave"),this.beamSpeakerLabelsLogger&&this.beamSpeakerLabelsLogger.stop().catch(Lx.e),Lx.i("left room")})).catch((e=>{Lx.e("error in leaving room - ",e),this.setState((e=>{e.room.roomState=t}),"revertLeave")}))}))}setScreenShareEnabled(e,t){return OC(this,null,(function*(){"boolean"==typeof t&&(t={audioOnly:t});try{e?yield this.startScreenShare(t):yield this.stopScreenShare()}catch(lP){throw this.hmsNotifications.sendError(ER.convertException(lP)),lP}}))}addTrack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regular";return OC(this,null,(function*(){yield this.sdk.addTrack(e,t),this.syncRoomState("addTrack")}))}removeTrack(e){return OC(this,null,(function*(){yield this.sdk.removeTrack(e),this.syncRoomState("removeTrack")}))}setLocalAudioEnabled(e){return OC(this,null,(function*(){let t=this.store.getState(sx);t&&(yield this.setEnabledTrack(t,e))}))}setLocalVideoEnabled(e){return OC(this,null,(function*(){let t=this.store.getState(ox);t&&(yield this.setEnabledTrack(t,e))}))}setEnabledTrack(e,t){return OC(this,null,(function*(){var n;if((null==(n=this.store.getState().tracks[e])?void 0:n.enabled)===t)return void this.logPossibleInconsistency(`local track[${e}] enabled state - ${t}`);this.setState((n=>{n.tracks[e]?n.tracks[e].displayEnabled=t:this.logPossibleInconsistency("track id not found for setEnabled")}),"displayEnabled");try{yield this.setEnabledSDKTrack(e,t),this.syncRoomState("setEnabled")}catch(r){throw this.setState((n=>{n.tracks[e].displayEnabled=!t}),"rollbackDisplayEnabled"),this.hmsNotifications.sendError(ER.convertException(r)),r}let i=t?3:2;this.hmsNotifications.sendTrackUpdate(i,e)}))}setAudioSettings(e){return OC(this,null,(function*(){let t=this.store.getState(sx);t&&(yield this.setSDKLocalAudioTrackSettings(t,e),this.syncRoomState("setAudioSettings"))}))}setVideoSettings(e){return OC(this,null,(function*(){let t=this.store.getState(ox);t&&(yield this.setSDKLocalVideoTrackSettings(t,e),this.syncRoomState("setVideoSettings"))}))}switchCamera(){return OC(this,null,(function*(){let e=this.store.getState(ox);if(e){let t=this.sdk.store.getLocalPeerTracks().find((t=>t.trackId===e));t&&(yield t.switchCamera(),this.syncRoomState("switchCamera"))}}))}sendMessage(e){this.sendBroadcastMessage(e)}sendBroadcastMessage(e,t){return OC(this,null,(function*(){let{message_id:n,timestamp:i}=yield this.sdk.sendBroadcastMessage(e,t);this.updateMessageInStore({message:e,type:t,id:n,time:i})}))}sendGroupMessage(e,t,n){return OC(this,null,(function*(){let i=this.store.getState(yx),r=t.map((e=>i[e])),{message_id:s,timestamp:o}=yield this.sdk.sendGroupMessage(e,r,n);this.updateMessageInStore({message:e,recipientRoles:t,type:n,id:s,time:o})}))}sendDirectMessage(e,t,n){return OC(this,null,(function*(){let{message_id:i,timestamp:r}=yield this.sdk.sendDirectMessage(e,t,n);this.updateMessageInStore({message:e,recipientPeer:t,type:n,id:i,time:r})}))}updateMessageInStore(e){var t;if(!e.message)throw Lx.w("sendMessage","Failed to send message",e),Error(`sendMessage Failed - ${JSON.stringify(e)}`);if(e.type&&this.ignoredMessageTypes.includes(e.type))return;let n=this.sdk.getLocalPeer(),i={read:!0,id:e.id,time:new Date(e.time),message:e.message,type:e.type||"chat",recipientPeer:e.recipientPeer,recipientRoles:e.recipientRoles,senderName:null==n?void 0:n.name,sender:null==n?void 0:n.peerId,senderRole:null==(t=null==n?void 0:n.role)?void 0:t.name,ignored:!1};this.setState((e=>{e.messages.byID[i.id]=i,e.messages.allIDs.push(i.id)}),"newMessage")}setMessageRead(e,t){this.setState((n=>{t?n.messages.byID[t]?n.messages.byID[t].read=e:this.logPossibleInconsistency("no message with id is found"):n.messages.allIDs.forEach((t=>{n.messages.byID[t].read=e}))}),"setMessageRead")}attachVideo(e,t){return OC(this,null,(function*(){if(this.localAndVideoUnmuting(e))return new Promise((n=>{let i=this.store.subscribe((r=>OC(this,null,(function*(){r&&(yield this.attachVideoInternal(e,t),i(),n())}))),ux)}));yield this.attachVideoInternal(e,t)}))}detachVideo(e,t){return OC(this,null,(function*(){let n=this.getTrackById(e);"video"===(null==n?void 0:n.type)?yield this.sdk.detachVideo(n,t):(t&&(t.srcObject=null),Lx.d("possible inconsistency detected - no video track found to remove sink"))}))}addPluginToVideoTrack(e,t){return OC(this,null,(function*(){return this.addRemoveVideoPlugin(e,"add",t)}))}addPluginsToVideoStream(e){return OC(this,null,(function*(){return this.addRemoveMediaStreamVideoPlugins(e,"add")}))}removePluginsFromVideoStream(e){return OC(this,null,(function*(){return this.addRemoveMediaStreamVideoPlugins(e,"remove")}))}addPluginToAudioTrack(e){return OC(this,null,(function*(){return this.addRemoveAudioPlugin(e,"add")}))}validateVideoPluginSupport(e){let t={isSupported:!1};if(!e)return Lx.w("no plugin passed in for checking support"),t.errMsg="no plugin passed in for checking support",t;let n=this.store.getState(ox);if(!n)return Lx.w("video Track not added to local peer yet"),t.errMsg="call this function only after local peer has video track",t;let i=this.getTrackById(n);return i?t=i.validatePlugin(e):(Lx.w(`track ${n} not present, unable to validate plugin`),t.errMsg=`track ${n} not present, unable to validate plugin`),t}validateAudioPluginSupport(e){let t={isSupported:!1};if(!e)return Lx.w('no plugin passed in for checking support"'),t.errMsg='no plugin passed in for checking support"',t;let n=this.store.getState(sx);if(!n)return Lx.w("audio track not added to local peer yet"),t.errMsg="call this function only after local peer has audio track",t;let i=this.getTrackById(n);return i?t=i.validatePlugin(e):(Lx.w(`track ${n} not present, unable to validate plugin`),t.errMsg=`track ${n} not present, unable to validate plugin`),t}removePluginFromVideoTrack(e){return OC(this,null,(function*(){return this.addRemoveVideoPlugin(e,"remove")}))}removePluginFromAudioTrack(e){return OC(this,null,(function*(){return this.addRemoveAudioPlugin(e,"remove")}))}changeRole(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return OC(this,null,(function*(){yield this.sdk.changeRoleOfPeer(e,t,n)}))}changeRoleOfPeer(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return OC(this,null,(function*(){yield this.sdk.changeRoleOfPeer(e,t,n)}))}changeRoleOfPeersWithRoles(e,t){return OC(this,null,(function*(){let n=this.sdk.getRoles().filter((t=>e.includes(t.name)));yield this.sdk.changeRoleOfPeersWithRoles(n,t)}))}acceptChangeRole(e){return OC(this,null,(function*(){let t=e.requestedBy?this.getSDKHMSPeer(e.requestedBy.id):void 0;t||Lx.w(`peer for which role change is requested no longer available - ${e.requestedBy}`);let n={requestedBy:t,role:e.role,token:e.token};yield this.sdk.acceptChangeRole(n),this.removeRoleChangeRequest(e)}))}raiseLocalPeerHand(){return OC(this,null,(function*(){yield this.sdk.raiseLocalPeerHand()}))}lowerLocalPeerHand(){return OC(this,null,(function*(){yield this.sdk.lowerLocalPeerHand()}))}raiseRemotePeerHand(e){return OC(this,null,(function*(){yield this.sdk.raiseRemotePeerHand(e)}))}lowerRemotePeerHand(e){return OC(this,null,(function*(){yield this.sdk.lowerRemotePeerHand(e)}))}getPeer(e){return OC(this,null,(function*(){let t=yield this.sdk.getPeer(e);if(t)return ER.convertPeer(t)}))}findPeerByName(e){return OC(this,null,(function*(){let{offset:t,peers:n,eof:i}=yield this.sdk.findPeerByName(e);return{offset:t,eof:i,peers:n.map((e=>ER.convertPeer(e)))}}))}getPeerListIterator(e){let t=this.sdk.getPeerListIterator(e);return{hasNext:()=>t.hasNext(),next:()=>OC(this,null,(function*(){return(yield t.next()).map((e=>ER.convertPeer(e)))})),findPeers:()=>OC(this,null,(function*(){return(yield t.findPeers()).map((e=>ER.convertPeer(e)))})),getTotal:()=>t.getTotal()}}initAppData(e){this.setState((t=>{t.appData=e}),"initAppData")}setAppData(e,t,n){let i="Object"===(null==t?void 0:t.constructor.name);this.setState((r=>{if(r.appData)n&&i?Object.assign(r.appData[e],t):r.appData[e]=t;else{let n={[e]:t};r.appData=n}}),`setAppData-${e}`)}rejectChangeRole(e){this.removeRoleChangeRequest(e)}endRoom(e,t){return OC(this,null,(function*(){let n=this.store.getState(kx);if(null==n||!n.endRoom)return void Lx.w("You are not allowed to perform this action - endRoom");let i=this.store.getState(gx);this.setState((e=>{e.room.roomState="Disconnecting"}),"endingRoom");try{yield this.sdk.endRoom(e,t),this.resetState("endRoom")}catch(tN){Lx.e("error in ending room - ",tN),this.setState((e=>{e.room.roomState=i}),"revertEndRoom")}}))}removePeer(e,t){return OC(this,null,(function*(){var n;let i=null==(n=this.sdk.getLocalPeer())?void 0:n.peerId;e!==i&&(yield this.sdk.removePeer(e,t))}))}startRTMPOrRecording(e){return OC(this,null,(function*(){yield this.sdk.startRTMPOrRecording(e)}))}stopRTMPAndRecording(){return OC(this,null,(function*(){yield this.sdk.stopRTMPAndRecording()}))}startHLSStreaming(e){return OC(this,null,(function*(){yield this.sdk.startHLSStreaming(e)}))}stopHLSStreaming(e){return OC(this,null,(function*(){yield this.sdk.stopHLSStreaming(e)}))}startTranscription(e){return OC(this,null,(function*(){yield this.sdk.startTranscription(e)}))}stopTranscription(e){return OC(this,null,(function*(){yield this.sdk.stopTranscription(e)}))}sendHLSTimedMetadata(e){return OC(this,null,(function*(){yield this.sdk.sendHLSTimedMetadata(e)}))}changeName(e){return OC(this,null,(function*(){yield this.sdk.changeName(e)}))}changeMetadata(e){return OC(this,null,(function*(){"string"!=typeof e&&(e=JSON.stringify(e)),yield this.sdk.changeMetadata(e)}))}setSessionMetadata(e){return OC(this,null,(function*(){yield this.sdk.setSessionMetadata(e),this.setState((t=>{t.sessionMetadata=e}),"setSessionMetadata"),this.setSessionStoreValueLocally({key:"default",value:e},"setSessionMetadata")}))}populateSessionMetadata(){return OC(this,null,(function*(){let e=yield this.sdk.getSessionMetadata();this.setState((t=>{t.sessionMetadata=e}),"populateSessionMetadata"),this.setSessionStoreValueLocally({key:"default",value:e},"populateSessionmetadata")}))}setRemoteTrackEnabled(e,t){return OC(this,null,(function*(){if("string"==typeof e){let n=this.getTrackById(e);n&&function(e){return e instanceof AA||e instanceof w_}(n)?yield this.sdk.changeTrackState(n,t):this.logPossibleInconsistency(`No remote track with ID ${e} found for change track state`)}else Array.isArray(e)&&e.forEach((e=>this.setRemoteTrackEnabled(e,t)))}))}setRemoteTracksEnabled(e){return OC(this,null,(function*(){let t={enabled:e.enabled,type:e.type,source:e.source};if(e.roles){let n=this.store.getState(yx);t.roles=e.roles.map((e=>n[e]))}yield this.sdk.changeMultiTrackState(t)}))}setLogLevel(e){Lx.level=e,this.sdk.setLogLevel(e)}setFrameworkInfo(e){this.sdk.setFrameworkInfo(e)}ignoreMessageTypes(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])this.ignoredMessageTypes=e;else for(let t of e)this.ignoredMessageTypes.includes(t)||this.ignoredMessageTypes.push(t)}enableBeamSpeakerLabelsLogging(){return OC(this,null,(function*(){this.beamSpeakerLabelsLogger||(Lx.i("enabling beam speaker labels logging"),this.beamSpeakerLabelsLogger=new PR(this.store,this),yield this.beamSpeakerLabelsLogger.start())}))}initDiagnostics(){let e=new FR(this.sdk,{onJoin:this.onJoin.bind(this),onPreview:this.onPreview.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this),onMessageReceived:this.onMessageReceived.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onRoleChangeRequest:this.onRoleChangeRequest.bind(this),onRoleUpdate:this.onRoleUpdate.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onChangeTrackStateRequest:this.onChangeTrackStateRequest.bind(this),onChangeMultiTrackStateRequest:this.onChangeMultiTrackStateRequest.bind(this),onRemovedFromRoom:this.onRemovedFromRoom.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onSessionStoreUpdate:this.onSessionStoreUpdate.bind(this),onPollsUpdate:this.onPollsUpdate.bind(this),onWhiteboardUpdate:this.onWhiteboardUpdate.bind(this)});return this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)}),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:this.onConnectionQualityUpdate.bind(this)}),e}resetState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"resetState";this.isRoomJoinCalled=!1,Lx.cleanup(),this.setState((e=>{Object.assign(e,{room:{id:"",isConnected:!1,name:"",peers:[],localPeer:"",roomState:"Disconnected",recording:{browser:{running:!1},server:{running:!1},hls:{running:!1}},rtmp:{running:!1},hls:{running:!1,variants:[]},sessionId:""},peers:{},tracks:{},playlist:{audio:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1},video:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1}},messages:{byID:{},allIDs:[]},speakers:{},connectionQualities:{},settings:{audioInputDeviceId:"",audioOutputDeviceId:"",videoInputDeviceId:""},devices:{audioInput:[],audioOutput:[],videoInput:[]},roles:{},roleChangeRequests:[],errors:[],sessionStore:{},templateAppData:{},polls:{},whiteboards:{},hideLocalPeer:!1})}),e)}getDebugInfo(){return this.sdk.getDebugInfo()}sdkJoinWithListeners(e){return OC(this,null,(function*(){yield this.sdk.join(e,{onJoin:this.onJoin.bind(this),onPreview:this.onPreview.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this),onMessageReceived:this.onMessageReceived.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onRoleChangeRequest:this.onRoleChangeRequest.bind(this),onRoleUpdate:this.onRoleUpdate.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onChangeTrackStateRequest:this.onChangeTrackStateRequest.bind(this),onChangeMultiTrackStateRequest:this.onChangeMultiTrackStateRequest.bind(this),onRemovedFromRoom:this.onRemovedFromRoom.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onSessionStoreUpdate:this.onSessionStoreUpdate.bind(this),onPollsUpdate:this.onPollsUpdate.bind(this),onWhiteboardUpdate:this.onWhiteboardUpdate.bind(this),onSFUMigration:this.onSFUMigration.bind(this)}),this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)}),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:this.onConnectionQualityUpdate.bind(this)})}))}onSFUMigration(){this.syncRoomState("SFUMigration")}onRemovedFromRoom(e){var t;let n=this.store.getState(qx(null==(t=e.requestedBy)?void 0:t.peerId));this.hmsNotifications.sendLeaveRoom(NC(RC({},e),{requestedBy:n||void 0}));let i=e.roomEnded||!n?"roomEnded":"removedFromRoom";Lx.i(`resetting state after peer removed ${i}`,e),this.resetState(i)}onDeviceChange(e){let t=e.devices;if(!t)return;let n=this.store.getState(ix);if(this.setState((e=>{TR(e.devices.audioInput,t.audioInput)||(e.devices.audioInput=t.audioInput),TR(e.devices.videoInput,t.videoInput)||(e.devices.videoInput=t.videoInput),TR(e.devices.audioOutput,t.audioOutput)||(e.devices.audioOutput=t.audioOutput);let i=this.sdk.getLocalPeer();null!=n&&n.id&&i&&Object.assign(e.settings,this.getMediaSettings(i))}),"deviceChange"),e.selection&&!e.internal){let t=ER.convertDeviceChangeUpdate(e);this.hmsNotifications.sendDeviceChange(t)}}sdkPreviewWithListeners(e){return OC(this,null,(function*(){yield this.sdk.preview(e,{onPreview:this.onPreview.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this)}),this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)})}))}onNetworkQuality(e){this.setState((t=>{var n;let i=t.room.localPeer||(null==(n=this.sdk.getLocalPeer())?void 0:n.peerId);i&&(t.connectionQualities[i]={peerID:i,downlinkQuality:e})}),"ConnectionQuality")}onSessionStoreUpdate(e){this.setSessionStoreValueLocally(e,"sessionStoreUpdate")}onPollsUpdate(e,t){let n=uR[e];this.setState((e=>{let n=t.reduce(((e,t)=>{var n;return e[t.id]=NC(RC({},t),{questions:null==(n=t.questions)?void 0:n.map((e=>{var t,n;return NC(RC({},e),{answer:e.answer?RC({},e.answer):void 0,options:null==(t=e.options)?void 0:t.map((e=>RC({},e))),responses:null==(n=e.responses)?void 0:n.map((e=>RC({},e)))})}))}),e}),{});((e,t)=>{let n=SR(Object.keys(e),Object.keys(t));for(let i of n){let n=e[i],r=t[i];bR(n,r)?(n.questions&&TR(n.questions,r.questions)&&(r.questions=n.questions),Object.assign(n,r)):kR(n,r)&&(e[i]=r)}})(e.polls,n)}),n),t.forEach((t=>this.hmsNotifications.sendPollUpdate(e,t.id)))}onWhiteboardUpdate(e){this.setState((t=>{t.whiteboards[e.id]=e}),"whiteboardUpdate")}startScreenShare(e){return OC(this,null,(function*(){this.store.getState(hx)?this.logPossibleInconsistency("start screenshare is called while it's on"):(yield this.sdk.startScreenShare((()=>this.syncRoomState("screenshareStopped")),e),this.syncRoomState("startScreenShare"))}))}stopScreenShare(){return OC(this,null,(function*(){this.store.getState(hx)?(yield this.sdk.stopScreenShare(),this.syncRoomState("stopScreenShare")):this.logPossibleInconsistency("stop screenshare is called while it's not on")}))}attachVideoInternal(e,t){return OC(this,null,(function*(){let n=this.getTrackById(e);n||(n=this.getLocalTrack(e)),n&&"video"===n.type?yield this.sdk.attachVideo(n,t):this.logPossibleInconsistency("no video track found to add sink")}))}syncRoomState(e){e=`${e}_fullSync`,Lx.time(`store-sync-${e}`);let t,n={},i=[],r={},s={},o={},a=this.sdk.getPeers();for(let h of a){let e=ER.convertPeer(h);n[e.id]=e,i.push(e.id),o[e.id]={peerID:e.id,downlinkQuality:h.networkQuality||-1};let a=[h.audioTrack,h.videoTrack,...h.auxiliaryTracks];for(let t of a){if(!t)continue;let e=ER.convertTrack(t);r[e.id]=e}if(h.isLocal){let e=h;t=this.getPreviewFields(e),Object.assign(s,this.getMediaSettings(e))}}let l=this.sdk.getRecordingState(),c=this.sdk.getRTMPState(),u=this.sdk.getHLSState(),d=this.sdk.getTranscriptionState();this.setState((e=>{var a;e.room.peers=i;let h=e.peers,p=e.tracks;((e,t)=>{let n=SR(Object.keys(e),Object.keys(t));for(let i of n){let n=e[i],r=t[i];bR(n,r)?(TR(n.auxiliaryTracks,r.auxiliaryTracks)&&(r.auxiliaryTracks=n.auxiliaryTracks),n.groups&&TR(n.groups,r.groups)&&(r.groups=n.groups),Object.assign(n,r)):wR(n,r)?delete e[i]:kR(n,r)&&(e[i]=r)}})(h,n),((e,t)=>{let n=SR(Object.keys(e),Object.keys(t));for(let i of n){let n=e[i],r=t[i];bR(n,r)?(yR(n,r),Object.assign(n,r)):wR(n,r)?delete e[i]:kR(n,r)&&(e[i]=r)}})(p,r),Object.assign(e.settings,s),e.room.isConnected&&Object.assign(e.connectionQualities,o),null!=(a=e.preview)&&a.localPeer&&null!=t&&t.localPeer?Object.assign(e.preview,t):e.preview=t,Object.assign(e.roles,ER.convertRoles(this.sdk.getRoles())),Object.assign(e.playlist,ER.convertPlaylist(this.sdk.getPlaylistManager())),Object.assign(e.room,ER.convertRecordingStreamingState(l,c,u,d)),Object.assign(e.templateAppData,this.sdk.getTemplateAppData())}),e),Lx.timeEnd(`store-sync-${e}`)}onPreview(e){this.setState((t=>{var n;Object.assign(t.room,ER.convertRoom(e,null==(n=this.sdk.getLocalPeer())?void 0:n.peerId)),t.room.roomState="Preview"}),"previewStart"),this.syncRoomState("previewSync")}onJoin(e){let t=this.sdk.getPlaylistManager();this.audioPlaylist=new IR(t,"audio",this.syncPlaylistState.bind(this),this.store),this.videoPlaylist=new IR(t,"video",this.syncRoomState.bind(this),this.store),this.syncRoomState("joinSync"),this.setState((t=>{var n;Object.assign(t.room,ER.convertRoom(e,null==(n=this.sdk.getLocalPeer())?void 0:n.peerId)),t.room.isConnected=!0,t.room.roomState="Connected"}),"joined"),t.onProgress(this.setProgress),t.onNewTrackStart((e=>{this.syncPlaylistState(`${e.type}PlaylistUpdate`)})),t.onPlaylistEnded((e=>{this.syncPlaylistState(`${e}PlaylistEnded`)})),t.onCurrentTrackEnded((e=>{this.hmsNotifications.sendPlaylistTrackEnded(ER.convertPlaylistItem(t,e)),this.syncPlaylistState(`${e.type}PlaylistItemEnded`)}))}onRoomUpdate(e,t){this.setState((e=>{var n;Object.assign(e.room,ER.convertRoom(t,null==(n=this.sdk.getLocalPeer())?void 0:n.peerId))}),e),"TRANSCRIPTION_STATE_UPDATED"===e&&this.hmsNotifications.sendTranscriptionUpdate(t.transcriptions)}onPeerUpdate(e,t){if(![4,5].includes(e)){if(Array.isArray(t)){let e=this.store.getState(K_),n=t.filter((t=>!e[t.peerId]));if(this.syncRoomState("peersJoined"),this.store.getState(ex)){let e=[];for(let n of t){let t=this.store.getState(qx(n.peerId));t&&e.push(t)}this.hmsNotifications.sendPeerList(e)}else n.forEach((e=>{let t=this.store.getState(qx(e.peerId));t&&this.hmsNotifications.sendPeerUpdate(0,t)}));return}this.sendPeerUpdateNotification(e,t)}}onTrackUpdate(e,t,n){if(1===e)this.hmsNotifications.sendTrackUpdate(e,t.trackId),this.handleTrackRemove(t,n);else if([0,1].includes(e)){let n=cR[e];this.syncRoomState(n),this.hmsNotifications.sendTrackUpdate(e,t.trackId)}else{let n=cR[e]||"trackUpdate",i=ER.convertTrack(t);this.setState((e=>{let t=e.tracks[i.id];bR(t,i)&&(yR(t,i),Object.assign(t,i))}),n),this.hmsNotifications.sendTrackUpdate(e,t.trackId)}}onMessageReceived(e){let t=ER.convertMessage(e,this.store.getState(rx));t.read=!1,t.ignored=this.ignoredMessageTypes.includes(t.type),"hms_transcript"===t.type&&(t.ignored=!0),this.putMessageInStore(t),this.hmsNotifications.sendMessageReceived(t)}putMessageInStore(e){e.ignored||this.actionBatcher.setState((t=>{t.messages.byID[e.id]=e,t.messages.allIDs.push(e.id)}),"newMessage",150)}onAudioLevelUpdate(e){this.setState((t=>{let n={};e.forEach((e=>{if(!e.track||!e.peer)return;let i=e.track.trackId;n[i]=e.audioLevel,t.speakers[i]||(t.speakers[i]={audioLevel:e.audioLevel,peerID:e.peer.peerId,trackID:i})}));let i=Object.entries(t.speakers);for(let[e,r]of i)r.audioLevel=n[e]||0,0===r.audioLevel&&delete t.speakers[e]}),"audioLevel")}onConnectionQualityUpdate(e){this.setState((t=>{e.forEach((e=>{let n=e.peerID;n&&(t.connectionQualities[n]?Object.assign(t.connectionQualities[n],e):t.connectionQualities[n]=e)}))}),"connectionQuality")}onChangeTrackStateRequest(e){var t;let n=this.store.getState(qx(null==(t=e.requestedBy)?void 0:t.peerId)),i=this.getStoreLocalTrackIDfromSDKTrack(e.track),r=this.store.getState(Hx(i));if(!r)return this.logPossibleInconsistency(`Not found track for which track state change was requested, ${e.track}`);e.enabled||this.syncRoomState("changeTrackStateRequest"),this.hmsNotifications.sendChangeTrackStateRequest({requestedBy:n||void 0,track:r,enabled:e.enabled})}onChangeMultiTrackStateRequest(e){var t;let n=this.store.getState(qx(null==(t=e.requestedBy)?void 0:t.peerId));e.enabled||this.syncRoomState("changeMultiTrackStateRequest");let i=[],r=this.store.getState(Y_);for(let s of e.tracks){let e=this.getStoreLocalTrackIDfromSDKTrack(s);e&&r[e]&&i.push(r[e])}this.hmsNotifications.sendChangeMultiTrackStateRequest({requestedBy:n||void 0,tracks:i,enabled:e.enabled,type:e.type,source:e.source})}onReconnected(){this.syncRoomState("reconnectedSync"),this.hmsNotifications.sendReconnected(),this.setState((e=>{e.room.roomState=e.room.isConnected?"Connected":"Preview"}),"reconnected")}onReconnecting(e){let t=ER.convertException(e);Lx.e("Reconnection: received error from sdk",t),this.hmsNotifications.sendReconnecting(t),this.setState((e=>{e.room.roomState="Reconnecting",e.errors.push(t)}),"reconnecting")}onError(e){let t=ER.convertException(e);t.isTerminal?(this.leave().then((()=>Lx.e("error from SDK, left room."))),this.setState((e=>{e.room.roomState="Failed",e.errors.push(t)}),"errorTerminal")):this.store.getState().errors.length<50&&this.setState((e=>{e.errors.push(t)}),"error"),this.syncRoomState("errorSync"),this.hmsNotifications.sendError(t),Lx.e("received error from sdk",t instanceof wP?`${t}`:t)}handleTrackRemove(e,t){this.setState((n=>{let i=n.peers[t.peerId],r=n.tracks,s=e.trackId;if(i)if(s===i.audioTrack)delete i.audioTrack;else if(s===i.videoTrack)delete i.videoTrack;else{let e=i.auxiliaryTracks.indexOf(s);e>-1&&i.auxiliaryTracks.splice(e,1)}delete r[s]}),"trackRemoved")}setEnabledSDKTrack(e,t){return OC(this,null,(function*(){let n=this.getLocalTrack(e);n?yield n.setEnabled(t):this.logPossibleInconsistency(`track ${e} not present, unable to enabled/disable`)}))}setSDKLocalVideoTrackSettings(e,t){return OC(this,null,(function*(){let n=this.getLocalTrack(e);n?yield n.setSettings(t):this.logPossibleInconsistency(`local track ${e} not present, unable to set settings`)}))}setSDKLocalAudioTrackSettings(e,t){return OC(this,null,(function*(){let n=this.getLocalTrack(e);n?yield n.setSettings(t):this.logPossibleInconsistency(`local track ${e} not present, unable to set settings`)}))}getMediaSettings(e){var t;let n=this.store.getState(X_),i=e.audioTrack,r=e.videoTrack;return{audioInputDeviceId:(null==i?void 0:i.settings.deviceId)||n.audioInputDeviceId,videoInputDeviceId:(null==r?void 0:r.settings.deviceId)||n.videoInputDeviceId,audioOutputDeviceId:null==(t=this.sdk.getAudioOutput().getDevice())?void 0:t.deviceId,audioMode:(null==i?void 0:i.settings.audioMode)||"voice"}}getPreviewFields(e){var t,n;if(!e.isInPreview())return;let i=ER.convertPeer(e);return{localPeer:i.id,audioTrack:i.audioTrack,videoTrack:i.videoTrack,asRole:(null==(t=e.asRole)?void 0:t.name)||(null==(n=e.role)?void 0:n.name)}}setTrackVolume(e,t){return OC(this,null,(function*(){let n=this.getTrackById(t);n?n instanceof BP?(yield n.setVolume(e),this.setState((n=>{let i=n.tracks[t];i&&"audio"===i.type&&(i.volume=e)}),"trackVolume")):Lx.w(`track ${t} is not an audio track`):this.logPossibleInconsistency(`track ${t} not present, unable to set volume`)}))}localAndVideoUnmuting(e){let t=this.store.getState(ix);if((null==t?void 0:t.videoTrack)!==e)return!1;let n=this.store.getState(dx),i=this.store.getState(ux);return n&&!i}logPossibleInconsistency(e){Lx.w("possible inconsistency detected - ",e)}addRemoveVideoPlugin(e,t,n){return OC(this,null,(function*(){if(!e)return void Lx.w("Invalid plugin received in store");let i=this.store.getState(ox);if(i){let r=this.getLocalTrack(i);r?("add"===t?yield r.addPlugin(e,n):"remove"===t&&(yield r.removePlugin(e)),this.syncRoomState(`${t}VideoPlugin`)):this.logPossibleInconsistency(`track ${i} not present, unable to ${t} plugin`)}}))}addRemoveMediaStreamVideoPlugins(e,t){return OC(this,null,(function*(){if(0===e.length)return void Lx.w("Invalid plugin received in store");let n=this.store.getState(ox);if(n){let i=this.getLocalTrack(n);i?("add"===t?yield i.addStreamPlugins(e):"remove"===t&&(yield i.removeStreamPlugins(e)),this.syncRoomState(`${t}MediaStreamPlugin`)):this.logPossibleInconsistency(`track ${n} not present, unable to ${t} plugin`)}}))}addRemoveAudioPlugin(e,t){return OC(this,null,(function*(){try{if(!e)return void Lx.w("Invalid plugin received in store");let n=this.store.getState(sx);if(n){let i=this.getLocalTrack(n);i?("add"===t?yield i.addPlugin(e):"remove"===t&&(yield i.removePlugin(e)),this.syncRoomState(`${t}AudioPlugin`)):this.logPossibleInconsistency(`track ${n} not present, unable to ${t} plugin`)}}catch(lP){console.error(lP)}}))}onRoleChangeRequest(e){this.setState((t=>{0===t.roleChangeRequests.length&&t.roleChangeRequests.push(ER.convertRoleChangeRequest(e))}),"roleChangeRequest")}removeRoleChangeRequest(e){this.setState((t=>{let n=t.roleChangeRequests.findIndex((t=>t.token===e.token));-1!==n&&t.roleChangeRequests.splice(n,1)}),"removeRoleChangeRequest")}onRoleUpdate(){this.syncRoomState("roleUpdate")}getStoreLocalTrackIDfromSDKTrack(e){return this.store.getState(lx).find((t=>{var n;return(null==(n=this.getTrackById(t))?void 0:n.trackId)===e.trackId}))}updateMidCallPreviewRoomState(e,t){t.isLocal&&8===e&&this.store.getState(vx)&&this.setState((e=>{e.room.roomState="Connected"}),"midCallPreviewCompleted")}setSessionStoreValueLocally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"setSessionStore",n=Array.isArray(e)?e:[e];this.setState((e=>{n.forEach((t=>{e.sessionStore[t.key]=t.value}))}),t)}hasActiveElements(e){let t=Object.keys(this.store.getState().whiteboards).length>0,n=Object.keys(this.store.getState().polls).length>0,i=Object.keys(this.store.getState().peers).length>0,r=e.getState().remoteTrackStats;return i&&(t||n||Object.values(r).some((e=>e&&"number"==typeof e.bitrate&&e.bitrate>0)))}},VR=e=>dP?`${e} ${document.title}`:e,BR=class{constructor(e,t){this.eventBus=e,this.listener=t,this.TAG="[NetworkTestManager]",this.controller=new AbortController,this.start=e=>OC(this,null,(function*(){var t;if(!e)return;let{url:n,timeout:i,scoreMap:r}=e,s=this.controller.signal,o=Date.now(),a=0,l=sA(i).then((()=>{this.controller.abort()}));try{let e=null==(t=(yield fetch(`${n}?${Date.now()}`,{signal:s})).body)?void 0:t.getReader();if(!e)throw Error("unable to process request");let i=()=>OC(this,null,(function*(){if(e)try{let t=!1;for(;!t;){let{value:n,done:i}=yield e.read();t=i,n&&(a+=n.byteLength,this.sendScore({scoreMap:r,downloadedSize:a,startTime:o}))}}catch(t){"AbortError"!==t.name&&nP.d(this.TAG,t)}}));return Promise.race([i(),l]).then((()=>{this.sendScore({scoreMap:r,downloadedSize:a,startTime:o,finished:!0})})).catch((e=>{nP.d(this.TAG,e),this.updateScoreToListener(0),this.eventBus.analytics.publish(FP.previewNetworkQuality({error:e.message}))}))}catch(c){"AbortError"!==c.name?(nP.d(this.TAG,c),this.updateScoreToListener(0),this.eventBus.analytics.publish(FP.previewNetworkQuality({error:c.message}))):nP.d(this.TAG,c)}})),this.stop=()=>{this.controller.signal.aborted||this.controller.abort()},this.sendScore=e=>{let{scoreMap:t,downloadedSize:n,startTime:i,finished:r=!1}=e,s=n/1024/((Date.now()-i)/1e3)*8,o=-1;for(let a in t){let e=t[a];s>=e.low&&(!e.high||s<=e.high)&&(o=Number(a))}this.updateScoreToListener(o),r&&this.eventBus.analytics.publish(FP.previewNetworkQuality({score:o,downLink:s.toFixed(2)}))}}updateScoreToListener(e){var t,n;e!==this.score&&(this.score=e,null==(n=null==(t=this.listener)?void 0:t.onNetworkQuality)||n.call(t,e))}},$R=class{constructor(e,t,n,i,r,s){this.store=e,this.transport=t,this.deviceManager=n,this.publish=i,this.removeAuxiliaryTrack=r,this.listener=s,this.handleLocalPeerRoleUpdate=e=>OC(this,[e],(function(e){var t=this;let{oldRole:n,newRole:i}=e;return function*(){var e;let r=t.store.getLocalPeer();r&&(yield t.diffRolesAndPublishTracks({oldRole:n,newRole:i}),null==(e=t.listener)||e.onPeerUpdate(8,r))}()})),this.diffRolesAndPublishTracks=e=>OC(this,[e],(function(e){var t=this;let{oldRole:n,newRole:i}=e;return function*(){var e,r,s,o,a,l;let c=new Set(n.publishParams.allowed),u=new Set(i.publishParams.allowed),d=t.removeTrack(c,u,"video"),h=t.removeTrack(c,u,"audio"),p=t.removeTrack(c,u,"screen"),f=t.hasSimulcastDifference(null==(e=n.publishParams.simulcast)?void 0:e.video,null==(r=i.publishParams.simulcast)?void 0:r.video),m=t.hasSimulcastDifference(null==(s=n.publishParams.simulcast)?void 0:s.screen,null==(o=i.publishParams.simulcast)?void 0:o.screen),g=null==(l=null==(a=t.store.getLocalPeer())?void 0:a.videoTrack)?void 0:l.enabled;yield t.removeAudioTrack(h),yield t.removeVideoTracks(d||f),yield t.removeScreenTracks(p||m);let v=t.getSettings();f&&(v.isVideoMuted=!g),yield t.publish(v),yield t.syncDevices(v,i)}()}))}syncDevices(e,t){return OC(this,null,(function*(){(!e.isAudioMuted||!e.isVideoMuted)&&t.publishParams.allowed.length>0&&(yield this.deviceManager.init(!0))}))}removeVideoTracks(e){return OC(this,null,(function*(){var t;if(!e)return;let n=this.store.getLocalPeer();null!=n&&n.videoTrack&&(n.videoTrack.isPublished?yield this.transport.unpublish([n.videoTrack]):yield n.videoTrack.cleanup(),null==(t=this.listener)||t.onTrackUpdate(1,n.videoTrack,n),n.videoTrack=void 0),yield this.removeAuxTracks((e=>"screen"!==e.source&&"video"===e.type))}))}removeAudioTrack(e){return OC(this,null,(function*(){var t;if(!e)return;let n=this.store.getLocalPeer();null!=n&&n.audioTrack&&(n.audioTrack.isPublished?yield this.transport.unpublish([n.audioTrack]):yield n.audioTrack.cleanup(),null==(t=this.listener)||t.onTrackUpdate(1,n.audioTrack,n),n.audioTrack=void 0),yield this.removeAuxTracks((e=>"screen"!==e.source&&"audio"===e.type))}))}removeScreenTracks(e){return OC(this,null,(function*(){e&&(yield this.removeAuxTracks((e=>"screen"===e.source)))}))}removeAuxTracks(e){return OC(this,null,(function*(){let t=this.store.getLocalPeer();if(null!=t&&t.auxiliaryTracks){let n=[...t.auxiliaryTracks];for(let t of n)e(t)&&(yield this.removeAuxiliaryTrack(t.trackId))}}))}removeTrack(e,t,n){return e.has(n)&&!t.has(n)}hasSimulcastDifference(e,t){var n,i,r;return!(!e&&!t)&&((null==(n=null==e?void 0:e.layers)?void 0:n.length)!==(null==(i=null==t?void 0:t.layers)?void 0:i.length)||!(null==(r=null==e?void 0:e.layers)||!r.some((e=>{var n;let i=null==(n=null==t?void 0:t.layers)?void 0:n.find((t=>t.rid===e.rid));return(null==i?void 0:i.maxBitrate)!==e.maxBitrate||(null==i?void 0:i.maxFramerate)!==e.maxFramerate}))))}getSettings(){let{isAudioMuted:e,isVideoMuted:t}=this.getMutedStatus(),{audioInputDeviceId:n,audioOutputDeviceId:i}=this.getAudioDeviceSettings();return{isAudioMuted:e,isVideoMuted:t,audioInputDeviceId:n,audioOutputDeviceId:i,videoDeviceId:this.getVideoInputDeviceId()}}getMutedStatus(){var e,t,n;let i=null==(e=this.store.getConfig())?void 0:e.settings;return{isAudioMuted:null==(t=null==i?void 0:i.isAudioMuted)||t,isVideoMuted:null==(n=null==i?void 0:i.isVideoMuted)||n}}getAudioDeviceSettings(){var e,t,n;let i=null==(e=this.store.getConfig())?void 0:e.settings;return{audioInputDeviceId:(null==(t=this.deviceManager.currentSelection.audioInput)?void 0:t.deviceId)||(null==i?void 0:i.audioInputDeviceId)||"default",audioOutputDeviceId:(null==(n=this.deviceManager.currentSelection.audioOutput)?void 0:n.deviceId)||(null==i?void 0:i.audioOutputDeviceId)||"default"}}getVideoInputDeviceId(){var e,t;let n=null==(e=this.store.getConfig())?void 0:e.settings;return(null==(t=this.deviceManager.currentSelection.videoInput)?void 0:t.deviceId)||(null==n?void 0:n.videoDeviceId)||"default"}},zR=new class{constructor(){this.TAG="[HTTPAnalyticsTransport]",this.failedEvents=new PP("client-events"),this.isConnected=!0,this.env=null,this.websocketURL=""}setEnv(e){this.env=e,this.flushFailedEvents()}setWebsocketEndpoint(e){this.websocketURL=e}sendEvent(e){if(!this.env)return void this.addEventToStorage(e);let t={event:e.name,payload:e.properties,event_id:String(e.timestamp),peer:e.metadata.peer,timestamp:e.timestamp,device_id:e.device_id,cluster:{websocket_url:this.websocketURL}},n="prod"===this.env?"https://event.100ms.live/v2/client/report":"https://event-nonprod.100ms.live/v2/client/report";fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.metadata.token}`,user_agent_v2:e.metadata.userAgent},body:JSON.stringify(t)}).then((t=>{if(401!==t.status){if(200!==t.status)throw Error(t.statusText);this.removeFromStorage(e)}else this.removeFromStorage(e)})).catch((t=>{nP.v(this.TAG,"Failed to send event",t,e),this.addEventToStorage(e)}))}flushFailedEvents(){let e=this.failedEvents.get();null==e||e.forEach((e=>this.sendEvent(e)))}addEventToStorage(e){let t=this.failedEvents.get()||[];t.find((t=>t.timestamp===e.timestamp))||(100===t.length&&t.shift(),t.push(e),this.failedEvents.set(t))}removeFromStorage(e){let t=this.failedEvents.get()||[],n=t.findIndex((t=>t.timestamp===e.timestamp));n>-1&&(t.splice(n,1),this.failedEvents.set(t))}},GR=class{constructor(e){this.type=e.type,this.source=e.source||"regular",this.description="",e instanceof VP?(this.mute=!e.enabled,this.track_id=e.publishedTrackId,this.stream_id=e.stream.id):(this.mute=e.mute,this.track_id=e.track_id,this.stream_id=e.stream_id)}},qR=class{constructor(){var e=this;this.TAG="[Store]:",this.knownRoles={},this.peers={},this.tracks=new Map,this.peerTrackStates={},this.speakers=[],this.roleDetailsArrived=!1,this.env="prod",this.simulcastEnabled=!1,this.userAgent=LP(this.env),this.polls=new Map,this.whiteboards=new Map,this.addPermissionToRole=(e,t,n,i)=>{var r;if(!this.knownRoles[e])return void nP.d(this.TAG,`role ${e} is not present in given roles`,this.knownRoles);let s=this.knownRoles[e].permissions;"transcriptions"===t&&i?s[t]=NC(RC({},s[t]),{[i]:[n]}):"whiteboard"===t&&(s[t]||(s[t]=[]),null==(r=s[t])||r.push(n))},this.addWhiteboardPluginToRole=e=>{var t,n,i;let r=null==e?void 0:e.permissions;null==(t=null==r?void 0:r.admin)||t.forEach((e=>this.addPermissionToRole(e,"whiteboard","admin"))),null==(n=null==r?void 0:r.reader)||n.forEach((e=>this.addPermissionToRole(e,"whiteboard","read"))),null==(i=null==r?void 0:r.writer)||i.forEach((e=>this.addPermissionToRole(e,"whiteboard","write")))},this.addTranscriptionsPluginToRole=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];var n,i;for(let r of t)null==(i=null==(n=r.permissions)?void 0:n.admin)||i.forEach((t=>e.addPermissionToRole(t,"transcriptions","admin",r.mode)))},this.handleNoiseCancellationPlugin=e=>{this.room&&(this.room.isNoiseCancellationEnabled=!(null==e||!e.enabled)&&!!this.room.isNoiseCancellationEnabled)}}getConfig(){return this.config}setSimulcastEnabled(e){this.simulcastEnabled=e}removeRemoteTracks(){this.tracks.forEach((e=>{(e instanceof AA||e instanceof w_)&&(this.removeTrack(e),delete this.peerTrackStates[e.trackId])}))}getEnv(){return this.env}getPublishParams(){let e=this.getLocalPeer(),t=(null==e?void 0:e.asRole)||(null==e?void 0:e.role);return null==t?void 0:t.publishParams}getRoom(){return this.room}getPolicyForRole(e){return this.knownRoles[e]}getKnownRoles(){return this.knownRoles}getTemplateAppData(){return this.templateAppData}getLocalPeer(){if(this.localPeerId&&this.peers[this.localPeerId])return this.peers[this.localPeerId]}getRemotePeers(){return Object.values(this.peers).filter((e=>!e.isLocal))}getPeers(){return Object.values(this.peers)}getPeerMap(){return this.peers}getPeerById(e){if(this.peers[e])return this.peers[e]}getTracksMap(){return this.tracks}getTracks(){return Array.from(this.tracks.values())}getVideoTracks(){return this.getTracks().filter((e=>"video"===e.type))}getRemoteVideoTracks(){return this.getTracks().filter((e=>e instanceof w_))}getAudioTracks(){return this.getTracks().filter((e=>"audio"===e.type))}getPeerTracks(e){let t=e?this.peers[e]:void 0,n=[];return null!=t&&t.videoTrack&&n.push(t.videoTrack),null!=t&&t.audioTrack&&n.push(t.audioTrack),n.concat((null==t?void 0:t.auxiliaryTracks)||[])}getLocalPeerTracks(){return this.getPeerTracks(this.localPeerId)}hasTrack(e){return this.tracks.has(e)}getTrackById(e){var t,n;let i=Array.from(this.tracks.values()).find((t=>t.trackId===e));if(i)return i;let r=this.getLocalPeer();if(r){if(null!=(t=r.audioTrack)&&t.isPublishedTrackId(e))return r.audioTrack;if(null!=(n=r.videoTrack)&&n.isPublishedTrackId(e))return r.videoTrack}}getPeerByTrackId(e){let t=Array.from(this.tracks.values()).find((t=>t.trackId===e));return null!=t&&t.peerId?this.peers[t.peerId]:void 0}getSpeakers(){return this.speakers}getSpeakerPeers(){return this.speakers.map((e=>e.peer))}getUserAgent(){return this.userAgent}createAndSetUserAgent(e){this.userAgent=LP(this.env,e)}setRoom(e){this.room=e}setKnownRoles(e){var t,n;if(this.knownRoles=e.known_roles,this.addPluginsToRoles(e.plugins),this.roleDetailsArrived=!0,this.templateAppData=e.app_data,!this.simulcastEnabled)return;let i=null==(t=this.knownRoles[e.name])?void 0:t.publishParams;this.videoLayers=this.convertSimulcastLayers(null==(n=i.simulcast)?void 0:n.video),this.updatePeersPolicy()}hasRoleDetailsArrived(){return this.roleDetailsArrived}setConfig(e){var t,n,i;if($P.rememberDevices(!!e.rememberDeviceSelection),e.rememberDeviceSelection){let r=$P.getSelection();r&&(e.settings||(e.settings={}),null!=(t=r.audioInput)&&t.deviceId&&(e.settings.audioInputDeviceId=e.settings.audioInputDeviceId||r.audioInput.deviceId),null!=(n=r.audioOutput)&&n.deviceId&&(e.settings.audioOutputDeviceId=e.settings.audioOutputDeviceId||r.audioOutput.deviceId),null!=(i=r.videoInput)&&i.deviceId&&(e.settings.videoDeviceId=e.settings.videoDeviceId||r.videoInput.deviceId))}e.autoManageVideo=!1!==e.autoManageVideo,e.autoManageWakeLock=!1!==e.autoManageWakeLock,this.config=e,this.setEnv()}addPeer(e){this.peers[e.peerId]=e,e.isLocal&&(this.localPeerId=e.peerId)}addTrack(e){this.tracks.set(e,e)}getTrackState(e){return this.peerTrackStates[e]}setTrackState(e){this.peerTrackStates[e.trackInfo.track_id]=e}removeTrackState(e){delete this.peerTrackStates[e]}removePeer(e){this.localPeerId===e&&(this.localPeerId=void 0),delete this.peers[e]}removeTrack(e){this.tracks.delete(e)}updateSpeakers(e){this.speakers=e}updateAudioOutputVolume(e){return OC(this,null,(function*(){for(let t of this.getAudioTracks())yield t.setVolume(e)}))}updateAudioOutputDevice(e){return OC(this,null,(function*(){let t=[];this.getAudioTracks().forEach((n=>{n instanceof AA&&t.push(n.setOutputDevice(e))})),yield Promise.all(t)}))}getSimulcastLayers(e){var t;return this.simulcastEnabled&&["screen","regular"].includes(e)?"screen"===e?[]:(null==(t=this.videoLayers)?void 0:t.layers)||[]:[]}convertSimulcastLayers(e){if(e)return NC(RC({},e),{layers:(e.layers||[]).map((e=>NC(RC({},e),{maxBitrate:1e3*e.maxBitrate})))})}getSimulcastDefinitionsForPeer(e,t){var n,i,r;if([!e||!e.role,"screen"===t,!this.simulcastEnabled].some((e=>!!e)))return[];let s,o,a,l=this.getPolicyForRole(e.role.name).publishParams;return"regular"===t?(s=null==(n=l.simulcast)?void 0:n.video,o=l.video.width,a=l.video.height):"screen"===t&&(s=null==(i=l.simulcast)?void 0:i.screen,o=l.screen.width,a=l.screen.height),(null==(r=null==s?void 0:s.layers)?void 0:r.map((e=>({layer:mA[e.rid],resolution:{width:Math.floor(o/e.scaleResolutionDownBy),height:Math.floor(a/e.scaleResolutionDownBy)}}))))||[]}setPoll(e){this.polls.set(e.id,e)}getPoll(e){return this.polls.get(e)}setWhiteboard(e){this.whiteboards.set(e.id,e)}getWhiteboards(){return this.whiteboards}getWhiteboard(e){return e?this.whiteboards.get(e):this.whiteboards.values().next().value}getErrorListener(){return this.errorListener}cleanup(){let e=this.getTracks();for(let t of e)t.cleanup();this.room=void 0,this.config=void 0,this.localPeerId=void 0,this.roleDetailsArrived=!1}setErrorListener(e){this.errorListener=e}updatePeersPolicy(){this.getPeers().forEach((e=>{var t;e.role?e.role=this.getPolicyForRole(e.role.name):null==(t=this.errorListener)||t.onError(IP.GenericErrors.InvalidRole("VALIDATION",""))}))}addPluginsToRoles(e){e&&Object.keys(e).forEach((t=>{let n=t;switch(n){case"whiteboard":this.addWhiteboardPluginToRole(e[n]);break;case"transcriptions":this.addTranscriptionsPluginToRole(e[n]);break;case"noiseCancellation":this.handleNoiseCancellationPlugin(e[n])}}))}setEnv(){var e;let t=(null==(e=this.config)?void 0:e.initEndpoint).split("https://")[1],n="prod";t.startsWith("prod")?n="prod":t.startsWith("qa")?n="qa":t.startsWith("dev")&&(n="dev"),this.env=n,zR.setEnv(n)}},HR=class{constructor(){this.TAG="[WakeLockManager]",this.wakeLock=null,this.acquireLock=()=>OC(this,null,(function*(){yield this.requestWakeLock(),null==document||document.addEventListener("visibilitychange",this.visibilityHandler)})),this.cleanup=()=>OC(this,null,(function*(){if(this.wakeLock&&!this.wakeLock.released)try{yield this.wakeLock.release(),nP.d(this.TAG,"Wake lock released")}catch(vC){let t=vC;nP.w(this.TAG,"Error while releasing wake lock",`name=${t.name}, message=${t.message}`)}null==document||document.removeEventListener("visibilitychange",this.visibilityHandler),this.wakeLock=null})),this.visibilityHandler=()=>OC(this,null,(function*(){"visible"===(null==document?void 0:document.visibilityState)&&(!this.wakeLock||this.wakeLock.released)&&(nP.d(this.TAG,"Re-acquiring wake lock due to visibility change"),yield this.requestWakeLock())})),this.requestWakeLock=()=>OC(this,null,(function*(){try{if(!("wakeLock"in navigator))return void nP.d(this.TAG,"Wake lock feature not supported");this.wakeLock=yield navigator.wakeLock.request("screen"),nP.d(this.TAG,"Wake lock acquired")}catch(vC){let t=vC;nP.w(this.TAG,"Error acquiring wake lock",`name=${t.name}, message=${t.message}`)}}))}},WR=class{constructor(e){this.store=e,this.bufferSize=100,this.TAG="[AnalyticsEventsService]",this.transport=null,this.pendingEvents=[],this.level=1}setTransport(e){this.transport=e}reset(){this.transport=null,this.pendingEvents=[]}queue(e){if(e.level>=this.level&&(this.pendingEvents.push(e),this.pendingEvents.length>this.bufferSize)){let e=this.pendingEvents.shift();nP.d(this.TAG,"Max buffer size reached","Removed event to accommodate new events",e)}return this}flushFailedClientEvents(){zR.flushFailedEvents()}flush(){var e;try{for(;this.pendingEvents.length>0;){let t=this.pendingEvents.shift();t&&(t.metadata.peer.peer_id=null==(e=this.store.getLocalPeer())?void 0:e.peerId,t.metadata.userAgent=this.store.getUserAgent(),this.transport&&this.transport.transportProvider.isConnected?this.transport.sendEvent(t):this.sendClientEventOnHTTP(t))}}catch(wC){nP.w(this.TAG,"Flush Failed",wC)}}sendClientEventOnHTTP(e){var t,n,i,r;let s=this.store.getRoom(),o=this.store.getLocalPeer();e.metadata.token=null==(t=this.store.getConfig())?void 0:t.authToken,e.metadata.peer={session_id:null==s?void 0:s.sessionId,room_id:null==s?void 0:s.id,room_name:null==s?void 0:s.name,template_id:null==s?void 0:s.templateId,joined_at:null==(n=null==s?void 0:s.joinedAt)?void 0:n.getTime(),session_started_at:null==(i=null==s?void 0:s.startedAt)?void 0:i.getTime(),role:null==(r=null==o?void 0:o.role)?void 0:r.name,user_name:null==o?void 0:o.name,user_data:null==o?void 0:o.metadata,peer_id:null==o?void 0:o.peerId},zR.sendEvent(e)}},KR={autoplayFailed:void 0,initialized:!1,autoplayCheckPromise:void 0},QR=class{constructor(e,t,n){this.store=e,this.deviceManager=t,this.eventBus=n,this.autoPausedTracks=new Set,this.TAG="[AudioSinkManager]:",this.volume=100,this.state=RC({},KR),this.handleAudioPaused=e=>OC(this,null,(function*(){nP.d(this.TAG,"Audio Paused",e.target.id);let t=this.store.getTrackById(e.target.id);t&&this.autoPausedTracks.add(t)})),this.handleTrackUpdate=e=>{let{track:t}=e;nP.d(this.TAG,"Track updated",`${t}`)},this.handleTrackAdd=e=>OC(this,[e],(function(e){var t=this;let{track:n,peer:i,callListener:r=!0}=e;return function*(){var e,s;let o=document.createElement("audio");o.style.display="none",o.id=n.trackId,o.addEventListener("pause",t.handleAudioPaused),o.onerror=()=>OC(t,null,(function*(){var e,t;nP.e(this.TAG,"error on audio element",o.error);let r=IP.TracksErrors.AudioPlaybackError(`Audio playback error for track - ${n.trackId} code - ${null==(e=null==o?void 0:o.error)?void 0:e.code}`);this.eventBus.analytics.publish(FP.audioPlaybackError(r)),(null==(t=null==o?void 0:o.error)?void 0:t.code)===MediaError.MEDIA_ERR_DECODE&&(this.removeAudioElement(o,n),yield sA(500),yield this.handleTrackAdd({track:n,peer:i,callListener:!1}),this.state.autoplayFailed||this.eventBus.analytics.publish(FP.audioRecovered("Audio recovered after media decode error")))})),n.setAudioElement(o),yield n.setVolume(t.volume),nP.d(t.TAG,"Audio track added",`${n}`),t.init(),null==(e=t.audioSink)||e.append(o),t.outputDevice&&(yield n.setOutputDevice(t.outputDevice)),o.srcObject=new MediaStream([n.nativeTrack]),r&&(null==(s=t.listener)||s.onTrackUpdate(0,n,i)),yield t.handleAutoplayError(n)}()})),this.handleAutoplayError=e=>OC(this,null,(function*(){void 0===this.state.autoplayFailed&&(this.state.autoplayCheckPromise||(this.state.autoplayCheckPromise=new Promise((t=>{this.playAudioFor(e).then(t)}))),yield this.state.autoplayCheckPromise),this.state.autoplayFailed?this.autoPausedTracks.add(e):yield this.playAudioFor(e)})),this.handleAudioDeviceChange=e=>OC(this,null,(function*(){e.isUserSelection||e.error||!e.selection||"video"===e.type||(yield this.unpauseAudioTracks())})),this.handleTrackRemove=e=>{this.autoPausedTracks.delete(e);let t=document.getElementById(e.trackId);t&&this.removeAudioElement(t,e),this.audioSink&&0===this.audioSink.childElementCount&&(this.state.autoplayCheckPromise=void 0,this.state.autoplayFailed=void 0),nP.d(this.TAG,"Audio track removed",`${e}`)},this.unpauseAudioTracks=()=>OC(this,null,(function*(){let e=[];this.autoPausedTracks.forEach((t=>{e.push(this.playAudioFor(t))})),yield Promise.all(e)})),this.removeAudioElement=(e,t)=>{e&&(nP.d(this.TAG,"removing audio element",`${t}`),e.removeEventListener("pause",this.handleAudioPaused),e.srcObject=null,e.remove(),t.setAudioElement(null))},this.eventBus.audioTrackAdded.subscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.subscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.subscribe(this.handleTrackUpdate),this.eventBus.deviceChange.subscribe(this.handleAudioDeviceChange),this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseAudioTracks),this.eventBus.localAudioUnmutedNatively.subscribe(this.unpauseAudioTracks)}setListener(e){this.listener=e}get outputDevice(){return this.deviceManager.outputDevice}getVolume(){return this.volume}setVolume(e){return OC(this,null,(function*(){yield this.store.updateAudioOutputVolume(e),this.volume=e}))}unblockAutoplay(){return OC(this,null,(function*(){this.autoPausedTracks.size>0&&(yield this.unpauseAudioTracks()),yield eA.resumeContext()}))}init(e){if(this.state.initialized||this.audioSink)return;this.state.initialized=!0;let t=document.createElement("div");t.id=`HMS-SDK-audio-sink-${uE()}`,(e&&document.getElementById(e)||document.body).append(t),this.audioSink=t,nP.d(this.TAG,"audio sink created",this.audioSink)}cleanup(){var e;null==(e=this.audioSink)||e.remove(),this.audioSink=void 0,this.eventBus.audioTrackAdded.unsubscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.unsubscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.unsubscribe(this.handleTrackUpdate),this.eventBus.deviceChange.unsubscribe(this.handleAudioDeviceChange),this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseAudioTracks),this.eventBus.localAudioUnmutedNatively.unsubscribe(this.unpauseAudioTracks),this.autoPausedTracks=new Set,this.state=RC({},KR)}playAudioFor(e){return OC(this,null,(function*(){let t=e.getAudioElement();if(t)try{yield t.play(),this.state.autoplayFailed=!1,this.autoPausedTracks.delete(e),nP.d(this.TAG,"Played track",`${e}`)}catch(lP){this.autoPausedTracks.add(e),nP.w(this.TAG,"Failed to play track",`${e}`,lP);let n=lP;if(!this.state.autoplayFailed&&"NotAllowedError"===n.name){this.state.autoplayFailed=!0;let e=IP.TracksErrors.AutoplayBlocked("AUTOPLAY","");e.addNativeError(n),this.eventBus.analytics.publish(FP.autoplayError()),this.eventBus.autoplayError.publish(e)}}else nP.w(this.TAG,"No audio element found on track",e.trackId)}))}},JR=class{constructor(e){this.eventBus=e,this.pluginUsage=new Map,this.pluginLastAddedAt=new Map,this.getPluginUsage=e=>{if(this.pluginUsage.has(e)||this.pluginUsage.set(e,0),this.pluginLastAddedAt.has(e)){let t=this.pluginLastAddedAt.get(e)||0,n=t?Date.now()-t:0;this.pluginUsage.set(e,(this.pluginUsage.get(e)||0)+n),this.pluginLastAddedAt.delete(e)}return this.pluginUsage.get(e)},this.updatePluginUsageData=e=>{var t;let n=(null==(t=e.properties)?void 0:t.plugin_name)||"";switch(e.name){case"mediaPlugin.toggled.on":case"mediaPlugin.added":{let t=e.properties.added_at||Date.now();this.pluginLastAddedAt.set(n,t);break}case"mediaPlugin.toggled.off":case"mediaPlugin.stats":if(this.pluginLastAddedAt.has(n)){let t=e.properties.duration||(Date.now()-(this.pluginLastAddedAt.get(n)||0))/1e3;this.pluginUsage.set(n,(this.pluginUsage.get(n)||0)+1e3*Math.max(t,0)),this.pluginLastAddedAt.delete(n)}}},this.cleanup=()=>{this.pluginLastAddedAt.clear(),this.pluginUsage.clear()},this.eventBus.analytics.subscribe((e=>this.updatePluginUsageData(e)))}},YR=class{constructor(e,t){this.store=e,this.eventBus=t,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.hasWebcamPermission=!1,this.hasMicrophonePermission=!1,this.currentSelection={audioInput:void 0,videoInput:void 0,audioOutput:void 0},this.TAG="[Device Manager]:",this.initialized=!1,this.videoInputChanged=!1,this.audioInputChanged=!1,this.earpieceSelected=!1,this.timer=null,this.updateOutputDevice=(e,t)=>OC(this,null,(function*(){let n=this.audioOutput.find((t=>t.deviceId===e));return n&&(this.outputDevice=n,yield this.store.updateAudioOutputDevice(n),this.eventBus.analytics.publish(FP.deviceChange({isUserSelection:t,selection:{audioOutput:n},devices:this.getDevices(),type:"audioOutput"})),$P.updateSelection("audioOutput",{deviceId:n.deviceId,groupId:n.groupId})),n})),this.getCurrentSelection=()=>{var e,t;let n=this.store.getLocalPeer(),i=this.createIdentifier(null==(e=null==n?void 0:n.audioTrack)?void 0:e.getMediaTrackSettings()),r=this.createIdentifier(null==(t=null==n?void 0:n.videoTrack)?void 0:t.getMediaTrackSettings()),s=this.audioInput.find((e=>this.createIdentifier(e)===i)),o=this.videoInput.find((e=>this.createIdentifier(e)===r));return{audioInput:s,videoInput:o,audioOutput:this.outputDevice}},this.computeChange=(e,t)=>e.length!==t.length||t.some((t=>!e.includes(this.createIdentifier(t)))),this.enumerateDevices=()=>OC(this,null,(function*(){try{let e=yield navigator.mediaDevices.enumerateDevices(),t=this.videoInput.map(this.createIdentifier),n=this.audioInput.map(this.createIdentifier);this.audioInput=[],this.audioOutput=[],this.videoInput=[],e.forEach((e=>{"audioinput"===e.kind&&e.label?(this.hasMicrophonePermission=!0,this.audioInput.push(e)):"audiooutput"===e.kind?this.audioOutput.push(e):"videoinput"===e.kind&&e.label&&(this.hasWebcamPermission=!0,this.videoInput.push(e))})),this.videoInputChanged=this.computeChange(t,this.videoInput),this.audioInputChanged=this.computeChange(n,this.audioInput),$P.setDevices({videoInput:[...this.videoInput],audioInput:[...this.audioInput],audioOutput:[...this.audioOutput]}),this.logDevices("Enumerate Devices")}catch(e){nP.e(this.TAG,"Failed enumerating devices",e)}})),this.updateToActualDefaultDevice=()=>OC(this,null,(function*(){var e,t,n,i,r;let s=this.store.getLocalPeer();if(!(null==(t=null==(e=this.store.getConfig())?void 0:e.settings)?void 0:t.videoDeviceId)&&null!=s&&s.videoTrack&&(yield s.videoTrack.setSettings({deviceId:null==(n=this.videoInput[0])?void 0:n.deviceId},!0)),!(null==(r=null==(i=this.store.getConfig())?void 0:i.settings)?void 0:r.audioInputDeviceId)&&null!=s&&s.audioTrack){let e=()=>{var e;let t=this.audioInput.find((e=>!e.label.toLowerCase().includes("iphone")));return(()=>{var e;return"ios"===(null==(e=uP.getOS().name)?void 0:e.toLowerCase())})()&&t?null==t?void 0:t.deviceId:null==(e=this.getNewAudioInputDevice())?void 0:e.deviceId};e()&&(yield s.audioTrack.setSettings({deviceId:e()},!0))}})),this.handleDeviceChange=aA((()=>OC(this,null,(function*(){yield this.enumerateDevices(),this.logDevices("After Device Change");let e=this.store.getLocalPeer();yield this.setOutputDevice(!0),yield this.handleAudioInputDeviceChange(null==e?void 0:e.audioTrack),yield this.handleVideoInputDeviceChange(null==e?void 0:e.videoTrack),this.eventBus.analytics.publish(FP.deviceChange({selection:this.getCurrentSelection(),type:"change",devices:this.getDevices()}))}))),500).bind(this),this.handleAudioInputDeviceChange=e=>OC(this,null,(function*(){if(!e)return void nP.d(this.TAG,"No Audio track on local peer");if(!this.audioInputChanged)return void nP.d(this.TAG,"No Change in AudioInput Device");let t=this.getNewAudioInputDevice();if(!t||!t.deviceId)return this.eventBus.analytics.publish(FP.deviceChange({selection:{audioInput:t},error:IP.TracksErrors.SelectedDeviceMissing("audio"),devices:this.getDevices(),type:"audioInput"})),void nP.e(this.TAG,"Audio device not found");let{settings:n}=e,i=(new yA).codec(n.codec).maxBitrate(n.maxBitrate).deviceId(t.deviceId).audioMode(n.audioMode).build();try{yield e.setSettings(i,!0),this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:t,type:"audioInput"}),this.logDevices("Audio Device Change Success")}catch(tN){nP.e(this.TAG,"[Audio Device Change]",tN),this.eventBus.analytics.publish(FP.deviceChange({selection:{audioInput:t},devices:this.getDevices(),type:"audioInput",error:tN})),this.eventBus.deviceChange.publish({error:tN,selection:t,type:"audioInput",devices:this.getDevices()})}})),this.handleVideoInputDeviceChange=e=>OC(this,null,(function*(){if(!e)return void nP.d(this.TAG,"No video track on local peer");if(!this.videoInputChanged)return void nP.d(this.TAG,"No Change in VideoInput Device");let t=this.videoInput[0];if(!t||!t.deviceId)return this.eventBus.analytics.publish(FP.deviceChange({selection:{videoInput:t},error:IP.TracksErrors.SelectedDeviceMissing("video"),devices:this.getDevices(),type:"video"})),void nP.e(this.TAG,"Video device not found");let{settings:n}=e,i=(new wA).codec(n.codec).maxBitrate(n.maxBitrate).maxFramerate(n.maxFramerate).setWidth(n.width).setHeight(n.height).deviceId(t.deviceId).build();try{yield e.setSettings(i,!0),this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:t,type:"video"}),this.logDevices("Video Device Change Success")}catch(tN){nP.e(this.TAG,"[Video Device Change]",tN),this.eventBus.analytics.publish(FP.deviceChange({selection:{videoInput:t},devices:this.getDevices(),type:"video",error:tN})),this.eventBus.deviceChange.publish({error:tN,type:"video",selection:t,devices:this.getDevices()})}})),this.startPollingForDevices=()=>OC(this,null,(function*(){let{earpiece:e}=this.categorizeAudioInputDevices();e&&(this.timer=setTimeout((()=>{OC(this,null,(function*(){yield this.enumerateDevices(),yield this.autoSelectAudioOutput(),this.startPollingForDevices()}))}),5e3))})),this.autoSelectAudioOutput=()=>OC(this,null,(function*(){var e,t;let{bluetoothDevice:n,earpiece:i,speakerPhone:r,wired:s}=this.categorizeAudioInputDevices(),o=null==(e=this.store.getLocalPeer())?void 0:e.audioTrack;if(!o||!i)return;let a=this.getManuallySelectedAudioDevice(),l=(null==a?void 0:a.deviceId)||(null==n?void 0:n.deviceId)||(null==s?void 0:s.deviceId)||(null==r?void 0:r.deviceId);if(o.settings.deviceId!==l||!this.earpieceSelected)try{if(!this.earpieceSelected){if((null==n?void 0:n.deviceId)===l)return void(this.earpieceSelected=!0);yield o.setSettings({deviceId:null==i?void 0:i.deviceId},!0),this.earpieceSelected=!0}yield o.setSettings({deviceId:l},!0);let e=null==(t=this.audioInput.find((e=>e.deviceId===l)))?void 0:t.groupId;this.eventBus.deviceChange.publish({isUserSelection:!1,type:"audioInput",selection:{deviceId:l,groupId:e},devices:this.getDevices(),internal:!0})}catch(c){this.eventBus.error.publish(c)}}));let n=e=>{let{enabled:t,track:n}=e;return t&&"regular"===n.source};this.eventBus.localVideoEnabled.waitFor(n).then((()=>{0===this.videoInput.length&&this.init(!0)})),this.eventBus.localAudioEnabled.waitFor(n).then((()=>{0===this.audioInput.length&&this.init(!0)})),this.eventBus.deviceChange.subscribe((e=>{let{type:t,isUserSelection:n,selection:i}=e;if(n){let e="video"===t?"videoInput":t,r=this[e].find((e=>this.createIdentifier(e)===this.createIdentifier(i)));this.eventBus.analytics.publish(FP.deviceChange({selection:{[e]:r},devices:this.getDevices(),type:t,isUserSelection:n}))}}))}init(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return OC(this,null,(function*(){this.initialized&&!e||(!this.initialized&&navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),this.initialized=!0,yield this.enumerateDevices(),e||(yield this.updateToActualDefaultDevice(),this.startPollingForDevices()),yield this.autoSelectAudioOutput(),this.logDevices("Init"),yield this.setOutputDevice(),this.eventBus.deviceChange.publish({devices:this.getDevices()}),t&&this.eventBus.analytics.publish(FP.deviceChange({selection:this.getCurrentSelection(),type:"list",devices:this.getDevices()})))}))}getDevices(){return{audioInput:this.audioInput,audioOutput:this.audioOutput,videoInput:this.videoInput}}cleanup(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.initialized=!1,this.earpieceSelected=!1,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.outputDevice=void 0,navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange)}createIdentifier(e){return e?`${e.deviceId}${e.groupId}`:""}getNewAudioInputDevice(){var e,t;let n=this.getManuallySelectedAudioDevice();if(n)return n;null==(t=null==(e=this.store.getLocalPeer())?void 0:e.audioTrack)||t.resetManuallySelectedDeviceId();let i=this.audioInput.find((e=>"default"===e.deviceId));return i?this.audioInput.find((e=>"default"!==e.deviceId&&i.label.includes(e.label))):this.audioInput[0]}setOutputDevice(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return OC(this,null,(function*(){let t=this.getNewAudioInputDevice(),n=this.createIdentifier(this.outputDevice);this.outputDevice=this.getAudioOutputDeviceMatchingInput(t),this.outputDevice||(this.outputDevice=this.audioOutput.find((e=>this.createIdentifier(e)===n)),this.outputDevice||(this.outputDevice=this.audioOutput.find((e=>"default"===e.deviceId))||this.audioOutput[0])),yield this.store.updateAudioOutputDevice(this.outputDevice),e&&n!==this.createIdentifier(this.outputDevice)&&(this.eventBus.analytics.publish(FP.deviceChange({selection:{audioOutput:this.outputDevice},devices:this.getDevices(),type:"audioOutput"})),this.eventBus.deviceChange.publish({selection:this.outputDevice,type:"audioOutput",devices:this.getDevices()}))}))}getManuallySelectedAudioDevice(){let e=this.store.getLocalPeer(),t=null==e?void 0:e.audioTrack;return this.audioInput.find((e=>e.deviceId===(null==t?void 0:t.getManuallySelectedDeviceId())))}categorizeAudioInputDevices(){let e=null,t=null,n=null,i=null;for(let r of this.audioInput){let s=nA(r.label);"SPEAKERPHONE"===s?t=r:"WIRED"===s?n=r:"BLUETOOTH"===s?e=r:"EARPIECE"===s&&(i=r)}return{bluetoothDevice:e,speakerPhone:t,wired:n,earpiece:i}}getAudioOutputDeviceMatchingInput(e){var t,n;let i=(null==(n=null==(t=this.store.getConfig())?void 0:t.settings)?void 0:n.speakerAutoSelectionBlacklist)||[];if("all"===i||!e)return;let r=e.label.toLowerCase()||"";if(i.some((e=>r.includes(e.toLowerCase()))))return;let s=this.audioOutput.find((t=>"default"!==e.deviceId&&t.label===e.label));if(s)return s;let o=this.audioOutput.find((t=>t.groupId===e.groupId));return o&&"default"===this.audioOutput[0].deviceId&&o.groupId===this.audioOutput[0].groupId?o:void 0}logDevices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";nP.d(this.TAG,e,JSON.stringify({videoInput:[...this.videoInput],audioInput:[...this.audioInput],audioOutput:[...this.audioOutput],selected:this.getCurrentSelection()},null,4))}},XR=class{constructor(e,t){this.deviceManager=e,this.audioSinkManager=t}getVolume(){return this.audioSinkManager.getVolume()}setVolume(e){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");this.audioSinkManager.setVolume(e)}getDevice(){return this.deviceManager.outputDevice}setDevice(e){return this.deviceManager.updateOutputDevice(e,!0)}unblockAutoplay(){return OC(this,null,(function*(){yield this.audioSinkManager.unblockAutoplay(),yield eA.resumeContext()}))}},ZR=class{static handleError(e){if(404===e.status)throw IP.APIErrors.EndpointUnreachable("FEEDBACK",e.statusText);if(e.status>=400)throw IP.APIErrors.ServerErrors(e.status,"FEEDBACK",null==e?void 0:e.statusText)}static sendFeedback(e){return OC(this,arguments,(function(e){var t=this;let{token:n,eventEndpoint:i="https://event.100ms.live",info:r,feedback:s}=e;return function*(){nP.d(t.TAG,`sendFeedback: feedbackEndpoint=${i} peerId=${r.peer.peer_id} session=${r.peer.session_id} `);let e=new URL("v2/client/feedback",i),o=NC(RC({},r),{payload:s});try{let i=yield fetch(e,{headers:{Authorization:`Bearer ${n}`},body:JSON.stringify(o),method:"POST"});try{return void t.handleError(i)}catch(a){throw nP.e(t.TAG,"error",a.message,i.status),a instanceof wP?a:IP.APIErrors.ServerErrors(i.status,"FEEDBACK",a.message)}}catch(ZC){let t=ZC;throw["Failed to fetch","NetworkError","ECONNRESET"].some((e=>t.message.includes(e)))?IP.APIErrors.EndpointUnreachable("FEEDBACK",t.message):t}}()}))}};ZR.TAG="[FeedbackService]";var eN,tN,nN=class{constructor(e,t){this.eventName=e,this.eventEmitter=t,this.publish=e=>{this.eventEmitter.emit(this.eventName,e)},this.subscribe=e=>{this.eventEmitter.on(this.eventName,e)},this.subscribeOnce=e=>{this.eventEmitter.once(this.eventName,e)},this.unsubscribe=e=>{this.eventEmitter.off(this.eventName,e)},this.waitFor=e=>this.eventEmitter.waitFor(this.eventName,{filter:e}),this.removeAllListeners=()=>{this.eventEmitter.removeAllListeners(this.eventName)}}},iN=class{constructor(){this.eventEmitter=new mI.EventEmitter2,this.analytics=new nN(c_,this.eventEmitter),this.deviceChange=new nN(ZA,this.eventEmitter),this.localAudioEnabled=new nN(e_,this.eventEmitter),this.localVideoEnabled=new nN(t_,this.eventEmitter),this.localVideoUnmutedNatively=new nN(n_,this.eventEmitter),this.localAudioUnmutedNatively=new nN(i_,this.eventEmitter),this.statsUpdate=new nN(r_,this.eventEmitter),this.trackDegraded=new nN(s_,this.eventEmitter),this.trackRestored=new nN(o_,this.eventEmitter),this.trackAudioLevelUpdate=new nN(a_,this.eventEmitter),this.audioPluginFailed=new nN(u_,this.eventEmitter),this.localAudioSilence=new nN(l_,this.eventEmitter),this.policyChange=new nN(d_,this.eventEmitter),this.localRoleUpdate=new nN(h_,this.eventEmitter),this.audioTrackUpdate=new nN(p_,this.eventEmitter),this.audioTrackAdded=new nN(f_,this.eventEmitter),this.audioTrackRemoved=new nN(m_,this.eventEmitter),this.autoplayError=new nN(g_,this.eventEmitter),this.leave=new nN(v_,this.eventEmitter),this.error=new nN(y_,this.eventEmitter)}},rN=class{constructor(e,t,n){this.store=e,this.listener=t,this.audioListener=n}handleActiveSpeakers(e){var t,n,i;let r=e["speaker-list"],s=r.map((e=>({audioLevel:e.level,peer:this.store.getPeerById(e.peer_id),track:this.store.getTrackById(e.track_id)})));null==(t=this.audioListener)||t.onAudioLevelUpdate(s),this.store.updateSpeakers(s);let o=r[0];if(o){let e=this.store.getPeerById(o.peer_id);null==(n=this.listener)||n.onPeerUpdate(4,e)}else null==(i=this.listener)||i.onPeerUpdate(5,null)}},sN=class{constructor(e){this.listener=e,this.TAG="[BroadcastManager]"}handleNotification(e,t){"on-broadcast"===e&&this.handleBroadcast(t)}handleBroadcast(e){var t,n;nP.d(this.TAG,`Received Message from sender=${null==(t=null==e?void 0:e.peer)?void 0:t.peer_id}: ${e}`),null==(n=this.listener)||n.onMessageReceived(e)}},oN=class{constructor(e,t){this.store=e,this.listener=t}handleQualityUpdate(e){var t;let n=e.peers.map((e=>{let t=this.store.getPeerById(e.peer_id);return t&&t.updateNetworkQuality(e.downlink_score),{peerID:e.peer_id,downlinkQuality:e.downlink_score}}));null==(t=this.listener)||t.onConnectionQualityUpdate(n)}},aN=class{constructor(e,t,n){var i=this;this.store=e,this.eventBus=t,this.listener=n,this.TAG="[TrackManager]",this.tracksToProcess=new Map,this.handleTrackAdd=e=>{nP.d(this.TAG,"ONTRACKADD",`${e}`),this.tracksToProcess.set(e.trackId,e),this.processPendingTracks()},this.handleTrackRemovedPermanently=e=>{nP.d(this.TAG,"ONTRACKREMOVE permanently",e),Object.keys(e.tracks).forEach((e=>{var t;let n=this.store.getTrackState(e);if(!n)return;let i=this.store.getTrackById(e);if(!i)return void nP.d(this.TAG,"Track not found in store");"audio"===i.type&&this.eventBus.audioTrackRemoved.publish(i),this.store.removeTrack(i);let r=this.store.getPeerById(n.peerId);r&&(this.removePeerTracks(r,i),null==(t=this.listener)||t.onTrackUpdate(1,i,r))}))},this.handleTrackLayerUpdate=e=>{for(let t in e.tracks){let n=e.tracks[t],i=this.store.getTrackById(t);!i||!this.store.getPeerByTrackId(t)||i instanceof w_&&this.setLayer(i,n)}},this.handleTrackUpdate=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n,r;let s=i.store.getPeerById(e.peer.peer_id),o=e.peer;if(s||o){s||(s=F_(o,i.store),i.store.addPeer(s));for(let o in e.tracks){let a=Object.assign({},null==(n=i.store.getTrackState(o))?void 0:n.trackInfo),l=e.tracks[o],c=i.store.getTrackById(o);if(i.store.setTrackState({peerId:e.peer.peer_id,trackInfo:RC(RC({},a),l)}),!c||i.tracksToProcess.has(o))i.processTrackInfo(l,e.peer.peer_id,t),i.processPendingTracks();else{c.setEnabled(!l.mute);let e=i.processTrackUpdate(c,a,l);e&&(null==(r=i.listener)||r.onTrackUpdate(e,c,s))}}}else nP.d(i.TAG,"Track Update ignored - Peer not added to store")},this.processTrackInfo=(e,t,n)=>{},this.processPendingTracks=()=>{new Map(this.tracksToProcess).forEach((e=>{var t;let n=this.store.getTrackState(e.trackId);if(!n)return void nP.d(this.TAG,"TrackState not added to store",`peerId - ${e.peerId}`,`trackId -${e.trackId}`);let i=this.store.getPeerById(n.peerId);i?(e.source=n.trackInfo.source,e.peerId=i.peerId,e.logIdentifier=i.name,e.setEnabled(!n.trackInfo.mute),this.addAudioTrack(i,e),this.addVideoTrack(i,e),"audio"===e.type?this.eventBus.audioTrackAdded.publish({track:e,peer:i}):null==(t=this.listener)||t.onTrackUpdate(0,e,i),this.tracksToProcess.delete(e.trackId)):nP.d(this.TAG,"Peer not added to store, peerId",n.peerId)}))}}handleTrackMetadataAdd(e){nP.d(this.TAG,"TRACK_METADATA_ADD",JSON.stringify(e,null,2));for(let t in e.tracks){let n=e.tracks[t];this.store.setTrackState({peerId:e.peer.peer_id,trackInfo:n})}this.processPendingTracks()}handleTrackRemove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;nP.d(this.TAG,"ONTRACKREMOVE",`${e}`);let i=this.store.getTrackState(e.trackId);if(i)if(this.store.hasTrack(e)){if(t){this.store.removeTrack(e);let t=this.store.getPeerById(i.peerId);if(!t)return;this.removePeerTracks(t,e),null==(n=this.listener)||n.onTrackUpdate(1,e,t),"audio"===e.type&&this.eventBus.audioTrackRemoved.publish(e)}}else nP.d(this.TAG,"Track not found in store")}setLayer(e,t){var n,i;let r=this.store.getPeerByTrackId(e.trackId);r&&(e.setLayerFromServer(t)?null==(n=this.listener)||n.onTrackUpdate(5,e,r):null==(i=this.listener)||i.onTrackUpdate(6,e,r))}removePeerTracks(e,t){let n=e.auxiliaryTracks.indexOf(t);n>-1?(e.auxiliaryTracks.splice(n,1),nP.d(this.TAG,"auxiliary track removed",`${t}`)):"audio"===t.type&&e.audioTrack===t?(e.audioTrack=void 0,nP.d(this.TAG,"audio track removed",`${t}`)):"video"===t.type&&e.videoTrack===t&&(e.videoTrack=void 0,nP.d(this.TAG,"video track removed",`${t}`))}addAudioTrack(e,t){var n;"audio"===t.type&&("regular"!==t.source||e.audioTrack&&(null==(n=e.audioTrack)?void 0:n.trackId)!==t.trackId?e.auxiliaryTracks.push(t):e.audioTrack=t,this.store.addTrack(t),nP.d(this.TAG,"audio track added",`${t}`))}addVideoTrack(e,t){if("video"!==t.type)return;let n=t,i=this.store.getSimulcastDefinitionsForPeer(e,n.source);if(n.setSimulcastDefinitons(i),this.addAsPrimaryVideoTrack(e,n))e.videoTrack?e.videoTrack.replaceTrack(n):e.videoTrack=n,this.store.addTrack(e.videoTrack);else{let t=e.auxiliaryTracks.findIndex((e=>e.trackId===n.trackId));-1===t?(e.auxiliaryTracks.push(n),this.store.addTrack(n)):(e.auxiliaryTracks[t].replaceTrack(n),this.store.addTrack(e.auxiliaryTracks[t]))}nP.d(this.TAG,"video track added",`${t}`)}addAsPrimaryVideoTrack(e,t){var n;return"regular"===t.source&&(!e.videoTrack||(null==(n=e.videoTrack)?void 0:n.trackId)===t.trackId)}processTrackUpdate(e,t,n){let i;return t.mute!==n.mute?(i=n.mute?2:3,"audio"===e.type&&this.eventBus.audioTrackUpdate.publish({track:e,enabled:!n.mute})):t.description!==n.description&&(i=4),i}},lN=class extends aN{constructor(e,t,n,i){var r;super(e,t,i),r=this,this.transport=n,this.TAG="[OnDemandTrackManager]",this.processTrackInfo=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var i,s;if("video"!==e.type)return;let o=r.store.getPeerById(t);if(!o||!r.isPeerRoleSubscribed(t))return void nP.d(r.TAG,`no peer in store for peerId: ${t}`);let a=new S_(new MediaStream,r.transport.getSubscribeConnection()),l=HA.getEmptyVideoTrack();l.enabled=!e.mute;let c=new w_(a,l,e.source,null==(i=r.store.getRoom())?void 0:i.disableNoneLayerRequest);c.setTrackId(e.track_id),c.peerId=o.peerId,c.logIdentifier=o.name,r.addVideoTrack(o,c),n&&(null==(s=r.listener)||s.onTrackUpdate(0,o.videoTrack,o))}}handleTrackMetadataAdd(e){super.handleTrackMetadataAdd(e);for(let t in e.tracks)"video"===e.tracks[t].type&&this.processTrackInfo(e.tracks[t],e.peer.peer_id)}handleTrackRemove(e){let t="video"===e.type&&"regular"===e.source;super.handleTrackRemove(e,!t),t&&this.processTrackInfo({track_id:e.trackId,mute:!e.enabled,type:e.type,source:e.source,stream_id:e.stream.id},e.peerId,!1)}addAsPrimaryVideoTrack(e,t){return"regular"===t.source&&(!e.videoTrack||e.videoTrack.trackId===t.trackId||e.videoTrack.enabled&&XP(e.videoTrack.nativeTrack))}isPeerRoleSubscribed(e){var t,n,i,r;if(!e)return!0;let s=this.store.getLocalPeer(),o=this.store.getPeerById(e);return o&&(null==(r=null==(n=null==(t=null==s?void 0:s.role)?void 0:t.subscribeParams)?void 0:n.subscribeToRoles)?void 0:r.includes(null==(i=o.role)?void 0:i.name))}},cN=class{constructor(e,t,n,i){this.store=e,this.peerManager=t,this.trackManager=n,this.listener=i,this.TAG="[PeerListManager]",this.handleInitialPeerList=e=>{let t=Object.values(e.peers);this.peerManager.handlePeerList(t)},this.handleReconnectPeerList=e=>{this.handleRepeatedPeerList(e.peers)},this.handlePreviewRoomState=e=>{if(!this.store.hasRoleDetailsArrived())return;let t=e.peers;null!=t?(Object.keys(t).forEach((e=>{t[e].tracks={},t[e].is_from_room_state=!0})),this.handleRepeatedPeerList(t)):0===e.peer_count&&this.handleRepeatedPeerList({})},this.handleRepeatedPeerList=e=>{let t=this.store.getRemotePeers(),n=Object.values(e),i=t.filter((t=>!e[t.peerId]));i.length>0&&nP.d(this.TAG,`${i}`),i.forEach((e=>{var t;let n={peer_id:e.peerId,role:(null==(t=e.role)?void 0:t.name)||"",info:{name:e.name,data:e.metadata||"",user_id:e.customerUserId||"",type:e.type},tracks:{},groups:[],realtime:e.realtime};this.peerManager.handlePeerLeave(n)}));let r=[];n.forEach((e=>{let t=this.store.getPeerById(e.peer_id),n=Object.values(e.tracks);t&&(this.store.getPeerTracks(t.peerId).forEach((n=>{var i;e.tracks[n.trackId]||(this.removePeerTrack(t,n.trackId),null==(i=this.listener)||i.onTrackUpdate(1,n,t))})),n.forEach((e=>{this.store.getTrackById(e.track_id)||this.store.setTrackState({peerId:t.peerId,trackInfo:e})})),this.trackManager.handleTrackUpdate({peer:e,tracks:e.tracks},!1),this.peerManager.handlePeerUpdate(e)),r.push(e)})),r.length>0&&this.peerManager.handlePeerList(r)}}handleNotification(e,t,n){if("peer-list"===e){let e=t;n?(nP.d(this.TAG,"RECONNECT_PEER_LIST event",JSON.stringify(e,null,2)),this.handleReconnectPeerList(e)):(nP.d(this.TAG,"PEER_LIST event",JSON.stringify(e,null,2)),this.handleInitialPeerList(e))}else if("room-state"===e){let e=t;this.handlePreviewRoomState(e)}}removePeerTrack(e,t){var n,i;if(nP.d(this.TAG,`removing track - ${t} from ${e}`),(null==(n=e.audioTrack)?void 0:n.trackId)===t)e.audioTrack=void 0;else if((null==(i=e.videoTrack)?void 0:i.trackId)===t)e.videoTrack=void 0;else{let n=e.auxiliaryTracks.findIndex((e=>e.trackId===t));n>=0&&e.auxiliaryTracks.splice(n,1)}}},uN=e=>e?new Date(e):void 0,dN=class{constructor(e,t,n){this.store=e,this.trackManager=t,this.listener=n,this.TAG="[PeerManager]",this.handlePeerList=e=>{var t,n;if(0===e.length)return void(null==(t=this.listener)||t.onPeerUpdate(9,[]));let i=[],r=new Set(e.map((e=>e.peer_id)));this.store.getRemotePeers().forEach((e=>{let{peerId:t,fromRoomState:n}=e;!r.has(t)&&n&&this.store.removePeer(t)}));for(let s of e)i.push(this.makePeer(s));null==(n=this.listener)||n.onPeerUpdate(9,i),this.trackManager.processPendingTracks()},this.handlePeerJoin=e=>{var t;let n=this.makePeer(e);null==(t=this.listener)||t.onPeerUpdate(0,n),this.trackManager.processPendingTracks()},this.handlePeerLeave=e=>{var t,n,i,r;let s=this.store.getPeerById(e.peer_id);this.store.removePeer(e.peer_id),nP.d(this.TAG,"PEER_LEAVE",e.peer_id,`remainingPeers=${this.store.getPeers().length}`),s&&(s.audioTrack&&(null==(t=this.listener)||t.onTrackUpdate(1,s.audioTrack,s)),s.videoTrack&&(null==(n=this.listener)||n.onTrackUpdate(1,s.videoTrack,s)),null==(i=s.auxiliaryTracks)||i.forEach((e=>{var t;null==(t=this.listener)||t.onTrackUpdate(1,e,s)})),null==(r=this.listener)||r.onPeerUpdate(1,s))}}handleNotification(e,t){switch(e){case"on-peer-join":{let e=t;this.handlePeerJoin(e);break}case"on-peer-leave":{let e=t;this.handlePeerLeave(e);break}case"on-peer-update":this.handlePeerUpdate(t)}}handlePeerUpdate(e){var t,n,i,r,s;let o=this.store.getPeerById(e.peer_id);if(!o&&e.realtime)return o=this.makePeer(e),void(null==(t=this.listener)||t.onPeerUpdate(o.isHandRaised?12:14,o));if(o&&!o.isLocal&&!e.realtime)return this.store.removePeer(o.peerId),void(null==(n=this.listener)||n.onPeerUpdate(13,o));if(!o)return void nP.d(this.TAG,`peer ${e.peer_id} not found`);if(o.role&&o.role.name!==e.role){let t=this.store.getPolicyForRole(e.role);o.updateRole(t),this.updateSimulcastLayersForPeer(o),null==(i=this.listener)||i.onPeerUpdate(8,o)}let a=o.isHandRaised;o.updateGroups(e.groups),a!==(null==(r=e.groups)?void 0:r.includes(b_))&&(null==(s=this.listener)||s.onPeerUpdate(12,o)),this.handlePeerInfoUpdate(RC({peer:o},e.info))}handlePeerInfoUpdate(e){let{peer:t,name:n,data:i}=e;var r,s;t&&(n&&t.name!==n&&(t.updateName(n),null==(r=this.listener)||r.onPeerUpdate(10,t)),i&&t.metadata!==i&&(t.updateMetadata(i),null==(s=this.listener)||s.onPeerUpdate(11,t)))}makePeer(e){let t=this.store.getPeerById(e.peer_id);t||(t=F_(e,this.store),t.realtime=e.realtime,t.joinedAt=uN(e.joined_at),t.fromRoomState=!!e.is_from_room_state,this.store.addPeer(t),nP.d(this.TAG,"adding to the peerList",`${t}`));for(let n in e.tracks){let t=e.tracks[n];this.store.setTrackState({peerId:e.peer_id,trackInfo:t}),"video"===t.type&&this.trackManager.processTrackInfo(t,e.peer_id,!1)}return t}updateSimulcastLayersForPeer(e){this.store.getPeerTracks(e.peerId).forEach((t=>{if("video"===t.type&&["regular","screen"].includes(t.source)){let n=t,i=this.store.getSimulcastDefinitionsForPeer(e,n.source);n.setSimulcastDefinitons(i)}}))}},hN=class{constructor(e,t){this.store=e,this.eventBus=t}handlePolicyChange(e){let t=this.store.getLocalPeer();if(t&&!t.role){let n=e.known_roles[e.name];t.updateRole(n)}this.store.setKnownRoles(e);let n=this.store.getRoom();n?n.templateId=e.template_id:nP.w("[PolicyChangeManager]","on policy change - room not present"),this.updateLocalPeerRole(e),this.eventBus.policyChange.publish(e)}updateLocalPeerRole(e){var t;let n=this.store.getLocalPeer();if(null!=n&&n.role&&n.role.name!==e.name){let i=this.store.getPolicyForRole(e.name),r=n.role;n.updateRole(i),i.name===(null==(t=n.asRole)?void 0:t.name)&&delete n.asRole,this.eventBus.localRoleUpdate.publish({oldRole:r,newRole:i})}}},pN=((eN=pN||{}).FLAG_SERVER_SUB_DEGRADATION="subscribeDegradation",eN.FLAG_SERVER_SIMULCAST="simulcast",eN.FLAG_NON_WEBRTC_DISABLE_OFFER="nonWebRTCDisableOffer",eN.FLAG_PUBLISH_STATS="publishStats",eN.FLAG_SUBSCRIBE_STATS="subscribeStats",eN.FLAG_ON_DEMAND_TRACKS="onDemandTracks",eN.FLAG_DISABLE_VIDEO_TRACK_AUTO_UNSUBSCRIBE="disableVideoTrackAutoUnsubscribe",eN.FLAG_WHITEBOARD_ENABLED="whiteboardEnabled",eN.FLAG_EFFECTS_SDK_ENABLED="effectsSDKEnabled",eN.FLAG_VB_ENABLED="vb",eN.FLAG_HIPAA_ENABLED="hipaa",eN.FLAG_NOISE_CANCELLATION="noiseCancellation",eN.FLAG_SCALE_SCREENSHARE_BASED_ON_PIXELS="scaleScreenshareBasedOnPixels",eN.FLAG_DISABLE_NONE_LAYER_REQUEST="disableNoneLayerRequest",eN),fN=(e,t,n)=>{let i=new URL("qa"===n?"https://whiteboard-qa.100ms.live":"https://whiteboard.100ms.live");return i.searchParams.set("endpoint",`https://${t}`),i.searchParams.set("token",e),i.toString()},mN=class{constructor(e,t,n){this.transport=e,this.store=t,this.listener=n,this.TAG="[HMSWhiteboardInteractivityCenter]"}get isEnabled(){return this.transport.isFlagEnabled("whiteboardEnabled")}open(e){return OC(this,null,(function*(){var t;if(!this.isEnabled)return nP.w(this.TAG,"Whiteboard is not enabled for customer");let n=this.store.getWhiteboard(null==e?void 0:e.id),i=null==n?void 0:n.id;if(n||(i=(yield this.transport.signal.createWhiteboard(this.getCreateOptionsWithDefaults(e))).id),!i)throw new Error(`Whiteboard ID: ${i} not found`);let r=yield this.transport.signal.getWhiteboard({id:i}),s=NC(RC({},n),{title:null==e?void 0:e.title,attributes:null==e?void 0:e.attributes,id:r.id,url:fN(r.token,r.addr,this.store.getEnv()),token:r.token,addr:r.addr,owner:r.owner,permissions:r.permissions||[],open:!0});this.store.setWhiteboard(s),null==(t=this.listener)||t.onWhiteboardUpdate(s)}))}close(e){return OC(this,null,(function*(){var t;if(!this.isEnabled)return nP.w(this.TAG,"Whiteboard is not enabled for customer");let n=this.store.getWhiteboard(e);if(!n)throw new Error(`Whiteboard ID: ${e} not found`);let i={id:n.id,title:n.title,open:!1};this.store.setWhiteboard(i),null==(t=this.listener)||t.onWhiteboardUpdate(i)}))}setListener(e){this.listener=e}handleLocalRoleUpdate(){return OC(this,null,(function*(){var e,t,n;let i=this.store.getWhiteboards();for(let r of i.values())if(r.url){let i=yield this.transport.signal.getWhiteboard({id:r.id}),s=this.store.getLocalPeer(),o=(null==s?void 0:s.customerUserId)===i.owner?null==(t=null==(e=s.role)?void 0:e.permissions.whiteboard)?void 0:t.includes("admin"):i.permissions.length>0,a=NC(RC({},r),{id:i.id,url:fN(i.token,i.addr,this.store.getEnv()),token:i.token,addr:i.addr,owner:i.owner,permissions:i.permissions,open:o});this.store.setWhiteboard(a),null==(n=this.listener)||n.onWhiteboardUpdate(a)}}))}getCreateOptionsWithDefaults(e){var t;let n=Object.values(this.store.getKnownRoles()),i=[],r=[],s=[];return n.forEach((e=>{var t,n,o;null!=(t=e.permissions.whiteboard)&&t.includes("read")&&i.push(e.name),null!=(n=e.permissions.whiteboard)&&n.includes("write")&&r.push(e.name),null!=(o=e.permissions.whiteboard)&&o.includes("admin")&&s.push(e.name)})),{title:(null==e?void 0:e.title)||`${null==(t=this.store.getRoom())?void 0:t.id} Whiteboard`,reader:(null==e?void 0:e.reader)||i,writer:(null==e?void 0:e.writer)||r,admin:(null==e?void 0:e.admin)||s}}},gN=class{constructor(e,t,n){this.transport=e,this.store=t,this.listener=n,this.whiteboard=new mN(e,t,n)}setListener(e){this.listener=e,this.whiteboard.setListener(e)}createPoll(e){return OC(this,null,(function*(){var t,n;let{poll_id:i}=yield this.transport.signal.setPollInfo(NC(RC({},e),{mode:e.mode?{customerID:"userid",peerID:"peerid",userName:"username"}[e.mode]:void 0,poll_id:e.id,vote:e.rolesThatCanVote,responses:e.rolesThatCanViewResponses}));e.id||(e.id=i),Array.isArray(e.questions)&&(yield this.addQuestionsToPoll(e.id,e.questions));let r=yield this.transport.signal.getPollQuestions({poll_id:e.id,index:0,count:50}),s=vN(NC(RC({},e),{poll_id:e.id,state:"created",created_by:null==(t=this.store.getLocalPeer())?void 0:t.peerId}));s.questions=r.questions.map((e=>{let{question:t,options:n,answer:i}=e;return NC(RC({},t),{options:n,answer:i})})),null==(n=this.listener)||n.onPollsUpdate(0,[s])}))}startPoll(e){return OC(this,null,(function*(){"string"==typeof e?yield this.transport.signal.startPoll({poll_id:e}):(yield this.createPoll(e),yield this.transport.signal.startPoll({poll_id:e.id}))}))}addQuestionsToPoll(e,t){return OC(this,null,(function*(){t.length>0&&(yield this.transport.signal.setPollQuestions({poll_id:e,questions:t.map(((e,t)=>this.createQuestionSetParams(e,t)))}))}))}stopPoll(e){return OC(this,null,(function*(){yield this.transport.signal.stopPoll({poll_id:e})}))}addResponsesToPoll(e,t){return OC(this,null,(function*(){let n=this.store.getPoll(e);if(!n)throw new Error("Invalid poll ID - Poll not found");let i=t.map((e=>{var t,i;let r=this.getQuestionInPoll(n,e.questionIndex);return"single-choice"===r.type?(e.option=e.option||(null==(t=e.options)?void 0:t[0])||-1,delete e.text,delete e.options):"multiple-choice"===r.type?(null==(i=e.options)||i.sort(),delete e.text,delete e.option):(delete e.option,delete e.options),e.skipped&&(delete e.option,delete e.options,delete e.text),RC({duration:0,type:r.type,question:e.questionIndex},e)}));yield this.transport.signal.setPollResponses({poll_id:e,responses:i})}))}fetchLeaderboard(e,t,n){return OC(this,null,(function*(){var i,r;let s=this.store.getPoll(e);if(!s)throw new Error("Invalid poll ID - Poll not found");let o=null==(r=null==(i=this.store.getLocalPeer())?void 0:i.role)?void 0:r.permissions,a=!!(null!=o&&o.pollRead||null!=o&&o.pollWrite);if(s.anonymous||"stopped"!==s.state||!a)return{entries:[],hasNext:!1};let l=yield this.transport.signal.fetchPollLeaderboard({poll_id:s.id,count:n,offset:t}),c={avgScore:l.avg_score,avgTime:l.avg_time,votedUsers:l.voted_users,totalUsers:l.total_users,correctUsers:l.correct_users};return{entries:l.questions.map((e=>({position:e.position,totalResponses:e.total_responses,correctResponses:e.correct_responses,duration:e.duration,peer:e.peer,score:e.score}))),hasNext:!l.last,summary:c}}))}getPollResponses(e,t){return OC(this,null,(function*(){var n,i;let r=yield this.transport.signal.getPollResponses({poll_id:e.id,index:0,count:50,self:t}),s=JSON.parse(JSON.stringify(e));null==(n=r.responses)||n.forEach((n=>{let{response:i,peer:r,final:o}=n;var a,l;let c=null==(a=null==e?void 0:e.questions)?void 0:a.find((e=>e.index===i.question));if(c){let e={id:i.response_id,questionIndex:i.question,option:i.option,options:i.options,text:i.text,responseFinal:o,peer:{peerid:r.peerid,userHash:r.hash,userid:r.userid,username:r.username},skipped:i.skipped,type:i.type,update:i.update},n=c.responses&&!t?[...c.responses]:[];null!=(l=s.questions)&&l[i.question-1]&&(s.questions[i.question-1].responses=[...n,e])}})),this.store.setPoll(s),null==(i=this.listener)||i.onPollsUpdate(4,[s])}))}getPolls(){return OC(this,null,(function*(){var e,t,n;let i=yield this.transport.signal.getPollsList({count:50,state:"started"}),r=[],s=null==(t=null==(e=this.store.getLocalPeer())?void 0:e.role)?void 0:t.permissions.pollWrite,o=[...i.polls];if(s){let e=yield this.transport.signal.getPollsList({count:50,state:"created"}),t=yield this.transport.signal.getPollsList({count:50,state:"stopped"});o=[...e.polls,...o,...t.polls]}for(let a of o){let e=yield this.transport.signal.getPollQuestions({poll_id:a.poll_id,index:0,count:50}),t=vN(a),n=this.store.getPoll(a.poll_id);t.questions=e.questions.map(((e,t)=>{let{question:i,options:r,answer:s}=e;var o,a;return NC(RC({},i),{options:r,answer:s,responses:null==(a=null==(o=null==n?void 0:n.questions)?void 0:o[t])?void 0:a.responses})})),r.push(t),this.store.setPoll(t)}return null==(n=this.listener)||n.onPollsUpdate(3,r),r}))}createQuestionSetParams(e,t){var n,i;if(e.index){let i=null==(n=e.options)?void 0:n.map(((e,t)=>NC(RC({},e),{index:t+1})));return{question:NC(RC({},e),{index:t+1}),options:i,answer:e.answer}}let r,s=NC(RC({},e),{index:t+1}),o=e.answer||{hidden:!1};return Array.isArray(e.options)&&["single-choice","multiple-choice"].includes(e.type)?(r=null==(i=e.options)?void 0:i.map(((e,t)=>({index:t+1,text:e.text,weight:e.weight}))),"single-choice"===e.type?o.option=e.options.findIndex((e=>e.isCorrectAnswer))+1||void 0:o.options=e.options.map(((e,t)=>e.isCorrectAnswer?t+1:void 0)).filter((e=>!!e))):(null==o||delete o.options,null==o||delete o.option),{question:s,options:r,answer:o}}getQuestionInPoll(e,t){var n;let i=null==(n=null==e?void 0:e.questions)?void 0:n.find((e=>e.index===t));if(!i)throw new Error("Invalid question index - Question not found in poll");return i}},vN=e=>({id:e.poll_id,title:e.title,startedBy:e.started_by,createdBy:e.created_by,anonymous:e.anonymous,type:e.type,duration:e.duration,locked:e.locked,mode:e.mode?{userid:"customerID",peerid:"peerID",username:"userName"}[e.mode]:void 0,visibility:e.visibility,rolesThatCanVote:e.vote||[],rolesThatCanViewResponses:e.responses||[],state:e.state,stoppedBy:e.stopped_by,startedAt:uN(e.started_at),stoppedAt:uN(e.stopped_at),createdAt:uN(e.created_at)}),yN=class{constructor(e,t,n){this.store=e,this.transport=t,this.listener=n}handleNotification(e,t){switch(e){case"on-poll-start":this.handlePollStart(t);break;case"on-poll-stop":this.handlePollStop(t);break;case"on-poll-stats":this.handlePollStats(t)}}handlePollStart(e){return OC(this,null,(function*(){var t,n;let i=[];for(let r of e.polls){let e=this.store.getPoll(r.poll_id);if(e&&"started"===e.state)return void(null==(t=this.listener)||t.onPollsUpdate(1,[e]));let n=yield this.transport.signal.getPollQuestions({poll_id:r.poll_id,index:0,count:50}),s=vN(r);s.questions=n.questions.map((e=>{let{question:t,options:n,answer:i}=e;return NC(RC({},t),{options:n,answer:i})})),yield this.updatePollResponses(s,!0),i.push(s),this.store.setPoll(s)}null==(n=this.listener)||n.onPollsUpdate(1,i)}))}handlePollStop(e){return OC(this,null,(function*(){var t;let n=[];for(let i of e.polls){let e=this.store.getPoll(i.poll_id);if(e){e.state="stopped",e.stoppedAt=uN(i.stopped_at),e.stoppedBy=i.stopped_by;let t=yield this.transport.signal.getPollResult({poll_id:i.poll_id});this.updatePollResult(e,t),n.push(e)}}n.length>0&&(null==(t=this.listener)||t.onPollsUpdate(2,n))}))}handlePollStats(e){return OC(this,null,(function*(){var t;let n=[];for(let i of e.polls){let e=this.store.getPoll(i.poll_id);if(!e)return;this.updatePollResult(e,i),n.push(e)}n.length>0&&(null==(t=this.listener)||t.onPollsUpdate(4,n))}))}updatePollResult(e,t){var n;e.result=RC({},e.result),e.result.totalUsers=t.user_count,e.result.maxUsers=t.max_user,e.result.totalResponses=t.total_response,null==(n=t.questions)||n.forEach((t=>{var n,i;let r=null==(n=e.questions)?void 0:n.find((e=>e.index===t.question));r&&(r.result=RC({},r.result),r.result.correctResponses=t.correct,r.result.skippedCount=t.skipped,r.result.totalResponses=t.total,null==(i=t.options)||i.forEach(((e,t)=>{var n;let i=null==(n=r.options)?void 0:n[t];i&&i.voteCount!==e&&(i.voteCount=e)})))}))}updatePollResponses(e,t){return OC(this,null,(function*(){var n;null==(n=(yield this.transport.signal.getPollResponses({poll_id:e.id,index:0,count:50,self:t})).responses)||n.forEach((t=>{let{response:n,peer:i,final:r}=t;var s;let o=null==(s=null==e?void 0:e.questions)?void 0:s.find((e=>e.index===n.question));if(!o)return;let a={id:n.response_id,questionIndex:n.question,option:n.option,options:n.options,text:n.text,responseFinal:r,peer:{peerid:i.peerid,userHash:i.hash,userid:i.userid,username:i.username},skipped:n.skipped,type:n.type,update:n.update};Array.isArray(o.responses)&&o.responses.length>0?o.responses.find((e=>{let{id:t}=e;return t===a.id}))||o.responses.push(a):o.responses=[a]}))}))}},bN=class{constructor(e,t){this.store=e,this.listener=t}handleNotification(e,t){switch(e){case"on-role-change-request":this.handleRoleChangeRequest(t);break;case"on-track-update-request":this.handleTrackUpdateRequest(t);break;case"on-change-track-mute-state-request":this.handleChangeTrackStateRequest(t);break;default:return}}handleRoleChangeRequest(e){var t;let n={requestedBy:e.requested_by?this.store.getPeerById(e.requested_by):void 0,role:this.store.getPolicyForRole(e.role),token:e.token};null==(t=this.listener)||t.onRoleChangeRequest(n)}handleTrackUpdateRequest(e){let{requested_by:t,track_id:n,mute:i}=e,r=t?this.store.getPeerById(t):void 0,s=this.store.getLocalPeerTracks().find((e=>e.publishedTrackId===n));if(!s)return;let o=()=>{var e;null==(e=this.listener)||e.onChangeTrackStateRequest({requestedBy:r,track:s,enabled:!i})};if(i){if(s.enabled===!i)return;s.setEnabled(!i).then(o)}else o()}handleChangeTrackStateRequest(e){var t;let{type:n,source:i,value:r,requested_by:s}=e,o=s?this.store.getPeerById(s):void 0,a=!r,l=this.getTracksToBeUpdated({type:n,source:i,enabled:a});if(0!==l.length)if(a)null==(t=this.listener)||t.onChangeMultiTrackStateRequest({requestedBy:o,tracks:l,type:n,source:i,enabled:!0});else{let e=[];for(let t of l)e.push(t.setEnabled(!1));Promise.all(e).then((()=>{var e;null==(e=this.listener)||e.onChangeMultiTrackStateRequest({requestedBy:o,tracks:l,enabled:!1})}))}}getTracksToBeUpdated(e){let{type:t,source:n,enabled:i}=e,r=this.store.getLocalPeerTracks();return t&&(r=r.filter((e=>e.type===t))),n&&(r=r.filter((e=>e.source===n))),r.filter((e=>e.enabled!==i))}},wN=class{constructor(e,t){this.store=e,this.listener=t,this.TAG="[RoomUpdateManager]"}handleNotification(e,t){switch(e){case"peer-list":this.onRoomState(t.room);break;case"on-rtmp-update":this.updateRTMPStatus(t);break;case"on-record-update":this.updateRecordingStatus(t);break;case"room-state":this.handlePreviewRoomState(t);break;case"room-info":this.handleRoomInfo(t);break;case"session-info":this.handleSessionInfo(t);break;case"on-hls-update":this.updateHLSStatus(t);break;case"on-transcription-update":this.handleTranscriptionStatus([t])}}handleRoomInfo(e){let t=this.store.getRoom();t?(t.description=e.description,t.large_room_optimization=e.large_room_optimization,t.max_size=e.max_size,t.name=e.name):nP.w(this.TAG,"on session info - room not present")}handleSessionInfo(e){var t;let n=this.store.getRoom();n?(n.sessionId=e.session_id,n.peerCount!==e.peer_count&&(n.peerCount=e.peer_count,null==(t=this.listener)||t.onRoomUpdate("ROOM_PEER_COUNT_UPDATED",n))):nP.w(this.TAG,"on session info - room not present")}handlePreviewRoomState(e){let{room:t}=e;this.onRoomState(t)}onRoomState(e){var t,n,i,r;let{recording:s,streaming:o,transcriptions:a,session_id:l,started_at:c,name:u}=e,d=this.store.getRoom();d?(d.name=u,d.rtmp.running=this.isStreamingRunning(null==(t=null==o?void 0:o.rtmp)?void 0:t.state),d.rtmp.startedAt=uN(null==(n=null==o?void 0:o.rtmp)?void 0:n.started_at),d.rtmp.state=null==(i=null==o?void 0:o.rtmp)?void 0:i.state,d.recording.server=this.getPeerListSFURecording(s),d.recording.browser=this.getPeerListBrowserRecording(s),d.recording.hls=this.getPeerListHLSRecording(s),d.hls=this.convertHls(null==o?void 0:o.hls),d.transcriptions=this.addTranscriptionDetail(a),d.sessionId=l,d.startedAt=uN(c),null==(r=this.listener)||r.onRoomUpdate("RECORDING_STATE_UPDATED",d)):nP.w(this.TAG,"on room state - room not present")}addTranscriptionDetail(e){return e?e.map((e=>({state:e.state,mode:e.mode,initialised_at:uN(e.initialised_at),started_at:uN(e.started_at),stopped_at:uN(e.stopped_at),updated_at:uN(e.updated_at),error:this.toSdkError(null==e?void 0:e.error)}))):[]}isRecordingRunning(e){return!!e&&!["none","paused","stopped","failed"].includes(e)}isStreamingRunning(e){return!!e&&!["none","stopped","failed"].includes(e)}initHLS(e){let t=this.store.getRoom(),n={running:!0,variants:[]};return t?(null!=e&&e.variants&&e.variants.forEach(((t,i)=>{var r,s,o;"initialised"!==t.state?n.variants.push({meetingURL:null==t?void 0:t.meetingURL,url:null==t?void 0:t.url,metadata:null==t?void 0:t.metadata,playlist_type:null==t?void 0:t.playlist_type,startedAt:uN(null==(r=null==e?void 0:e.variants)?void 0:r[i].started_at),initialisedAt:uN(null==(s=null==e?void 0:e.variants)?void 0:s[i].initialised_at),state:t.state,stream_type:null==t?void 0:t.stream_type}):n.variants.push({initialisedAt:uN(null==(o=null==e?void 0:e.variants)?void 0:o[i].initialised_at),url:""})})),n):(nP.w(this.TAG,"on hls - room not present"),n)}updateHLSStatus(e){var t;let n=this.store.getRoom(),i=!!(e.variants&&e.variants.length>0)&&e.variants.some((e=>this.isStreamingRunning(e.state)));n?(e.enabled=i,n.hls=this.convertHls(e),null==(t=this.listener)||t.onRoomUpdate("HLS_STREAMING_STATE_UPDATED",n)):nP.w(this.TAG,"on hls - room not present")}handleTranscriptionStatus(e){var t;let n=this.store.getRoom();n?(n.transcriptions=this.addTranscriptionDetail(e)||[],null==(t=this.listener)||t.onRoomUpdate("TRANSCRIPTION_STATE_UPDATED",n)):nP.w(this.TAG,"on transcription - room not present")}convertHls(e){var t;if(null!=e&&e.variants&&e.variants.length>0&&e.variants.some((e=>"initialised"===e.state)))return this.initHLS(e);let n={running:!(null==e||!e.enabled),variants:[],error:this.toSdkError(null==e?void 0:e.error)};return null==(t=null==e?void 0:e.variants)||t.forEach((e=>{n.variants.push({meetingURL:null==e?void 0:e.meeting_url,url:null==e?void 0:e.url,metadata:null==e?void 0:e.metadata,playlist_type:null==e?void 0:e.playlist_type,startedAt:uN(null==e?void 0:e.started_at),initialisedAt:uN(null==e?void 0:e.initialised_at),state:e.state,stream_type:null==e?void 0:e.stream_type})})),n}getHLSRecording(e){var t,n;let i={running:!1},r=this.isRecordingRunning(null==e?void 0:e.state);return(r||"paused"===(null==e?void 0:e.state))&&(i={running:r,singleFilePerLayer:!(null==(t=null==e?void 0:e.hls_recording)||!t.single_file_per_layer),hlsVod:!(null==(n=null==e?void 0:e.hls_recording)||!n.hls_vod),startedAt:uN(null==e?void 0:e.started_at),initialisedAt:uN(null==e?void 0:e.initialised_at),state:null==e?void 0:e.state,error:this.toSdkError(null==e?void 0:e.error)}),i}getPeerListHLSRecording(e){var t,n;let i=null==e?void 0:e.hls;return{running:this.isRecordingRunning(null==i?void 0:i.state),startedAt:uN(null==i?void 0:i.started_at),initialisedAt:uN(null==i?void 0:i.initialised_at),state:null==i?void 0:i.state,singleFilePerLayer:null==(t=null==i?void 0:i.config)?void 0:t.single_file_per_layer,hlsVod:null==(n=null==i?void 0:i.config)?void 0:n.hls_vod}}getPeerListBrowserRecording(e){let t=null==e?void 0:e.browser;return{running:this.isRecordingRunning(null==t?void 0:t.state),startedAt:uN(null==t?void 0:t.started_at),state:null==t?void 0:t.state}}getPeerListSFURecording(e){let t=null==e?void 0:e.sfu;return{running:this.isRecordingRunning(null==t?void 0:t.state),startedAt:uN(null==t?void 0:t.started_at),state:null==t?void 0:t.state}}updateRecordingStatus(e){var t;let n,i=this.store.getRoom(),r=this.isRecordingRunning(e.state);i?("sfu"===e.type?(i.recording.server={running:r,startedAt:r?uN(e.started_at):void 0,error:this.toSdkError(e.error),state:e.state},n="SERVER_RECORDING_STATE_UPDATED"):"HLS"===e.type?(i.recording.hls=this.getHLSRecording(e),n="RECORDING_STATE_UPDATED"):(i.recording.browser={running:r,startedAt:r?uN(e.started_at):void 0,error:this.toSdkError(e.error),state:null==e?void 0:e.state},n="BROWSER_RECORDING_STATE_UPDATED"),null==(t=this.listener)||t.onRoomUpdate(n,i)):nP.w(this.TAG,`set recording status running=${r} - room not present`)}updateRTMPStatus(e){var t,n;let i=this.store.getRoom(),r=this.isStreamingRunning(e.state);if(i)return r?(i.rtmp={running:r,startedAt:r?uN(e.started_at):void 0,state:e.state,error:this.toSdkError(e.error)},void(null==(n=this.listener)||n.onRoomUpdate("RTMP_STREAMING_STATE_UPDATED",i))):(i.rtmp={running:r,state:e.state,error:this.toSdkError(e.error)},void(null==(t=this.listener)||t.onRoomUpdate("RTMP_STREAMING_STATE_UPDATED",i)));nP.w(this.TAG,"on policy change - room not present")}toSdkError(e){if(null==e||!e.code)return;let t=e.message||"error in streaming/recording",n=new wP(e.code,"ServerErrors","NONE",t,t);return nP.e(this.TAG,"error in streaming/recording",n),n}},kN=class{constructor(e,t){this.store=e,this.listener=t}handleNotification(e,t){"on-metadata-change"===e&&this.handleMetadataChange(t)}handleMetadataChange(e){var t;let n=e.values.map((e=>({key:e.key,value:e.data,updatedAt:uN(e.updated_at),updatedBy:e.updated_by?this.store.getPeerById(e.updated_by):void 0})));null==(t=this.listener)||t.onSessionStoreUpdate(n)}},TN=class{constructor(e,t,n){this.store=e,this.transport=t,this.listener=n}handleNotification(e,t){if("on-whiteboard-update"===e)this.handleWhiteboardUpdate(t)}handleWhiteboardUpdate(e){return OC(this,null,(function*(){var t;let n=this.store.getLocalPeer(),i=this.store.getWhiteboard(e.id),r=e.owner===(null==n?void 0:n.peerId)||e.owner===(null==n?void 0:n.customerUserId),s="open"===e.state,o={id:e.id,title:e.title,attributes:e.attributes};if(o.open=r?null==i?void 0:i.open:s,o.owner=o.open?e.owner:void 0,o.open)if(r)o.url=null==i?void 0:i.url,o.token=null==i?void 0:i.token,o.addr=null==i?void 0:i.addr,o.permissions=null==i?void 0:i.permissions;else{let t=yield this.transport.signal.getWhiteboard({id:e.id});o.url=fN(t.token,t.addr,this.store.getEnv()),o.token=t.token,o.addr=t.addr,o.permissions=t.permissions,o.open=t.permissions.length>0}this.store.setWhiteboard(o),null==(t=this.listener)||t.onWhiteboardUpdate(o)}))}},SN=class{constructor(e,t,n,i,r,s){this.store=e,this.transport=n,this.listener=i,this.audioListener=r,this.connectionQualityListener=s,this.TAG="[HMSNotificationManager]",this.hasConsistentRoomStateArrived=!1,this.ignoreNotification=e=>{if("peer-list"===e)this.hasConsistentRoomStateArrived=!0;else if("room-state"===e)return this.hasConsistentRoomStateArrived;return!1},this.handleTrackAdd=e=>{this.trackManager.handleTrackAdd(e)},this.handleTrackRemove=e=>{this.trackManager.handleTrackRemove(e)},this.updateLocalPeer=e=>{let{name:t,metadata:n}=e,i=this.store.getLocalPeer();this.peerManager.handlePeerInfoUpdate({peer:i,name:t,data:n})};let o=this.transport.isFlagEnabled("onDemandTracks");this.trackManager=o?new lN(this.store,t,this.transport,this.listener):new aN(this.store,t,this.listener),this.peerManager=new dN(this.store,this.trackManager,this.listener),this.peerListManager=new cN(this.store,this.peerManager,this.trackManager,this.listener),this.broadcastManager=new sN(this.listener),this.policyChangeManager=new hN(this.store,t),this.requestManager=new bN(this.store,this.listener),this.activeSpeakerManager=new rN(this.store,this.listener,this.audioListener),this.connectionQualityManager=new oN(this.store,this.connectionQualityListener),this.roomUpdateManager=new wN(this.store,this.listener),this.sessionMetadataManager=new kN(this.store,this.listener),this.pollsManager=new yN(this.store,this.transport,this.listener),this.whiteboardManager=new TN(this.store,this.transport,this.listener)}setListener(e){this.listener=e,this.trackManager.listener=e,this.peerManager.listener=e,this.peerListManager.listener=e,this.broadcastManager.listener=e,this.requestManager.listener=e,this.activeSpeakerManager.listener=e,this.roomUpdateManager.listener=e,this.sessionMetadataManager.listener=e,this.pollsManager.listener=e,this.whiteboardManager.listener=e}setAudioListener(e){this.audioListener=e,this.activeSpeakerManager.audioListener=e}setConnectionQualityListener(e){this.connectionQualityListener=e,this.connectionQualityManager.listener=e}handleNotification(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n,i;let r=e.method,s=e.params;["active-speakers","sfu-stats","on-connection-quality-update",void 0].includes(r)||nP.d(this.TAG,`Received notification - ${r}`,{notification:s}),"sfu-stats"===r&&null!=(n=window.HMS)&&n.ON_SFU_STATS&&"function"==typeof(null==(i=window.HMS)?void 0:i.ON_SFU_STATS)&&window.HMS.ON_SFU_STATS(e.params),!this.ignoreNotification(r)&&(this.roomUpdateManager.handleNotification(r,s),this.peerManager.handleNotification(r,s),this.requestManager.handleNotification(r,s),this.peerListManager.handleNotification(r,s,t),this.broadcastManager.handleNotification(r,s),this.sessionMetadataManager.handleNotification(r,s),this.pollsManager.handleNotification(r,s),this.whiteboardManager.handleNotification(r,s),this.handleIsolatedMethods(r,s))}handleIsolatedMethods(e,t){switch(e){case"on-track-add":this.trackManager.handleTrackMetadataAdd(t);break;case"on-track-update":this.trackManager.handleTrackUpdate(t);break;case"on-track-remove":if(!t.peer)return void nP.d(this.TAG,`Ignoring sfu notification - ${e}`,{notification:t});this.trackManager.handleTrackRemovedPermanently(t);break;case"on-track-layer-update":this.trackManager.handleTrackLayerUpdate(t);break;case"active-speakers":this.activeSpeakerManager.handleActiveSpeakers(t);break;case"on-connection-quality-update":this.connectionQualityManager.handleQualityUpdate(t);break;case"on-policy-change":this.policyChangeManager.handlePolicyChange(t);break;case"node-info":this.transport.setSFUNodeId(t.sfu_node_id)}}},EN=class{constructor(e){this.transport=e,this.observedKeys=new Set}get(e){return OC(this,null,(function*(){let{data:t,updated_at:n}=yield this.transport.signal.getSessionMetadata(e);return{value:t,updatedAt:uN(n)}}))}set(e,t){return OC(this,null,(function*(){let{data:n,updated_at:i}=yield this.transport.signal.setSessionMetadata({key:e,data:t});return{value:n,updatedAt:uN(i)}}))}observe(e){return OC(this,null,(function*(){let t=new Set(this.observedKeys);if(e.forEach((e=>this.observedKeys.add(e))),this.observedKeys.size!==t.size)try{yield this.transport.signal.listenMetadataChange(Array.from(this.observedKeys))}catch(lP){throw this.observedKeys=t,lP}}))}unobserve(e){return OC(this,null,(function*(){let t=new Set(this.observedKeys);if(this.observedKeys=new Set([...this.observedKeys].filter((t=>!e.includes(t)))),this.observedKeys.size!==t.size)try{yield this.transport.signal.listenMetadataChange(Array.from(this.observedKeys))}catch(lP){throw this.observedKeys=t,lP}}))}},IN=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"https://prod-init.100ms.live/init",s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0;this.authToken=e,this.peerId=t,this.peerName=n,this.data=i,this.endpoint=r,this.autoSubscribeVideo=s,this.iceServers=o}},CN=((tN=CN||{})[tN.ConnectFailed=0]="ConnectFailed",tN[tN.SignalDisconnect=1]="SignalDisconnect",tN[tN.JoinWSMessageFailed=2]="JoinWSMessageFailed",tN[tN.PublishIceConnectionFailed=3]="PublishIceConnectionFailed",tN[tN.SubscribeIceConnectionFailed=4]="SubscribeIceConnectionFailed",tN),PN={0:[],1:[],2:[1],3:[1],4:[1]},AN=(e=>(e.Disconnected="Disconnected",e.Connecting="Connecting",e.Joined="Joined",e.Preview="Preview",e.Failed="Failed",e.Reconnecting="Reconnecting",e.Leaving="Leaving",e))(AN||{}),_N=class{constructor(e){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n,e(t,n)}))}},xN=class{constructor(e,t){this.onStateChange=e,this.sendEvent=t,this.TAG="[RetryScheduler]",this.inProgress=new Map,this.retryTaskIds=[]}schedule(e){return OC(this,arguments,(function(e){var t=this;let{category:n,error:i,task:r,originalState:s,maxRetryTime:o=6e4,changeState:a=!0}=e;return function*(){yield t.scheduleTask({category:n,error:i,changeState:a,task:r,originalState:s,maxRetryTime:o,failedAt:Date.now()})}()}))}reset(){this.retryTaskIds.forEach((e=>clearTimeout(e))),this.retryTaskIds=[],this.inProgress.clear()}isTaskInProgress(e){return!!this.inProgress.get(e)}scheduleTask(e){return OC(this,arguments,(function(e){var t=this;let{category:n,error:i,changeState:r,task:s,originalState:o,failedAt:a,maxRetryTime:l=6e4,failedRetryCount:c=0}=e;return function*(){if(nP.d(t.TAG,"schedule: ",{category:CN[n],error:i}),0===c){let e=t.inProgress.get(n);if(e)return nP.d(t.TAG,`schedule: Already a task for ${CN[n]} scheduled, waiting for its completion`),void(yield e.promise);let r=new _N(((e,t)=>{}));t.inProgress.set(n,r),t.sendEvent(i,n)}let e=!1,u=PN[n];for(let i in u){let r=u[parseInt(i)];try{let e=t.inProgress.get(r);e&&(nP.d(t.TAG,`schedule: Suspending retry task of ${CN[n]}, waiting for ${CN[r]} to recover`),yield e.promise,nP.d(t.TAG,`schedule: Resuming retry task ${CN[n]} as it's dependency ${CN[r]} is recovered`))}catch(m){nP.d(t.TAG,`schedule: Stopping retry task of ${CN[n]} as it's dependency ${CN[r]} failed to recover`),e=!0;break}}let d=e=>{if(t.inProgress.delete(n),t.sendEvent(e,n),t.reset(),!r)throw e;t.onStateChange("Failed",e)},h=Date.now()-a;if(h>=l||e)return i.description+=`. [${CN[n]}] Could not recover after ${h} milliseconds`,e&&(i.description+=` Could not recover all of it's required dependencies - [${u.map((e=>CN[e])).toString()}]`),i.isTerminal=!0,d(i);r&&t.onStateChange("Reconnecting",i);let p,f=t.getDelayForRetryCount(n);nP.d(t.TAG,`schedule: [${CN[n]}] [failedRetryCount=${c}] Scheduling retry task in ${f}ms`);try{p=yield t.setTimeoutPromise(s,f)}catch(g){p=!1;let e=g;if(e.isTerminal)return nP.e(t.TAG,`[${CN[n]}] Un-caught terminal exception ${e.name} in retry-task`,g),d(e);nP.w(t.TAG,`[${CN[n]}] Un-caught exception ${e.name} in retry-task, initiating retry`,g)}if(p){let e=t.inProgress.get(n);t.inProgress.delete(n),null==e||e.resolve(c),r&&0===t.inProgress.size&&t.onStateChange(o),nP.d(t.TAG,`schedule: [${CN[n]}] [failedRetryCount=${c}] Recovered \u267b\ufe0f after ${h}ms`)}else yield t.scheduleTask({category:n,error:i,changeState:r,task:s,originalState:o,maxRetryTime:l,failedAt:a,failedRetryCount:c+1})}()}))}getDelayForRetryCount(e){let t=2===e?2*Math.random():Math.random(),n=0;return 2===e?n=2+t:1===e&&(n=1),1e3*n}setTimeoutPromise(e,t){return OC(this,null,(function*(){return new Promise(((n,i)=>{let r=window.setTimeout((()=>OC(this,null,(function*(){try{let t=yield e();t&&this.retryTaskIds.splice(this.retryTaskIds.indexOf(r),1),n(t)}catch(t){i(t)}}))),t);this.retryTaskIds.push(r)}))}))}},RN=class extends iA{constructor(){super(100),this.localStorage=new PP("hms-analytics"),this.localStorage.clear(),this.initLocalStorageQueue()}enqueue(e){super.enqueue(e),this.localStorage.set(this.storage)}dequeue(){let e=super.dequeue();return this.localStorage.set(this.storage),e}initLocalStorageQueue(){var e;null==(e=this.localStorage.get())||e.forEach((e=>{let t=new jP(e);super.enqueue(t)}))}},NN=class{constructor(){this.TAG="[AnalyticsTransport]",this.eventCount=0,this.lastResetTime=Date.now(),this.MAX_EVENTS_PER_MINUTE=200,this.RESET_INTERVAL_MS=6e4}checkRateLimit(){let e=Date.now();if(e-this.lastResetTime>=this.RESET_INTERVAL_MS&&(this.eventCount=0,this.lastResetTime=e),this.eventCount>=this.MAX_EVENTS_PER_MINUTE)throw new Error("Too many events being sent, please check the implementation.");this.eventCount++}sendEvent(e){try{this.checkRateLimit()}catch(wC){throw nP.w(this.TAG,"Rate limit exceeded",wC),wC}try{this.sendSingleEvent(e),this.flushFailedEvents()}catch(wC){nP.w(this.TAG,"sendEvent failed",wC)}}flushFailedEvents(e){var t;try{for(nP.d(this.TAG,"Flushing failed events",this.failedEvents);this.failedEvents.size()>0;){let n=this.failedEvents.dequeue();n&&((null==(t=n.metadata)?void 0:t.peer.peer_id)!==e&&n.metadata.peer.peer_id?zR.sendEvent(n):this.sendSingleEvent(n))}}catch(lP){nP.w(this.TAG,"flushFailedEvents failed",lP)}}sendSingleEvent(e){try{this.transportProvider.sendEvent(e),nP.d(this.TAG,"Sent event",e.name,e)}catch(wC){throw nP.w(this.TAG,`${this.transportProvider.TAG}.sendEvent failed, adding to local storage events`,{event:e,error:wC}),this.failedEvents.enqueue(e),wC}}},DN=class extends NN{constructor(e){super(),this.transportProvider=e,this.failedEvents=new RN}},LN=class{constructor(e,t,n,i){this.store=e,this.eventBus=t,this.sampleWindowSize=n,this.pushInterval=i,this.shouldSendEvent=!1,this.sequenceNum=1,this.stop=()=>{this.shouldSendEvent&&this.sendEvent(),this.eventBus.statsUpdate.unsubscribe(this.handleStatsUpdate.bind(this)),this.shouldSendEvent=!1},this.start()}start(){this.shouldSendEvent||(this.stop(),this.shouldSendEvent=!0,this.eventBus.statsUpdate.subscribe(this.handleStatsUpdate.bind(this)),this.startLoop().catch((e=>nP.e("[StatsAnalytics]",e.message))))}startLoop(){return OC(this,null,(function*(){for(;this.shouldSendEvent;)yield sA(1e3*this.pushInterval),this.sendEvent()}))}sendEvent(){this.trackAnalytics.forEach((e=>{e.clearSamples()}))}cleanTrackAnalyticsAndCreateSample(e){this.trackAnalytics.forEach((e=>{!this.store.hasTrack(e.track)&&!(e.samples.length>0)&&this.trackAnalytics.delete(e.track_id)})),e&&this.trackAnalytics.forEach((e=>{e.createSample()}))}},ON=class{constructor(e){let{track:t,ssrc:n,rid:i,kind:r,sampleWindowSize:s}=e;this.samples=[],this.tempStats=[],this.track=t,this.ssrc=n,this.rid=i,this.kind=r,this.track_id=this.track.trackId,this.source=this.track.source,this.sampleWindowSize=s}pushTempStat(e){this.tempStats.push(e)}createSample(){0!==this.tempStats.length&&(this.samples.push(this.collateSample()),this.prevLatestStat=this.getLatestStat(),this.tempStats.length=0)}clearSamples(){this.samples.length=0}getLatestStat(){return this.tempStats[this.tempStats.length-1]}getFirstStat(){return this.tempStats[0]}calculateSum(e){if("number"==typeof this.getLatestStat()[e])return this.tempStats.reduce(((t,n)=>t+(n[e]||0)),0)}calculateAverage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.calculateSum(e),i=void 0!==n?n/this.tempStats.length:void 0;return i?t?Math.round(i):i:void 0}calculateDifferenceForSample(e){var t;let n=Number(null==(t=this.prevLatestStat)?void 0:t[e])||0;return(Number(this.getLatestStat()[e])||0)-n}calculateDifferenceAverage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.calculateDifferenceForSample(e)/this.tempStats.length;return t?Math.round(n):n}calculateInstancesOfHigh(e,t){if("number"==typeof this.getLatestStat()[e])return this.tempStats.reduce(((n,i)=>n+((i[e]||0)>t?1:0)),0)}},MN=(e,t)=>e&&t&&(e.frameWidth!==t.frameWidth||e.frameHeight!==t.frameHeight),jN=(e,t)=>e&&t&&e.enabled!==t.enabled,FN=e=>Object.entries(e).filter((e=>{let[,t]=e;return void 0!==t})).reduce(((e,t)=>{let[n,i]=t;return e[n]=i,e}),{}),UN=class extends LN{constructor(){super(...arguments),this.trackAnalytics=new Map}toAnalytics(){var e,t;let n=[],i=[];return this.trackAnalytics.forEach((e=>{"audio"===e.track.type?n.push(e.toAnalytics()):"video"===e.track.type&&i.push(e.toAnalytics())})),{audio:n,video:i,joined_at:null==(t=null==(e=this.store.getRoom())?void 0:e.joinedAt)?void 0:t.getTime(),sequence_num:this.sequenceNum++,max_window_sec:30}}sendEvent(){this.eventBus.analytics.publish(FP.publishStats(this.toAnalytics())),super.sendEvent()}handleStatsUpdate(e){let t=!1,n=e.getLocalTrackStats();Object.keys(n).forEach((i=>{let r=n[i],s=this.store.getLocalPeerTracks().find((e=>e.getTrackIDBeingSent()===i));Object.keys(r).forEach((n=>{var i,o,a;let l=r[n];if(!s)return;let c=this.getTrackIdentifier(s.trackId,l),u=NC(RC({},l),{availableOutgoingBitrate:null==(o=null==(i=e.getLocalPeerStats())?void 0:i.publish)?void 0:o.availableOutgoingBitrate});if(c&&this.trackAnalytics.has(c))null==(a=this.trackAnalytics.get(c))||a.pushTempStat(u);else if(s){let e=new VN({track:s,sampleWindowSize:this.sampleWindowSize,rid:l.rid,ssrc:l.ssrc.toString(),kind:l.kind});e.pushTempStat(u),this.trackAnalytics.set(this.getTrackIdentifier(s.trackId,l),e)}let d=this.trackAnalytics.get(c);null!=d&&d.shouldCreateSample()&&(t=!0)}))})),this.cleanTrackAnalyticsAndCreateSample(t)}getTrackIdentifier(e,t){return t.rid?`${e}:${t.rid}`:e}},VN=class extends ON{constructor(){super(...arguments),this.samples=[],this.collateSample=()=>{let e=this.getLatestStat(),t=e.qualityLimitationDurations,n=t&&{bandwidth_sec:t.bandwidth,cpu_sec:t.cpu,other_sec:t.other},i=e.frameHeight?{height_px:this.getLatestStat().frameHeight,width_px:this.getLatestStat().frameWidth}:void 0,r=this.calculateAverage("jitter",!1),s=r?Math.round(1e3*r):void 0,o=this.calculateAverage("roundTripTime",!1),a=o?Math.round(1e3*o):void 0;return FN({timestamp:Date.now(),avg_available_outgoing_bitrate_bps:this.calculateAverage("availableOutgoingBitrate"),avg_bitrate_bps:this.calculateAverage("bitrate"),avg_fps:this.calculateAverage("framesPerSecond"),total_packets_lost:this.getLatestStat().packetsLost,total_packets_sent:this.getLatestStat().packetsSent,total_packet_sent_delay_sec:parseFloat(this.calculateDifferenceForSample("totalPacketSendDelay").toFixed(4)),total_fir_count:this.calculateDifferenceForSample("firCount"),total_pli_count:this.calculateDifferenceForSample("pliCount"),total_nack_count:this.calculateDifferenceForSample("nackCount"),avg_jitter_ms:s,avg_round_trip_time_ms:a,total_quality_limitation:n,resolution:i})},this.shouldCreateSample=()=>{let e=this.tempStats.length,t=this.tempStats[e-1],n=this.tempStats[e-2];return 30===e||jN(t,n)||"video"===t.kind&&MN(t,n)},this.toAnalytics=()=>({track_id:this.track_id,ssrc:this.ssrc,source:this.source,rid:this.rid,samples:this.samples})}},BN=class extends LN{constructor(){super(...arguments),this.trackAnalytics=new Map}toAnalytics(){var e,t;let n=[],i=[];return this.trackAnalytics.forEach((e=>{"audio"===e.track.type?n.push(e.toAnalytics()):"video"===e.track.type&&i.push(e.toAnalytics())})),{audio:n,video:i,joined_at:null==(t=null==(e=this.store.getRoom())?void 0:e.joinedAt)?void 0:t.getTime(),sequence_num:this.sequenceNum++,max_window_sec:10}}sendEvent(){this.eventBus.analytics.publish(FP.subscribeStats(this.toAnalytics())),super.sendEvent()}handleStatsUpdate(e){let t=e.getAllRemoteTracksStats(),n=!1;Object.keys(t).forEach((i=>{var r,s;let o=this.store.getTrackById(i),a=t[i],l=((e,t)=>{let n=(null==t?void 0:t.jitterBufferDelay)||0,i=(null==t?void 0:t.jitterBufferEmittedCount)||0,r=((null==e?void 0:e.jitterBufferDelay)||0)-n,s=((null==e?void 0:e.jitterBufferEmittedCount)||0)-i;return s>0?1e3*r/s:(null==t?void 0:t.calculatedJitterBufferDelay)||0})(a,null==(r=this.trackAnalytics.get(i))?void 0:r.getLatestStat()),c=this.calculateAvSyncForStat(a,e),u=NC(RC({},a),{calculatedJitterBufferDelay:l,avSync:c});if("video"===a.kind){let e=o.getPreferredLayerDefinition();u.expectedFrameHeight=null==e?void 0:e.resolution.height,u.expectedFrameWidth=null==e?void 0:e.resolution.width}if(this.trackAnalytics.has(i))null==(s=this.trackAnalytics.get(i))||s.pushTempStat(u);else if(o){let e=new $N({track:o,sampleWindowSize:this.sampleWindowSize,ssrc:a.ssrc.toString(),kind:a.kind});e.pushTempStat(u),this.trackAnalytics.set(i,e)}let d=this.trackAnalytics.get(i);null!=d&&d.shouldCreateSample()&&(n=!0)})),this.cleanTrackAnalyticsAndCreateSample(n)}calculateAvSyncForStat(e,t){if(!e.peerID||!e.estimatedPlayoutTimestamp||"video"!==e.kind)return;let n=this.store.getPeerById(e.peerID),i=null==n?void 0:n.audioTrack,r=null==n?void 0:n.videoTrack;if(!(i&&r&&i.enabled&&r.enabled))return XA;let s=t.getRemoteTrackStats(i.trackId);return s?s.estimatedPlayoutTimestamp?s.estimatedPlayoutTimestamp-e.estimatedPlayoutTimestamp:void 0:XA}},$N=class extends ON{constructor(){super(...arguments),this.samples=[],this.collateSample=()=>{let e=this.getLatestStat(),t=this.getFirstStat(),n={timestamp:Date.now(),total_pli_count:this.calculateDifferenceForSample("pliCount"),total_nack_count:this.calculateDifferenceForSample("nackCount"),avg_jitter_buffer_delay:this.calculateAverage("calculatedJitterBufferDelay",!1)};if("video"===e.kind)return FN(NC(RC({},n),{avg_av_sync_ms:this.calculateAvgAvSyncForSample(),avg_frames_received_per_sec:this.calculateDifferenceAverage("framesReceived"),avg_frames_dropped_per_sec:this.calculateDifferenceAverage("framesDropped"),avg_frames_decoded_per_sec:this.calculateDifferenceAverage("framesDecoded"),frame_width:this.calculateAverage("frameWidth"),frame_height:this.calculateAverage("frameHeight"),expected_frame_width:this.calculateAverage("expectedFrameWidth"),expected_frame_height:this.calculateAverage("expectedFrameHeight"),pause_count:this.calculateDifferenceForSample("pauseCount"),pause_duration_seconds:this.calculateDifferenceForSample("totalPausesDuration"),freeze_count:this.calculateDifferenceForSample("freezeCount"),freeze_duration_seconds:this.calculateDifferenceForSample("totalFreezesDuration")}));{let i=(e.concealedSamples||0)-(e.silentConcealedSamples||0)-((t.concealedSamples||0)-(t.silentConcealedSamples||0));return FN(NC(RC({},n),{audio_level:this.calculateInstancesOfHigh("audioLevel",.05),audio_concealed_samples:i,audio_total_samples_received:this.calculateDifferenceForSample("totalSamplesReceived"),audio_concealment_events:this.calculateDifferenceForSample("concealmentEvents"),fec_packets_discarded:this.calculateDifferenceForSample("fecPacketsDiscarded"),fec_packets_received:this.calculateDifferenceForSample("fecPacketsReceived"),total_samples_duration:this.calculateDifferenceForSample("totalSamplesDuration"),total_packets_received:this.calculateDifferenceForSample("packetsReceived"),total_packets_lost:this.calculateDifferenceForSample("packetsLost")}))}},this.shouldCreateSample=()=>{let e=this.tempStats.length,t=this.tempStats[e-1],n=this.tempStats[e-2];return 10===e||jN(t,n)||"video"===t.kind&&MN(t,n)},this.toAnalytics=()=>({track_id:this.track_id,ssrc:this.ssrc,source:this.source,rid:this.rid,samples:this.samples})}calculateAvgAvSyncForSample(){let e=this.tempStats.map((e=>e.avSync)).filter((e=>void 0!==e&&e!==XA));return 0===e.length?XA:e.reduce(((e,t)=>e+t),0)/e.length}},zN=(e=>(e[e.Publish=0]="Publish",e[e.Subscribe=1]="Subscribe",e))(zN||{});var GN="[HMSConnection]",qN=class{constructor(e,t){this.candidates=new Array,this.role=e,this.signal=t}get iceConnectionState(){return this.nativeConnection.iceConnectionState}get connectionState(){return this.nativeConnection.connectionState}get action(){return 0===this.role?"PUBLISH":"SUBSCRIBE"}setSfuNodeId(e){this.sfuNodeId=e}addTransceiver(e,t){return this.nativeConnection.addTransceiver(e,t)}createOffer(e,t){return OC(this,null,(function*(){try{let n=yield this.nativeConnection.createOffer(t);return nP.d(GN,`[role=${this.role}] createOffer offer=${JSON.stringify(n,null,1)}`),function(e){return e.sdp.includes("usedtx=1")?e:{type:e.type,sdp:e.sdp.replace("useinbandfec=1","useinbandfec=1;usedtx=1")}}(function(e,t){var n;let i=kC.qg(e.sdp);if(null==(n=i.origin)||!n.username.startsWith("mozilla"))return e;let r=t?Array.from(t.values()):[];return i.media.forEach((e=>{var t,n,i;let s=null==(t=e.msid)?void 0:t.split(" ")[0],o=null==(n=r.find((t=>t.type===e.type&&t.stream_id===s)))?void 0:n.track_id;o&&(e.msid=null==(i=e.msid)?void 0:i.replace(/\s(.+)/,` ${o}`))})),{type:e.type,sdp:kC.M9(i)}}(n,e))}catch(lP){throw IP.WebrtcErrors.CreateOfferFailed(this.action,lP.message)}}))}createAnswer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return OC(this,null,(function*(){try{let t=yield this.nativeConnection.createAnswer(e);return nP.d(GN,`[role=${this.role}] createAnswer answer=${JSON.stringify(t,null,1)}`),t}catch(wC){throw IP.WebrtcErrors.CreateAnswerFailed(this.action,wC.message)}}))}setLocalDescription(e){return OC(this,null,(function*(){try{nP.d(GN,`[role=${this.role}] setLocalDescription description=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.setLocalDescription(e)}catch(wC){throw IP.WebrtcErrors.SetLocalDescriptionFailed(this.action,wC.message)}}))}setRemoteDescription(e){return OC(this,null,(function*(){try{nP.d(GN,`[role=${this.role}] setRemoteDescription description=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.setRemoteDescription(e)}catch(wC){throw IP.WebrtcErrors.SetRemoteDescriptionFailed(this.action,wC.message)}}))}addIceCandidate(e){return OC(this,null,(function*(){"closed"!==this.nativeConnection.signalingState?(nP.d(GN,`[role=${this.role}] addIceCandidate candidate=${JSON.stringify(e,null,1)}`),yield this.nativeConnection.addIceCandidate(e)):nP.d(GN,`[role=${this.role}] addIceCandidate signalling state closed`)}))}get remoteDescription(){return this.nativeConnection.remoteDescription}getSenders(){return this.nativeConnection.getSenders()}handleSelectedIceCandidatePairs(){try{(0===this.role?this.getSenders():this.getReceivers()).forEach((e=>{var t;let n=null==(t=e.track)?void 0:t.kind;if(e.transport){let t=e.transport.iceTransport,i=()=>{"function"==typeof t.getSelectedCandidatePair&&(this.selectedCandidatePair=t.getSelectedCandidatePair(),this.selectedCandidatePair&&(this.observer.onSelectedCandidatePairChange(this.selectedCandidatePair),nP.d(GN,`${zN[this.role]} connection`,`selected ${n||"unknown"} candidate pair`,JSON.stringify(this.selectedCandidatePair,null,2))))};"function"==typeof t.onselectedcandidatepairchange&&(t.onselectedcandidatepairchange=i),i()}}))}catch(vC){nP.w(GN,`Error in logging selected ice candidate pair for ${zN[this.role]} connection`,vC)}}removeTrack(e){"closed"!==this.nativeConnection.signalingState&&this.nativeConnection.removeTrack(e)}setMaxBitrateAndFramerate(e,t){return OC(this,null,(function*(){let n=(null==t?void 0:t.maxBitrate)||e.settings.maxBitrate,i=e instanceof KA&&e.settings.maxFramerate,r=this.getSenders().find((t=>{var n;return(null==(n=null==t?void 0:t.track)?void 0:n.id)===e.getTrackIDBeingSent()}));if(r){let e=r.getParameters();1===e.encodings.length&&(n&&(e.encodings[0].maxBitrate=1e3*n),i&&(e.encodings[0].maxFramerate=i)),yield r.setParameters(e)}else nP.w(GN,`no sender found to setMaxBitrate for track - ${e.trackId}, sentTrackId - ${e.getTrackIDBeingSent()}`)}))}getStats(){return OC(this,null,(function*(){return yield this.nativeConnection.getStats()}))}close(){this.nativeConnection.close()}getReceivers(){return this.nativeConnection.getReceivers()}},HN=class extends qN{constructor(e,t,n){super(0,e),this.TAG="[HMSPublishConnection]",this.observer=n,this.nativeConnection=new RTCPeerConnection(t),this.channel=this.nativeConnection.createDataChannel(JA,{protocol:"SCTP"}),this.channel.onerror=e=>nP.e(this.TAG,`publish data channel onerror ${e}`,e),this.nativeConnection.onicecandidate=t=>{let{candidate:n}=t;n&&(this.observer.onIceCandidate(n),e.trickle(this.role,n))},this.nativeConnection.oniceconnectionstatechange=()=>{this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState)},this.nativeConnection.onconnectionstatechange=()=>{this.observer.onConnectionStateChange(this.nativeConnection.connectionState),this.nativeConnection.sctp&&(this.nativeConnection.sctp.transport.onstatechange=()=>{var e;this.observer.onDTLSTransportStateChange(null==(e=this.nativeConnection.sctp)?void 0:e.transport.state)},this.nativeConnection.sctp.transport.onerror=e=>{var t;this.observer.onDTLSTransportError(new Error(null==(t=null==e?void 0:e.error)?void 0:t.errorDetail)||"DTLS Transport failed")})}}close(){super.close(),this.channel.close()}initAfterJoin(){this.nativeConnection.onnegotiationneeded=()=>OC(this,null,(function*(){nP.d(this.TAG,"onnegotiationneeded"),yield this.observer.onRenegotiationNeeded()}))}},WN=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.TAG="[HMSDataChannel]",this.nativeChannel=e,this.observer=t,this.metadata=n,e.onmessage=e=>{this.observer.onMessage(e.data)}}get id(){return this.nativeChannel.id}get label(){return this.nativeChannel.label}get readyState(){return this.nativeChannel.readyState}send(e){nP.d(this.TAG,`[${this.metadata}] Sending [size=${e.length}] message=${e}`),this.nativeChannel.send(e)}close(){this.nativeChannel.close()}},KN=class extends qN{constructor(e,t,n,i){super(1,e),this.isFlagEnabled=n,this.TAG="[HMSSubscribeConnection]",this.remoteStreams=new Map,this.MAX_RETRIES=3,this.pendingMessageQueue=[],this.eventEmitter=new(gI())({maxListeners:60}),this.handlePendingApiMessages=()=>{this.eventEmitter.emit("open",!0),this.pendingMessageQueue.length>0&&(nP.d(this.TAG,"Found pending message queue, sending messages"),this.pendingMessageQueue.forEach((e=>this.sendOverApiDataChannel(e))),this.pendingMessageQueue.length=0)},this.sendMessage=(e,t)=>OC(this,null,(function*(){var n;let i;"open"!==(null==(n=this.apiChannel)?void 0:n.readyState)&&(yield this.eventEmitter.waitFor("open"));for(let r=0;r<this.MAX_RETRIES;r++){this.apiChannel.send(e),i=yield this.waitForResponse(t);let n=i.error;if(!n)break;{if(404===n.code){nP.d(this.TAG,`Track not found ${t}`,{request:e,try:r+1,error:n});break}if(nP.d(this.TAG,`Failed sending ${t}`,{request:e,try:r+1,error:n}),n.code/100!==5&&429!==n.code)throw Error(`code=${n.code}, message=${n.message}`);let i=1e3*(2+2*Math.random());yield oA(i)}}return i})),this.waitForResponse=e=>OC(this,null,(function*(){let t=yield this.eventEmitter.waitFor("message",(function(t){return t.includes(e)})),n=JSON.parse(t[0]);return nP.d(this.TAG,`response for ${e} -`,JSON.stringify(n,null,2)),n})),this.observer=i,this.nativeConnection=new RTCPeerConnection(t),this.initNativeConnectionCallbacks()}initNativeConnectionCallbacks(){this.nativeConnection.oniceconnectionstatechange=()=>{this.observer.onIceConnectionChange(this.nativeConnection.iceConnectionState)},this.nativeConnection.onconnectionstatechange=()=>{this.observer.onConnectionStateChange(this.nativeConnection.connectionState)},this.nativeConnection.ondatachannel=e=>{e.channel.label===JA&&(this.apiChannel=new WN(e.channel,{onMessage:e=>{this.eventEmitter.emit("message",e),this.observer.onApiChannelMessage(e)}},`role=${this.role}`),e.channel.onopen=this.handlePendingApiMessages)},this.nativeConnection.onicecandidate=e=>{null!==e.candidate&&(this.observer.onIceCandidate(e.candidate),this.signal.trickle(this.role,e.candidate))},this.nativeConnection.ontrack=e=>{var t;let n=e.streams[0],i=n.id;if(!this.remoteStreams.has(i)){let e=new S_(n,this);this.remoteStreams.set(i,e)}n.addEventListener("removetrack",(t=>{if(t.track.id!==e.track.id)return;let n=r.tracks.findIndex((n=>{var i;return n.nativeTrack.id===t.track.id&&e.transceiver.mid===(null==(i=n.transceiver)?void 0:i.mid)}));if(n>=0){let e=r.tracks[n];this.observer.onTrackRemove(e),r.tracks.splice(n,1),0===r.tracks.length&&this.remoteStreams.delete(i)}}));let r=this.remoteStreams.get(i),s="audio"===e.track.kind,o=s?AA:w_,a=s?new o(r,e.track):new o(r,e.track,void 0,this.isFlagEnabled("disableNoneLayerRequest"));"video"===e.track.kind&&r.setVideoLayerLocally("none","addTrack","subscribeConnection"),a.transceiver=e.transceiver;let l=function(e,t){var n;if(null==e||!e.sdp||!t)return;let i=kC.qg(e.sdp).media.find((e=>xP(e.mid)&&parseInt(e.mid)===parseInt(t)));return null==(n=null==i?void 0:i.msid)?void 0:n.split(" ")[1]}(this.remoteDescription,null==(t=e.transceiver)?void 0:t.mid);l&&a.setSdpTrackId(l),r.tracks.push(a),this.observer.onTrackAdd(a)}}sendOverApiDataChannel(e){this.apiChannel&&"open"===this.apiChannel.readyState?this.apiChannel.send(e):(nP.w(this.TAG,`API Data channel not ${this.apiChannel?"open":"present"}, queueing`,e),this.pendingMessageQueue.push(e))}sendOverApiDataChannelWithResponse(e,t){return OC(this,null,(function*(){let n=uE();if("prefer-video-track-state"===e.method&&this.isFlagEnabled("disableVideoTrackAutoUnsubscribe")&&"none"===e.params.max_spatial_layer)return nP.d(this.TAG,"video auto unsubscribe is disabled, request is ignored"),{id:n};let i=JSON.stringify(RC({id:t||n,jsonrpc:"2.0"},e));return this.sendMessage(i,n)}))}close(){var e;super.close(),null==(e=this.apiChannel)||e.close()}},QN=(e,t)=>t&&0!==t.length?t.map((e=>({urls:e.urls,credentialType:"password",credential:e.password,username:e.userName}))):e,JN="[InitService]",YN=class{static handleError(e,t){switch(e.status){case 404:throw IP.APIErrors.EndpointUnreachable("INIT",t.message||e.statusText);case 200:break;default:throw IP.APIErrors.ServerErrors(t.code||e.status,"INIT",t.message||(null==e?void 0:e.statusText))}}static fetchInitConfig(e){return OC(this,arguments,(function(e){var t=this;let{token:n,peerId:i,userAgent:r,initEndpoint:s="https://prod-init.100ms.live",region:o="",iceServers:a}=e;return function*(){nP.d(JN,`fetchInitConfig: initEndpoint=${s} token=${n} peerId=${i} region=${o} `);let e=function(e,t,n,i){try{let r=new URL("/init",e);return i&&i.trim().length>0&&r.searchParams.set("region",i.trim()),r.searchParams.set("peer_id",t),r.searchParams.set("user_agent_v2",n),r.toString()}catch(s){let t=s;throw nP.e(JN,t.name,t.message),t}}(s,i,r,o);try{let i=yield fetch(e,{headers:{Authorization:`Bearer ${n}`}});try{let e=yield i.clone().json();return t.handleError(i,e),nP.d(JN,`config is ${JSON.stringify(e,null,2)}`),function(e,t){var n;return NC(RC({},e),{rtcConfiguration:NC(RC({},e.rtcConfiguration),{iceServers:QN(null==(n=e.rtcConfiguration)?void 0:n.ice_servers,t)})})}(e,a)}catch(l){let e=yield i.text();throw nP.e(JN,"json error",l.message,e),l instanceof wP?l:IP.APIErrors.ServerErrors(i.status,"INIT",l.message)}}catch(c){let e=c;throw["Failed to fetch","NetworkError","ECONNRESET"].some((t=>e.message.includes(t)))?IP.APIErrors.EndpointUnreachable("INIT",e.message):e}}()}))}};var XN=class{constructor(e){this.TAG="[SIGNAL]: ",this.pongResponseTimes=new iA(5),this.isJoinCompleted=!1,this.pendingTrickle=[],this.socket=null,this.callbacks=new Map,this._isConnected=!1,this.id=0,this.onCloseHandler=()=>{},this.resolvePingOnAnyResponse=()=>{this.callbacks.forEach(((e,t)=>{var n;"ping"===(null==(n=e.metadata)?void 0:n.method)&&(e.resolve({timestamp:Date.now()}),this.callbacks.delete(t))}))},this.offlineListener=()=>{nP.d(this.TAG,"Window network offline"),this.setIsConnected(!1,"Window network offline")},this.onlineListener=()=>{nP.d(this.TAG,"Window network online"),this.observer.onNetworkOnline()},this.observer=e,window.addEventListener("offline",this.offlineListener),window.addEventListener("online",this.onlineListener),this.onMessageHandler=this.onMessageHandler.bind(this)}get isConnected(){return this._isConnected}setSfuNodeId(e){this.sfuNodeId=e}setIsConnected(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";nP.d(this.TAG,`isConnected set id: ${this.id}, oldValue: ${this._isConnected}, newValue: ${e}`),this._isConnected!==e&&(this._isConnected&&!e?(this._isConnected=e,this.rejectPendingCalls(t),this.observer.onOffline(t)):!this._isConnected&&e&&(this._isConnected=e,this.observer.onOnline()))}getPongResponseTimes(){return this.pongResponseTimes.toList()}internalCall(e,t){return OC(this,null,(function*(){var n;let i=uE(),r={method:e,params:t,id:i,jsonrpc:"2.0"};null==(n=this.socket)||n.send(JSON.stringify(r));try{return yield new Promise(((t,n)=>{this.callbacks.set(i,{resolve:t,reject:n,metadata:{method:e}})}))}catch(s){if(s instanceof wP)throw s;let t=s;throw IP.WebsocketMethodErrors.ServerErrors(Number(t.code),SP(e),t.message)}}))}notify(e,t){var n,i;let r={method:e,params:t};(null==(n=this.socket)?void 0:n.readyState)===WebSocket.OPEN&&(null==(i=this.socket)||i.send(JSON.stringify(r)))}open(e){return new Promise(((t,n)=>{let i=!1;this.socket&&(this.socket.close(),this.socket.removeEventListener("close",this.onCloseHandler),this.socket.removeEventListener("message",this.onMessageHandler)),this.socket=new WebSocket(e);let r=()=>{nP.e(this.TAG,"Error from websocket"),i=!0,n(IP.WebSocketConnectionErrors.FailedToConnect("JOIN","Error opening websocket connection"))};this.onCloseHandler=e=>{nP.w(`Websocket closed code=${e.code}`),i?this.setIsConnected(!1,`code: ${e.code}${1e3!==e.code?", unexpected websocket close":""}`):(i=!0,n(IP.WebSocketConnectionErrors.AbnormalClose("JOIN",`Error opening websocket connection - websocket closed unexpectedly with code=${e.code}`)))},this.socket.addEventListener("error",r);let s=()=>{var e,n;i=!0,t(),this.setIsConnected(!0),this.id++,null==(e=this.socket)||e.removeEventListener("open",s),null==(n=this.socket)||n.removeEventListener("error",r),this.pingPongLoop(this.id)};this.socket.addEventListener("open",s),this.socket.addEventListener("close",this.onCloseHandler),this.socket.addEventListener("message",this.onMessageHandler)}))}close(){return OC(this,null,(function*(){window.removeEventListener("offline",this.offlineListener),window.removeEventListener("online",this.onlineListener),this.socket?(this.socket.close(1e3,"Normal Close"),this.setIsConnected(!1,"code: 1000, normal websocket close"),this.socket.removeEventListener("close",this.onCloseHandler),this.socket.removeEventListener("message",this.onMessageHandler)):this.setIsConnected(!1,"websocket not connected yet")}))}join(e,t,n,i,r,s,o){return OC(this,null,(function*(){if(!this.isConnected)throw IP.WebSocketConnectionErrors.WebSocketConnectionLost("JOIN","Failed to send join over WS connection");let a={name:e,disableVidAutoSub:n,data:t,offer:o,server_sub_degrade:i,simulcast:r,onDemandTracks:s},l=yield this.internalCall("join",a);return this.isJoinCompleted=!0,this.pendingTrickle.forEach((e=>{let{target:t,candidate:n}=e;return this.trickle(t,n)})),this.pendingTrickle.length=0,nP.d(this.TAG,`join: response=${JSON.stringify(l,null,1)}`),l}))}trickle(e,t){this.isJoinCompleted?this.notify("trickle",{target:e,candidate:t,sfu_node_id:this.sfuNodeId}):this.pendingTrickle.push({target:e,candidate:t})}offer(e,t){return OC(this,null,(function*(){return yield this.call("offer",{desc:e,tracks:Object.fromEntries(t),sfu_node_id:this.sfuNodeId})}))}answer(e){this.notify("answer",{desc:e,sfu_node_id:this.sfuNodeId})}trackUpdate(e){this.notify("track-update",{tracks:Object.fromEntries(e)})}broadcast(e){return OC(this,null,(function*(){return yield this.call("broadcast",e)}))}leave(e){this.notify("leave",{client_reason:e})}endRoom(e,t){return OC(this,null,(function*(){yield this.call("end-room",{lock:e,reason:t})}))}sendEvent(e){if(!this.isConnected)throw Error(`${this.TAG} not connected. Could not send event ${e}`);this.notify("analytics",e.toSignalParams())}ping(e){let t=Date.now(),n=new Promise((n=>{setTimeout((()=>{n(Date.now()-t)}),e+1)})),i=this.internalCall("ping",{timestamp:t}).then((()=>Date.now()-t)).catch((()=>Date.now()-t));return Promise.race([n,i])}requestRoleChange(e){return OC(this,null,(function*(){yield this.call("role-change-request",e)}))}requestBulkRoleChange(e){return OC(this,null,(function*(){yield this.call("role-change-request",e)}))}acceptRoleChangeRequest(e){return OC(this,null,(function*(){yield this.call("role-change",e)}))}requestTrackStateChange(e){return OC(this,null,(function*(){yield this.call("track-update-request",e)}))}requestMultiTrackStateChange(e){return OC(this,null,(function*(){yield this.call("change-track-mute-state-request",e)}))}removePeer(e){return OC(this,null,(function*(){yield this.call("peer-leave-request",e)}))}startRTMPOrRecording(e){return OC(this,null,(function*(){yield this.call("rtmp-start",RC({},e))}))}stopRTMPAndRecording(){return OC(this,null,(function*(){yield this.call("rtmp-stop",{})}))}startHLSStreaming(e){return OC(this,null,(function*(){yield this.call("hls-start",RC({},e))}))}stopHLSStreaming(e){return OC(this,null,(function*(){yield this.call("hls-stop",RC({},e))}))}startTranscription(e){return OC(this,null,(function*(){yield this.call("transcription-start",RC({},e))}))}stopTranscription(e){return OC(this,null,(function*(){yield this.call("transcription-stop",RC({},e))}))}sendHLSTimedMetadata(e){return OC(this,null,(function*(){yield this.call("hls-timed-metadata",RC({},e))}))}updatePeer(e){return OC(this,null,(function*(){yield this.call("peer-update",RC({},e))}))}getPeer(e){return OC(this,null,(function*(){return yield this.call("get-peer",RC({},e))}))}joinGroup(e){return OC(this,null,(function*(){return yield this.call("group-join",{name:e})}))}leaveGroup(e){return OC(this,null,(function*(){return yield this.call("group-leave",{name:e})}))}addToGroup(e,t){return OC(this,null,(function*(){yield this.call("group-add",{name:t,peer_id:e})}))}removeFromGroup(e,t){return OC(this,null,(function*(){yield this.call("group-remove",{name:t,peer_id:e})}))}peerIterNext(e){return OC(this,null,(function*(){return yield this.call("peer-iter-next",e)}))}findPeers(e){return OC(this,null,(function*(){return yield this.call("find-peer",e)}))}findPeerByName(e){return OC(this,null,(function*(){return yield this.call("peer-name-search",e)}))}setSessionMetadata(e){if(!this.isConnected)throw IP.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to set session store value due to network disconnection");return this.call("set-metadata",RC({},e))}listenMetadataChange(e){if(!this.isConnected)throw IP.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to observe session store key due to network disconnection");return this.call("listen-metadata-change",{keys:e})}getSessionMetadata(e){if(!this.isConnected)throw IP.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to set session store value due to network disconnection");return this.call("get-metadata",{key:e})}setPollInfo(e){return this.call("poll-info-set",RC({},e))}getPollInfo(e){return this.call("poll-info-get",RC({},e))}setPollQuestions(e){return this.call("poll-questions-set",RC({},e))}startPoll(e){return this.call("poll-start",RC({},e))}stopPoll(e){return this.call("poll-stop",RC({},e))}getPollQuestions(e){return this.call("poll-questions-get",RC({},e))}setPollResponses(e){return this.call("poll-response",RC({},e))}getPollResponses(e){return this.call("poll-responses",RC({},e))}getPollsList(e){return this.call("poll-list",RC({},e))}getPollResult(e){return this.call("poll-result",RC({},e))}createWhiteboard(e){return this.validateConnection(),this.call("whiteboard-create",RC({},e))}getWhiteboard(e){return this.validateConnection(),this.call("whiteboard-get",RC({},e))}fetchPollLeaderboard(e){return this.call("poll-leaderboard",RC({},e))}validateConnection(){if(!this.isConnected)throw IP.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL","Failed to send message due to network disconnection")}onMessageHandler(e){let t=e.data,n=JSON.parse(t);if(this.resolvePingOnAnyResponse(),n.id)this.handleResponseWithId(n);else{if(!n.method)throw Error(`WebSocket message has no 'method' or 'id' field, message=${n}`);this.handleResponseWithMethod(n)}}handleResponseWithId(e){let t=e,n=t.id;if(this.callbacks.has(n)){let e=this.callbacks.get(n);this.callbacks.delete(n),t.result?e.resolve(t.result):e.reject(t.error)}else this.observer.onNotification(t)}handleResponseWithMethod(e){switch(e.method){case"offer":this.observer.onOffer(e.params);break;case"trickle":this.observer.onTrickle(e.params);break;case"on-error":this.observer.onServerError(IP.WebsocketMethodErrors.ServerErrors(Number(e.params.code),"on-error",e.params.message));break;case"on-warning":nP.w(this.TAG,e.params);break;default:this.observer.onNotification(e)}}rejectPendingCalls(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.callbacks.forEach(((t,n)=>{var i,r,s,o;"ping"!==(null==(i=t.metadata)?void 0:i.method)&&(nP.e(this.TAG,`rejecting pending callback ${null==(r=t.metadata)?void 0:r.method}, id=${n}`),t.reject(IP.WebSocketConnectionErrors.WebSocketConnectionLost(null!=(s=t.metadata)&&s.method?SP(null==(o=t.metadata)?void 0:o.method):"RECONNECT_SIGNAL",e)),this.callbacks.delete(n))}))}pingPongLoop(e){return OC(this,null,(function*(){var t,n;let i=(null==(t=window.HMS)?void 0:t.PING_TIMEOUT)||12e3;if(this.isConnected){let t=yield this.ping(i);this.pongResponseTimes.enqueue(t),t>i?(nP.d(this.TAG,`Pong timeout ${e}, pageHidden=${"undefined"!=typeof document&&document.hidden}`),this.id===e&&this.setIsConnected(!1,"ping pong failure")):setTimeout((()=>this.pingPongLoop(e)),(null==(n=window.HMS)?void 0:n.PING_INTERVAL)||3e3)}}))}call(e,t){return OC(this,null,(function*(){let n,i=IP.WebsocketMethodErrors.ServerErrors(500,e,`Default ${e} error`);for(n=1;n<=3;n++)try{return this.validateConnection(),nP.d(this.TAG,`Try number ${n} sending ${e}`,t),yield this.internalCall(e,t)}catch(r){if(i=r,nP.e(this.TAG,`Failed sending ${e} try: ${n}`,{method:e,params:t,error:i}),5!==parseInt(""+i.code/100)&&429!==i.code&&1003!==i.code)break;let s=1e3*(2+2*Math.random());yield oA(s)}throw nP.e(`Sending ${e} over WS failed after ${Math.min(n,3)} retries`,{method:e,params:t,error:i}),i}))}},ZN="[HMSTransport]:",eD=class{constructor(e,t,n,i,r,s,o){this.observer=e,this.deviceManager=t,this.store=n,this.eventBus=i,this.analyticsEventsService=r,this.analyticsTimer=s,this.pluginUsageTracker=o,this.state="Disconnected",this.trackStates=new Map,this.publishConnection=null,this.subscribeConnection=null,this.maxSubscribeBitrate=0,this.joinRetryCount=0,this.publishDisconnectTimer=0,this.onScreenshareStop=()=>{},this.screenStream=new Set,this.callbacks=new Map,this.setListener=e=>{this.listener=e},this.setOnScreenshareStop=e=>{this.onScreenshareStop=e},this.signalObserver={onOffer:e=>OC(this,null,(function*(){try{if(!this.subscribeConnection)return;if(e.sfu_node_id&&this.subscribeConnection.sfuNodeId&&this.subscribeConnection.sfuNodeId!==e.sfu_node_id)return void nP.d(ZN,"ignoring old offer");yield this.subscribeConnection.setRemoteDescription(e),nP.d(ZN,`[SUBSCRIBE] Adding ${this.subscribeConnection.candidates.length} ice-candidates`,this.subscribeConnection.candidates);for(let e of this.subscribeConnection.candidates)yield this.subscribeConnection.addIceCandidate(e);this.subscribeConnection.candidates.length=0;let t=yield this.subscribeConnection.createAnswer();yield this.subscribeConnection.setLocalDescription(t),this.signal.answer(t),nP.d(ZN,"[role=SUBSCRIBE] onOffer renegotiation DONE \u2705")}catch(t){let n;nP.d(ZN,"[role=SUBSCRIBE] onOffer renegotiation FAILED \u274c",t),this.state="Failed",n=t instanceof wP?t:IP.GenericErrors.Unknown("SUBSCRIBE",t.message),this.observer.onFailure(n),this.eventBus.analytics.publish(FP.subscribeFail(n))}})),onTrickle:e=>OC(this,null,(function*(){let t=0===e.target?this.publishConnection:this.subscribeConnection;null!=t&&t.remoteDescription?yield t.addIceCandidate(e.candidate):null==t||t.candidates.push(e.candidate)})),onNotification:e=>this.observer.onNotification(e),onServerError:e=>OC(this,null,(function*(){yield this.observer.onStateChange("Failed",e)})),onFailure:e=>{this.joinParameters&&this.retryScheduler.schedule({category:1,error:e,task:this.retrySignalDisconnectTask,originalState:this.state})},onOffline:e=>OC(this,null,(function*(){nP.d(ZN,"socket offline",AN[this.state]);try{"Leaving"!==this.state&&this.joinParameters&&this.retryScheduler.schedule({category:1,error:IP.WebSocketConnectionErrors.WebSocketConnectionLost("RECONNECT_SIGNAL",e),task:this.retrySignalDisconnectTask,originalState:this.state})}catch(t){console.error(t)}})),onOnline:()=>{var e;nP.d(ZN,"socket online",AN[this.state]),this.analyticsSignalTransport.flushFailedEvents(null==(e=this.store.getLocalPeer())?void 0:e.peerId)},onNetworkOnline:()=>{this.analyticsEventsService.flushFailedClientEvents()}},this.signal=new XN(this.signalObserver),this.analyticsSignalTransport=new DN(this.signal),this.publishDtlsStateTimer=0,this.lastPublishDtlsState="new",this.handleLocalRoleUpdate=e=>OC(this,[e],(function(e){var t=this;let{oldRole:n,newRole:i}=e;return function*(){!t.doesRoleNeedWebRTC(n)&&t.doesRoleNeedWebRTC(i)&&(nP.d(ZN,"Local peer role updated to webrtc role, creating PeerConnections and performing inital publish negotiation \u23f3"),t.createPeerConnections(),yield t.negotiateOnFirstPublish())}()})),this.retryPublishIceFailedTask=()=>OC(this,null,(function*(){if(this.publishConnection){let e=new Promise(((e,t)=>{this.callbacks.set(QA,{promise:{resolve:e,reject:t},action:"RESTART_ICE",extra:{}})}));yield this.performPublishRenegotiation({iceRestart:"connected"!==this.publishConnection.connectionState}),yield e}return!0})),this.retrySubscribeIceFailedTask=()=>OC(this,null,(function*(){if(this.subscribeConnection&&"connected"!==this.subscribeConnection.connectionState){let e=new Promise(((e,t)=>{this.callbacks.set(YA,{promise:{resolve:e,reject:t},action:"RESTART_ICE",extra:{}})})),t=new Promise((e=>{setTimeout(e,6e4,!1)}));return Promise.race([e,t])}return!0})),this.retrySignalDisconnectTask=()=>OC(this,null,(function*(){var e;nP.d(ZN,"retrySignalDisconnectTask",{signalConnected:this.signal.isConnected}),this.signal.isConnected||(yield this.internalConnect(this.joinParameters.authToken,this.joinParameters.endpoint,this.joinParameters.peerId,this.joinParameters.iceServers));let t=null!=(e=this.store.getRoom())&&e.joinedAt?this.signal.isConnected&&(yield this.retryPublishIceFailedTask()):this.signal.isConnected;return this.signal.trackUpdate(this.trackStates),t})),this.webrtcInternals=new D_(this.store,this.eventBus);this.retryScheduler=new xN(((e,t)=>OC(this,null,(function*(){e!==this.state&&(this.state=e,yield this.observer.onStateChange(this.state,t))}))),this.sendErrorAnalyticsEvent.bind(this)),this.eventBus.statsUpdate.subscribe((e=>{var t,n;let i=(null==(n=null==(t=e.getLocalPeerStats())?void 0:t.subscribe)?void 0:n.bitrate)||0;this.maxSubscribeBitrate=Math.max(this.maxSubscribeBitrate,i)})),this.eventBus.localAudioEnabled.subscribe((e=>{let{track:t,enabled:n}=e;return this.trackUpdate(t,n)})),this.eventBus.localVideoEnabled.subscribe((e=>{let{track:t,enabled:n}=e;return this.trackUpdate(t,n)}))}getWebsocketEndpoint(){if(this.initConfig)return this.initConfig.endpoint}getWebrtcInternals(){return this.webrtcInternals}isFlagEnabled(e){var t;let n=null==(t=this.initConfig)?void 0:t.config;return((null==n?void 0:n.enabledFlags)||[]).includes(e)}setConnectivityListener(e){this.connectivityListener=e}preview(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;return OC(this,null,(function*(){let o=yield this.connect(e,t,n,i,r,s);return this.state="Preview",this.observer.onStateChange(this.state),o}))}join(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;return OC(this,null,(function*(){nP.d(ZN,"join: started \u23f0");try{(!this.signal.isConnected||!this.initConfig)&&(yield this.connect(e,i,t,n,r,s)),this.validateNotDisconnected("connect"),this.initConfig&&(yield this.waitForLocalRoleAvailability(),yield this.createConnectionsAndNegotiateJoin(n,r),this.initStatsAnalytics(),nP.d(ZN,"\u2705 join: Negotiated over PUBLISH connection"))}catch(yC){nP.e(ZN,`join: failed \u274c [token=${e}]`,yC),this.state="Failed";let n=yC;throw n.isTerminal=n.isTerminal||500===n.code,yield this.observer.onStateChange(this.state,n),n}nP.d(ZN,"\u2705 join: successful"),this.state="Joined",this.observer.onStateChange(this.state)}))}connect(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;return OC(this,null,(function*(){this.setTransportStateForConnect(),this.joinParameters=new IN(e,n,i.name,i.metaData,t,r,s);try{return yield this.internalConnect(e,t,n,s)}catch(yC){if(!(yC instanceof wP&&([bP.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,bP.WebSocketConnectionErrors.FAILED_TO_CONNECT,bP.WebSocketConnectionErrors.ABNORMAL_CLOSE,bP.APIErrors.ENDPOINT_UNREACHABLE].includes(yC.code)||yC.code.toString().startsWith("5")||yC.code.toString().startsWith("429"))))throw yC;{let r=()=>OC(this,null,(function*(){return yield this.internalConnect(e,t,n,s),!(!this.initConfig||!this.initConfig.endpoint)}));yield this.retryScheduler.schedule({category:0,error:yC,task:r,originalState:this.state,changeState:!1})}}}))}leave(e){return OC(this,arguments,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user request";return function*(){var i,r,s;t.retryScheduler.reset(),t.joinParameters=void 0,nP.d(ZN,"leaving in transport");try{let o=t.pluginUsageTracker.getPluginUsage("HMSKrispPlugin");if(o&&t.eventBus.analytics.publish(FP.getKrispUsage(o)),t.state="Leaving",null==(i=t.publishStatsAnalytics)||i.stop(),null==(r=t.subscribeStatsAnalytics)||r.stop(),null==(s=t.webrtcInternals)||s.cleanup(),t.clearPeerConnections(),e)try{t.signal.leave(n),nP.d(ZN,"signal leave done")}catch(ZC){nP.w(ZN,"failed to send leave on websocket to server",ZC)}t.analyticsEventsService.flushFailedClientEvents(),t.analyticsEventsService.reset(),yield t.signal.close()}catch(yC){t.eventBus.analytics.publish(FP.disconnect(yC)),nP.e(ZN,"leave: FAILED \u274c",yC)}finally{t.state="Disconnected",t.observer.onStateChange(t.state)}}()}))}publish(e){return OC(this,null,(function*(){var t;for(let n of e)try{yield this.publishTrack(n),null==(t=this.connectivityListener)||t.onMediaPublished(n)}catch(vP){this.eventBus.analytics.publish(FP.publish({devices:this.deviceManager.getDevices(),error:vP}))}}))}unpublish(e){return OC(this,null,(function*(){for(let t of e)yield this.unpublishTrack(t)}))}setSFUNodeId(e){var t,n;this.signal.setSfuNodeId(e),this.sfuNodeId?e&&this.sfuNodeId!==e&&(this.sfuNodeId=e,this.handleSFUMigration()):(this.sfuNodeId=e,null==(t=this.publishConnection)||t.setSfuNodeId(e),null==(n=this.subscribeConnection)||n.setSfuNodeId(e))}handleSFUMigration(){return OC(this,null,(function*(){var e,t;nP.time("sfu migration"),this.clearPeerConnections();let n=this.store.getPeerMap();this.store.removeRemoteTracks();for(let o in n){let e=n[o];e.isLocal||(e.audioTrack=void 0,e.videoTrack=void 0,e.auxiliaryTracks=[])}let i=this.store.getLocalPeer();if(!i)return;this.createPeerConnections(),this.trackStates.clear(),yield this.negotiateOnFirstPublish();let r=new Map;if(i.audioTrack){let e=i.audioTrack.stream;r.get(e.id)||r.set(e.id,new T_(new MediaStream));let t=i.audioTrack.clone(r.get(e.id));this.store.removeTrack(i.audioTrack),i.audioTrack.cleanup(),yield this.publishTrack(t),i.audioTrack=t}if(i.videoTrack){let e=i.videoTrack.stream;r.get(e.id)||r.set(e.id,new T_(new MediaStream)),this.store.removeTrack(i.videoTrack);let t=i.videoTrack.clone(r.get(e.id));i.videoTrack.cleanup(),yield this.publishTrack(t),i.videoTrack=t}let s=[];for(;i.auxiliaryTracks.length>0;){let e=i.auxiliaryTracks.shift();if(e){let t=e.stream;r.get(t.id)||r.set(t.id,new T_("screen"===e.source?t.nativeStream.clone():new MediaStream)),this.store.removeTrack(e);let n=e.clone(r.get(t.id));"video"===n.type&&"screen"===n.source&&(this.screenStream.add(t.nativeStream),this.screenStream.add(n.stream.nativeStream),n.nativeTrack.addEventListener("ended",this.onScreenshareStop)),e.cleanup(),yield this.publishTrack(n),s.push(n)}}i.auxiliaryTracks=s,r.clear(),null==(t=null==(e=this.listener)?void 0:e.onSFUMigration)||t.call(e),nP.timeEnd("sfu migration")}))}trackUpdate(e,t){var n;let i=Array.from(this.trackStates.values()).find((t=>e.type===t.type&&e.source===t.source));if(i){let r=new GR(NC(RC({},i),{mute:!t}));this.trackStates.set(i.track_id,r),nP.d(ZN,"Track Update",this.trackStates,e),this.signal.trackUpdate(new Map([[i.track_id,r]]));let s=this.store.getLocalPeer();s&&t===e.enabled&&(null==(n=this.listener)||n.onTrackUpdate(t?3:2,e,s))}}publishTrack(e){return OC(this,null,(function*(){e.publishedTrackId=e.getTrackIDBeingSent(),nP.d(ZN,`\u23f3 publishTrack: trackId=${e.trackId}, toPublishTrackId=${e.publishedTrackId}`,`${e}`),this.trackStates.set(e.publishedTrackId,new GR(e));let t=new Promise(((e,t)=>{this.callbacks.set(QA,{promise:{resolve:e,reject:t},action:"PUBLISH",extra:{}})})),n=e.stream;n.setConnection(this.publishConnection);let i=this.store.getSimulcastLayers(e.source);n.addTransceiver(e,i),nP.time(`publish-${e.trackId}-${e.type}`),yield t,nP.timeEnd(`publish-${e.trackId}-${e.type}`),this.store.addTrack(e),yield n.setMaxBitrateAndFramerate(e).then((()=>{nP.d(ZN,`Setting maxBitrate=${e.settings.maxBitrate} kpbs${e instanceof KA?` and maxFramerate=${e.settings.maxFramerate}`:""} for ${e.source} ${e.type} ${e.trackId}`)})).catch((e=>nP.w(ZN,"Failed setting maxBitrate and maxFramerate",e))),e.isPublished=!0,nP.d(ZN,`\u2705 publishTrack: trackId=${e.trackId}`,`${e}`,this.callbacks)}))}unpublishTrack(e){return OC(this,null,(function*(){if(nP.d(ZN,`\u23f3 unpublishTrack: trackId=${e.trackId}`,`${e}`),e.publishedTrackId&&this.trackStates.has(e.publishedTrackId))this.trackStates.delete(e.publishedTrackId);else{let t=Array.from(this.trackStates.values()).find((t=>e.type===t.type&&e.source===t.source));t&&this.trackStates.delete(t.track_id)}let t=new Promise(((e,t)=>{this.callbacks.set(QA,{promise:{resolve:e,reject:t},action:"UNPUBLISH",extra:{}})}));e.stream.removeSender(e),yield t,yield e.cleanup(),"screen"===e.source&&this.screenStream&&this.screenStream.forEach((e=>{e.getTracks().forEach((e=>{e.stop()})),this.screenStream.delete(e)})),this.store.removeTrack(e),nP.d(ZN,`\u2705 unpublishTrack: trackId=${e.trackId}`,this.callbacks)}))}clearPeerConnections(){return OC(this,null,(function*(){var e,t;clearTimeout(this.publishDtlsStateTimer),this.publishDtlsStateTimer=0,clearTimeout(this.publishDisconnectTimer),this.publishDisconnectTimer=0,this.lastPublishDtlsState="new",null==(e=this.publishConnection)||e.close(),null==(t=this.subscribeConnection)||t.close(),this.publishConnection=null,this.subscribeConnection=null}))}waitForLocalRoleAvailability(){if(!this.store.hasRoleDetailsArrived())return new Promise((e=>{this.eventBus.policyChange.subscribeOnce((()=>e()))}))}createConnectionsAndNegotiateJoin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){let n=this.doesLocalPeerNeedWebRTC();n&&this.createPeerConnections(),this.analyticsTimer.start("join_response_time"),yield this.negotiateJoinWithRetry({name:e.name,data:e.metaData,autoSubscribeVideo:t,isWebRTC:n}),this.analyticsTimer.end("join_response_time")}))}createPeerConnections(){var e,t,n;let i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(["disconnected","failed"].includes(t)?nP.w.bind(nP):nP.d.bind(nP))(ZN,`${zN[e]} ${n?"ice":""} connection state change: ${t}`)};if(this.initConfig){let e={onRenegotiationNeeded:()=>OC(this,null,(function*(){yield this.performPublishRenegotiation()})),onDTLSTransportStateChange:e=>{var t,n,i;if(("failed"===e?nP.w.bind(nP):nP.d.bind(nP))(ZN,`Publisher on dtls transport state change: ${e}`),!e||this.lastPublishDtlsState===e||(this.lastPublishDtlsState=e,0!==this.publishDtlsStateTimer&&(clearTimeout(this.publishDtlsStateTimer),this.publishDtlsStateTimer=0),"connecting"!==e&&"failed"!==e))return;let r=null==(i=null==(n=null==(t=this.initConfig)?void 0:t.config)?void 0:n.dtlsStateTimeouts)?void 0:i[e];!r||r<=0||(this.publishDtlsStateTimer=window.setTimeout((()=>{var t;let n=null==(t=this.publishConnection)?void 0:t.nativeConnection.connectionState;if(n&&e&&n===e){let t=IP.WebrtcErrors.ICEFailure("PUBLISH",`DTLS transport state ${e} timeout:${r}ms`,!0);this.eventBus.analytics.publish(FP.disconnect(t)),this.observer.onFailure(t)}}),r))},onDTLSTransportError:e=>{nP.e(ZN,`onDTLSTransportError ${e.name} ${e.message}`,e),this.eventBus.analytics.publish(FP.disconnect(e))},onIceConnectionChange:e=>OC(this,null,(function*(){i(0,e,!0)})),onConnectionStateChange:e=>OC(this,null,(function*(){var t,n,r,s,o,a,l,c;i(0,e,!1),"new"!==e&&("connected"===e?(null==(t=this.connectivityListener)||t.onICESuccess(!0),null==(n=this.publishConnection)||n.handleSelectedIceCandidatePairs()):"failed"===e?yield this.handleIceConnectionFailure(0,IP.WebrtcErrors.ICEFailure("PUBLISH",`local candidate - ${null==(o=null==(s=null==(r=this.publishConnection)?void 0:r.selectedCandidatePair)?void 0:s.local)?void 0:o.candidate}; remote candidate - ${null==(c=null==(l=null==(a=this.publishConnection)?void 0:a.selectedCandidatePair)?void 0:l.remote)?void 0:c.candidate}`)):this.publishDisconnectTimer=window.setTimeout((()=>{var e,t,n,i,r,s,o;"connected"!==(null==(e=this.publishConnection)?void 0:e.connectionState)&&this.handleIceConnectionFailure(0,IP.WebrtcErrors.ICEDisconnected("PUBLISH",`local candidate - ${null==(i=null==(n=null==(t=this.publishConnection)?void 0:t.selectedCandidatePair)?void 0:n.local)?void 0:i.candidate}; remote candidate - ${null==(o=null==(s=null==(r=this.publishConnection)?void 0:r.selectedCandidatePair)?void 0:s.remote)?void 0:o.candidate}`))}),5e3))})),onIceCandidate:e=>{var t;null==(t=this.connectivityListener)||t.onICECandidate(e,!0)},onSelectedCandidatePairChange:e=>{var t;null==(t=this.connectivityListener)||t.onSelectedICECandidatePairChange(e,!0)}},t={onApiChannelMessage:e=>{this.observer.onNotification(JSON.parse(e))},onTrackAdd:e=>{nP.d(ZN,"[Subscribe] onTrackAdd",`${e}`),this.observer.onTrackAdd(e)},onTrackRemove:e=>{nP.d(ZN,"[Subscribe] onTrackRemove",`${e}`),this.observer.onTrackRemove(e)},onIceConnectionChange:e=>OC(this,null,(function*(){var t;if(i(1,e,!0),"connected"===e){let e=this.callbacks.get(YA);this.callbacks.delete(YA),null==(t=this.connectivityListener)||t.onICESuccess(!1),e&&e.promise.resolve(!0)}})),onConnectionStateChange:e=>OC(this,null,(function*(){var t,n,r,s,o,a,l;if(i(1,e,!1),"failed"===e)yield this.handleIceConnectionFailure(1,IP.WebrtcErrors.ICEFailure("SUBSCRIBE",`local candidate - ${null==(r=null==(n=null==(t=this.subscribeConnection)?void 0:t.selectedCandidatePair)?void 0:n.local)?void 0:r.candidate}; remote candidate - ${null==(a=null==(o=null==(s=this.subscribeConnection)?void 0:s.selectedCandidatePair)?void 0:o.remote)?void 0:a.candidate}`));else if("disconnected"===e)setTimeout((()=>{var e,t,n,i,r,s,o;"disconnected"===(null==(e=this.subscribeConnection)?void 0:e.connectionState)&&this.handleIceConnectionFailure(1,IP.WebrtcErrors.ICEDisconnected("SUBSCRIBE",`local candidate - ${null==(i=null==(n=null==(t=this.subscribeConnection)?void 0:t.selectedCandidatePair)?void 0:n.local)?void 0:i.candidate}; remote candidate - ${null==(o=null==(s=null==(r=this.subscribeConnection)?void 0:r.selectedCandidatePair)?void 0:s.remote)?void 0:o.candidate}`))}),5e3);else if("connected"===e){null==(l=this.subscribeConnection)||l.handleSelectedIceCandidatePairs();let e=this.callbacks.get(YA);this.callbacks.delete(YA),e&&e.promise.resolve(!0)}})),onIceCandidate:e=>{var t;null==(t=this.connectivityListener)||t.onICECandidate(e,!1)},onSelectedCandidatePairChange:e=>{var t;null==(t=this.connectivityListener)||t.onSelectedICECandidatePairChange(e,!1)}};this.publishConnection||(this.publishConnection=new HN(this.signal,this.initConfig.rtcConfiguration,e)),this.subscribeConnection||(this.subscribeConnection=new KN(this.signal,this.initConfig.rtcConfiguration,this.isFlagEnabled.bind(this),t))}null==(n=this.webrtcInternals)||n.setPeerConnections({publish:null==(e=this.publishConnection)?void 0:e.nativeConnection,subscribe:null==(t=this.subscribeConnection)?void 0:t.nativeConnection})}negotiateJoinWithRetry(e){return OC(this,arguments,(function(e){var t=this;let{name:n,data:i,autoSubscribeVideo:r,isWebRTC:s=!0}=e;return function*(){try{yield t.negotiateJoin({name:n,data:i,autoSubscribeVideo:r,isWebRTC:s})}catch(e){nP.e(ZN,"Join negotiation failed \u274c",e);let o=e instanceof wP?e:IP.WebsocketMethodErrors.ServerErrors(500,"JOIN",`Websocket join error - ${e.message}`),a=5===parseInt(""+o.code/100)||[bP.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,429].includes(o.code);if(410===o.code&&(o.isTerminal=!0),!a)throw e;{t.joinRetryCount=0,o.isTerminal=!1;let e=()=>OC(t,null,(function*(){return this.joinRetryCount++,yield this.negotiateJoin({name:n,data:i,autoSubscribeVideo:r,isWebRTC:s})}));yield t.retryScheduler.schedule({category:2,error:o,task:e,originalState:"Joined",changeState:!1})}}}()}))}negotiateJoin(e){return OC(this,arguments,(function(e){var t=this;let{name:n,data:i,autoSubscribeVideo:r,isWebRTC:s=!0}=e;return function*(){return s?yield t.negotiateJoinWebRTC({name:n,data:i,autoSubscribeVideo:r}):yield t.negotiateJoinNonWebRTC({name:n,data:i,autoSubscribeVideo:r})}()}))}negotiateJoinWebRTC(e){return OC(this,arguments,(function(e){var t=this;let{name:n,data:i,autoSubscribeVideo:r}=e;return function*(){if(nP.d(ZN,"\u23f3 join: Negotiating over PUBLISH connection"),!t.publishConnection)return nP.e(ZN,"Publish peer connection not found, cannot negotiate"),!1;let e=yield t.publishConnection.createOffer();yield t.publishConnection.setLocalDescription(e);let s=t.isFlagEnabled("subscribeDegradation"),o=t.isFlagEnabled("simulcast"),a=t.isFlagEnabled("onDemandTracks"),l=yield t.signal.join(n,i,!r,s,o,a,e);t.setSFUNodeId(null==l?void 0:l.sfu_node_id),yield t.publishConnection.setRemoteDescription(l);for(let n of t.publishConnection.candidates)yield t.publishConnection.addIceCandidate(n);return t.publishConnection.initAfterJoin(),!!l}()}))}negotiateJoinNonWebRTC(e){return OC(this,arguments,(function(e){var t=this;let{name:n,data:i,autoSubscribeVideo:r}=e;return function*(){nP.d(ZN,"\u23f3 join: Negotiating Non-WebRTC");let e=t.isFlagEnabled("subscribeDegradation"),s=t.isFlagEnabled("simulcast"),o=t.isFlagEnabled("onDemandTracks"),a=yield t.signal.join(n,i,!r,e,s,o);return t.setSFUNodeId(null==a?void 0:a.sfu_node_id),!!a}()}))}negotiateOnFirstPublish(){return OC(this,null,(function*(){if(nP.d(ZN,"\u23f3 Negotiating offer over PUBLISH connection"),!this.publishConnection)return nP.e(ZN,"Publish peer connection not found, cannot negotiate"),!1;try{let e=yield this.publishConnection.createOffer(this.trackStates);yield this.publishConnection.setLocalDescription(e);let t=yield this.signal.offer(e,this.trackStates);yield this.publishConnection.setRemoteDescription(t);for(let n of this.publishConnection.candidates)yield this.publishConnection.addIceCandidate(n);return this.publishConnection.initAfterJoin(),!!t}catch(vC){if(vC instanceof wP&&421===vC.code)return!0;throw vC}}))}performPublishRenegotiation(e){return OC(this,null,(function*(){nP.d(ZN,"\u23f3 [role=PUBLISH] onRenegotiationNeeded START",this.trackStates);let t=this.callbacks.get(QA);if(t)if(this.publishConnection)try{let n=yield this.publishConnection.createOffer(this.trackStates,e);yield this.publishConnection.setLocalDescription(n),nP.time("renegotiation-offer-exchange");let i=yield this.signal.offer(n,this.trackStates);this.callbacks.delete(QA),nP.timeEnd("renegotiation-offer-exchange"),yield this.publishConnection.setRemoteDescription(i),t.promise.resolve(!0),nP.d(ZN,"[role=PUBLISH] onRenegotiationNeeded DONE \u2705")}catch(lP){let n;n=lP instanceof wP?lP:IP.GenericErrors.Unknown("PUBLISH",lP.message),421===n.code?t.promise.resolve(!0):t.promise.reject(n),nP.d(ZN,"[role=PUBLISH] onRenegotiationNeeded FAILED \u274c")}else nP.e(ZN,"Publish peer connection not found, cannot renegotiate");else nP.w(ZN,"no callback found for renegotiation")}))}handleIceConnectionFailure(e,t){return OC(this,null,(function*(){this.retryScheduler.isTaskInProgress(4)||(0===e?this.retryScheduler.schedule({category:3,error:t,task:this.retryPublishIceFailedTask,originalState:"Joined"}):this.retryScheduler.schedule({category:4,error:t,task:this.retrySubscribeIceFailedTask,originalState:"Joined"}))}))}internalConnect(e,t,n,i){return OC(this,null,(function*(){var r,s,o;nP.d(ZN,"connect: started \u23f0");let a=new Date;try{this.analyticsTimer.start("init_response_time"),this.initConfig=yield YN.fetchInitConfig({token:e,peerId:n,userAgent:this.store.getUserAgent(),initEndpoint:t,iceServers:i}),null==(r=this.connectivityListener)||r.onInitSuccess(this.initConfig.endpoint);let a=this.store.getRoom();return a&&(a.effectsKey=null==(s=this.initConfig.config.vb)?void 0:s.effectsKey,a.isEffectsEnabled=this.isFlagEnabled("effectsSDKEnabled"),a.disableNoneLayerRequest=this.isFlagEnabled("disableNoneLayerRequest"),a.isVBEnabled=this.isFlagEnabled("vb"),a.isHipaaEnabled=this.isFlagEnabled("hipaa"),a.isNoiseCancellationEnabled=this.isFlagEnabled("noiseCancellation")),this.analyticsTimer.end("init_response_time"),zR.setWebsocketEndpoint(this.initConfig.endpoint),this.validateNotDisconnected("post init"),yield this.openSignal(e,n),this.observer.onConnected(),null==(o=this.connectivityListener)||o.onSignallingSuccess(),this.store.setSimulcastEnabled(this.isFlagEnabled("simulcast")),nP.d(ZN,"Adding Analytics Transport: JsonRpcSignal"),this.analyticsEventsService.setTransport(this.analyticsSignalTransport),this.analyticsEventsService.flush(),this.initConfig}catch(l){throw"Reconnecting"!==this.state&&this.eventBus.analytics.publish(FP.connect(l,this.getAdditionalAnalyticsProperties(),a,new Date,t)),nP.e(ZN,"\u274c internal connect: failed",l),l}}))}validateNotDisconnected(e){if("Disconnected"===this.state)throw nP.w(ZN,"aborting join as transport state is disconnected"),IP.GenericErrors.ValidationFailed(`leave called before join could complete - stage=${e}`)}openSignal(e,t){return OC(this,null,(function*(){if(!this.initConfig)throw IP.APIErrors.InitConfigNotAvailable("INIT","Init Config not found");nP.d(ZN,"\u23f3 internal connect: connecting to ws endpoint",this.initConfig.endpoint);let n=new URL(this.initConfig.endpoint);n.searchParams.set("peer",t),n.searchParams.set("token",e),n.searchParams.set("user_agent_v2",this.store.getUserAgent()),n.searchParams.set("protocol_version","2.5"),n.searchParams.set("protocol_spec","20250115"),this.endpoint=n.toString(),this.analyticsTimer.start("ws_connect_time"),yield this.signal.open(this.endpoint),this.analyticsTimer.end("ws_connect_time"),this.analyticsTimer.start("on_policy_change_time"),this.analyticsTimer.start("room_state_time"),nP.d(ZN,"\u2705 internal connect: connected to ws endpoint")}))}initStatsAnalytics(){var e,t;this.isFlagEnabled("publishStats")&&(this.publishStatsAnalytics=new UN(this.store,this.eventBus,this.getValueFromInitConfig("publishStats","maxSampleWindowSize",30),this.getValueFromInitConfig("publishStats","maxSamplePushInterval",300)),null==(e=this.getWebrtcInternals())||e.start()),this.isFlagEnabled("subscribeStats")&&(this.subscribeStatsAnalytics=new BN(this.store,this.eventBus,this.getValueFromInitConfig("subscribeStats","maxSampleWindowSize",10),this.getValueFromInitConfig("subscribeStats","maxSamplePushInterval",60)),null==(t=this.getWebrtcInternals())||t.start())}getValueFromInitConfig(e,t,n){var i,r;return(null==(r=null==(i=this.initConfig)?void 0:i.config[e])?void 0:r[t])||n}doesRoleNeedWebRTC(e){var t,n;if(!this.isFlagEnabled("nonWebRTCDisableOffer"))return!0;let i=!!(e.publishParams.allowed&&(null==(t=e.publishParams.allowed)?void 0:t.length)>0),r=!!(e.subscribeParams.subscribeToRoles&&(null==(n=e.subscribeParams.subscribeToRoles)?void 0:n.length)>0);return i||r}doesLocalPeerNeedWebRTC(){var e;let t=null==(e=this.store.getLocalPeer())?void 0:e.role;return!t||this.doesRoleNeedWebRTC(t)}setTransportStateForConnect(){if("Failed"===this.state&&(this.state="Disconnected"),"Disconnected"!==this.state&&"Reconnecting"!==this.state)throw IP.WebsocketMethodErrors.AlreadyJoined("JOIN",`Cannot join a meeting in ${this.state} state`);"Disconnected"===this.state&&(this.state="Connecting",this.observer.onStateChange(this.state))}sendErrorAnalyticsEvent(e,t){let n,i=this.getAdditionalAnalyticsProperties();switch(t){case 0:n=FP.connect(e,i);break;case 1:n=FP.disconnect(e,i);break;case 2:n=FP.join({error:e,time:this.analyticsTimer.getTimeTaken("join_time"),init_response_time:this.analyticsTimer.getTimeTaken("init_response_time"),ws_connect_time:this.analyticsTimer.getTimeTaken("ws_connect_time"),on_policy_change_time:this.analyticsTimer.getTimeTaken("on_policy_change_time"),local_audio_track_time:this.analyticsTimer.getTimeTaken("local_audio_track_time"),local_video_track_time:this.analyticsTimer.getTimeTaken("local_video_track_time"),retries_join:this.joinRetryCount});break;case 3:n=FP.publish({error:e});break;case 4:n=FP.subscribeFail(e)}this.eventBus.analytics.publish(n)}getSubscribeConnection(){return this.subscribeConnection}getAdditionalAnalyticsProperties(){var e,t,n,i,r,s,o,a;let l=(()=>{if(!dP||"undefined"==typeof navigator.connection)return;let e=navigator.connection;return{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData,type:e.type}})(),c="undefined"!=typeof document&&document.hidden,u=this.store.getRemoteVideoTracks().filter((e=>e.degraded)).length;return{network_info:l,document_hidden:c,num_degraded_tracks:u,bitrate:{publish:null==(i=null==(n=null==(t=null==(e=this.getWebrtcInternals())?void 0:e.getCurrentStats())?void 0:t.getLocalPeerStats())?void 0:n.publish)?void 0:i.bitrate,subscribe:null==(a=null==(o=null==(s=null==(r=this.getWebrtcInternals())?void 0:r.getCurrentStats())?void 0:s.getLocalPeerStats())?void 0:o.subscribe)?void 0:a.bitrate},max_sub_bitrate:this.maxSubscribeBitrate,recent_pong_response_times:this.signal.getPongResponseTimes(),transport_state:this.state}}};function tD(e){if(!e||0===e.length)throw IP.APIErrors.InvalidTokenFormat("INIT","Token cannot be an empty string or undefined or null");let t=e.split(".");if(3!==t.length)throw IP.APIErrors.InvalidTokenFormat("INIT","Expected 3 '.' separate fields - header, payload and signature respectively");let n=atob(t[1]);try{let e=JSON.parse(n);return{roomId:e.room_id,userId:e.user_id,role:e.role}}catch(lP){throw IP.APIErrors.InvalidTokenFormat("INIT",`couldn't parse to json - ${lP.message}`)}}var nD={published:!1,isInitialised:!1,isReconnecting:!1,isPreviewInProgress:!1,isPreviewCalled:!1,isJoinInProgress:!1,deviceManagersInitialised:!1},iD=class{constructor(){var e=this;this.TAG="[HMSSdk]:",this.transportState="Disconnected",this.analyticsTimer=new GA,this.sdkState=RC({},nD),this.isDiagnostics=!1,this.playlistSettings={video:{bitrate:1e3},audio:{bitrate:64}},this.handleAutoplayError=e=>{var t,n;null==(n=null==(t=this.errorListener)?void 0:t.onError)||n.call(t,e)},this.observer={onNotification:e=>{var t;if("on-peer-leave-request"!==e.method){switch(e.method){case"on-policy-change":this.analyticsTimer.end("on_policy_change_time");break;case"peer-list":this.analyticsTimer.end("peer_list_time"),this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled);break;case"room-state":this.analyticsTimer.end("room_state_time")}null==(t=this.notificationManager)||t.handleNotification(e,this.sdkState.isReconnecting)}else this.handlePeerLeaveRequest(e.params)},onConnected:()=>{this.initNotificationManager()},onTrackAdd:e=>{var t;null==(t=this.notificationManager)||t.handleTrackAdd(e)},onTrackRemove:e=>{var t;null==(t=this.notificationManager)||t.handleTrackRemove(e)},onFailure:e=>{var t;null==(t=this.errorListener)||t.onError(e)},onStateChange:(e,t)=>OC(this,null,(function*(){var n,i;let r=e=>OC(this,null,(function*(){var t,n;yield this.internalLeave(!0,e),!this.sdkState.isPreviewInProgress&&!this.sdkState.isJoinInProgress&&(null==(n=null==(t=this.errorListener)?void 0:t.onError)||n.call(t,e)),this.sdkState.isReconnecting=!1}));switch(e){case"Preview":case"Joined":this.initNotificationManager(),"Reconnecting"===this.transportState&&(null==(n=this.listener)||n.onReconnected());break;case"Failed":yield r(t);break;case"Reconnecting":this.sdkState.isReconnecting=!0,null==(i=this.listener)||i.onReconnecting(t)}this.transportState=e,nP.d(this.TAG,"Transport State Change",this.transportState)}))},this.handlePeerLeaveRequest=e=>{var t;let n=e.requested_by?this.store.getPeerById(e.requested_by):void 0,i={roomEnded:e.room_end,reason:e.reason,requestedBy:n};null==(t=this.listener)||t.onRemovedFromRoom(i),this.internalLeave(!1)},this.handlePreviewError=e=>{var t;this.analyticsTimer.end("preview_time"),e&&(null==(t=this.errorListener)||t.onError(e)),this.sendPreviewAnalyticsEvent(e),this.sdkState.isPreviewInProgress=!1},this.handleDeviceChange=e=>{var t,n;e.isUserSelection||(nP.d(this.TAG,"Device Change event",e),null==(n=null==(t=this.deviceChangeListener)?void 0:t.onDeviceChange)||n.call(t,e),(()=>{var t,n,i,r;if(e.error&&e.type){let s=e.type.includes("audio")?null==(t=this.localPeer)?void 0:t.audioTrack:null==(n=this.localPeer)?void 0:n.videoTrack;null==(i=this.errorListener)||i.onError(e.error),[bP.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,bP.TracksErrors.DEVICE_IN_USE,bP.TracksErrors.DEVICE_NOT_AVAILABLE].includes(e.error.code)&&s&&(s.setEnabled(!1),null==(r=this.listener)||r.onTrackUpdate(2,s,this.localPeer))}})())},this.handleAudioPluginError=e=>{var t;nP.e(this.TAG,"Audio Plugin Error event",e),null==(t=this.errorListener)||t.onError(e)},this.handleError=e=>{var t;nP.e(this.TAG,e),null==(t=this.errorListener)||t.onError(e)},this.handleLocalRoleUpdate=e=>OC(this,[e],(function(e){var t=this;let{oldRole:n,newRole:i}=e;return function*(){var e;t.deviceManager.currentSelection=t.deviceManager.getCurrentSelection(),yield t.transport.handleLocalRoleUpdate({oldRole:n,newRole:i}),yield null==(e=t.roleChangeManager)?void 0:e.handleLocalPeerRoleUpdate({oldRole:n,newRole:i}),yield t.interactivityCenter.whiteboard.handleLocalRoleUpdate()}()})),this.unpauseRemoteVideoTracks=()=>{this.store.getRemoteVideoTracks().forEach((e=>e.handleTrackUnmute()))},this.sendAudioPresenceFailed=()=>{var e;let t=IP.TracksErrors.NoAudioDetected("PREVIEW");nP.w(this.TAG,"Audio Presence Failure",this.transportState,t),this.isDiagnostics&&(null==(e=this.listener)||e.onError(t))},this.sendJoinAnalyticsEvent=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;e.eventBus.analytics.publish(FP.join(NC(RC({error:n},e.analyticsTimer.getTimes()),{time:e.analyticsTimer.getTimeTaken("join_time"),is_preview_called:t,retries_join:e.transport.joinRetryCount})))},this.sendPreviewAnalyticsEvent=e=>{this.eventBus.analytics.publish(FP.preview(NC(RC({error:e},this.analyticsTimer.getTimes()),{time:this.analyticsTimer.getTimeTaken("preview_time")})))},this.sendAnalyticsEvent=e=>{this.isDiagnostics||this.analyticsEventsService.queue(e).flush()}}setSessionPeerInfo(e,t){var n,i,r,s;let o=this.store.getRoom();t&&o?this.sessionPeerInfo={peer:{peer_id:t.peerId,role:null==(n=t.role)?void 0:n.name,joined_at:(null==(i=t.joinedAt)?void 0:i.valueOf())||0,room_name:o.name,session_started_at:(null==(r=o.startedAt)?void 0:r.valueOf())||0,user_data:t.customerUserId,user_name:t.name,template_id:o.templateId,session_id:o.sessionId,token:null==(s=this.store.getConfig())?void 0:s.authToken},agent:this.store.getUserAgent(),device_id:AP(),cluster:{websocket_url:e},timestamp:Date.now()}:nP.e(this.TAG,"setSessionPeerInfo> Local peer or room is undefined")}initNotificationManager(){this.notificationManager||(this.notificationManager=new SN(this.store,this.eventBus,this.transport,this.listener,this.audioListener))}initStoreAndManagers(e){var t,n;if(this.listener=e,this.errorListener=e,this.deviceChangeListener=e,null==(t=this.store)||t.setErrorListener(this.errorListener),this.sdkState.isInitialised)return null==(n=this.notificationManager)||n.setListener(this.listener),this.audioSinkManager.setListener(this.listener),this.interactivityCenter.setListener(this.listener),void this.transport.setListener(this.listener);this.sdkState.isInitialised=!0,this.store=new qR,this.store.setErrorListener(this.errorListener),this.eventBus=new iN,this.pluginUsageTracker=new JR(this.eventBus),this.wakeLockManager=new HR,this.networkTestManager=new BR(this.eventBus,this.listener),this.playlistManager=new H_(this,this.eventBus),this.deviceManager=new YR(this.store,this.eventBus),this.audioSinkManager=new QR(this.store,this.deviceManager,this.eventBus),this.audioOutput=new XR(this.deviceManager,this.audioSinkManager),this.audioSinkManager.setListener(this.listener),this.eventBus.autoplayError.subscribe(this.handleAutoplayError),this.localTrackManager=new HA(this.store,this.observer,this.deviceManager,this.eventBus,this.analyticsTimer),this.analyticsEventsService=new WR(this.store),this.transport=new eD(this.observer,this.deviceManager,this.store,this.eventBus,this.analyticsEventsService,this.analyticsTimer,this.pluginUsageTracker),"onInitSuccess"in e&&this.transport.setConnectivityListener(e),this.sessionStore=new EN(this.transport),this.interactivityCenter=new gN(this.transport,this.store,this.listener),this.eventBus.analytics.subscribe(this.sendAnalyticsEvent),this.eventBus.deviceChange.subscribe(this.handleDeviceChange),this.eventBus.localVideoUnmutedNatively.subscribe(this.unpauseRemoteVideoTracks),this.eventBus.localAudioUnmutedNatively.subscribe(this.unpauseRemoteVideoTracks),this.eventBus.audioPluginFailed.subscribe(this.handleAudioPluginError),this.eventBus.error.subscribe(this.handleError)}validateJoined(e){if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION",`Not connected - ${e}`)}sendHLSAnalytics(e){this.sendAnalyticsEvent(FP.hlsPlayerError(e))}refreshDevices(){return OC(this,null,(function*(){this.validateJoined("refreshDevices"),yield this.deviceManager.init(!0)}))}getWebrtcInternals(){var e;return null==(e=this.transport)?void 0:e.getWebrtcInternals()}getDebugInfo(){var e;if(!this.transport)throw nP.e(this.TAG,"Transport is not defined"),new Error("getDebugInfo can only be called after join");let t=this.transport.getWebsocketEndpoint(),n=Object.values(pN).filter((e=>this.transport.isFlagEnabled(e)));return{websocketURL:t,enabledFlags:n,initEndpoint:null==(e=this.store.getConfig())?void 0:e.initEndpoint}}getSessionStore(){return this.sessionStore}getPlaylistManager(){return this.playlistManager}getRecordingState(){var e;return null==(e=this.store.getRoom())?void 0:e.recording}getRTMPState(){var e;return null==(e=this.store.getRoom())?void 0:e.rtmp}getHLSState(){var e;return null==(e=this.store.getRoom())?void 0:e.hls}getTranscriptionState(){var e;return null==(e=this.store.getRoom())?void 0:e.transcriptions}getTemplateAppData(){return this.store.getTemplateAppData()}getInteractivityCenter(){return this.interactivityCenter}getPeerListIterator(e){return new U_(this.transport,this.store,e)}updatePlaylistSettings(e){e.video&&Object.assign(this.playlistSettings.video,e.video),e.audio&&Object.assign(this.playlistSettings.audio,e.audio)}get localPeer(){var e;return null==(e=this.store)?void 0:e.getLocalPeer()}preview(e,t){return OC(this,null,(function*(){if(NP(),RP(),this.sdkState.isPreviewInProgress)return Promise.reject(IP.GenericErrors.PreviewAlreadyInProgress("PREVIEW","Preview already called"));if(["Joined","Reconnecting"].includes(this.transportState))return this.midCallPreview(e.asRole,e.settings);this.analyticsTimer.start("preview_time"),this.setUpPreview(e,t);let n=!1,i=!1,r=setTimeout((()=>{var e,t;(!n||!i)&&(null==(t=null==(e=this.listener)?void 0:e.onNetworkQuality)||t.call(e,-1))}),3e3);return new Promise(((s,o)=>{this.eventBus.policyChange.subscribeOnce((()=>OC(this,null,(function*(){var n;if(this.localPeer){let t=e.asRole&&this.store.getPolicyForRole(e.asRole);this.localPeer.asRole=t||this.localPeer.role}let i=yield this.localTrackManager.getTracksToPublish(e.settings);i.forEach((e=>{var t;if(this.setLocalPeerTrack(e),e.isTrackNotPublishing()){let n=IP.TracksErrors.NoDataInTrack(`${e.type} track has no data. muted: ${e.nativeTrack.muted}, readyState: ${e.nativeTrack.readyState}`);nP.e(this.TAG,n),this.sendAnalyticsEvent(FP.publish({devices:this.deviceManager.getDevices(),error:n})),null==(t=this.listener)||t.onError(n)}})),null!=(n=this.localPeer)&&n.audioTrack&&this.initPreviewTrackAudioLevelMonitor(),yield this.initDeviceManagers(),this.sdkState.isPreviewInProgress=!1,this.analyticsTimer.end("preview_time");let r=this.store.getRoom();r&&t.onPreview(r,i),this.sendPreviewAnalyticsEvent(),s()})))),this.eventBus.leave.subscribeOnce(this.handlePreviewError),this.eventBus.leave.subscribeOnce((e=>o(e))),this.transport.preview(e.authToken,e.initEndpoint,this.localPeer.peerId,{name:e.userName,metaData:e.metaData||""},e.autoVideoSubscribe,e.iceServers).then((t=>{var s;n=!0,clearTimeout(r),t&&e.captureNetworkQualityInPreview&&this.networkTestManager.start(null==(s=t.config)?void 0:s.networkHealth).then((()=>{i=!0}))})).catch((e=>{this.handlePreviewError(e),o(e)}))}))}))}midCallPreview(e,t){return OC(this,null,(function*(){var n,i;if(!this.localPeer||"Joined"!==this.transportState)throw IP.GenericErrors.NotConnected("VALIDATION","Not connected - midCallPreview");let r=e&&this.store.getPolicyForRole(e);if(!r)throw IP.GenericErrors.InvalidRole("PREVIEW",`role ${e} does not exist in policy`);this.localPeer.asRole=r;let s=yield this.localTrackManager.getTracksToPublish(t);s.forEach((e=>this.setLocalPeerTrack(e))),null!=(n=this.localPeer)&&n.audioTrack&&this.initPreviewTrackAudioLevelMonitor(),yield this.initDeviceManagers(),null==(i=this.listener)||i.onPreview(this.store.getRoom(),s)}))}cancelMidCallPreview(){return OC(this,null,(function*(){var e,t,n;if((!this.localPeer||!this.localPeer.isInPreview())&&nP.w(this.TAG,"Cannot cancel mid call preview as preview is not in progress"),null!=(e=this.localPeer)&&e.asRole&&this.localPeer.role){let e=this.localPeer.asRole,i=this.localPeer.role;delete this.localPeer.asRole,yield null==(t=this.roleChangeManager)?void 0:t.diffRolesAndPublishTracks({oldRole:e,newRole:i}),null==(n=this.listener)||n.onPeerUpdate(8,this.localPeer)}}))}join(e,t){return OC(this,null,(function*(){var n,i,r,s,o,a,l,c;if(NP(),RP(),this.sdkState.isPreviewInProgress)throw IP.GenericErrors.NotReady("JOIN","Preview is in progress, can't join");null==(i=null==(n=this.eventBus)?void 0:n.leave)||i.unsubscribe(this.handlePreviewError),this.analyticsTimer.start("join_time"),this.sdkState.isJoinInProgress=!0;let{roomId:u,userId:d,role:h}=tD(e.authToken),p=(null==(s=null==(r=this.localPeer)?void 0:r.asRole)?void 0:s.name)||(null==(a=null==(o=this.localPeer)?void 0:o.role)?void 0:a.name);null==(l=this.networkTestManager)||l.stop(),this.commonSetup(e,u,t),this.removeDevicesFromConfig(e),this.store.setConfig(e),this.store.createAndSetUserAgent(this.frameworkInfo),eA.resumeContext();let f=this.store.getConfig();null!=f&&f.autoManageWakeLock&&this.wakeLockManager.acquireLock(),this.localPeer?(this.localPeer.name=e.userName,this.localPeer.role=this.store.getPolicyForRole(h),this.localPeer.customerUserId=d,this.localPeer.metadata=e.metaData,delete this.localPeer.asRole):this.createAndAddLocalPeerToStore(e,h,d),this.roleChangeManager=new $R(this.store,this.transport,this.deviceManager,this.getAndPublishTracks.bind(this),this.removeTrack.bind(this),this.listener),this.eventBus.localRoleUpdate.subscribe(this.handleLocalRoleUpdate),nP.d(this.TAG,`\u23f3 Joining room ${u}`),nP.time(`join-room-${u}`);try{yield this.transport.join(e.authToken,this.localPeer.peerId,{name:e.userName,metaData:e.metaData},e.initEndpoint,e.autoVideoSubscribe,e.iceServers),nP.d(this.TAG,`\u2705 Joined room ${u}`),this.analyticsTimer.start("peer_list_time"),yield this.notifyJoin(),this.sdkState.isJoinInProgress=!1,yield this.publish(e.settings,p)}catch(m){throw this.analyticsTimer.end("join_time"),this.sdkState.isJoinInProgress=!1,null==(c=this.listener)||c.onError(m),this.sendJoinAnalyticsEvent(this.sdkState.isPreviewCalled,m),nP.e(this.TAG,"Unable to join room",m),m}nP.timeEnd(`join-room-${u}`)}))}stringifyMetadata(e){e.metaData&&"string"!=typeof e.metaData?e.metaData=JSON.stringify(e.metaData):e.metaData||(e.metaData="")}cleanup(){var e,t,n;this.cleanDeviceManagers(),this.eventBus.analytics.unsubscribe(this.sendAnalyticsEvent),this.eventBus.localVideoUnmutedNatively.unsubscribe(this.unpauseRemoteVideoTracks),this.eventBus.localAudioUnmutedNatively.unsubscribe(this.unpauseRemoteVideoTracks),this.eventBus.error.unsubscribe(this.handleError),this.analyticsTimer.cleanup(),$P.cleanup(),this.playlistManager.cleanup(),null==(e=this.wakeLockManager)||e.cleanup(),HA.cleanup(),this.notificationManager=void 0,nP.cleanup(),this.sdkState=RC({},nD),this.localPeer&&(null==(t=this.localPeer.audioTrack)||t.cleanup(),this.localPeer.audioTrack=void 0,null==(n=this.localPeer.videoTrack)||n.cleanup(),this.localPeer.videoTrack=void 0),this.store.cleanup(),this.listener=void 0,this.roleChangeManager&&this.eventBus.localRoleUpdate.unsubscribe(this.handleLocalRoleUpdate)}leave(e){return this.internalLeave(e)}internalLeave(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;return OC(this,null,(function*(){var n,i,r,s;let o=null==(n=this.store)?void 0:n.getRoom();if(o){for(;(this.sdkState.isPreviewInProgress||this.sdkState.isJoinInProgress)&&(null==t||!t.isTerminal);)yield oA(100);let n=o.id;this.setSessionPeerInfo(this.transport.getWebsocketEndpoint()||"",this.localPeer),null==(i=this.networkTestManager)||i.stop(),this.eventBus.leave.publish(t);let a=null==(r=this.localPeer)?void 0:r.peerId;nP.d(this.TAG,`\u23f3 Leaving room ${n}, peerId=${a}`),yield null==(s=this.transport)?void 0:s.leave(e,t?"sdk request":"user request"),this.cleanup(),nP.d(this.TAG,`\u2705 Left room ${n}, peerId=${a}`)}}))}getAuthTokenByRoomCode(e,t){return OC(this,null,(function*(){let n=(t||{}).endpoint||"https://auth.100ms.live/v2/token";this.analyticsTimer.start("GET_TOKEN");let i=yield jR(n,{method:"POST",body:JSON.stringify({code:e.roomCode,user_id:e.userId})},[429,500,501,502,503,504,505,506,507,508,509,510,511]),r=yield i.json();if(this.analyticsTimer.end("GET_TOKEN"),!i.ok)throw IP.APIErrors.ServerErrors(r.code,"GET_TOKEN",r.message,!1);let{token:s}=r;if(!s)throw Error(r.message);return s}))}getLocalPeer(){return this.store.getLocalPeer()}getPeers(){return this.store.getPeers()}getPeerMap(){return this.store.getPeerMap()}getAudioOutput(){return this.audioOutput}sendMessage(e,t){this.sendMessageInternal({message:t,type:e})}sendBroadcastMessage(e,t){return OC(this,null,(function*(){return yield this.sendMessageInternal({message:e,type:t})}))}sendGroupMessage(e,t,n){return OC(this,null,(function*(){let i=this.store.getKnownRoles();if(0===(t.filter((e=>i[e.name]))||[]).length)throw IP.GenericErrors.ValidationFailed("No valid role is present",t);return yield this.sendMessageInternal({message:e,recipientRoles:t,type:n})}))}sendDirectMessage(e,t,n){return OC(this,null,(function*(){var i,r;if((null==(i=this.localPeer)?void 0:i.peerId)===t)throw IP.GenericErrors.ValidationFailed("Cannot send message to self");let s=!(null==(r=this.store.getRoom())||!r.large_room_optimization),o=this.store.getPeerById(t);if(!o){if(!s)throw IP.GenericErrors.ValidationFailed("Invalid peer - peer not present in the room",t);{let e=yield this.transport.signal.getPeer({peer_id:t});if(!e)throw IP.GenericErrors.ValidationFailed("Invalid peer - peer not present in the room",t);o=F_(e,this.store)}}return yield this.sendMessageInternal({message:e,recipientPeer:o,type:n})}))}submitSessionFeedback(e,t){return OC(this,null,(function*(){if(!this.sessionPeerInfo)throw nP.e(this.TAG,"submitSessionFeedback> session is undefined"),new Error("session is undefined");let n=this.sessionPeerInfo.peer.token;if(!n)throw nP.e(this.TAG,"submitSessionFeedback> token is undefined"),new Error("Internal error, token is not present");try{yield ZR.sendFeedback({token:n,info:this.sessionPeerInfo,feedback:e,eventEndpoint:t}),nP.i(this.TAG,"submitSessionFeedback> submitted feedback"),this.sessionPeerInfo=void 0}catch(vP){throw nP.e(this.TAG,"submitSessionFeedback> error occured ",vP),new Error("Unable to submit feedback")}}))}getPeer(e){return OC(this,null,(function*(){let t=yield this.transport.signal.getPeer({peer_id:e});if(t)return F_(t,this.store)}))}findPeerByName(e){return OC(this,arguments,(function(e){var t=this;let{query:n,limit:i=10,offset:r}=e;return function*(){let{peers:e,offset:s,eof:o}=yield t.transport.signal.findPeerByName({query:null==n?void 0:n.toLowerCase(),limit:i,offset:r});return e.length>0?{offset:s,eof:o,peers:e.map((e=>F_({peer_id:e.peer_id,role:e.role,groups:[],info:{name:e.name,data:"",user_id:"",type:e.type}},t.store)))}:{offset:s,peers:[]}}()}))}sendMessageInternal(e){return OC(this,arguments,(function(e){var t=this;let{recipientRoles:n,recipientPeer:i,type:r="chat",message:s}=e;return function*(){if(""===s.replace(/\u200b/g," ").trim())throw nP.w(t.TAG,"sendMessage","Ignoring empty message send"),IP.GenericErrors.ValidationFailed("Empty message not allowed");let e={info:{message:s,type:r}};return null!=n&&n.length&&(e.roles=n.map((e=>e.name))),null!=i&&i.peerId&&(e.peer_id=i.peerId),nP.d(t.TAG,"Sending Message: ",e),yield t.transport.signal.broadcast(e)}()}))}startScreenShare(e,t){return OC(this,null,(function*(){var n,i,r;let s=this.store.getPublishParams();if(!s)return;let{allowed:o}=s;if(!o||!o.includes("screen"))return void nP.e(this.TAG,`Role ${null==(n=this.localPeer)?void 0:n.role} cannot share screen`);if(null!=(r=null==(i=this.localPeer)?void 0:i.auxiliaryTracks)&&r.find((e=>"screen"===e.source)))throw Error("Cannot share multiple screens");let a=yield this.getScreenshareTracks(e,t);if(!this.localPeer)return nP.d(this.TAG,"Screenshared when not connected"),void a.forEach((e=>{e.cleanup()}));this.transport.setOnScreenshareStop((()=>{this.stopEndedScreenshare(e)})),yield this.transport.publish(a),a.forEach((e=>{var t,n,i;e.peerId=null==(t=this.localPeer)?void 0:t.peerId,null==(n=this.localPeer)||n.auxiliaryTracks.push(e),null==(i=this.listener)||i.onTrackUpdate(0,e,this.localPeer)}))}))}stopEndedScreenshare(e){return OC(this,null,(function*(){nP.d(this.TAG,"\u2705 Screenshare ended natively"),yield this.stopScreenShare(),e()}))}stopScreenShare(){return OC(this,null,(function*(){var e;nP.d(this.TAG,"\u2705 Screenshare ended from app");let t=null==(e=this.localPeer)?void 0:e.auxiliaryTracks.filter((e=>"screen"===e.source));if(t)for(let n of t)yield this.removeTrack(n.trackId)}))}addTrack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regular";return OC(this,null,(function*(){var n,i,r,s;if(!e)return void nP.w(this.TAG,"Please pass a valid MediaStreamTrack");if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot addTrack");if(this.localPeer.auxiliaryTracks.find((t=>t.trackId===e.id)))return;let o=e.kind,a=new MediaStream([e]),l=new T_(a),c=new("audio"===o?PA:KA)(l,e,t,this.eventBus);yield this.applySettings(c),yield this.setPlaylistSettings({track:e,hmsTrack:c,source:t}),yield null==(n=this.transport)?void 0:n.publish([c]),c.peerId=null==(i=this.localPeer)?void 0:i.peerId,null==(r=this.localPeer)||r.auxiliaryTracks.push(c),null==(s=this.listener)||s.onTrackUpdate(0,c,this.localPeer)}))}removeTrack(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OC(this,null,(function*(){var n;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot removeTrack");let i=this.localPeer.auxiliaryTracks.findIndex((t=>t.trackId===e));if(i>-1){let e=this.localPeer.auxiliaryTracks[i];e.isPublished?yield this.transport.unpublish([e]):yield e.cleanup(),t||this.stopPlaylist(e),this.localPeer.auxiliaryTracks.splice(i,1),null==(n=this.listener)||n.onTrackUpdate(1,e,this.localPeer)}else nP.w(this.TAG,`No track found for ${e}`)}))}setAnalyticsLevel(e){this.analyticsEventsService.level=e}setLogLevel(e){nP.level=e}addAudioListener(e){var t;this.audioListener=e,null==(t=this.notificationManager)||t.setAudioListener(e)}addConnectionQualityListener(e){var t;null==(t=this.notificationManager)||t.setConnectionQualityListener(e)}setIsDiagnostics(e){this.isDiagnostics=e}changeRole(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return OC(this,null,(function*(){var i;yield null==(i=this.transport)?void 0:i.signal.requestRoleChange({requested_for:e,role:t,force:n})}))}changeRoleOfPeer(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return OC(this,null,(function*(){var i;yield null==(i=this.transport)?void 0:i.signal.requestRoleChange({requested_for:e,role:t,force:n})}))}changeRoleOfPeersWithRoles(e,t){return OC(this,null,(function*(){var n;e.length<=0||!t||(yield null==(n=this.transport)?void 0:n.signal.requestBulkRoleChange({roles:e.map((e=>e.name)),role:t,force:!0}))}))}acceptChangeRole(e){return OC(this,null,(function*(){var t,n;yield null==(n=this.transport)?void 0:n.signal.acceptRoleChangeRequest({requested_by:null==(t=e.requestedBy)?void 0:t.peerId,role:e.role.name,token:e.token})}))}endRoom(e,t){return OC(this,null,(function*(){var n;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot end room");yield null==(n=this.transport)?void 0:n.signal.endRoom(e,t),yield this.leave()}))}removePeer(e,t){return OC(this,null,(function*(){var n;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot remove peer");yield null==(n=this.transport)?void 0:n.signal.removePeer({requested_for:e,reason:t})}))}startRTMPOrRecording(e){return OC(this,null,(function*(){var t,n;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start streaming or recording");let i={meeting_url:e.meetingURL,record:e.record};null!=(t=e.rtmpURLs)&&t.length&&(i.rtmp_urls=e.rtmpURLs),e.resolution&&(i.resolution=e.resolution),yield null==(n=this.transport)?void 0:n.signal.startRTMPOrRecording(i)}))}stopRTMPAndRecording(){return OC(this,null,(function*(){var e;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop streaming or recording");yield null==(e=this.transport)?void 0:e.signal.stopRTMPAndRecording()}))}startHLSStreaming(e){return OC(this,null,(function*(){var t;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start HLS streaming");let n={};e&&e.variants&&e.variants.length>0&&(n.variants=e.variants.map((e=>{let t={meeting_url:e.meetingURL};return e.metadata&&(t.metadata=e.metadata),t}))),null!=e&&e.recording&&(n.hls_recording={single_file_per_layer:e.recording.singleFilePerLayer,hls_vod:e.recording.hlsVod}),yield null==(t=this.transport)?void 0:t.signal.startHLSStreaming(n)}))}stopHLSStreaming(e){return OC(this,null,(function*(){var t,n,i;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop HLS streaming");if(e){let i={variants:null==(t=null==e?void 0:e.variants)?void 0:t.map((e=>{let t={meeting_url:e.meetingURL};return e.metadata&&(t.metadata=e.metadata),t}))};yield null==(n=this.transport)?void 0:n.signal.stopHLSStreaming(i)}yield null==(i=this.transport)?void 0:i.signal.stopHLSStreaming()}))}startTranscription(e){return OC(this,null,(function*(){var t;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot start transcriptions");let n={mode:e.mode};yield null==(t=this.transport)?void 0:t.signal.startTranscription(n)}))}stopTranscription(e){return OC(this,null,(function*(){var t;if(!this.localPeer)throw IP.GenericErrors.NotConnected("VALIDATION","No local peer present, cannot stop transcriptions");if(!e)throw IP.GenericErrors.Signalling("VALIDATION","No mode is passed to stop the transcription");let n={mode:e.mode};yield null==(t=this.transport)?void 0:t.signal.stopTranscription(n)}))}sendHLSTimedMetadata(e){return OC(this,null,(function*(){var t;if(this.validateJoined("sendHLSTimedMetadata"),e.length>0){let n={metadata_objs:e};yield null==(t=this.transport)?void 0:t.signal.sendHLSTimedMetadata(n)}}))}changeName(e){return OC(this,null,(function*(){var t,n;this.validateJoined("changeName");let i=this.store.getLocalPeer();i&&i.name!==e&&(yield null==(t=this.transport)?void 0:t.signal.updatePeer({name:e}),null==(n=this.notificationManager)||n.updateLocalPeer({name:e}))}))}changeMetadata(e){return OC(this,null,(function*(){var t,n;this.validateJoined("changeMetadata"),yield null==(t=this.transport)?void 0:t.signal.updatePeer({data:e}),null==(n=this.notificationManager)||n.updateLocalPeer({metadata:e})}))}setSessionMetadata(e){return OC(this,null,(function*(){var t;yield null==(t=this.transport)?void 0:t.signal.setSessionMetadata({key:"default",data:e})}))}getSessionMetadata(){return OC(this,null,(function*(){var e;return(yield null==(e=this.transport)?void 0:e.signal.getSessionMetadata("default")).data}))}getRoles(){return Object.values(this.store.getKnownRoles())}changeTrackState(e,t){return OC(this,null,(function*(){var n;if("video"===e.type&&"regular"!==e.source)return void nP.w(this.TAG,"Muting non-regular video tracks is currently not supported");if(e.enabled===t)return void nP.w(this.TAG,`Aborting change track state, track already has enabled - ${t}`,e);if(!this.store.getTrackById(e.trackId))throw IP.GenericErrors.ValidationFailed("No track found for change track state",e);let i=this.store.getPeerByTrackId(e.trackId);if(!i)throw IP.GenericErrors.ValidationFailed("No peer found for change track state",e);yield null==(n=this.transport)?void 0:n.signal.requestTrackStateChange({requested_for:i.peerId,track_id:e.trackId,stream_id:e.stream.id,mute:!t})}))}changeMultiTrackState(e){return OC(this,null,(function*(){var t;if("boolean"!=typeof e.enabled)throw IP.GenericErrors.ValidationFailed("Pass a boolean for enabled");let{enabled:n,roles:i,type:r,source:s}=e;yield null==(t=this.transport)?void 0:t.signal.requestMultiTrackStateChange({value:!n,type:r,source:s,roles:null==i?void 0:i.map((e=>null==e?void 0:e.name))})}))}raiseLocalPeerHand(){return OC(this,null,(function*(){var e;this.validateJoined("raiseLocalPeerHand"),yield null==(e=this.transport)?void 0:e.signal.joinGroup(b_)}))}lowerLocalPeerHand(){return OC(this,null,(function*(){var e;this.validateJoined("lowerLocalPeerHand"),yield null==(e=this.transport)?void 0:e.signal.leaveGroup(b_)}))}raiseRemotePeerHand(e){return OC(this,null,(function*(){var t;yield null==(t=this.transport)?void 0:t.signal.addToGroup(e,b_)}))}lowerRemotePeerHand(e){return OC(this,null,(function*(){var t;yield null==(t=this.transport)?void 0:t.signal.removeFromGroup(e,b_)}))}setFrameworkInfo(e){this.frameworkInfo=RC(RC({},this.frameworkInfo),e)}attachVideo(e,t){return OC(this,null,(function*(){let n=this.store.getConfig();null!=n&&n.autoManageVideo?e.attach(t):yield e.addSink(t)}))}detachVideo(e,t){return OC(this,null,(function*(){let n=this.store.getConfig();null!=n&&n.autoManageVideo?e.detach(t):yield e.removeSink(t)}))}publish(e,t){return OC(this,null,(function*(){var n,i,r;if([this.store.getPublishParams(),!this.sdkState.published,!hP].every((e=>!!e))){let s=t&&t!==(null==(i=null==(n=this.localPeer)?void 0:n.role)?void 0:i.name)?()=>{var e;return null==(e=this.roleChangeManager)?void 0:e.diffRolesAndPublishTracks({oldRole:this.store.getPolicyForRole(t),newRole:this.localPeer.role})}:()=>this.getAndPublishTracks(e);yield null==(r=null==s?void 0:s())?void 0:r.catch((e=>{var t;nP.e(this.TAG,"Error in publish",e),null==(t=this.listener)||t.onError(e)}))}}))}getAndPublishTracks(e){return OC(this,null,(function*(){var t,n;let i=yield this.localTrackManager.getTracksToPublish(e);yield this.initDeviceManagers(),yield this.setAndPublishTracks(i),null==(n=null==(t=this.localPeer)?void 0:t.audioTrack)||n.initAudioLevelMonitor(),this.sdkState.published=!0}))}setAndPublishTracks(e){return OC(this,null,(function*(){var t,n;for(let i of e){if(yield this.transport.publish([i]),i.isTrackNotPublishing()){let e=IP.TracksErrors.NoDataInTrack(`${i.type} track has no data. muted: ${i.nativeTrack.muted}, readyState: ${i.nativeTrack.readyState}`);nP.e(this.TAG,e),this.sendAnalyticsEvent(FP.publish({devices:this.deviceManager.getDevices(),error:e})),null==(t=this.listener)||t.onError(e)}yield this.setLocalPeerTrack(i),null==(n=this.listener)||n.onTrackUpdate(0,i,this.localPeer)}}))}setLocalPeerTrack(e){return OC(this,null,(function*(){var t;switch(e.peerId=null==(t=this.localPeer)?void 0:t.peerId,e.type){case"audio":this.localPeer.audioTrack=e,yield this.deviceManager.autoSelectAudioOutput();break;case"video":this.localPeer.videoTrack=e}}))}initDeviceManagers(){return OC(this,null,(function*(){var e,t,n,i,r;this.sdkState.deviceManagersInitialised||(this.sdkState.deviceManagersInitialised=!0,yield this.deviceManager.init(),(yield this.deviceManager.updateOutputDevice(null==(t=null==(e=this.store.getConfig())?void 0:e.settings)?void 0:t.audioOutputDeviceId))||(yield this.deviceManager.updateOutputDevice(null==(i=null==(n=$P.getSelection())?void 0:n.audioOutput)?void 0:i.deviceId)),this.audioSinkManager.init(null==(r=this.store.getConfig())?void 0:r.audioSinkElementId))}))}cleanDeviceManagers(){this.eventBus.deviceChange.unsubscribe(this.handleDeviceChange),this.eventBus.audioPluginFailed.unsubscribe(this.handleAudioPluginError),this.eventBus.autoplayError.unsubscribe(this.handleAutoplayError),this.deviceManager.cleanup(),this.audioSinkManager.cleanup()}initPreviewTrackAudioLevelMonitor(){var e;let t=null==(e=this.localPeer)?void 0:e.audioTrack;null==t||t.initAudioLevelMonitor(),this.eventBus.trackAudioLevelUpdate.subscribe((e=>{var n;let i=e&&e.track.trackId===(null==t?void 0:t.trackId)?[{audioLevel:e.audioLevel,peer:this.localPeer,track:t}]:[];this.store.updateSpeakers(i),null==(n=this.audioListener)||n.onAudioLevelUpdate(i)})),this.eventBus.localAudioSilence.subscribe(this.sendAudioPresenceFailed)}notifyJoin(){var e;let t=this.store.getLocalPeer(),n=this.store.getRoom();if(n)return n.joinedAt=new Date,t&&(t.joinedAt=n.joinedAt),null!=t&&t.role?(this.analyticsTimer.end("join_time"),void(null==(e=this.listener)||e.onJoin(n))):new Promise(((e,t)=>{this.eventBus.policyChange.subscribeOnce((()=>{var t;this.analyticsTimer.end("join_time"),null==(t=this.listener)||t.onJoin(n),e()})),this.eventBus.leave.subscribeOnce((e=>{t(e)}))}));nP.w(this.TAG,"notify join - room not present")}setUpPreview(e,t){this.sdkState.isPreviewCalled=!0,this.sdkState.isPreviewInProgress=!0;let{roomId:n,userId:i,role:r}=tD(e.authToken);this.commonSetup(e,n,t),this.store.setConfig(e),this.store.createAndSetUserAgent(this.frameworkInfo),this.createAndAddLocalPeerToStore(e,r,i,e.asRole)}setPlaylistSettings(e){return OC(this,arguments,(function(e){var t=this;let{track:n,hmsTrack:i,source:r}=e;return function*(){var e,s;if("videoplaylist"===r){let r={};if("audio"===n.kind)r.maxBitrate=(null==(e=t.playlistSettings.audio)?void 0:e.bitrate)||64;else{r.maxBitrate=(null==(s=t.playlistSettings.video)?void 0:s.bitrate)||1e3;let{width:e,height:i}=n.getSettings();r.width=e,r.height=i}yield i.setSettings(r)}else"audioplaylist"===r&&(yield i.setSettings({maxBitrate:64}))}()}))}createAndAddLocalPeerToStore(e,t,n,i){let r=this.store.getPolicyForRole(t),s=i?this.store.getPolicyForRole(i):void 0,o=new M_({name:e.userName||"",customerUserId:n,metadata:e.metaData||"",role:r,asRole:s||r,type:"regular"});this.store.addPeer(o)}commonSetup(e,t,n){this.stringifyMetadata(e),e.initEndpoint||(e.initEndpoint="https://prod-init.100ms.live"),this.initStoreAndManagers(n),this.store.getRoom()||this.store.setRoom(new MR(t))}removeDevicesFromConfig(e){this.store.getConfig()&&e.settings&&(delete e.settings.audioOutputDeviceId,delete e.settings.videoDeviceId,delete e.settings.audioInputDeviceId)}getScreenshareTracks(e,t){return OC(this,null,(function*(){let n=this.transport.isFlagEnabled("scaleScreenshareBasedOnPixels"),[i,r]=yield this.localTrackManager.getLocalScreen(t,n),s=()=>{this.stopEndedScreenshare(e)},o=[];if(null!=t&&t.audioOnly){if(i.nativeTrack.stop(),!r)throw IP.TracksErrors.NothingToReturn("TRACK","Select share audio when sharing screen","No audio found");o.push(r),r.nativeTrack.addEventListener("ended",s)}else o.push(i),i.nativeTrack.addEventListener("ended",s),r&&o.push(r);return o}))}stopPlaylist(e){"audioplaylist"===e.source?this.playlistManager.stop("audio"):"videoplaylist"===e.source&&this.playlistManager.stop("video")}applySettings(e){return OC(this,null,(function*(){(e=>{if(!e.getPublishParams())throw IP.GenericErrors.NotConnected("VALIDATION","call addTrack after preview or join is successful")})(this.store);let t=this.store.getPublishParams();if(t)if(e instanceof KA){let n="regular"===e.source?"video":"screen"===e.source?"screen":"";if(!n||!t.allowed.includes(n))return;let i=t[n];if(!i)return;let r=(new wA).codec(i.codec).maxBitrate(i.bitRate).maxFramerate(i.frameRate).setWidth(i.width).setHeight(i.height).build();yield e.setSettings(r)}else if(e instanceof PA){if(!t.allowed.includes("audio"))return;let n=(new yA).codec(t.audio.codec).maxBitrate(t.audio.bitRate).build();yield e.setSettings(n)}}))}},rD=class e{constructor(t,n,i){this.getStats=()=>(this.stats||(this.stats=new cD(this.store,this.sdk)),this.stats),this.getDiagnosticsSDK=()=>(this.diagnostics||(this.diagnostics=this.actions.initDiagnostics()),this.diagnostics),this.store=t||e.createNewHMSStore(VR("HMSStore"),FC),this.notifications=i||new pR(this.store),n?this.actions=n:(this.sdk=new iD,this.actions=new UR(this.store,this.sdk,this.notifications)),this.actions.setFrameworkInfo({type:"js",sdkVersion:MC().version}),this.initialTriggerOnSubscribe=!1,dP&&(window.__hms=this)}triggerOnSubscribe(){this.initialTriggerOnSubscribe||(e.makeStoreTriggerOnSubscribe(this.store),this.initialTriggerOnSubscribe=!0)}getStore(){return this.store}getHMSActions(){return this.actions}getActions(){return this.actions}getNotifications(){return{onNotification:this.notifications.onNotification}}static createNewHMSStore(t,n){let i=mC((()=>n())),r=i.setState;i.setState=e=>{let t="function"==typeof e?pC(e):e;r(t)};let s=i.getState;i.getState=e=>e?e(s()):s(),e.compareWithShallowCheckInSubscribe(i);let o=e.setUpDevtools(i,t);return NC(RC({},i),{namedSetState:o})}static makeStoreTriggerOnSubscribe(e){let t=e.subscribe;e.subscribe=(n,i,r)=>(n(e.getState(i),void 0),t(n,i,r))}static compareWithShallowCheckInSubscribe(e){let t=e.subscribe;e.subscribe=(e,n,i)=>(n||(n=e=>e),t(e,n,i=i||fC))}static setUpDevtools(t,n){let i;try{i=window.__REDUX_DEVTOOLS_EXTENSION__||window.top.__REDUX_DEVTOOLS_EXTENSION__}catch(o){}if(!i)return e=>{t.setState(e)};let r=i.connect(e.devtoolsOptions(n));r.prefix=n?`${n} > `:"";let s=t.setState;return t.setState=e=>{s(e),r.send(`${r.prefix}setState`,t.getState())},r.subscribe(e.devtoolsSubscribe(r,t,s)),r.send("setUpStore",t.getState()),(e,n)=>{s(e);let i=n||`${r.prefix}action`;r.send(i,t.getState())}}static devtoolsOptions(e){return{name:e,actionsBlacklist:["audioLevel","playlistProgress","connectionQuality"]}}static devtoolsSubscribe(e,t,n){return i=>{var r,s,o,a;if("DISPATCH"===i.type&&i.state)["JUMP_TO_ACTION","JUMP_TO_STATE"].includes(i.payload.type)?n(JSON.parse(i.state)):t.setState(JSON.parse(i.state));else if("DISPATCH"===i.type&&"COMMIT"===(null==(r=i.payload)?void 0:r.type))e.init(t.getState());else if("DISPATCH"===i.type&&"IMPORT_STATE"===(null==(s=i.payload)?void 0:s.type)){let r=null==(o=i.payload.nextLiftedState)?void 0:o.actionsById;((null==(a=i.payload.nextLiftedState)?void 0:a.computedStates)||[]).forEach(((i,s)=>{let{state:o}=i,a=r[s]||`${e.prefix}setState`;0===s?e.init(o):(n(o),e.send(a,t.getState()))}))}}}},sD=(e,t,n)=>{var i,r;let s=oD(n,t);null==(i=e.getWebrtcInternals())||i.start();let o=null==(r=e.getWebrtcInternals())?void 0:r.onStatsChange((i=>aD(t,i,n,e)));return()=>{s(),o&&o()}},oD=(e,t)=>{let n,i,r;return e.getState(rx)?t.namedSetState((t=>{t.localPeer.id=e.getState(rx)}),"localpeer-id"):n=e.subscribe((e=>{e&&t.namedSetState((t=>{t.localPeer.id=e}),"localpeer-id")}),rx),e.getState(ox)?t.namedSetState((t=>{t.localPeer.videoTrack=e.getState(ox)}),"localpeer-videotrack-id"):i=e.subscribe((e=>{e&&t.namedSetState((t=>{t.localPeer.videoTrack=e}),"localpeer-videotrack-id")}),ox),e.getState(sx)?t.namedSetState((t=>{t.localPeer.audioTrack=e.getState(sx)}),"localpeer-audiotrack-id"):r=e.subscribe((e=>{e&&t.namedSetState((t=>{t.localPeer.audioTrack=e}),"localpeer-audiotrack-id")}),sx),()=>{null==n||n(),null==i||i(),null==r||r()}},aD=(e,t,n,i)=>{let r=n.getState(Y_);e.namedSetState((e=>{let s=n.getState(rx),o={},a=Object.keys(r).filter((e=>r[e].peerId!==s));for(let n of a){let e=t.getRemoteTrackStats(n);e&&(o[n]=e)}vR(e.remoteTrackStats,o);let l={[s]:t.getLocalPeerStats()};vR(e.peerStats,l),((e,t,n)=>{let i=n.reduce(((e,n)=>(e[n.firstTrackId]=Object.values(t[n.getTrackIDBeingSent()]||{}).sort(((e,t)=>e.rid&&t.rid?e.rid<t.rid?-1:1:0)),e)),{}),r=SR(Object.keys(e),Object.keys(i));for(let s of r)i[s]?e[s]=i[s]:delete e[s]})(e.localTrackStats,t.getLocalTrackStats(),i.store.getLocalPeerTracks())}),"webrtc-stats")},lD=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"resetState";e.namedSetState((e=>{Object.assign(e,{peerStats:{},remoteTrackStats:{},localTrackStats:{},localPeer:{id:""}})}),t)},cD=class{constructor(e,t){this.hmsStore=e,this.sdk=t,this.store=rD.createNewHMSStore(VR("HMSStatsStore"),UC),this.getState=this.store.getState,this.subscribe=this.store.subscribe,this.getPublishPeerConnection=()=>new Promise((e=>{var t,n;"Connected"===this.hmsStore.getState(gx)?e(null==(n=null==(t=this.sdk)?void 0:t.getWebrtcInternals())?void 0:n.getPublishPeerConnection()):this.hmsStore.subscribe((t=>{var n,i;"Connected"===t&&e(null==(i=null==(n=this.sdk)?void 0:n.getWebrtcInternals())?void 0:i.getPublishPeerConnection())}),gx)})),this.getSubscribePeerConnection=()=>new Promise((e=>{var t,n;"Connected"===this.hmsStore.getState(gx)?e(null==(n=null==(t=this.sdk)?void 0:t.getWebrtcInternals())?void 0:n.getSubscribePeerConnection()):this.hmsStore.subscribe((t=>{var n,i;"Connected"===t&&e(null==(i=null==(n=this.sdk)?void 0:n.getWebrtcInternals())?void 0:i.getSubscribePeerConnection())}),gx)})),this.sdk&&((e,t,n)=>{let i;"Connected"===n.getState(gx)&&(i=sD(e,t,n)),n.subscribe((r=>{["Connected","Reconnecting"].includes(r)?i||(i=sD(e,t,n)):["Disconnected","Failed"].includes(r)&&i&&(lD(t,r),i(),i=void 0)}),gx)})(this.sdk,this.store,this.hmsStore)}},uD=(e,t)=>t,dD=e=>e.peerStats,hD=e=>e.localTrackStats,pD=eE([dD,e=>e.localPeer.id],((e,t)=>e[t])),fD=(eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.packetsLost})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.jitter})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.publish)?void 0:t.bitrate})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.bitrate})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.publish)?void 0:t.availableOutgoingBitrate})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.availableIncomingBitrate})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.publish)?void 0:t.bytesSent})),eE(pD,(e=>{var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.bytesReceived})),eE([dD,(e,t)=>t],((e,t)=>t?e[t]:void 0))),mD=eE([e=>e.remoteTrackStats,uD],((e,t)=>t?e[t]:void 0)),gD=eE([hD,uD],((e,t)=>t?e[t]:void 0));Nx(fD),Nx(mD),eE([hD,e=>e.localPeer.audioTrack],((e,t)=>{var n;return t?null==(n=e[t])?void 0:n[0]:void 0})),Nx(eE(gD,(e=>null==e?void 0:e[0]))),eE([hD,e=>e.localPeer.videoTrack],((e,t)=>{var n;return t?null==(n=e[t])?void 0:n[0]:void 0})),Nx(eE(gD,(e=>e)));const vD=new rD,yD=vD.getStore(),bD=vD.getActions(),wD=e=>{let{isVisible:t,isMirrored:n=!0}=e;const i=(0,a.useRef)(null),[r,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),[d,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!1),m=async()=>{try{if(d)return void console.log("Not starting camera because user manually disabled it");if("denied"===(await navigator.permissions.query({name:"camera"})).state)throw new Error("Camera permission was denied. Please enable it in your browser settings.");r&&r.getTracks().forEach((e=>e.stop())),console.log("Starting direct camera preview");const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});if(i.current){i.current.srcObject=e,s(e),l(!0),u(""),window._directMediaStream=e;const t=e.getVideoTracks()[0];console.log("Camera accessed:",t.label),console.log("Camera settings:",t.getSettings())}}catch(e){console.error("Camera access failed:",e),u(`Camera error: ${e.message}. Please check your camera permissions.`),l(!1)}},g=async()=>{if(r){console.log("Stopping camera preview stream");try{p&&(console.log("Turning off HMS video because direct camera is being stopped"),await bD.setLocalVideoEnabled(!1),f(!1))}catch(e){console.error("Error disabling HMS video:",e)}r.getTracks().forEach((e=>e.stop())),s(null)}l(!1),h(!0)};(0,a.useEffect)((()=>{const e=yD.subscribe(ex,(async()=>{if(yD.getState(ex)&&o&&r&&!p)try{const e=r.getVideoTracks()[0];e&&(console.log("Connection detected, publishing preview camera"),await bD.replaceLocalVideoTrack(e),f(!0))}catch(e){console.error("Failed to publish camera after connection:",e)}}));return()=>e()}),[o,r,p]),(0,a.useEffect)((()=>(t&&!d?m():g(),()=>g())),[t,d]),(0,a.useEffect)((()=>{const e=yD.subscribe(ux,(()=>{const e=yD.getState(ux);!e&&o?(console.log("Stopping preview camera because HMS video was disabled"),g()):!e||o||d||(console.log("Starting preview camera because HMS video was enabled"),h(!1),m())}));return()=>e()}),[o,d]),(0,a.useEffect)((()=>{t&&(console.log("DirectCameraPreview is now visible, starting camera immediately"),m())}),[t]);return t?(0,gk.jsx)("div",{className:"direct-camera-preview",style:t?{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxWidth:"640px",height:"60%",maxHeight:"480px",backgroundColor:"#000",zIndex:1e3,borderRadius:"8px",boxShadow:"0 0 30px rgba(0, 0, 0, 0.5)",border:"2px solid #2196f3",overflow:"hidden"}:void 0,children:o?(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,gk.jsx)("div",{style:{position:"absolute",bottom:"10px",left:"10px",padding:"5px 10px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",borderRadius:"5px",fontSize:"14px"},children:"Direct Camera Preview (100ms SDK is having issues)"}),(0,gk.jsxs)("div",{style:{position:"absolute",top:"10px",right:"10px",padding:"5px 10px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",borderRadius:"5px",fontSize:"12px"},children:["Camera Active: ",o?"Yes":"No",(0,gk.jsx)("br",{}),"Track Published: ",p?"Yes":"No",(0,gk.jsx)("br",{}),"Camera Status: ",r?"Stream Active":"No Stream"]}),(0,gk.jsx)("button",{className:"camera-stop-btn",onClick:g,title:"Turn off camera",children:(0,gk.jsx)("i",{className:"fas fa-video-slash"})})]}):(0,gk.jsxs)("div",{className:"camera-error",children:[(0,gk.jsx)("i",{className:"fas fa-video-slash"}),(0,gk.jsx)("p",{children:c||(d?"Camera turned off":"Camera not available")}),(0,gk.jsx)("button",{onClick:()=>{h(!1),m()},children:d?"Turn On":"Retry"}),(0,gk.jsxs)("div",{style:{marginTop:"10px",fontSize:"12px",color:"#aaa"},children:[(0,gk.jsx)("p",{children:"Troubleshooting Tips:"}),(0,gk.jsxs)("ul",{style:{textAlign:"left",marginTop:"5px"},children:[(0,gk.jsx)("li",{children:"Ensure camera permissions are granted in browser settings"}),(0,gk.jsx)("li",{children:"Close other applications using your camera"}),(0,gk.jsx)("li",{children:"Try refreshing the page"}),(0,gk.jsx)("li",{children:"Check if camera is working in other applications"})]})]})]})}):null},kD=e=>{let{peer:t}=e;const n=(0,a.useRef)(null),i=(0,a.useRef)(null),[r,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(0),p=async()=>{if(!n.current||!t)return!1;try{return console.log(`Attaching video for peer ${t.id}`),t.videoTrack?(await bD.attachVideo(t.videoTrack,n.current),console.log(`Successfully attached video for peer ${t.id}`),s(!0),setTimeout((()=>{n.current&&!n.current.srcObject?(console.log(`Video not attached properly for peer ${t.id}, retrying...`),bD.attachVideo(t.videoTrack,n.current).catch((e=>console.error(`Retry attachment failed for peer ${t.id}:`,e)))):console.log(`Video confirmed active for peer ${t.id}`)}),1e3),!0):(console.log(`Peer ${t.id} has no video track available`),!1)}catch(e){return console.error(`Error attaching video for peer ${t.id}:`,e),!1}};return(0,a.useEffect)((()=>{(async()=>{try{!await p()&&d<3&&(console.log(`Scheduling retry for peer ${t.id}, attempt ${d+1}`),setTimeout((()=>{h((e=>e+1)),p()}),2e3))}catch(e){console.error(`Error in video attachment effect for peer ${null===t||void 0===t?void 0:t.id}:`,e)}})();const e=()=>{if(t)try{t.isLocal?l(yD.getState(ux)):l(yD.getState(Zx(t.id)))}catch(e){console.error(`Error getting video state for peer ${t.id}:`,e)}};e();const n=[];return t&&(t.isLocal?n.push(yD.subscribe(ux,(()=>{e()}))):(n.push(yD.subscribe(Zx(t.id),(()=>{e(),yD.getState(Zx(t.id))&&(console.log(`Remote peer ${t.id} video enabled, trying to attach`),setTimeout((()=>p()),1e3))}))),n.push(yD.subscribe(qx(t.id),(()=>{const e=yD.getState(qx(t.id));e&&e.videoTrack&&(console.log(`Peer ${t.id} video track updated, reattaching`),setTimeout((()=>p()),500))}))))),()=>{n.forEach((e=>e()))}}),[t,d]),(0,a.useEffect)((()=>{u(yD.getState(Xx(t.id)));const e=yD.subscribe(Xx(t.id),(()=>{u(yD.getState(Xx(t.id)))}));return()=>{e()}}),[t.id]),(0,a.useEffect)((()=>{if(n.current){const e=()=>{n.current&&n.current.paused&&n.current.play().catch((e=>{console.warn("Play on click failed:",e)}))};return n.current.addEventListener("click",e),()=>{n.current&&n.current.removeEventListener("click",e)}}}),[n.current]),(0,gk.jsxs)("div",{className:"peer-container",ref:i,children:[(0,gk.jsxs)("div",{className:"peer-video-container",children:[(0,gk.jsx)("video",{ref:n,className:"peer-video",autoPlay:!0,playsInline:!0,muted:t.isLocal}),(!o||!r)&&(0,gk.jsx)("div",{className:"video-off-indicator",children:(0,gk.jsx)("div",{className:"avatar",style:{backgroundColor:(()=>{const e=["#2196f3","#ff9800","#f44336","#4caf50","#9c27b0","#00bcd4"];return e[t.name?t.name.charCodeAt(0)%e.length:0]})()},children:t.name?t.name[0].toUpperCase():"?"})})]}),(0,gk.jsxs)("div",{className:"peer-info",children:[(0,gk.jsxs)("div",{className:"peer-details",children:[(0,gk.jsxs)("p",{className:"peer-name",children:[t.name||"Guest"," ",t.isLocal&&"(You)"]}),(0,gk.jsx)("span",{className:"peer-role",children:t.roleName?t.roleName.charAt(0).toUpperCase()+t.roleName.slice(1):t.isLocal?"You":"Guest"})]}),(0,gk.jsx)("div",{className:"peer-audio-indicator",children:(0,gk.jsx)("i",{className:"fas fa-"+(c?"microphone":"microphone-slash")})})]})]})},TD=e=>{let{appointment:t,onClose:n,role:i}=e;const[r,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(yD.getState(ex)),[d,h]=(0,a.useState)(yD.getState(cx)),[p,f]=(0,a.useState)(yD.getState(ux)),[m,g]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[k,T]=(0,a.useState)(null),[S,E]=(0,a.useState)(!1),[I,C]=(0,a.useState)(!1),[,P]=(yD.getState(rx),(0,a.useReducer)((e=>e+1),0)),[A,_]=(0,a.useState)(!1),x=window._forceDirectCamera||!c&&o||A;(0,a.useEffect)((()=>{(async()=>{try{console.log("Fetching token for room:",t.id);const e=new URL("http://localhost:5000/api/hms/get-hms-token");e.searchParams.append("roomName",t.id),e.searchParams.append("role","doctor"===i?"host":"guest"),console.log("Making request to:",e.toString());const n=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!n.ok){const e=await n.text();throw console.error("Token fetch failed:",{status:n.status,statusText:n.statusText,body:e}),new Error(`Failed to fetch token: ${n.status} ${n.statusText}`)}const r=await n.json();if(console.log("Token response:",{success:r.success,hasToken:!!r.token,roomId:r.roomId}),!r.success||!r.token)throw new Error("Invalid token response");console.log("Token fetched successfully"),s(r.token),l(null)}catch(o){console.error("Error fetching token:",o),l(`Failed to get video token: ${o.message}`),s(null)}})()}),[t.id,i]),(0,a.useEffect)((()=>{if(r){return(async()=>{try{if(!r)throw new Error("No token available");console.log("Initializing video...");if(!await R())return console.log("Falling back to direct camera mode due to permission issue"),window._forceDirectCamera=!0,void P();try{console.log("Joining HMS room with token:",r.substring(0,20)+"..."),await bD.join({userName:"doctor"===i?"Doctor":"Patient",authToken:r,settings:{isAudioMuted:!0,isVideoMuted:!1,initialVideoState:!0},rememberDeviceSelection:!0,captureNetworkQualityInPreview:!0}),console.log("Successfully joined video call"),l(""),u(!0),setTimeout((async()=>{try{await bD.setLocalVideoEnabled(!0)}catch(e){console.error("Error enabling video after join:",e)}}),1e3)}catch(e){throw console.error("HMS join error:",e),new Error(`Failed to join HMS room: ${e.message}`)}}catch(t){console.error("Error joining room:",t),l(t.message),u(!1),window._forceDirectCamera=!0,P()}})(),()=>{yD.getState(ex)&&(console.log("Leaving HMS room on cleanup"),bD.leave().catch((e=>{console.error("Error leaving room:",e)}))),window._directMediaStream&&(window._directMediaStream.getTracks().forEach((e=>e.stop())),delete window._directMediaStream)}}}),[r,t,i]);(0,a.useEffect)((()=>{c&&(async()=>{try{const e=(await bD.getDevices()).videoInput;console.log("Available video devices:",e),w(e),e.length>0&&!k&&T(e[0].deviceId)}catch(e){console.error("Error listing devices:",e)}})()}),[c,k]),(0,a.useEffect)((()=>{(async()=>{if(k&&c&&p)try{E(!0),console.log("Switching to camera:",k),await bD.setVideoSettings({deviceId:k}),console.log("Camera switched successfully")}catch(e){console.error("Error switching camera:",e)}finally{E(!1)}})()}),[k,c,p]),(0,a.useEffect)((()=>{console.log("Setting up HMS store subscriptions");const e=[yD.subscribe(ux,(()=>{const e=yD.getState(ux);console.log("Local video state changed:",e),f(e)})),yD.subscribe(ex,(()=>{const e=yD.getState(ex);console.log("Connection state changed:",e),u(e)})),yD.subscribe(tx,(()=>{const e=yD.getState(tx);console.log("Peers list changed:",e),g(e)})),yD.subscribe(cx,(()=>{const e=yD.getState(cx);console.log("Local audio state changed:",e),h(e)}))];return u(yD.getState(ex)),f(yD.getState(ux)),h(yD.getState(cx)),g(yD.getState(tx)),()=>{e.forEach((e=>e())),yD.getState(ex)&&bD.leave().catch(console.error)}}),[]),(0,a.useEffect)((()=>{if(!m.length)return void y([]);const e=m.find((e=>e.isLocal)),t=m.filter((e=>!e.isLocal)),n=e?[e,...t]:t;console.log("Updated peers list:",n.map((e=>({id:e.id,name:e.name,isLocal:e.isLocal,hasVideo:!!e.videoTrack})))),y(n)}),[m]),(0,a.useEffect)((()=>{if(!c||!p)return;const e=()=>{const e=m.find((e=>e.isLocal));console.log("Checking if HMS video is working...",{hasLocalPeer:!!e,hasVideoTrack:!!e&&!!e.videoTrack,videoEnabled:p}),!p||e&&e.videoTrack||(console.log("HMS video not working - switching to direct camera mode"),window._forceDirectCamera=!0,P()),m.length>0&&console.log("Current peers and video status:",m.map((e=>({id:e.id,name:e.name,isLocal:e.isLocal,role:e.roleName,hasVideoTrack:!!e.videoTrack,videoTrackId:e.videoTrack?e.videoTrack.id:null,videoEnabled:e.isLocal?yD.getState(ux):yD.getState(Zx(e.id))}))))};e();const t=setInterval(e,5e3);return()=>clearInterval(t)}),[c,p,m]);const R=async()=>{try{if("denied"===(await navigator.permissions.query({name:"camera"})).state)throw new Error("Camera permission was denied. Please enable it in your browser settings.");return(await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:24}},audio:!0})).getTracks().forEach((e=>e.stop())),!0}catch(e){return console.error("Camera permission error:",e),l(`Camera access error: ${e.message}. Please check your camera permissions and try again.`),!1}};return(0,gk.jsxs)("div",{className:"hms-meet-container",children:[(0,gk.jsxs)("div",{className:"hms-header",children:[(0,gk.jsx)("h2",{children:"Video Consultation"}),o&&(0,gk.jsx)("div",{className:"error-message",children:o}),(0,gk.jsxs)("div",{className:"header-controls",children:[(0,gk.jsx)("button",{onClick:()=>{console.log("Toggling camera debug mode"),_(!A)},className:"debug-btn",style:{background:"transparent",color:"#999",border:"1px solid #666",padding:"3px 8px",borderRadius:"4px",fontSize:"12px"},children:A?"Hide Direct Camera":"Try Direct Camera"}),(0,gk.jsx)("button",{onClick:n,className:"close-call-btn",style:{background:"rgba(220, 38, 38, 0.8)",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",fontSize:"14px",marginLeft:"10px",cursor:"pointer"},children:"End Call"})]})]}),x&&(0,gk.jsx)(wD,{isVisible:!0,isMirrored:!0}),!x&&(0,gk.jsx)("div",{className:"hms-video-container",children:c?(0,gk.jsx)("div",{className:"hms-video-grid",children:v.length>0?v.map((e=>(0,gk.jsx)(kD,{peer:e},e.id))):(0,gk.jsx)("div",{className:"empty-room-message",children:(0,gk.jsxs)("div",{className:"waiting-message",children:[(0,gk.jsx)("i",{className:"fas fa-users"}),(0,gk.jsx)("p",{children:"Waiting for others to join..."})]})})}):(0,gk.jsxs)("div",{className:"hms-connecting",children:[(0,gk.jsx)("div",{className:"connecting-spinner"}),(0,gk.jsx)("p",{children:"Connecting to video call..."}),(0,gk.jsx)("p",{className:"connecting-tip",children:"Once connected, you can turn on your camera and microphone."})]})}),(0,gk.jsxs)("div",{className:"hms-controls",children:[(0,gk.jsxs)("button",{className:"control-btn "+(d?"":"muted"),onClick:async()=>{try{await bD.setLocalAudioEnabled(!d)}catch(e){console.error("Error toggling audio:",e)}},children:[(0,gk.jsx)("i",{className:"fas fa-"+(d?"microphone":"microphone-slash")}),d?"Mute":"Unmute"]}),(0,gk.jsxs)("button",{className:"control-btn "+(p?"":"muted"),onClick:async()=>{try{p?(console.log("User explicitly disabled camera"),C(!0),await bD.setLocalVideoEnabled(!1)):(console.log("User explicitly enabled camera"),C(!1),await bD.setLocalVideoEnabled(!0),setTimeout((async()=>{try{const e=(await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})).getVideoTracks()[0];e&&(console.log("Replacing video track to ensure proper publishing"),await bD.replaceLocalVideoTrack(e))}catch(e){console.error("Error replacing video track:",e)}}),500))}catch(e){console.error("Error toggling video:",e)}},children:[(0,gk.jsx)("i",{className:"fas fa-"+(p?"video":"video-slash")}),p?"Stop Video":"Start Video"]}),(0,gk.jsxs)("button",{className:"control-btn",onClick:async()=>{try{console.log("Manual video refresh requested"),await bD.setLocalVideoEnabled(!1),await new Promise((e=>setTimeout(e,500)));const e=(await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})).getVideoTracks()[0];e&&(await bD.replaceLocalVideoTrack(e),await bD.setLocalVideoEnabled(!0),console.log("Video manually refreshed successfully"))}catch(e){console.error("Error refreshing video:",e)}},children:[(0,gk.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh Video"]}),b.length>1&&(0,gk.jsx)("div",{className:"camera-selector",children:(0,gk.jsx)("select",{value:k||"",onChange:e=>T(e.target.value),disabled:S||!p,children:b.map((e=>(0,gk.jsx)("option",{value:e.deviceId,children:e.label||`Camera ${e.deviceId.substr(0,5)}`},e.deviceId)))})}),(0,gk.jsxs)("button",{className:"control-btn",onClick:async()=>{try{console.log("Manual camera republish requested");const e=(await navigator.mediaDevices.getUserMedia({video:{width:640,height:480},audio:!1})).getVideoTracks()[0];e&&(await bD.setLocalVideoEnabled(!1),await new Promise((e=>setTimeout(e,500))),await bD.setVideoSettings({track:e}),await bD.setLocalVideoEnabled(!0),console.log("Video manually republished successfully"))}catch(e){console.error("Error republishing camera:",e)}},children:[(0,gk.jsx)("i",{className:"fas fa-sync"}),"Republish"]}),(0,gk.jsxs)("button",{className:"control-btn "+(window._forceDirectCamera?"muted":""),onClick:()=>{window._forceDirectCamera=!window._forceDirectCamera,P()},children:[(0,gk.jsx)("i",{className:"fas fa-webcam"}),window._forceDirectCamera?"HMS View":"Direct Camera"]}),(0,gk.jsxs)("button",{className:"control-btn end-call",onClick:async()=>{try{await bD.leave(),n()}catch(e){console.error("Error leaving room:",e),n()}},children:[(0,gk.jsx)("i",{className:"fas fa-phone-slash"}),"End Call"]})]})]})},SD=()=>{const[e,t]=(0,a.useState)(null),[n,i]=(0,a.useState)(null),[r,s]=(0,a.useState)("overview"),[o,l]=(0,a.useState)("upcoming"),[c,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(null),[p,f]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(!1),[b,w]=(0,a.useState)(null),[k,T]=(0,a.useState)({upcoming:[],previous:[]}),[S,E]=(0,a.useState)(null),[I,C]=(0,a.useState)(null),[P,A]=(0,a.useState)(null),[_,x]=(0,a.useState)(null),[R,N]=(0,a.useState)([]),[D,L]=(0,a.useState)(!1),[O,M]=(0,a.useState)(!1),[j,F]=(0,a.useState)(null),[U,V]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=th.onAuthStateChanged((async e=>{if(e){if(!e.emailVerified)return tt.error("Please verify your email before logging in"),await(0,ht.signOut)(th),t(null),void i(null);const n="admin@bionexa.com"===e.email;i(n?"admin":"user"),t(e)}else t(null),i(null)}));return()=>e()}),[]),(0,a.useEffect)((()=>{(async()=>{if(e)try{const t=await fetch("http://localhost:5000/api/appointments",{headers:{Authorization:`Bearer ${await e.getIdToken()}`}}),n=await t.json();if(t.ok){const e=new Date;e.setHours(0,0,0,0);const t=n.data.upcoming.concat(n.data.previous),i={upcoming:t.filter((t=>{const n=new Date(t.date);return n.setHours(0,0,0,0),n>=e&&("scheduled"===t.status||"pending"===t.status)&&"cancelled"!==t.status&&"completed"!==t.status})).sort(((e,t)=>new Date(e.date)-new Date(t.date))),previous:t.filter((t=>{const n=new Date(t.date);return n.setHours(0,0,0,0),n<e||"cancelled"===t.status||"completed"===t.status})).sort(((e,t)=>new Date(t.date)-new Date(e.date)))};T(i)}else console.error("Error fetching appointments:",n.message)}catch(S){console.error("Error fetching appointments:",S)}})()}),[e]);const B=()=>{h(null),f(""),g(""),w(null)},$=[{icon:Um,title:"Instant Messaging",description:"Real-time chat with your healthcare providers"},{icon:Mm,title:"Appointment Scheduling",description:"Book and manage your medical appointments easily"},{icon:Gm,title:"Digital Prescriptions",description:"Access and manage your prescriptions digitally for convenience"}];return(0,gk.jsxs)("div",{className:"dashboard",children:[(0,gk.jsx)(ct,{position:"top-right",autoClose:5e3}),(0,gk.jsxs)("aside",{className:"dashboard-sidebar",children:[(0,gk.jsxs)("div",{className:"user-profile",children:[(0,gk.jsx)(Nm,{icon:$m,className:"user-icon"}),(0,gk.jsxs)("h3",{children:["Welcome, ",(null===e||void 0===e?void 0:e.displayName)||"User","!"]})]}),(0,gk.jsxs)("nav",{className:"dashboard-nav",children:[(0,gk.jsxs)("button",{className:"nav-item "+("overview"===r?"active":""),onClick:()=>s("overview"),children:[(0,gk.jsx)(Nm,{icon:Wm}),(0,gk.jsx)("span",{children:"Overview"})]}),(0,gk.jsxs)("button",{className:"nav-item "+("appointments"===r?"active":""),onClick:()=>s("appointments"),children:[(0,gk.jsx)(Nm,{icon:Mm}),(0,gk.jsx)("span",{children:"Appointments"})]}),(0,gk.jsxs)("button",{className:"nav-item logout",onClick:async()=>{try{await(0,ht.signOut)(th)}catch(S){console.error("Error logging out:",S)}},children:[(0,gk.jsx)(Nm,{icon:Fm}),(0,gk.jsx)("span",{children:"Logout"})]})]})]}),(0,gk.jsx)("main",{className:"dashboard-main",children:"overview"===r?(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("header",{className:"dashboard-header",children:[(0,gk.jsx)("h1",{children:"BioNexa Healthcare Platform"}),(0,gk.jsx)("p",{children:"Your gateway to modern healthcare solutions"})]}),(0,gk.jsx)("section",{className:"features-grid",children:$.map(((e,t)=>(0,gk.jsxs)(XS.div,{className:"feature-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2*t},children:[(0,gk.jsx)(Nm,{icon:e.icon,className:"feature-icon"}),(0,gk.jsx)("h3",{children:e.title}),(0,gk.jsx)("p",{children:e.description})]},t)))})]}):(0,gk.jsx)("section",{className:"appointments-section",children:(0,gk.jsx)("div",{className:"appointments-container",children:c?(0,gk.jsxs)("div",{className:"booking-section",children:[(0,gk.jsxs)("div",{className:"booking-header",children:[(0,gk.jsx)("button",{className:"back-button",onClick:()=>{u(!1),h(null),f(""),g(""),w(null)},children:(0,gk.jsx)(Nm,{icon:qm})}),(0,gk.jsx)("h2",{children:"Book New Appointment"})]}),d?"specialization"===d?(0,gk.jsxs)("div",{className:"search-form",children:[(0,gk.jsxs)("div",{className:"search-header",children:[(0,gk.jsx)("button",{className:"back-button",onClick:B,children:(0,gk.jsx)(Nm,{icon:qm})}),(0,gk.jsx)("h3",{children:"Select Doctor's Specialization"})]}),(0,gk.jsx)("div",{className:"form-group",children:(0,gk.jsxs)("select",{className:"specialization-select",value:p,onChange:e=>f(e.target.value),children:[(0,gk.jsx)("option",{value:"",children:"Choose a specialization"}),["Cardiology","Dermatology","Endocrinology","ENT","Gastroenterology","Neurology","Oncology","Pediatrics","Psychiatry","Pulmonology","Urology"].map(((e,t)=>(0,gk.jsx)("option",{value:e,children:e},t)))]})}),(0,gk.jsxs)("button",{className:"search-button",onClick:async()=>{if(p){L(!0);try{const t=new URL(`http://localhost:5000/api/doctors/specialization/${p}`);P&&t.searchParams.append("date",P),console.log("Fetching doctors from:",t.toString());const n=await fetch(t,{headers:{Authorization:`Bearer ${await e.getIdToken()}`}});if(!n.ok)throw new Error("Failed to fetch doctors");const i=await n.json();console.log("Received doctors data:",i.data),i.data&&i.data.length>0&&i.data.forEach((e=>{var t;console.log(`Doctor ${e.name} availability:`,null===(t=e.availability)||void 0===t?void 0:t.filter((e=>e.isAvailable&&!e.isBooked&&e.currentBookings<(e.patientLimit||1))))})),N(i.data),h("doctors-list")}catch(S){console.error("Error fetching doctors:",S),tt.error("Failed to fetch doctors. Please try again.")}finally{L(!1)}}},disabled:!p,children:[(0,gk.jsx)(Nm,{icon:Jm}),"Search Doctors"]})]}):"doctors-list"===d?(0,gk.jsxs)("div",{className:"doctors-list-container",children:[(0,gk.jsxs)("div",{className:"doctors-list-header",children:[(0,gk.jsx)("button",{className:"back-button",onClick:B,children:(0,gk.jsx)(Nm,{icon:qm})}),(0,gk.jsx)("h3",{children:"Available Doctors"}),"admin"===n&&(0,gk.jsx)("button",{className:"delete-all-doctors-btn",onClick:async()=>{try{if(!(await fetch("http://localhost:5000/api/doctors/all",{method:"DELETE",headers:{Authorization:`Bearer ${await e.getIdToken()}`}})).ok)throw new Error("Failed to delete doctors");N([]),tt.success("All doctors have been deleted successfully")}catch(S){console.error("Error deleting doctors:",S),tt.error("Failed to delete doctors. Please try again.")}},children:"Delete All Doctors"})]}),D?(0,gk.jsxs)("div",{className:"loading",children:[(0,gk.jsx)(Nm,{icon:Xm,className:"fa-spin"}),"Loading doctors..."]}):(0,gk.jsx)("div",{className:"doctors-grid",children:R.length>0?R.map((t=>{var n,i;return(0,gk.jsx)("div",{className:"doctor-card",children:(0,gk.jsxs)("div",{className:"doctor-info",children:[(0,gk.jsxs)("div",{className:"doctor-header",children:[(0,gk.jsx)("h3",{className:"doctor-name",children:t.name}),(0,gk.jsxs)("div",{className:"doctor-rating",children:[(0,gk.jsx)(Nm,{icon:zm}),t.rating||"N/A"]})]}),(0,gk.jsxs)("div",{className:"doctor-details",children:[(0,gk.jsxs)("div",{className:"doctor-detail-item",children:[(0,gk.jsx)(Nm,{icon:og}),t.education||"Not specified"]}),(0,gk.jsxs)("div",{className:"doctor-detail-item",children:[(0,gk.jsx)(Nm,{icon:Zm}),t.experience||"Not specified"," experience"]}),(0,gk.jsxs)("div",{className:"doctor-detail-item",children:[(0,gk.jsx)(Nm,{icon:Vm}),t.patients||"Not specified"," patients treated"]})]}),(0,gk.jsx)("p",{className:"doctor-description",children:t.description||"No description available"}),(0,gk.jsxs)("div",{className:"available-dates",children:[(0,gk.jsx)("h4",{children:"Available Dates"}),(0,gk.jsx)("div",{className:"date-slots",children:null===(n=t.availability)||void 0===n?void 0:n.filter((e=>e.isAvailable&&!e.isBooked&&e.currentBookings<(e.patientLimit||1))).map((e=>e.date)).filter(((e,t,n)=>n.indexOf(e)===t)).map((e=>{const n=P===e&&U===t._id;return(0,gk.jsx)("button",{className:"date-slot "+(n?"selected":""),onClick:()=>((e,t)=>{A(e),V(t);const n=R.find((e=>e._id===t||e.id===t));if(n){console.log(`Doctor ${n.name} availability:`,n.availability);const t=n.availability?n.availability.filter((t=>t.date===e)):[];console.log(`Available slots for ${e}:`,t)}})(e,t._id),children:new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})},e)}))}),P&&U===t._id&&(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)("h4",{children:"Available Time Slots"}),(0,gk.jsx)("div",{className:"date-slots",children:null===(i=t.availability)||void 0===i?void 0:i.filter((e=>e.date===P&&e.isAvailable&&!e.isBooked&&e.currentBookings<(e.patientLimit||1))).map((e=>{const n=_===e.time&&U===t._id;return(0,gk.jsx)("button",{className:"date-slot "+(n?"selected":""),onClick:()=>((e,t)=>{x(e),V(t);const n=R.find((e=>e._id===t||e.id===t));if(n&&n.availability){const t=n.availability.find((t=>t.date===P&&t.time===e));console.log(`Selected slot ${e} on ${P} exists:`,!!t),t?console.log("Slot details:",t):console.log("Slot does not exist in doctor's availability")}})(e.time,t._id),children:e.time},e.time)}))})]})]}),(0,gk.jsx)("button",{className:"book-appointment",onClick:()=>{C(t),P&&_&&U===t._id?(async()=>{if(I)if(P)if(_)try{console.log("Selected Doctor:",I),console.log("Selected Doctor ID:",I._id||I.id),console.log("Selected Date:",P),console.log("Selected Time Slot:",_);const t=I.availability&&I.availability.some((e=>e.date===P&&e.time===_&&!0===e.isAvailable));console.log("Slot exists in doctor's availability:",t),t||console.log("Available slots for this doctor:",I.availability?I.availability.filter((e=>e.date===P)):"No availability data");const n=I.id||I._id;if(k.upcoming.find((e=>{const t=e.doctor._id||e.doctor.id,i=new Date(e.date).toISOString().split("T")[0];return t===n&&i===P&&e.time===_&&("scheduled"===e.status||"pending"===e.status)})))return void tt.error("You already have an appointment scheduled with this doctor at this time.");try{const t={doctorId:n,date:P,time:_};console.log("Checking for duplicate appointment with data:",t);const i=await fetch("http://localhost:5000/api/appointments/check-duplicate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await e.getIdToken()}`},body:JSON.stringify(t)});if(!i.ok){const e=await i.json();throw new Error(e.message||"Failed to check for duplicate appointments")}const r=await i.json();if(console.log("Duplicate check response:",r),r.isDuplicate)return void tt.error("You already have an appointment scheduled with this doctor at this time.")}catch(S){return console.error("Error checking for duplicate appointments:",S),void tt.error(S.message||"Error checking for duplicate appointments. Please try again.")}console.log("Selected Doctor:",I);const i={doctor:n,date:P,time:_,type:"consultation",symptoms:I.expertise||I.specialization};console.log("Appointment Data:",i);const r=await fetch("http://localhost:5000/api/appointments",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await e.getIdToken()}`},body:JSON.stringify(i)}),s=r.headers.get("content-type");if(!s||!s.includes("application/json"))throw console.error("Server returned non-JSON response:",await r.text()),new Error("Server error. Please try again later.");const o=await r.json();if(console.log("Response:",o),!r.ok)throw o.availableDoctors&&console.log("Available doctors:",o.availableDoctors),new Error(o.message||"Failed to book appointment");T((e=>({upcoming:[...e.upcoming||[],{...o.data,doctor:{name:I.name,specialization:I.expertise||I.specialization,experience:I.experience,rating:I.rating,image:I.image}}],previous:e.previous||[]}))),C(null),A(null),x(null),h(null),u(!1),tt.success("Appointment booked successfully!")}catch(S){console.error("Error booking appointment:",S),tt.error(S.message||"Failed to book appointment. Please try again.")}else tt.warning("Please select a time slot.");else tt.warning("Please select an appointment date.");else tt.warning("Please select a doctor first.")})():tt.warning("Please select a date and time slot first.")},disabled:!P||!_||U!==t._id,children:"Book Appointment"})]})},t._id)})):(0,gk.jsxs)("div",{className:"no-doctors-message",children:[(0,gk.jsx)(Nm,{icon:tg}),(0,gk.jsx)("h3",{children:"No Verified Doctors Available"}),(0,gk.jsxs)("p",{children:["There are currently no verified doctors available for ",p,". Please try another specialization or check back later."]})]})})]}):(0,gk.jsxs)("div",{className:"search-form",children:[(0,gk.jsxs)("div",{className:"search-header",children:[(0,gk.jsx)("button",{className:"back-button",onClick:B,children:(0,gk.jsx)(Nm,{icon:qm})}),(0,gk.jsx)("h3",{children:"Describe Your Symptoms"})]}),b?(0,gk.jsxs)("div",{className:"analysis-result",children:[(0,gk.jsxs)("div",{className:`urgency-banner ${b.urgency.toLowerCase()}`,children:[(0,gk.jsx)(Nm,{icon:tg}),(0,gk.jsxs)("span",{children:["Urgency Level: ",b.urgency]})]}),(0,gk.jsx)("h4",{children:"Based on your symptoms:"}),(0,gk.jsx)("p",{className:"symptoms-summary",children:b.symptoms}),(0,gk.jsx)("h4",{children:"Recommended Specializations:"}),(0,gk.jsx)("div",{className:"specialization-list",children:b.specializations.map(((e,t)=>(0,gk.jsx)("div",{className:"specialization-item",children:(0,gk.jsxs)("div",{className:"specialization-content",children:[(0,gk.jsx)(Nm,{icon:Lm}),(0,gk.jsx)("span",{className:"specialization-name",children:e}),(0,gk.jsx)("p",{className:"specialization-explanation",children:b.explanations[e]})]})},t)))}),(0,gk.jsx)("button",{className:"search-button",onClick:()=>w(null),children:"Try Again"})]}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)("div",{className:"form-group",children:(0,gk.jsx)("textarea",{className:"symptoms-textarea",placeholder:"Please describe your symptoms in detail (e.g., fever, headache, chest pain)...",value:m,onChange:e=>g(e.target.value),rows:6})}),S&&(0,gk.jsx)("div",{className:"error-message",children:S}),(0,gk.jsx)("button",{className:"search-button",onClick:async()=>{if(y(!0),E(null),!m.trim())return E("Please describe your symptoms before analyzing"),void y(!1);try{const e=await(async e=>{try{var t,n,i,r;if(!e||""===e.trim())throw new Error("Please provide symptoms to analyze");const a=`As a medical AI assistant, analyze the following symptoms and recommend appropriate medical specializations. \n    Symptoms: ${e}\n    \n    Please provide:\n    1. A list of relevant medical specializations (at least 1, maximum 3)\n    2. A brief explanation of why each specialization is recommended (2-3 sentences)\n    3. The urgency level (Low/Medium/High) based on symptom severity and duration\n    \n    Format the response as JSON with the following structure:\n    {\n      "specializations": ["specialization1", "specialization2"],\n      "explanations": {\n        "specialization1": "explanation1",\n        "specialization2": "explanation2"\n      },\n      "urgency": "Low/Medium/High"\n    }`,l=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=AIzaSyBL6D-PRgJ-YFCDobQKhbYGnfzZz6JE3hY",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}]})});if(!l.ok){var s;const e=await l.json();throw console.error("API Error:",e),new Error(`API Error: ${(null===(s=e.error)||void 0===s?void 0:s.message)||"Failed to analyze symptoms"}`)}const c=await l.json();if(console.log("API Response:",c),!c.candidates||null===(t=c.candidates[0])||void 0===t||null===(n=t.content)||void 0===n||null===(i=n.parts)||void 0===i||null===(r=i[0])||void 0===r||!r.text)throw new Error("Invalid response format from API");const u=c.candidates[0].content.parts[0].text;let d;console.log("AI Response Text:",u);try{const e=u.replace(/```json\n?|\n?```/g,"").trim();d=JSON.parse(e)}catch(o){throw console.error("Error parsing AI response:",o),console.error("Raw response:",u),new Error("Failed to parse AI response. Please try again.")}if(!d.specializations||!d.explanations||!d.urgency)throw console.error("Invalid response structure:",d),new Error("Invalid response format from AI service");return d}catch(S){if(console.error("Error in analyzeSymptoms:",S),S.message.includes("API key"))throw new Error("AI service configuration error. Please contact support.");throw S}})(m);w({specializations:e.specializations,explanations:e.explanations,urgency:e.urgency,symptoms:m})}catch(S){console.error("Error analyzing symptoms:",S),E(S.message||"Failed to analyze symptoms. Please try again.")}finally{y(!1)}},disabled:!m.trim()||v,children:v?(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)(Nm,{icon:Xm,className:"fa-spin"}),"Analyzing Symptoms..."]}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)(Nm,{icon:Jm}),"Analyze Symptoms"]})})]})]}):(0,gk.jsxs)("div",{className:"doctor-selection-cards",children:[(0,gk.jsxs)("div",{className:"selection-card",children:[(0,gk.jsx)(Nm,{icon:Lm,className:"selection-icon"}),(0,gk.jsx)("h3",{children:"Search by Specialization"}),(0,gk.jsx)("p",{children:"Find doctors based on their medical specialization and expertise"}),(0,gk.jsxs)("button",{className:"search-button",onClick:()=>h("specialization"),children:[(0,gk.jsx)(Nm,{icon:Jm}),"Search Doctors"]})]}),(0,gk.jsxs)("div",{className:"selection-card",children:[(0,gk.jsx)(Nm,{icon:Bm,className:"selection-icon"}),(0,gk.jsx)("h3",{children:"Search by Symptoms"}),(0,gk.jsx)("p",{children:"Describe your symptoms and let AI find the right specialist for you"}),(0,gk.jsxs)("button",{className:"search-button",onClick:()=>h("symptoms"),children:[(0,gk.jsx)(Nm,{icon:Jm}),"Search Doctors"]})]})]})]}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("div",{className:"appointments-header",children:[(0,gk.jsxs)("div",{className:"appointment-tabs",children:[(0,gk.jsx)("button",{className:"appointment-tab "+("upcoming"===o?"active":""),onClick:()=>l("upcoming"),children:"Upcoming Appointments"}),(0,gk.jsx)("button",{className:"appointment-tab "+("previous"===o?"active":""),onClick:()=>l("previous"),children:"Previous Appointments"})]}),(0,gk.jsxs)("button",{className:"book-appointment-btn",onClick:()=>{u(!0)},children:[(0,gk.jsx)(Nm,{icon:Ym}),"Book New Appointment"]})]}),(0,gk.jsx)("div",{className:"appointments-list",children:"upcoming"===o?k.upcoming&&k.upcoming.length>0?k.upcoming.map((t=>{var n,i;return(0,gk.jsxs)("div",{className:"appointment-card",children:[(0,gk.jsx)("div",{className:"appointment-doctor",children:(0,gk.jsxs)("div",{className:"doctor-info",children:[(0,gk.jsx)("h3",{children:(null===(n=t.doctor)||void 0===n?void 0:n.name)||"Doctor Name"}),(0,gk.jsx)("p",{className:"doctor-specialization",children:null===(i=t.doctor)||void 0===i?void 0:i.specialization})]})}),(0,gk.jsxs)("div",{className:"appointment-details",children:[(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:ng,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Date"}),(0,gk.jsx)("div",{className:"value",children:new Date(t.date).toLocaleDateString()})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Km,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Time"}),(0,gk.jsx)("div",{className:"value",children:t.time})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Lm,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Type"}),(0,gk.jsx)("div",{className:"value",children:t.type})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Bm,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Symptoms"}),(0,gk.jsx)("div",{className:"value",children:t.symptoms})]})]})]}),(0,gk.jsxs)("div",{className:"appointment-actions",children:[(0,gk.jsxs)("button",{className:"cancel-btn",onClick:()=>(async t=>{try{const n=await fetch(`http://localhost:5000/api/appointments/${t}/cancel`,{method:"PATCH",headers:{Authorization:`Bearer ${await e.getIdToken()}`,"Content-Type":"application/json"}}),i=await n.json();if(!n.ok)throw new Error(i.message||"Failed to cancel appointment");T((e=>{const n=e.upcoming.find((e=>e._id===t));return n?(n.status="cancelled",{upcoming:e.upcoming.filter((e=>e._id!==t)),previous:[n,...e.previous]}):e})),tt.success("Appointment cancelled successfully!")}catch(S){console.error("Error cancelling appointment:",S),tt.error(S.message||"Failed to cancel appointment. Please try again.")}})(t._id),children:[(0,gk.jsx)(Nm,{icon:rg}),"Cancel Appointment"]}),(t.date,t.time,"scheduled"===t.status&&(0,gk.jsxs)("button",{className:"join-video-btn",onClick:()=>{F(t),M(!0)},children:[(0,gk.jsx)(Nm,{icon:sg}),"Join Video Call"]}))]})]},t._id)})):(0,gk.jsx)("div",{className:"no-appointments",children:(0,gk.jsx)("p",{children:"No upcoming appointments"})}):k.previous&&k.previous.length>0?k.previous.map((e=>{var t,n;return(0,gk.jsxs)("div",{className:"appointment-card",children:[(0,gk.jsx)("div",{className:"appointment-doctor",children:(0,gk.jsxs)("div",{className:"doctor-info",children:[(0,gk.jsx)("h3",{children:(null===(t=e.doctor)||void 0===t?void 0:t.name)||"Doctor Name"}),(0,gk.jsx)("p",{className:"doctor-specialization",children:null===(n=e.doctor)||void 0===n?void 0:n.specialization})]})}),(0,gk.jsxs)("div",{className:"appointment-details",children:[(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:ng,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Date"}),(0,gk.jsx)("div",{className:"value",children:new Date(e.date).toLocaleDateString()})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Km,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Time"}),(0,gk.jsx)("div",{className:"value",children:e.time})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Lm,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Type"}),(0,gk.jsx)("div",{className:"value",children:e.type})]})]}),(0,gk.jsxs)("div",{className:"detail-item",children:[(0,gk.jsx)(Nm,{icon:Bm,className:"icon"}),(0,gk.jsxs)("div",{children:[(0,gk.jsx)("div",{className:"label",children:"Status"}),(0,gk.jsx)("div",{className:`appointment-status status-${e.status.toLowerCase()}`,children:e.status})]})]})]})]},e._id)})):(0,gk.jsx)("div",{className:"no-appointments",children:(0,gk.jsx)("p",{children:"No previous appointments"})})})]})})})}),O&&j&&(0,gk.jsx)(TD,{appointment:j,onClose:()=>{M(!1)},role:"patient"})]})};let ED={data:""},ID=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||ED,CD=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,PD=/\/\*[^]*?\*\/|  +/g,AD=/\n+/g,_D=(e,t)=>{let n="",i="",r="";for(let s in e){let o=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+o+";":i+="f"==s[1]?_D(o,s):s+"{"+_D(o,"k"==s[1]?"":t)+"}":"object"==typeof o?i+=_D(o,t?t.replace(/([^,])+/g,(e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,(t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)))):s):null!=o&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=_D.p?_D.p(s,o):s+":"+o+";")}return n+(t&&r?t+"{"+r+"}":r)+i},xD={},RD=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+RD(e[n]);return t}return e};function ND(e){let t=this||{},n=e.call?e(t.p):e;return((e,t,n,i,r)=>{let s=RD(e),o=xD[s]||(xD[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!xD[o]){let t=s!==e?e:(e=>{let t,n,i=[{}];for(;t=CD.exec(e.replace(PD,""));)t[4]?i.shift():t[3]?(n=t[3].replace(AD," ").trim(),i.unshift(i[0][n]=i[0][n]||{})):i[0][t[1]]=t[2].replace(AD," ").trim();return i[0]})(e);xD[o]=_D(r?{["@keyframes "+o]:t}:t,n?"":"."+o)}let a=n&&xD.g?xD.g:null;return n&&(xD.g=xD[o]),((e,t,n,i)=>{i?t.data=t.data.replace(i,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(xD[o],t,i,a),o})(n.unshift?n.raw?((e,t,n)=>e.reduce(((e,i,r)=>{let s=t[r];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":_D(e,""):!1===e?"":e}return e+i+(null==s?"":s)}),""))(n,[].slice.call(arguments,1),t.p):n.reduce(((e,n)=>Object.assign(e,n&&n.call?n(t.p):n)),{}):n,ID(t.target),t.g,t.o,t.k)}ND.bind({g:1});let DD,LD,OD,MD=ND.bind({k:1});function jD(e,t){let n=this||{};return function(){let i=arguments;function r(s,o){let a=Object.assign({},s),l=a.className||r.className;n.p=Object.assign({theme:LD&&LD()},a),n.o=/ *go\d+/.test(l),a.className=ND.apply(n,i)+(l?" "+l:""),t&&(a.ref=o);let c=e;return e[0]&&(c=a.as||e,delete a.as),OD&&c[0]&&OD(a),DD(c,a)}return t?t(r):r}}var FD=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,UD=(()=>{let e=0;return()=>(++e).toString()})(),VD=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),BD=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case 2:let{toast:n}=t;return BD(e,{type:e.toasts.find((e=>e.id===n.id))?1:0,toast:n});case 3:let{toastId:i}=t;return{...e,toasts:e.toasts.map((e=>e.id===i||void 0===i?{...e,dismissed:!0,visible:!1}:e))};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map((e=>({...e,pauseDuration:e.pauseDuration+r})))}}},$D=[],zD={toasts:[],pausedAt:void 0},GD=e=>{zD=BD(zD,e),$D.forEach((e=>{e(zD)}))},qD=e=>(t,n)=>{let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||UD()}}(t,e,n);return GD({type:2,toast:i}),i.id},HD=(e,t)=>qD("blank")(e,t);HD.error=qD("error"),HD.success=qD("success"),HD.loading=qD("loading"),HD.custom=qD("custom"),HD.dismiss=e=>{GD({type:3,toastId:e})},HD.remove=e=>GD({type:4,toastId:e}),HD.promise=(e,t,n)=>{let i=HD.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then((e=>{let r=t.success?FD(t.success,e):void 0;return r?HD.success(r,{id:i,...n,...null==n?void 0:n.success}):HD.dismiss(i),e})).catch((e=>{let r=t.error?FD(t.error,e):void 0;r?HD.error(r,{id:i,...n,...null==n?void 0:n.error}):HD.dismiss(i)})),e};new Map;var WD=MD`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,KD=MD`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,QD=MD`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,JD=jD("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${WD} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${KD} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${QD} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,YD=MD`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,XD=jD("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${YD} 1s linear infinite;
`,ZD=MD`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,eL=MD`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,tL=jD("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ZD} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${eL} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,nL=jD("div")`
  position: absolute;
`,iL=jD("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,rL=MD`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,sL=jD("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${rL} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,oL=e=>{let{toast:t}=e,{icon:n,type:i,iconTheme:r}=t;return void 0!==n?"string"==typeof n?a.createElement(sL,null,n):n:"blank"===i?null:a.createElement(iL,null,a.createElement(XD,{...r}),"loading"!==i&&a.createElement(nL,null,"error"===i?a.createElement(JD,{...r}):a.createElement(tL,{...r})))},aL=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,lL=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,cL=jD("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,uL=jD("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`;a.memo((e=>{let{toast:t,position:n,style:i,children:r}=e,s=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[i,r]=VD()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[aL(n),lL(n)];return{animation:t?`${MD(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${MD(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||n||"top-center",t.visible):{opacity:0},o=a.createElement(oL,{toast:t}),l=a.createElement(uL,{...t.ariaProps},FD(t.message,t));return a.createElement(cL,{className:t.className,style:{...s,...i,...t.style}},"function"==typeof r?r({icon:o,message:l}):a.createElement(a.Fragment,null,o,l))}));!function(e,t,n,i){_D.p=t,DD=e,LD=n,OD=i}(a.createElement);ND`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const dL=()=>{const[e,t]=(0,a.useState)(null),[n,i]=(0,a.useState)([]),[r,s]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[d,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1),[v,y]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[k,T]=(0,a.useState)(!1),S=(0,a.useRef)(null),E=(0,a.useRef)(null),[I,C]=(0,a.useState)({totalAppointments:0,completedAppointments:0,pendingAppointments:0}),[P,A]=(0,a.useState)(!1),[_,x]=(0,a.useState)(null),[R,N]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=e=>{S.current&&!S.current.contains(e.target)&&h(!1),E.current&&!E.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]),(0,a.useEffect)((()=>{(async()=>{try{u(!0);const e=th.currentUser;if(!e)return console.error("No user logged in"),void u(!1);const n=await e.getIdToken(!0),r=await fetch("http://localhost:5000/api/doctors/me",{headers:{Authorization:`Bearer ${n}`}});if(!r.ok){const e=await r.json();throw new Error(e.message||"Failed to fetch doctor data")}const s=await r.json();if(!s.success)throw new Error(s.message);t(s.data);const o=await fetch("http://localhost:5000/api/appointments",{headers:{Authorization:`Bearer ${n}`}});if(!o.ok)throw new Error("Failed to fetch appointments");const a=(await o.json()).data||[];i(a),D(a);const l={totalAppointments:a.length,completedAppointments:a.filter((e=>"completed"===e.status)).length,pendingAppointments:a.filter((e=>"pending"===e.status)).length};C(l);const c=(new Date).toISOString().split("T")[0],d=new Date;d.setDate(d.getDate()+7);const h=d.toISOString().split("T")[0],p=await fetch(`http://localhost:5000/api/doctors/availability?startDate=${c}&endDate=${h}`,{headers:{Authorization:`Bearer ${n}`}});if(!p.ok){const e=await p.json();throw new Error(e.message||"Failed to fetch availability")}const f=await p.json();let m=[];m=f.success&&f.data&&0!==f.data.length?f.data:L();const g=m.map((e=>{const t=e.date,n=e.time,i=a.filter((e=>{let i;if("string"===typeof e.date)i=e.date.split("T")[0];else if(e.date instanceof Date)i=e.date.toISOString().split("T")[0];else try{i=new Date(e.date).toISOString().split("T")[0]}catch(R){return console.error("Error parsing appointment date:",e.date,R),!1}const r=i===t,s=e.time===n,o=["scheduled","pending"].includes(e.status);return r&&s&&console.log(`Matching appointment found for slot ${t} ${n}: Status ${e.status}, Counted: ${o}`),r&&s&&o})).length;return i>0&&console.log(`Slot ${t} ${n} has ${i} bookings`),{...e,currentBookings:i,isBooked:i>=(e.patientLimit||1)}}));console.log("Updated slots with booking counts:",g),y(g),w(g),N(null)}catch(R){console.error("Error fetching data:",R),N(R.message)}finally{u(!1)}})()}),[]);const D=e=>{if(!Array.isArray(e)||0===e.length)return console.log("No appointments to filter"),s([]),void l([]);console.log(`Starting to filter ${e.length} appointments`);const t=new Date;t.setHours(0,0,0,0);const n=t.toISOString().split("T")[0];console.log("Today's date string:",n),e.forEach((e=>{console.log(`Appointment: ${e.id}, Date: ${e.date}, Status: ${e.status}, Patient: ${e.patientName}`)}));const i=e=>{if(!e)return null;try{return"string"===typeof e?e.split("T")[0]:e instanceof Date?e.toISOString().split("T")[0]:new Date(e).toISOString().split("T")[0]}catch(R){return console.error("Error parsing date:",e,R),null}},r=e.filter((e=>"cancelled"!==e.status));console.log(`Active appointments (non-cancelled): ${r.length}`);const o=r.filter((e=>{const t=i(e.date);if(!t)return!1;const r=t===n;return console.log(`Appointment: ${e.id}, date: ${t}, isToday: ${r}`),r})),a=r.filter((e=>{const t=i(e.date);if(!t)return!1;const r=t>n;return console.log(`Appointment: ${e.id}, date: ${t}, isUpcoming: ${r}`),r}));console.log(`Today's appointments: ${o.length}`),console.log(`Upcoming appointments: ${a.length}`),s(o),l(a)},L=()=>{const e=[],t=new Date,n=v||[];for(let i=0;i<7;i++){const r=new Date(t);r.setDate(t.getDate()+i);const s=r.toISOString().split("T")[0];for(let t=9;t<=17;t++){const i=`${t.toString().padStart(2,"0")}:00`,r=n.find((e=>e.date===s&&e.time===i));e.push({date:s,time:i,isAvailable:(null===r||void 0===r?void 0:r.isAvailable)||!1,isBooked:(null===r||void 0===r?void 0:r.isBooked)||!1,patientLimit:(null===r||void 0===r?void 0:r.patientLimit)||1,currentBookings:(null===r||void 0===r?void 0:r.currentBookings)||0})}}return e},O=async(e,t)=>{try{const r=th.currentUser;if(!r)return void console.error("No user logged in");const s=await r.getIdToken();console.log(`Updating appointment ${e} to status: ${t}`);const o=await fetch(`http://localhost:5000/api/appointments/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({status:t})}),a=await o.json();if(console.log("API response for status update:",a),!o.ok)throw new Error("Failed to update appointment status");if(a.success&&a.data){const r=n.map((t=>t.id===e?a.data:t));console.log("Updated appointments array:",r),i(r),D(r),C({totalAppointments:r.length,completedAppointments:r.filter((e=>"completed"===e.status)).length,pendingAppointments:r.filter((e=>"pending"===e.status||"scheduled"===e.status)).length});const o=a.data,l=v.map((e=>{if(e.date===o.date&&e.time===o.time){let n=e.currentBookings||0;return"cancelled"===t&&"cancelled"!==o.status?n=Math.max(0,n-1):"completed"!==t&&"cancelled"!==t||"pending"!==o.status&&"scheduled"!==o.status?"scheduled"===t&&"cancelled"===o.status&&(n+=1):n=Math.max(0,n-1),{...e,currentBookings:n,isBooked:n>=(e.patientLimit||1)}}return e}));y(l),w(l);(await fetch("http://localhost:5000/api/doctors/availability/bulk",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({slots:l})})).ok||console.error("Failed to update availability after appointment status change")}}catch(R){console.error("Error updating appointment:",R)}},M=()=>v?Object.entries(v).filter((e=>{let[t,n]=e;const i=n.currentBookings||0,r=n.patientLimit||1;return i>0&&(i>=r||i>=.8*r)})).map((e=>{let[t,n]=e;return{date:t,time:n.time,currentBookings:n.currentBookings||0,patientLimit:n.patientLimit||1}})).sort(((e,t)=>t.currentBookings-e.currentBookings)):[],j=e=>{x(e),A(!0)},F=()=>{var n,i;const[r,s]=(0,a.useState)((null===e||void 0===e?void 0:e.name)||""),[o,l]=(0,a.useState)((null===e||void 0===e||null===(n=e.contact)||void 0===n?void 0:n.phone)||""),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(null!==e&&void 0!==e&&e.profilePhotoUrl?`http://localhost:5000${e.profilePhotoUrl}`:""),[p,f]=(0,a.useState)((null===e||void 0===e||null===(i=e.contact)||void 0===i?void 0:i.phoneVerified)||!1),[m,v]=(0,a.useState)(""),[y,b]=(0,a.useState)(""),[w,k]=(0,a.useState)(!1),[T,S]=(0,a.useState)(""),[E,I]=(0,a.useState)(""),[C,P]=(0,a.useState)(!1),[A,_]=(0,a.useState)(!1);(0,a.useEffect)((()=>{var t,n;console.log("Doctor data changed in modal:",e),s((null===e||void 0===e?void 0:e.name)||""),l((null===e||void 0===e||null===(t=e.contact)||void 0===t?void 0:t.phone)||""),h(null!==e&&void 0!==e&&e.profilePhotoUrl?`http://localhost:5000${e.profilePhotoUrl}`:""),f((null===e||void 0===e||null===(n=e.contact)||void 0===n?void 0:n.phoneVerified)||!1)}),[e]);return(0,gk.jsx)("div",{className:"profile-settings-modal",children:(0,gk.jsxs)("div",{className:"profile-settings-content",children:[(0,gk.jsxs)("div",{className:"profile-settings-header",children:[(0,gk.jsx)("h2",{children:"Profile Settings"}),(0,gk.jsx)("button",{className:"close-button",onClick:()=>g(!1),children:(0,gk.jsx)("i",{className:"fas fa-times"})})]}),(0,gk.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{let n=(null===e||void 0===e?void 0:e.profilePhotoUrl)||"";if(c){const e=new FormData;e.append("photo",c);const t=await fetch("http://localhost:5000/api/doctors/upload-photo",{method:"POST",headers:{Authorization:`Bearer ${await th.currentUser.getIdToken()}`},body:e});if(!t.ok)throw new Error("Failed to upload photo");const i=await t.json();console.log("Photo upload response:",i),n=i.photoUrl}const i={name:r,mobileNumber:o,profilePhotoUrl:n,contact:{phone:o,phoneVerified:p}};console.log("Submitting profile update with data:",i),await(async n=>{try{const i=th.currentUser;if(!i)return void console.error("No current user found");console.log("Updating profile with data:",n);const r=await i.getIdToken(!0);console.log("Got ID token, making request to update profile");const s=await fetch("http://localhost:5000/api/doctors/update-profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(n)});if(console.log("Response status:",s.status),console.log("Response headers:",s.headers),!s.ok){const e=await s.json().catch((()=>null));throw console.error("Error response data:",e),new Error(`Failed to update profile: ${s.status} ${s.statusText}`)}const o=await s.json();console.log("Success response data:",o),console.log("Previous doctor state:",e),o.success&&(t((e=>{const t={...e,...o.data};return console.log("Updated doctor state:",t),t})),HD.success("Profile updated successfully"),g(!1))}catch(R){console.error("Error updating profile:",R),HD.error(`Failed to update profile: ${R.message}`)}})(i)}catch(R){console.error("Error in profile update:",R),HD.error("Failed to update profile: "+R.message)}},className:"profile-settings-form",children:[(0,gk.jsxs)("div",{className:"profile-photo-section",children:[(0,gk.jsx)("div",{className:"profile-photo-container",children:d?(0,gk.jsx)("img",{src:d,alt:"Profile",className:"profile-photo-preview",onError:e=>{console.error("Error loading profile photo:",e),e.target.onerror=null,e.target.src="",e.target.parentElement.innerHTML='<div class="profile-photo-placeholder"><i class="fas fa-user"></i></div>'}}):(0,gk.jsx)("div",{className:"profile-photo-placeholder",children:(0,gk.jsx)("i",{className:"fas fa-user"})})}),(0,gk.jsxs)("div",{className:"profile-photo-upload",children:[(0,gk.jsxs)("label",{htmlFor:"profile-photo",className:"upload-button",children:[(0,gk.jsx)("i",{className:"fas fa-camera"}),"Change Photo"]}),(0,gk.jsx)("input",{id:"profile-photo",type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&(u(t),h(URL.createObjectURL(t)))},style:{display:"none"}})]})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,gk.jsx)("input",{type:"text",id:"name",value:r,onChange:e=>s(e.target.value),placeholder:"Enter your full name"})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"mobile",children:"Mobile Number"}),(0,gk.jsxs)("div",{className:"phone-input-group",children:[(0,gk.jsx)("input",{type:"tel",id:"mobile",value:o,onChange:e=>l(e.target.value),placeholder:"Enter your mobile number",disabled:p}),!p&&(0,gk.jsx)("button",{type:"button",onClick:async()=>{try{if(!o)return void HD.error("Please enter a phone number first");let e=o.replace(/\D/g,"");if(e=e.startsWith("91")?"+"+e:e.startsWith("0")?"+91"+e.substring(1):"+91"+e,!/^\+91\d{10}$/.test(e))return void HD.error("Please enter a valid 10-digit Indian phone number");if((()=>{try{window.recaptchaVerifier&&window.recaptchaVerifier.clear(),window.recaptchaVerifier=new ht.RecaptchaVerifier(th,"recaptcha-container",{size:"invisible",callback:()=>{console.log("reCAPTCHA verified")},"expired-callback":()=>{console.log("reCAPTCHA expired"),window.recaptchaVerifier.clear(),HD.error("Verification expired. Please try again.")}}),window.recaptchaVerifier.render().then((function(e){window.recaptchaWidgetId=e}))}catch(R){console.error("Error setting up reCAPTCHA:",R),HD.error("Failed to initialize verification. Please try again.")}})(),!window.recaptchaVerifier)throw new Error("reCAPTCHA not initialized");const t=window.recaptchaVerifier,n=await(0,ht.signInWithPhoneNumber)(th,e,t);v(n),k(!0),HD.success("OTP sent successfully!")}catch(R){console.error("Error sending OTP:",R),"auth/invalid-phone-number"===R.code?HD.error("Please enter a valid 10-digit Indian phone number"):HD.error(R.message||"Failed to send OTP")}},className:"verify-button",children:"Verify Phone"}),p&&(0,gk.jsxs)("span",{className:"verified-badge",children:[(0,gk.jsx)("i",{className:"fas fa-check"})," Verified"]})]}),(0,gk.jsx)("div",{id:"recaptcha-container",style:{marginTop:"10px"}})]}),w&&(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"otp",children:"Enter OTP"}),(0,gk.jsxs)("div",{className:"otp-input-group",children:[(0,gk.jsx)("input",{type:"text",id:"otp",value:y,onChange:e=>b(e.target.value),placeholder:"Enter OTP",maxLength:6}),(0,gk.jsx)("button",{type:"button",onClick:async()=>{try{if((await m.confirm(y)).user){f(!0),k(!1),HD.success("Phone number verified successfully!");const t=await th.currentUser.getIdToken(!0);await fetch("http://localhost:5000/api/doctors/update-profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({name:r,mobileNumber:o,profilePhotoUrl:(null===e||void 0===e?void 0:e.profilePhotoUrl)||"",contact:{phone:o,phoneVerified:!0}})})}}catch(R){console.error("Error verifying OTP:",R),HD.error("Invalid OTP. Please try again.")}},className:"verify-button",children:"Verify OTP"})]})]}),(0,gk.jsxs)("div",{className:"form-actions",children:[(0,gk.jsx)("button",{type:"submit",className:"save-button",children:"Save Changes"}),(0,gk.jsx)("button",{type:"button",className:"cancel-button",onClick:()=>g(!1),children:"Cancel"})]})]}),(0,gk.jsxs)("div",{className:"password-change-section",children:[(0,gk.jsxs)("h3",{children:[(0,gk.jsx)("i",{className:"fas fa-lock"})," Change Password"]}),A?(0,gk.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p)if(T===E)if(T.length<6)HD.error("Password should be at least 6 characters long");else{P(!0);try{await(0,ht.updatePassword)(th.currentUser,T),HD.success("Password updated successfully!"),S(""),I(""),_(!1)}catch(R){console.error("Error changing password:",R),HD.error(R.message||"Failed to change password")}finally{P(!1)}}else HD.error("Passwords do not match");else HD.error("Please verify your phone number first")},className:"password-form",children:[(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,gk.jsx)("input",{type:"password",id:"newPassword",value:T,onChange:e=>S(e.target.value),placeholder:"Enter new password",disabled:!p})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,gk.jsx)("input",{type:"password",id:"confirmPassword",value:E,onChange:e=>I(e.target.value),placeholder:"Confirm new password",disabled:!p})]}),(0,gk.jsxs)("div",{className:"form-actions",children:[(0,gk.jsx)("button",{type:"submit",className:"save-button",disabled:!p||C,children:C?(0,gk.jsx)("i",{className:"fas fa-spinner fa-spin"}):"Change Password"}),(0,gk.jsx)("button",{type:"button",className:"cancel-button",onClick:()=>_(!1),children:"Cancel"})]})]}):(0,gk.jsx)("button",{type:"button",className:"change-password-button",onClick:()=>_(!0),disabled:!p,children:"Change Password"}),!p&&(0,gk.jsx)("p",{className:"verification-notice",children:"Please verify your phone number to change password"})]})]})})};return c?(0,gk.jsx)("div",{className:"loading",children:"Loading..."}):(console.log("Current appointments data:",n),console.log("Today's appointments:",r),console.log("Upcoming appointments:",o),(0,gk.jsxs)("div",{className:"doctor-dashboard",children:[(0,gk.jsxs)("div",{className:"dashboard-header",children:[(0,gk.jsxs)("div",{className:"doctor-info",children:[(0,gk.jsx)("div",{className:"doctor-photo",children:null!==e&&void 0!==e&&e.profilePhotoUrl?(0,gk.jsx)("img",{src:`http://localhost:5000${e.profilePhotoUrl}`,alt:"Doctor's profile",className:"profile-photo",onError:e=>{console.error("Error loading profile photo:",e),e.target.onerror=null,e.target.src="",e.target.parentElement.innerHTML='<div class="profile-photo-placeholder"><i class="fas fa-user"></i></div>'}}):(0,gk.jsx)("div",{className:"profile-photo-placeholder",children:(0,gk.jsx)("i",{className:"fas fa-user"})})}),(0,gk.jsxs)("div",{className:"doctor-details",children:[(0,gk.jsx)("h1",{children:(null===e||void 0===e?void 0:e.name)||"Doctor Name"}),(0,gk.jsx)("p",{children:(null===e||void 0===e?void 0:e.specialization)||"Specialization"})]})]}),(0,gk.jsxs)("div",{className:"quick-actions",children:[(0,gk.jsx)("h2",{children:"Quick Actions"}),(0,gk.jsxs)("div",{className:"action-buttons",children:[(0,gk.jsxs)("button",{className:"action-button",onClick:()=>f(!0),children:[(0,gk.jsx)("i",{className:"fas fa-calendar-alt"}),"Set Availability"]}),(0,gk.jsxs)("button",{className:"action-button",children:[(0,gk.jsx)("i",{className:"fas fa-calendar-plus"}),"New Appointment"]}),(0,gk.jsxs)("button",{className:"action-button",children:[(0,gk.jsx)("i",{className:"fas fa-user-plus"}),"Add Patient"]}),(0,gk.jsxs)("button",{className:"action-button",children:[(0,gk.jsx)("i",{className:"fas fa-file-medical"}),"Write Prescription"]})]})]}),(0,gk.jsxs)("div",{className:"settings-container",ref:S,children:[(0,gk.jsx)("div",{className:"settings-icon",onClick:()=>h(!d),children:(0,gk.jsx)("i",{className:"fas fa-cog"})}),(0,gk.jsxs)("div",{className:"settings-dropdown "+(d?"active":""),children:[(0,gk.jsxs)("div",{className:"settings-dropdown-item",onClick:()=>{g(!0),h(!1)},children:[(0,gk.jsx)("i",{className:"fas fa-user"}),"Profile Settings"]}),(0,gk.jsxs)("div",{className:"settings-dropdown-item",children:[(0,gk.jsx)("i",{className:"fas fa-bell"}),"Notification Settings"]}),(0,gk.jsxs)("div",{className:"settings-dropdown-item",children:[(0,gk.jsx)("i",{className:"fas fa-shield-alt"}),"Security"]}),(0,gk.jsxs)("div",{className:"settings-dropdown-item logout",onClick:async()=>{try{await(0,ht.signOut)(th)}catch(R){console.error("Error signing out:",R)}},children:[(0,gk.jsx)("i",{className:"fas fa-sign-out-alt"}),"Logout"]})]})]})]}),p&&(0,gk.jsx)("div",{className:"availability-modal",ref:E,children:(0,gk.jsxs)("div",{className:"availability-content",children:[(0,gk.jsxs)("div",{className:"availability-header",children:[(0,gk.jsx)("h2",{children:"Set Your Availability"}),(0,gk.jsxs)("div",{className:"availability-actions",children:[(0,gk.jsx)("button",{className:"select-all-btn",onClick:()=>{const e=(0===b.length?L():b).map((e=>({...e,isAvailable:!0})));w(e)},children:"Select All"}),(0,gk.jsx)("button",{className:"deselect-all-btn",onClick:()=>{const e=(0===b.length?L():b).map((e=>({...e,isAvailable:!1})));w(e)},children:"Deselect All"}),(0,gk.jsx)("button",{className:"save-button",onClick:async()=>{try{T(!0);const e=th.currentUser;if(!e)return void console.error("No user logged in");console.log("Current user:",e.uid);const t=b.map((e=>{const t=v.find((t=>t.date===e.date&&t.time===e.time)),n=t?t.currentBookings||0:e.currentBookings||0;return{...e,currentBookings:n}}));console.log("Temp availability data with preserved bookings:",JSON.stringify(t,null,2));const n=await e.getIdToken();console.log("Got auth token");const i=await fetch("http://localhost:5000/api/doctors/availability/bulk",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({slots:t})});console.log("Response status:",i.status);const r=await i.text();if(console.log("Response text:",r),!i.ok)throw new Error(`Failed to update availability: ${r}`);const s=JSON.parse(r);if(!s.success)throw new Error(s.message);y(t),w(t),alert("Availability updated successfully!"),f(!1)}catch(R){console.error("Error saving availability:",R),alert("Failed to save availability. Please try again.")}finally{T(!1)}},disabled:k,children:k?"Saving...":"Save Changes"}),(0,gk.jsx)("button",{className:"close-button",onClick:()=>{w(v),f(!1)},children:"Cancel"})]})]}),(0,gk.jsx)("div",{className:"availability-calendar",children:(()=>{const e=()=>b&&0!==b.length?b:(console.log("Using generated time slots for display"),L()),t=e().reduce(((e,t)=>(e[t.date]||(e[t.date]=[]),e[t.date].push(t),e)),{});return Object.entries(t).map((t=>{let[n,i]=t;return(0,gk.jsxs)("div",{className:"date-section",children:[(0,gk.jsxs)("div",{className:"date-header",children:[(0,gk.jsx)("h3",{children:new Date(n).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,gk.jsxs)("div",{className:"date-actions",children:[(0,gk.jsx)("button",{className:"select-date-btn",onClick:()=>{const t=b.map((e=>e.date===n?{...e,isAvailable:!0}:e)),i=e().filter((e=>e.date===n));i.forEach((e=>{const n=t.some((t=>t.date===e.date&&t.time===e.time));n||t.push({...e,isAvailable:!0})})),w(t)},children:"Select All"}),(0,gk.jsx)("button",{className:"deselect-date-btn",onClick:()=>{const t=b.map((e=>e.date===n?{...e,isAvailable:!1}:e)),i=e().filter((e=>e.date===n));i.forEach((e=>{const n=t.some((t=>t.date===e.date&&t.time===e.time));n||t.push({...e,isAvailable:!1})})),w(t)},children:"Deselect All"})]})]}),(0,gk.jsx)("div",{className:"time-slots-grid",children:i.map((e=>(0,gk.jsxs)("div",{className:`time-slot ${e.isAvailable?"available":""} ${e.isBooked?"booked":""}`,onClick:()=>!e.isBooked&&((e,t)=>{try{const n=b.find((n=>n.date===e&&n.time===t));if(!n){console.log("Slot not found in tempAvailability, adding it now");const n={date:e,time:t,isAvailable:!0,isBooked:!1,patientLimit:1,currentBookings:0},i=[...b,n];return void w(i)}if(n.isBooked)return void alert("Cannot modify availability for booked slots");const i=b.map((n=>n.date===e&&n.time===t?{...n,isAvailable:!n.isAvailable}:n));w(i)}catch(R){console.error("Error toggling availability:",R)}})(e.date,e.time),title:e.isBooked?"This slot is already booked":"",children:[(0,gk.jsx)("div",{className:"time",children:e.time}),(0,gk.jsx)("div",{className:"status-indicator",children:e.isBooked?"Booked":e.isAvailable?"Available":"Unavailable"}),e.isAvailable&&(0,gk.jsxs)("div",{className:"patient-limit-control",onClick:e=>e.stopPropagation(),children:[(0,gk.jsx)("label",{htmlFor:`patient-limit-${e.date}-${e.time}`,children:"Patients per slot:"}),(0,gk.jsx)("select",{id:`patient-limit-${e.date}-${e.time}`,value:e.patientLimit||1,onChange:t=>((e,t,n)=>{try{const i=parseInt(n);if(isNaN(i)||i<=0)return void HD.error("Patient limit must be a positive number");if(i>10)return void HD.error("Maximum patient limit is 10 per slot");const r=b.map((n=>n.date===e&&n.time===t?{...n,patientLimit:i}:n));w(r),HD.success(`Patient limit set to ${i} for ${t} on ${e}`)}catch(R){console.error("Error updating patient limit:",R),HD.error("Failed to update patient limit")}})(e.date,e.time,t.target.value),className:"patient-limit-select",children:[1,2,3,4,5,6,7,8,9,10].map((e=>(0,gk.jsx)("option",{value:e,children:e},e)))}),(0,gk.jsxs)("div",{className:"booking-info",children:[e.currentBookings||0,"/",e.patientLimit||1," booked"]})]})]},`${e.date}-${e.time}`)))})]},n)}))})()})]})}),(0,gk.jsxs)("div",{className:"dashboard-stats",children:[(0,gk.jsxs)("div",{className:"stat-card",children:[(0,gk.jsx)("h3",{children:"Total Appointments"}),(0,gk.jsx)("div",{className:"value",children:I.totalAppointments})]}),(0,gk.jsxs)("div",{className:"stat-card",children:[(0,gk.jsx)("h3",{children:"Completed"}),(0,gk.jsx)("div",{className:"value",children:I.completedAppointments})]}),(0,gk.jsxs)("div",{className:"stat-card",children:[(0,gk.jsx)("h3",{children:"Pending"}),(0,gk.jsx)("div",{className:"value",children:I.pendingAppointments})]})]}),(0,gk.jsxs)("div",{className:"dashboard-section",children:[(0,gk.jsx)("h3",{children:"Near Capacity Slots"}),M().length>0?(0,gk.jsx)("div",{className:"near-capacity-slots",children:M().map(((e,t)=>(0,gk.jsxs)("div",{className:"slot-card "+(e.currentBookings>=e.patientLimit?"fully-booked":"nearly-full"),children:[(0,gk.jsx)("div",{className:"slot-date",children:new Date(e.date).toLocaleDateString()}),(0,gk.jsx)("div",{className:"slot-time",children:e.time}),(0,gk.jsxs)("div",{className:"slot-bookings",children:[e.currentBookings,"/",e.patientLimit," patients"]})]},t)))}):(0,gk.jsx)("p",{className:"no-data",children:"No slots near capacity"})]}),(0,gk.jsxs)("div",{className:"dashboard-content",children:[(0,gk.jsxs)("div",{className:"appointments-section",children:[(0,gk.jsx)("div",{className:"section-header",children:(0,gk.jsx)("h2",{children:"Today's Appointments"})}),(0,gk.jsx)("div",{className:"appointments-list",children:Array.isArray(r)&&0!==r.length?r.map((e=>(console.log("Rendering appointment:",e),(0,gk.jsxs)("div",{className:"appointment-card",children:[(0,gk.jsxs)("div",{className:"appointment-info",children:[(0,gk.jsx)("h4",{children:e.patientName}),(0,gk.jsx)("div",{className:`appointment-status ${e.status}`,children:e.status}),(0,gk.jsxs)("p",{children:[(0,gk.jsx)("strong",{children:"Time:"})," ",e.time]}),e.patientEmail&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-envelope"})," ",e.patientEmail]}),e.patientPhone&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-phone"})," ",e.patientPhone]}),e.appointmentReason&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-sticky-note"})," ",e.appointmentReason]})]}),(0,gk.jsxs)("div",{className:"appointment-actions",children:["scheduled"===e.status&&(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)("button",{className:"btn btn-primary",onClick:()=>O(e.id,"completed"),children:"Complete"}),(0,gk.jsx)("button",{className:"btn btn-secondary",onClick:()=>O(e.id,"cancelled"),children:"Cancel"}),(e.date,e.time,(0,gk.jsxs)("button",{className:"btn btn-video",onClick:()=>j(e),children:[(0,gk.jsx)("i",{className:"fas fa-video"}),"Join Video Call"]}))]}),"completed"===e.status&&(0,gk.jsx)("div",{className:"completed-text",children:"\u2713 Completed"}),"cancelled"===e.status&&(0,gk.jsx)("div",{className:"cancelled-text",children:"\u2717 Cancelled"})]})]},e.id)))):(0,gk.jsx)("p",{children:"No appointments scheduled for today"})}),(0,gk.jsx)("div",{className:"section-header upcoming-header",children:(0,gk.jsx)("h2",{children:"Upcoming Appointments"})}),(0,gk.jsx)("div",{className:"appointments-list",children:Array.isArray(o)&&0!==o.length?o.map((e=>(0,gk.jsxs)("div",{className:"appointment-card",children:[(0,gk.jsxs)("div",{className:"appointment-info",children:[(0,gk.jsx)("h4",{children:e.patientName}),(0,gk.jsx)("div",{className:`appointment-status ${e.status}`,children:e.status}),(0,gk.jsxs)("p",{children:[(0,gk.jsx)("strong",{children:"Date:"})," ",new Date(e.date).toLocaleDateString()," at ",e.time]}),e.patientEmail&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-envelope"})," ",e.patientEmail]}),e.patientPhone&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-phone"})," ",e.patientPhone]}),e.appointmentReason&&(0,gk.jsxs)("p",{className:"patient-detail",children:[(0,gk.jsx)("i",{className:"fas fa-sticky-note"})," ",e.appointmentReason]})]}),(0,gk.jsxs)("div",{className:"appointment-actions",children:["scheduled"===e.status&&(0,gk.jsx)("button",{className:"btn btn-secondary",onClick:()=>O(e.id,"cancelled"),children:"Cancel"}),"completed"===e.status&&(0,gk.jsx)("div",{className:"completed-text",children:"\u2713 Completed"}),"cancelled"===e.status&&(0,gk.jsx)("div",{className:"cancelled-text",children:"\u2717 Cancelled"}),(e.date,e.time,"scheduled"===e.status&&(0,gk.jsxs)("button",{className:"btn btn-video",onClick:()=>j(e),children:[(0,gk.jsx)("i",{className:"fas fa-video"}),"Join Video Call"]}))]})]},e.id))):(0,gk.jsx)("p",{children:"No upcoming appointments scheduled"})})]}),(0,gk.jsx)("div",{className:"sidebar-section",children:(0,gk.jsxs)("div",{className:"notifications",children:[(0,gk.jsx)("h2",{children:"Notifications"}),(0,gk.jsxs)("div",{className:"notification-item",children:[(0,gk.jsx)("div",{className:"notification-icon",children:(0,gk.jsx)("i",{className:"fas fa-bell"})}),(0,gk.jsxs)("div",{className:"notification-content",children:[(0,gk.jsx)("h4",{children:"New Appointment Request"}),(0,gk.jsx)("p",{children:"John Doe requested an appointment for tomorrow"})]})]}),(0,gk.jsxs)("div",{className:"notification-item",children:[(0,gk.jsx)("div",{className:"notification-icon",children:(0,gk.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,gk.jsxs)("div",{className:"notification-content",children:[(0,gk.jsx)("h4",{children:"System Update"}),(0,gk.jsx)("p",{children:"New features available in your dashboard"})]})]}),(0,gk.jsxs)("div",{className:"notification-item",children:[(0,gk.jsx)("div",{className:"notification-icon",children:(0,gk.jsx)("i",{className:"fas fa-calendar-check"})}),(0,gk.jsxs)("div",{className:"notification-content",children:[(0,gk.jsx)("h4",{children:"Appointment Reminder"}),(0,gk.jsx)("p",{children:"You have 3 appointments scheduled for today"})]})]})]})})]}),m&&(0,gk.jsx)(F,{}),P&&_&&(0,gk.jsx)(TD,{appointment:_,onClose:()=>{A(!1),x(null)},role:"doctor"})]}))};const hL=function(){const e=oe(),[t,i]=(0,a.useState)(!1),[r,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)({email:"",password:"",name:""}),[d,h]=(0,a.useState)(!1),[p,f]=(0,a.useState)({name:"",email:"",password:"",confirmPassword:"",specialization:"",expertise:"",experience:"",education:"",patients:"",description:"",availableDates:[],availableSlots:[]}),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)({name:"",email:"",password:"",confirmPassword:""}),[b,w]=(0,a.useState)(!1),[k,T]=(0,a.useState)({email:"",doctorId:"",password:""}),[S,E]=(0,a.useState)(null),[I,C]=(0,a.useState)(null),[P,A]=(0,a.useState)(navigator.onLine);(0,a.useEffect)((()=>{const e=()=>{A(!0),tt.success("You are back online")},t=()=>{A(!1),tt.error("You are offline. Some features may be unavailable.")};return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}),[]),(0,a.useEffect)((()=>{const e=th.onAuthStateChanged((async e=>{if(e){C(e),console.log("Auth state changed, user detected:",e.email),console.log("Email verification status:",e.emailVerified),await e.reload(),console.log("After reload, email verification status:",e.emailVerified);try{const n=await fetch(`http://localhost:5000/api/doctors/check-uid/${e.uid}`),i=await n.json();if(i.exists){if(console.log("Doctor found in database:",i.doctor),!e.emailVerified)return console.log("Doctor email not verified in Firebase, signing out"),tt.error("Please verify your email before logging in. Check your inbox for a verification link."),await(0,ht.signOut)(th),C(null),void E(null);if(console.log("Firebase indicates email is verified for doctor"),!i.doctor.isVerified){console.log("Syncing verification status to backend");try{(await fetch("http://localhost:5000/api/doctors/verify-by-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})})).ok?console.log("Successfully verified doctor in backend"):console.error("Failed to verify doctor in backend")}catch(t){console.error("Error verifying doctor in backend:",t)}}E("doctor"),l(!0)}else{if(!e.emailVerified)return tt.error("Please verify your email before logging in"),await(0,ht.signOut)(th),C(null),void E(null);E("user"),l(!0)}}catch(m){console.error("Error checking if user is a doctor:",m);try{const t=await fetch("http://localhost:5000/api/doctors/find/"+e.email),n=await t.json();if(n.found)return console.log("Doctor found by email, reload user to get updated email verification status"),await e.reload(),e.emailVerified?(console.log("Email verified, allowing login and updating doctor UID"),await fetch(`http://localhost:5000/api/doctors/${n.doctor._id}/update-uid`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:e.uid})}),E("doctor"),void l(!0)):(console.log("Email not verified after reload"),tt.error("Please verify your email before logging in"),await(0,ht.signOut)(th),C(null),void E(null))}catch(n){console.error("Error checking doctor by email:",n)}if(!e.emailVerified)return tt.error("Please verify your email before logging in"),await(0,ht.signOut)(th),C(null),void E(null);l(!0)}}else C(null),E(null),l(!1)}));return()=>e()}),[]),(0,a.useEffect)((()=>{const e=new URLSearchParams(window.location.search),t=e.get("verifyEmail"),r=e.get("mode"),s=e.get("oobCode");if("true"===t||"verifyEmail"===r&&s)if(console.log("Email verification redirect detected"),tt.info("Verifying your email...",{autoClose:!1,toastId:"verifying-email"}),s)Promise.resolve().then(n.bind(n,786)).then((e=>{let{applyActionCode:t}=e;t(th,s).then((()=>{tt.dismiss("verifying-email"),tt.success("Email verified successfully. You can now log in.");const e=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,e),i(!0)})).catch((e=>{tt.dismiss("verifying-email"),console.error("Error verifying email:",e),"auth/invalid-action-code"===e.code?tt.error("The verification link has expired or is invalid. Please request a new one."):"auth/user-not-found"===e.code?tt.error("User not found. The account may have been deleted."):tt.error("Failed to verify email. Please try again or request a new verification link.");const t=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,t)}))}));else{tt.dismiss("verifying-email"),tt.info("Please check your email for a verification link.");const e=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,e)}}),[]);const _=e=>{const{name:t,value:n}=e.target;u((e=>({...e,[t]:n})))},x=async()=>{try{await(0,ht.signOut)(th),C(null),E(null),tt.success("Logged out successfully")}catch(m){console.error("Error logging out:",m),tt.error("Error logging out")}};return(0,gk.jsxs)(Se,{children:[(0,gk.jsx)(ke,{path:"/dashboard",element:o?"doctor"===S?(0,gk.jsx)(dL,{user:I,onLogout:x}):(0,gk.jsx)(SD,{}):(0,gk.jsx)(we,{to:"/"})}),(0,gk.jsx)(ke,{path:"/",element:(0,gk.jsxs)("div",{className:"App",children:[!P&&(0,gk.jsx)("div",{className:"offline-indicator",children:"You are currently offline. Some features may be unavailable."}),o?(0,gk.jsx)(gk.Fragment,{children:"doctor"===S?(0,gk.jsx)(dL,{user:I,onLogout:x}):(0,gk.jsx)(SD,{user:I,onLogout:x})}):(0,gk.jsxs)("div",{className:"landing-page",children:[(0,gk.jsxs)("nav",{className:"navbar",children:[(0,gk.jsxs)("div",{className:"logo",children:[(0,gk.jsx)("img",{src:ut,alt:"BioNexa Logo"}),(0,gk.jsx)("h1",{children:"BioNexa"})]}),(0,gk.jsx)("div",{className:"nav-buttons",children:I?(0,gk.jsx)(gk.Fragment,{children:(0,gk.jsx)("button",{className:"btn btn-login",onClick:x,children:"Logout"})}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsx)("button",{className:"btn btn-login",onClick:()=>i(!0),children:"Login"}),(0,gk.jsx)("button",{className:"btn btn-signup",onClick:()=>s(!0),children:"Sign Up"})]})})]}),!I&&(0,gk.jsx)("main",{className:"hero",children:(0,gk.jsxs)("div",{className:"hero-content",children:[(0,gk.jsx)("h1",{className:"hero-title",children:"Welcome to BioNexa"}),(0,gk.jsx)("p",{className:"hero-subtitle",children:"Connecting Biology with Technology for a Better Future"}),(0,gk.jsx)("button",{className:"btn btn-signup",onClick:()=>s(!0),children:"Get Started"})]})}),t&&(0,gk.jsx)("div",{className:"modal-overlay",children:(0,gk.jsxs)("div",{className:"auth-modal",children:[(0,gk.jsx)("button",{className:"close-btn",onClick:()=>{i(!1),w(!1),u({email:"",password:"",name:""}),T({email:"",doctorId:"",password:""})},children:"\xd7"}),(0,gk.jsx)("h2",{children:b?"Doctor Login":"User Login"}),(0,gk.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{if(b){console.log("Doctor login attempt:",k);try{console.log("Attempting Firebase login first to check email verification status");const e=await(0,ht.signInWithEmailAndPassword)(th,k.email,k.password);if(await e.user.reload(),!e.user.emailVerified)return console.log("Email not verified in Firebase"),tt.error("Please verify your email before logging in. Check your inbox for a verification link."),await(0,ht.sendEmailVerification)(e.user),void await(0,ht.signOut)(th);{console.log("Email is verified in Firebase, ensuring backend is in sync");const e=await fetch(`http://localhost:5000/api/doctors/find/${k.email}`),t=await e.json();if(!t.found)return console.log("Doctor not found in backend database"),tt.error("Doctor account not found in our records"),void await(0,ht.signOut)(th);if(console.log("Doctor found in database:",t.doctor),!t.doctor.isVerified){console.log("Doctor not verified in backend, attempting to verify...");(await fetch("http://localhost:5000/api/doctors/verify-by-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:k.email})})).ok?console.log("Successfully verified doctor in backend"):console.log("Could not auto-verify doctor in backend")}}}catch(n){return console.error("Error in pre-verification check:",n),"auth/wrong-password"===n.code?void tt.error("Invalid password. Please try again."):"auth/user-not-found"===n.code?void tt.error("No account found with this email."):void tt.error(n.message||"Error authenticating. Please try again.")}try{if(!navigator.onLine)return void tt.error("You appear to be offline. Please check your internet connection and try again.");const t=await fetch("http://localhost:5000/api/doctors/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:k.email,password:k.password,doctorId:k.doctorId})});let n;console.log("Backend response status:",t.status);const r=t.headers.get("content-type");if(!r||!r.includes("application/json")){const e=await t.text();throw console.error("Received non-JSON response:",e),new Error("Server returned invalid response format")}if(n=await t.json(),console.log("Backend response data:",n),!t.ok){if(403===t.status)return tt.error("Please verify your email before logging in"),void await(0,ht.signOut)(th);throw new Error(n.message||"Invalid doctor credentials")}console.log("Backend login successful");const s=th.currentUser;if(!s)return console.error("No authenticated user found after backend verification"),void tt.error("Authentication error. Please try again.");E("doctor"),C(s),l(!0),tt.success("Doctor logged in successfully!"),i(!1),w(!1),e("/dashboard")}catch(m){return console.error("Error verifying doctor credentials:",m),void tt.error(m.message||"Error verifying doctor credentials. Please try again.")}}else{if(!navigator.onLine)return void tt.error("You appear to be offline. Please check your internet connection and try again.");const t=await(0,ht.signInWithEmailAndPassword)(th,c.email,c.password);if(!t.user.emailVerified)return void tt.error("Please verify your email before logging in");E("user"),C(t.user),l(!0),tt.success("Logged in successfully!"),i(!1),e("/dashboard")}}catch(m){console.error("Login error:",m),"auth/network-request-failed"===m.code?tt.error("Network error: Please check your internet connection and try again."):tt.error(m.message)}},className:"auth-form",children:[b?(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"doctorEmail",children:"Email"}),(0,gk.jsx)("input",{type:"email",id:"doctorEmail",value:k.email,onChange:e=>T({...k,email:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"doctorId",children:"Doctor ID"}),(0,gk.jsx)("input",{type:"text",id:"doctorId",value:k.doctorId,onChange:e=>T({...k,doctorId:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"doctorPassword",children:"Password"}),(0,gk.jsx)("input",{type:"password",id:"doctorPassword",value:k.password,onChange:e=>T({...k,password:e.target.value}),required:!0})]})]}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"email",children:"Email"}),(0,gk.jsx)("input",{type:"email",id:"email",name:"email",value:c.email,onChange:_,required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"password",children:"Password"}),(0,gk.jsx)("input",{type:"password",id:"password",name:"password",value:c.password,onChange:_,required:!0})]})]}),(0,gk.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gk.jsx)("button",{type:"button",onClick:()=>{w(!b),u({email:"",password:"",name:""}),T({email:"",doctorId:"",password:""})},className:"text-sm text-blue-600 hover:text-blue-800",children:b?"Login as User":"Login as Doctor"}),(0,gk.jsx)("button",{type:"submit",className:"submit-button",children:b?"Login as Doctor":"Login"})]}),(0,gk.jsx)("div",{className:"mt-4 text-center",children:(0,gk.jsx)("button",{type:"button",onClick:e=>{e.preventDefault();const t=b?k.email:c.email;t?(0,ht.signInWithEmailAndPassword)(th,t,b?k.password:c.password).then((()=>{(async()=>{if(!th.currentUser)return tt.error("You must be logged in to request a verification email"),void i(!0);try{const e={url:window.location.origin+"/?verifyEmail=true",handleCodeInApp:!0};await(0,ht.sendEmailVerification)(th.currentUser,e),tt.success("Verification email sent! Please check your inbox.")}catch(m){console.error("Error sending verification email:",m),tt.error("Failed to send verification email. Please try again later.")}})()})).catch((e=>{"auth/user-not-found"===e.code?tt.error("No account found with this email"):"auth/wrong-password"===e.code?tt.error("Incorrect password. Please enter the correct password to verify your email."):(console.error("Error signing in to resend verification:",e),tt.error("Please make sure your email and password are correct"))})):tt.error("Please enter your email first")},className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Resend verification email"})})]})]})}),r&&(0,gk.jsx)("div",{className:"modal-overlay",children:(0,gk.jsxs)("div",{className:"auth-modal",children:[(0,gk.jsx)("button",{className:"close-btn",onClick:()=>{console.log("Closing signup modal"),s(!1),h(!1),f({name:"",email:"",password:"",confirmPassword:"",specialization:"",expertise:"",experience:"",education:"",patients:"",description:"",availableDates:[],availableSlots:[]}),y({name:"",email:"",password:"",confirmPassword:""})},children:"\xd7"}),(0,gk.jsx)("h2",{children:d?"Doctor Registration":"User Registration"}),m&&(0,gk.jsx)("div",{className:"error-message",children:m}),(0,gk.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),console.log("Signup form submitted"),g(""),d){if(console.log("Doctor signup data:",p),p.password!==p.confirmPassword)return void g("Passwords do not match")}else if(console.log("User signup data:",v),v.password!==v.confirmPassword)return void g("Passwords do not match");try{if(d){console.log("Creating Firebase user for doctor");const e=await(0,ht.createUserWithEmailAndPassword)(th,p.email,p.password);console.log("Firebase user created:",e.user.uid);const r=e.user;console.log("User reference stored:",r.uid),console.log("Sending verification email");try{const e={url:window.location.origin+"/?verifyEmail=true",handleCodeInApp:!0};await(0,ht.sendEmailVerification)(r,e),console.log("Verification email sent successfully with proper action URL")}catch(t){console.error("Error sending verification email:",t);try{await r.delete(),console.log("Firebase user deleted after verification email failure")}catch(n){console.error("Error deleting Firebase user:",n)}throw new Error("Failed to send verification email: "+t.message)}let o=!1,a=null;console.log("Attempting to register doctor with backend");try{const e=await fetch("http://localhost:5000/api/doctors/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:p.name,email:p.email,password:p.password,specialization:p.specialization,expertise:p.expertise,experience:p.experience,education:p.education,patients:parseInt(p.patients),description:p.description,uid:r.uid,availableDates:[],availableSlots:[]})}),t=await e.json();e.ok?(o=!0,a=t.doctorId):console.error("Backend registration failed:",t)}catch(i){console.error("Error registering with backend:",i)}await(0,ht.signOut)(th),o?tt.success(`Doctor registration request submitted. Please check your email for verification. Your Doctor ID is: ${a}`):tt.success("Account created and verification email sent! Note: Your doctor profile could not be fully set up at this time. Please contact support after verifying your email."),s(!1),h(!1),f({name:"",email:"",password:"",confirmPassword:"",specialization:"",expertise:"",experience:"",education:"",patients:"",description:"",availableDates:[],availableSlots:[]})}else{console.log("Creating Firebase user for regular user");const e=await(0,ht.createUserWithEmailAndPassword)(th,v.email,v.password);console.log("Firebase user created:",e.user.uid);const i=e.user;console.log("User reference stored:",i.uid),console.log("Sending verification email");try{const e={url:window.location.origin+"/?verifyEmail=true",handleCodeInApp:!0};await(0,ht.sendEmailVerification)(i,e),console.log("Verification email sent successfully with proper action URL")}catch(t){console.error("Error sending verification email:",t);try{await i.delete(),console.log("Firebase user deleted after verification email failure")}catch(n){console.error("Error deleting Firebase user:",n)}throw new Error("Failed to send verification email: "+t.message)}let o=!1;console.log("Attempting to store user data in Firestore");try{const e={name:v.name,email:i.email,createdAt:(new Date).toISOString(),userId:i.uid};console.log("Attempting to write user data with add()");const t=await function(e,t){const n=bd(e.firestore,Pd),i=Id(e),r=Xd(e.converter,t);return Zd(n,[$d(Bd(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,sa.exists(!1))]).then((()=>i))}(function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=(0,ft.Ku)(e),md("collection","path",t),e instanceof kd){const n=xi.fromString(t,...i);return vd(n),new Ed(e,null,n)}{if(!(e instanceof Sd||e instanceof Ed))throw new hi(di.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(xi.fromString(t,...i));return vd(n),new Ed(e.firestore,null,n)}}(nh,"users"),e);console.log("User data stored successfully with ID:",t.id),o=!0}catch(r){console.error("Error storing user data in Firestore:",r),console.log("Continuing registration without Firestore storage")}await(0,ht.signOut)(th),o?tt.success("Account created successfully! Please check your email for verification."):tt.success("Account created and verification email sent! Please note: Your profile data could not be stored at this time, but you can update it after verifying your email."),s(!1),y({name:"",email:"",password:"",confirmPassword:""})}}catch(m){console.error("Error signing up:",m),"auth/email-already-in-use"===m.code?g("This email is already registered. Please use a different email or sign in."):"auth/invalid-email"===m.code?g("Please enter a valid email address."):"auth/weak-password"===m.code?g("Password should be at least 6 characters long."):g(m.message||"An error occurred during registration.")}},className:"auth-form",children:[d?(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"name",children:"Name"}),(0,gk.jsx)("input",{type:"text",id:"name",value:p.name,onChange:e=>f({...p,name:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"email",children:"Email"}),(0,gk.jsx)("input",{type:"email",id:"email",value:p.email,onChange:e=>f({...p,email:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"password",children:"Password"}),(0,gk.jsx)("input",{type:"password",id:"password",value:p.password,onChange:e=>f({...p,password:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),(0,gk.jsx)("input",{type:"password",id:"confirmPassword",value:p.confirmPassword,onChange:e=>f({...p,confirmPassword:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"specialization",children:"Specialization"}),(0,gk.jsxs)("select",{id:"specialization",value:p.specialization,onChange:e=>f({...p,specialization:e.target.value}),required:!0,children:[(0,gk.jsx)("option",{value:"",children:"Select specialization"}),(0,gk.jsx)("option",{value:"Cardiology",children:"Cardiology"}),(0,gk.jsx)("option",{value:"Dermatology",children:"Dermatology"}),(0,gk.jsx)("option",{value:"Neurology",children:"Neurology"}),(0,gk.jsx)("option",{value:"Pediatrics",children:"Pediatrics"}),(0,gk.jsx)("option",{value:"Orthopedics",children:"Orthopedics"}),(0,gk.jsx)("option",{value:"Ophthalmology",children:"Ophthalmology"}),(0,gk.jsx)("option",{value:"ENT",children:"ENT"}),(0,gk.jsx)("option",{value:"Dental",children:"Dental"}),(0,gk.jsx)("option",{value:"Psychiatry",children:"Psychiatry"}),(0,gk.jsx)("option",{value:"General",children:"General"})]})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"expertise",children:"Expertise"}),(0,gk.jsx)("input",{type:"text",id:"expertise",value:p.expertise,onChange:e=>f({...p,expertise:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"experience",children:"Years of Experience"}),(0,gk.jsx)("input",{type:"number",id:"experience",value:p.experience,onChange:e=>f({...p,experience:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"education",children:"Education"}),(0,gk.jsx)("input",{type:"text",id:"education",value:p.education,onChange:e=>f({...p,education:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"patients",children:"Number of Patients Treated"}),(0,gk.jsx)("input",{type:"number",id:"patients",value:p.patients,onChange:e=>f({...p,patients:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"description",children:"Professional Description"}),(0,gk.jsx)("textarea",{id:"description",value:p.description,onChange:e=>f({...p,description:e.target.value}),rows:"3",required:!0})]})]}):(0,gk.jsxs)(gk.Fragment,{children:[(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"userName",children:"Name"}),(0,gk.jsx)("input",{type:"text",id:"userName",value:v.name,onChange:e=>y({...v,name:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"userEmail",children:"Email"}),(0,gk.jsx)("input",{type:"email",id:"userEmail",value:v.email,onChange:e=>y({...v,email:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"userPassword",children:"Password"}),(0,gk.jsx)("input",{type:"password",id:"userPassword",value:v.password,onChange:e=>y({...v,password:e.target.value}),required:!0})]}),(0,gk.jsxs)("div",{className:"form-group",children:[(0,gk.jsx)("label",{htmlFor:"userConfirmPassword",children:"Confirm Password"}),(0,gk.jsx)("input",{type:"password",id:"userConfirmPassword",value:v.confirmPassword,onChange:e=>y({...v,confirmPassword:e.target.value}),required:!0})]})]}),(0,gk.jsxs)("div",{className:"flex justify-between items-center",children:[(0,gk.jsx)("button",{type:"button",onClick:()=>{console.log("Switching to:",d?"User":"Doctor","registration"),h(!d)},className:"text-sm text-blue-600 hover:text-blue-800",children:d?"Register as User":"Register as Doctor"}),(0,gk.jsx)("button",{type:"submit",className:"submit-button",children:d?"Register Doctor":"Register User"})]})]})]})})]}),(0,gk.jsx)(ct,{position:"top-right",autoClose:5e3})]})})]})};(0,c.H)(document.getElementById("root")).render((0,gk.jsx)(a.StrictMode,{children:(0,gk.jsx)(Ce,{children:(0,gk.jsx)(hL,{})})}))})()})();
//# sourceMappingURL=main.7387c71e.js.map